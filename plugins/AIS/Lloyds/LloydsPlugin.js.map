{"version":3,"sources":["webpack:///webpack/bootstrap b132909f4442412760d3","webpack:///./src/entry.js","webpack:///./src/all.css","webpack:///./src/Views/View.css","webpack:///./src/locale.js","webpack:///./src/Polyfill2.js","webpack:///./src/PluginPanel.js","webpack:///./src/ViewsFactory.js","webpack:///./src/Views/MyCollectionView.js","webpack:///./src/Views/MyCollection.css","webpack:///./src/Views/BaseView.js","webpack:///./src/Search/SearchControl.js","webpack:///./src/Search/SearchControl.css","webpack:///./src/Models/MyCollectionModel.js","webpack:///./src/Polyfill.js","webpack:///./src/Views/RegisterDlgView.js","webpack:///./src/Views/RegisterDialog.css","webpack:///./src/Models/RegisterModel.js","webpack:///./src/Search/Searcher.js"],"names":["PRODUCTION","NOSIDEBAR","SIDEBAR2","require","pluginName","menuId","toolbarIconId","cssTable","modulePath","gmxCore","getModulePath","PluginPanel","ViewsFactory","publicInterface","afterViewer","params","map","options","aisLastPoint","viewFactory","pluginPanel","sidebar","window","iconSidebarWidget","tab","createTabFunction","icon","active","inactive","hint","_gtxt","tabDiv","querySelector","sidebarPane","setPane","createTab","append","innerHTML","addEventListener","e","_activeTabId","show","addModule","css","_translationsHash","addtext","proto","matches","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","closest","selector","parentElement","Element","prototype","arr","CharacterData","DocumentType","args","forEach","item","push","hasOwnProperty","Object","defineProperty","configurable","enumerable","writable","value","remove","parentNode","removeChild","argArr","Array","slice","call","arguments","docFrag","document","createDocumentFragment","argItem","isNode","Node","appendChild","createTextNode","String","Document","DocumentFragment","NodeList","module","exports","_isReady","_activeView","_canvas","_div","_views","create","_create","$","v","frame","resize","_returnInstance","MyCollectionView","MyCollectionModel","RegisterDlgView","RegisterModel","Searcher","_searcher","_rm","_rdv","model","_mcm","_mcv","registerDlg","BaseView","SearchControl","Handlebars","compile","gifLoader","container","find","searchInput","callback","vessel","mmsi","data","vessels","every","x","rs","save","bind","tableTemplate","on","collection","length","_clean","count","text","inProgress","state","progress","hide","h","height","outerHeight","repaint","each","i","elm","inst","off","splice","focus","apply","_calcHeight","template","getBoundingClientRect","H","topOffset","view","scrollCont","empty","isActive","is","clean","startScreen","position","top","content","mCustomScrollbar","mcsbOptions","_this","target","JSON","parse","attr","infoDialogView","xmin","xmax","longitude","ymin","ymax","latitude","ts_pos_utc","ts_pos_org","dt_pos_utc","html","stringify","stopPropagation","update","_searchString","_sparams","localStorage","getItem","suggestions","createElement","preferences","classList","add","search","asparams","split","console","log","p","q","searchBut","prefeBut","removeBut","delay","suggestionsCount","suggestionsFrame","first","current","last","found","values","searchDone","vessel_name","doSearch","actualId","queries","fetch","sp","Promise","all","then","a","r","status","json","concat","Name","MMSI","imo","IMO","vessel_type","Type","RS","owner","RegisteredOwner","callsign","Callsign","reject","style","display","suggestion","querySelectorAll","cr","left","bottom","width","Math","round","el","onclick","currentTarget","id","response","offsetWidth","ch","contains","sparam","replace","RegExp","setItem","clearTimeout","onkeydown","keyCode","previousSibling","nextSibling","scrollInertia","prepareSearchInput","temp","click","onkeyup","setTimeout","onpaste","originalEvent","clipboardData","getData","Polyfill","searcher","_actualUpdate","_data","isDirty","predicate","list","thisArg","undefined","findIndex","set","filter","indexOf","new_tasks","some","cv","tasks","axis","callbacks","whileScrolling","mcs","direction","onScrollStart","mousedown","loadMeta","feeldsTree","columns","checked","caption","j","nodes","k","name","disabled","trans","_export","ev","form","FormData","_vesselsToExport","c","serverBase","method","mode","body","credentials","res","src","catch","_showFieldsTree","panel","offset","siblings","_showFieldsTreeBranch","lbl","b","_dialog","_dialogRect","_dialogW","w","_dialogH","_containerH","dx","dy","canvas","screen","sw","parseFloat","getComputedStyle","sh","posX","posY","isMaximized","columns_ts","columnsTs","showDialog","closeFunc","timestamp","dialog","resizable","event","ui","size","parent","titlebar","parents","chb","node","s","n","pop","uls","inputs","eq","_repaintExport","cells","getOuterWidth","setOuterWidth","w1","after","cont_w","calc_w","returnInstance","beforeLoad","load","z","rr","parseInt","version","ds","properties","wait","Date","getTime","actualUpdate","Status","toLowerCase","ErrorInfo","msg","txt","resolve","columnsJson","promise","Error","convert","name1","name3","name2","e0","i0","e1","i1","e2","i2","attributes","nn","_baseUrl","location","href","_aisServices","_serverScript","_aisLastPoint","_screenSearchLayer","screenSearchLayer","_aisLayerID","aisLayerID","_historyLayer","historyLayer","baseUrl","aisServices","getBorder","lmap","nsGmx","leafletMap","dFeatures","gmxDrawing","getFeatures","toGeoJSON","latLngBounds","getBounds","getSouthWest","ne","getNorthEast","min","lng","y","lat","max","minX","maxX","geo","type","coordinates","center","formatTime","d","local","setMinutes","getMinutes","getTimezoneOffset","toLocaleTimeString","formatDate","toLocaleDateString","formatDateTime","isNaN","toLocaleString","formatDate2","dd","m","mm","getDate","getMonth","getFullYear","getHours","getUTCHours","getUTCMinutes","getUTCDate","getUTCMonth","getUTCFullYear","ldd","lm","ly","lh","lmm","searchString","isfuzzy"],"mappings":"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","file":"LloydsPlugin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b132909f4442412760d3","let PRODUCTION = false,\r\n    NOSIDEBAR = false,\r\n    SIDEBAR2 = false;\r\nif (has('PRODUCTION')) PRODUCTION = true;\r\nif (has('NOSIDEBAR'))  NOSIDEBAR = true;\r\nif (has('SIDEBAR2'))   SIDEBAR2 = true;\r\n\r\nrequire(\"./all.css\");\r\nrequire(\"./Views/View.css\");\r\nrequire(\"./locale.js\");\r\nrequire(\"./Polyfill2.js\");\r\n\r\nconst pluginName = PRODUCTION ? 'LloydsPlugin' : 'LloydsPluginTest',\r\n      menuId = 'LloydsPlugin',\r\n      toolbarIconId = null, \r\n      cssTable = PRODUCTION ? 'LloydsPlugin' : 'LloydsPlugin',\r\n      modulePath = gmxCore.getModulePath(pluginName);\r\n\r\nconst PluginPanel = require('./PluginPanel.js'),\r\n      ViewsFactory = require('./ViewsFactory');\r\n\r\nconst publicInterface = {\r\n    pluginName: pluginName,\r\n    afterViewer: function (params, map) {\r\n        const options = {\r\n            aisLastPoint: '303F8834DEE2449DAF1DA9CD64B748FE',\r\n            modulePath: modulePath,\r\n            },\r\n            viewFactory = new ViewsFactory(options),\r\n            pluginPanel = new PluginPanel(viewFactory);\r\n        pluginPanel.menuId = menuId;\r\n\r\n        let sidebar = window.iconSidebarWidget,\r\n        tab = window.createTabFunction({\r\n                    icon: \"Lloyds\", //menuId,\r\n                    active: \"lloyds_sidebar-icon\",\r\n                    inactive: \"lloyds_sidebar-icon\",\r\n                    hint: _gtxt('Lloyds.title')\r\n                })();\r\n        //tab.querySelector('.Lloyds').innerHTML = '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 14 14\"><path d=\"M13.13,0H0.88A0.83,0.83,0,0,0,0,.88V13.13A0.83,0.83,0,0,0,.88,14H13.13A0.83,0.83,0,0,0,14,13.13V0.88A0.83,0.83,0,0,0,13.13,0ZM12.25,12.25H1.75V1.75h10.5v10.5Z\"/><rect x=\"3.5\" y=\"4.38\" width=\"7\" height=\"1.75\"/><rect x=\"3.5\" y=\"7.88\" width=\"7\" height=\"1.75\"/></svg>';\r\n        let tabDiv = tab.querySelector('.Lloyds');\r\n        pluginPanel.sidebarPane = sidebar.setPane(\r\n            menuId, {\r\n                createTab: ()=>{\r\n                    !tab.querySelector('.Lloyds') && tab.append(tabDiv);\r\n                    tab.querySelector('.Lloyds').innerHTML = '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"14\" viewBox=\"0 0 14 14\"><path d=\"M13.13,0H0.88A0.83,0.83,0,0,0,0,.88V13.13A0.83,0.83,0,0,0,.88,14H13.13A0.83,0.83,0,0,0,14,13.13V0.88A0.83,0.83,0,0,0,13.13,0ZM12.25,12.25H1.75V1.75h10.5v10.5Z\"/><rect x=\"3.5\" y=\"4.38\" width=\"7\" height=\"1.75\"/><rect x=\"3.5\" y=\"7.88\" width=\"7\" height=\"1.75\"/></svg>';\r\n                    return tab;\r\n                }\r\n            }\r\n        )\r\n        sidebar.addEventListener('opened', function (e) {\r\n            if (sidebar._activeTabId == menuId)\r\n                pluginPanel.show();\r\n        });\r\n    }\r\n};\r\n\r\ngmxCore.addModule(pluginName, publicInterface, {\r\n    css: cssTable + '.css'\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/entry.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/all.css\n// module id = 1\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/View.css\n// module id = 3\n// module chunks = 0","\r\n    _translationsHash.addtext('rus', {\r\n        \"Lloyds.title\": \" \",\r\n        \"Lloyds.search_placeholder\": \"\",\r\n        \"Lloyds.found\":\": \",\r\n        \"Lloyds.vesselExclude\":\"\",\r\n        \"Lloyds.showRegister\":\" \",\r\n        \"Lloyds.cleanList\":\" \",\r\n\r\n        \"Lloyds.fieldsSelector\":\" \",\r\n        \"Lloyds.dlgTitle\":\" \",\r\n        \"Lloyds.closeButton\":\"\",\r\n        \"Lloyds.expandButton\":\"\",\r\n        \"Lloyds.shrinkButton\":\"\",\r\n    });\r\n    _translationsHash.addtext('eng', {\r\n        \"Lloyds.title\": \"Lloyd's register\",\r\n        \"Lloyds.search_placeholder\": \"Search\",\r\n        \"Lloyds.found\":\"Found \",\r\n        \"Lloyds.vesselExclude\":\"remove\",\r\n        \"Lloyds.showRegister\":\"Open register\",\r\n        \"Lloyds.cleanList\":\"Clean\",\r\n        \"Lloyds.fieldsSelector\":\"Select columns\",\r\n        \"Lloyds.dlgTitle\":\"Register\",\r\n        \"Lloyds.closeButton\":\"close\",\r\n        \"Lloyds.expandButton\":\"maximize\",\r\n        \"Lloyds.shrinkButton\":\"minimize\",\r\n    });\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/locale.js","// Element.closest\r\n(function(proto) {\r\n    proto.matches = proto.matches || proto.mozMatchesSelector || proto.msMatchesSelector || proto.oMatchesSelector || proto.webkitMatchesSelector;\r\n    proto.closest = proto.closest || function closest(selector) {\r\n        if (!this) return null;\r\n        if (this.matches(selector)) return this;\r\n        if (!this.parentElement) {return null}\r\n        else return this.parentElement.closest(selector)\r\n      };\r\n}(Element.prototype));\r\n\r\n// Element.remove\r\n(function() {\r\n    var arr = [window.Element, window.CharacterData, window.DocumentType];\r\n    var args = [];\r\n  \r\n    arr.forEach(function (item) {\r\n      if (item) {\r\n        args.push(item.prototype);\r\n      }\r\n    });  \r\n    // from:https://github.com/jserz/js_piece/blob/master/DOM/ChildNode/remove()/remove().md\r\n    (function (arr) {\r\n      arr.forEach(function (item) {\r\n        if (item.hasOwnProperty('remove')) {\r\n          return;\r\n        }\r\n        Object.defineProperty(item, 'remove', {\r\n          configurable: true,\r\n          enumerable: true,\r\n          writable: true,\r\n          value: function remove() {\r\n            this.parentNode && this.parentNode.removeChild(this);\r\n          }\r\n        });\r\n      });\r\n    })(args);\r\n  })();\r\n\r\n// Element.append, Document.append, DocumentFragment.append\r\n(function (arr) {\r\n    arr.forEach(function (item) {\r\n      if (item.hasOwnProperty('append')) {\r\n        return;\r\n      }\r\n      Object.defineProperty(item, 'append', {\r\n        configurable: true,\r\n        enumerable: true,\r\n        writable: true,\r\n        value: function append() {\r\n          var argArr = Array.prototype.slice.call(arguments),\r\n            docFrag = document.createDocumentFragment();\r\n          \r\n          argArr.forEach(function (argItem) {\r\n            var isNode = argItem instanceof Node;\r\n            docFrag.appendChild(isNode ? argItem : document.createTextNode(String(argItem)));\r\n          });\r\n          \r\n          this.appendChild(docFrag);\r\n        }\r\n      });\r\n    });\r\n  })([Element.prototype, Document.prototype, DocumentFragment.prototype]);\r\n\r\n//NodeList.forEach\r\nNodeList.prototype[\"forEach\"] = NodeList.prototype[\"forEach\"] || Array.prototype[\"forEach\"];\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Polyfill2.js","let NOSIDEBAR = false,\r\n    PRODUCTION = false,\r\n    SIDEBAR2 = false;\r\nif (has('NOSIDEBAR'))\r\n    NOSIDEBAR = true;\r\nif (has('SIDEBAR2'))\r\n    SIDEBAR2 = true;\r\nif (has('PRODUCTION'))\r\n    PRODUCTION = true;\r\n\r\n\r\nmodule.exports = function (viewFactory) {\r\n    let _isReady = false,\r\n        _activeView,\r\n        _canvas = _div(null),\r\n        _views = viewFactory.create(),\r\n        _create = function () {\r\n            $(this.sidebarPane).append(_canvas);\r\n            $(_canvas).append(_views.map(v => v.frame));\r\n            _views[0].resize(true);\r\n            _views[0].show();\r\n            _activeView = _views[0];\r\n            _isReady = true;\r\n        };\r\n    const _returnInstance = {\r\n        show: function () {          \r\n            if (!_isReady)\r\n            {\r\n                _create.call(this);\r\n            }\r\n            else{       \r\n                _activeView && _activeView.show();\r\n            }\r\n        }\r\n    }\r\n    return _returnInstance;\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/PluginPanel.js","/*\r\nconst ScreenSearchView = require('./Views/ScreenSearchView'),\r\n    ScreenSearchModel = require('./Models/ScreenSearchModel'),\r\n    MyFleetView = require('./Views/MyFleetView'),\r\n    MyFleetModel = require('./Models/MyFleetModel'),\r\n    DbSearchView = require('./Views/DbSearchView'),\r\n    DbSearchModel = require('./Models/DbSearchModel'),\r\n    InfoDialogView = require('./Views/InfoDialogView'),\r\n    Toolbox = require('./Toolbox.js');\r\n*/\r\nconst MyCollectionView = require('./Views/MyCollectionView'),\r\n      MyCollectionModel = require('./Models/MyCollectionModel'),\r\n      RegisterDlgView = require('./Views/RegisterDlgView'),\r\n      RegisterModel = require('./Models/RegisterModel'),\r\n      Searcher = require('./Search/Searcher');\r\nmodule.exports = function (options) {   \r\n    const _searcher = new Searcher(options),\r\n          _rm = new RegisterModel(_searcher),\r\n          _rdv = new RegisterDlgView({model:_rm/*, highlight:options.highlight, tools:_tools*/}),\r\n          _mcm = new MyCollectionModel(_searcher),\r\n          _mcv = new MyCollectionView({model:_mcm/*, highlight:options.highlight, tools:_tools*/, registerDlg: _rdv}); \r\n    return {\r\n        create: function () {\r\n            return [_mcv];\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/ViewsFactory.js","require(\"./MyCollection.css\")\r\nconst BaseView = require('./BaseView.js');\r\nconst SearchControl = require('../Search/SearchControl.js');\r\n\r\n//let _searchString = \"\";\r\n\r\nconst MyCollectionView = function ({ model, registerDlg }) {\r\n        BaseView.call(this, model);\r\n        this.frame = $(Handlebars.compile('<div class=\"lloyds_view search_view\">' +\r\n            '<table border=0 class=\"instruments\">' +\r\n            '<tr><td class=\"search_input_container\"></td></tr>' +\r\n            '</table>' +   \r\n            '<table class=\"results\">'+\r\n            '<td class=\"count\"></td>' +\r\n            '<td><div class=\"refresh clicable\"><div>' + this.gifLoader + '</div></div></td></tr>' +\r\n            '</table>'+    \r\n            // '<table class=\"start_screen\"><tr><td>' +\r\n            // '<img src=\"plugins/AIS/AISSearch/svg/steer-weel.svg\">' +\r\n            // '<div>  <br>   ,<br>' +\r\n            // 'IMO  MMSI ' +\r\n            // '</div></td></tr></table>' +\r\n            '<div class=\"ais_vessels\">'+\r\n            '<div class=\"ais_vessel\">' +\r\n            '<table><tr><div class=\"position\">vessel name</div><div>mmsi:  imo: </div></tr></table>' +\r\n            '</div>' +\r\n            '</div>' +\r\n            '<table class=\"menu\">'+\r\n            '<td class=\"open clicable\"><div>{{i \"Lloyds.showRegister\"}}</div></td>' +\r\n            '<td class=\"clean clicable\"><div>{{i \"Lloyds.cleanList\"}}</div></td></tr>' +\r\n            '</table></div>'\r\n        )());\r\n\r\n        this.container = this.frame.find('.ais_vessels');\r\n        //this.startScreen = this.frame.find('.start_screen');\r\n        this.searchInput = new SearchControl({tab:this.frame[0], container:this.frame.find('.search_input_container')[0],\r\n            callback:(v=>{\r\n                        if (!this.vessel || this.vessel.mmsi != v.mmsi || !this.frame.find('.ais_positions_date')[0]) {\r\n                            //LOAD INTO LOCAL REGISTRY\r\n                            if (this.model.data.vessels.every(x=>x.rs!=v.rs)){\r\n                                this.model.data.vessels.push(v);\r\n                                this.model.save();\r\n                                this.show();\r\n                            }\r\n                        }\r\n            }).bind(this)\r\n        });\r\n        this.tableTemplate = '{{#each vessels}}' +\r\n            '<div class=\"ais_vessel\">' +\r\n            '<table border=0><tr>' +\r\n            '<td><div class=\"position\">{{vessel_name}}</div><div>mmsi: {{mmsi}} imo: {{imo}}</div></td>' +\r\n            '<td><div class=\"exclude button\" title=\"{{i \"Lloyds.vesselExclude\"}}\"></div></td>' +\r\n            '</tr></table>' +\r\n            '</div>' +\r\n            '{{/each}}' +\r\n            '{{#each msg}}<div class=\"msg\">{{txt}}</div>{{/each}}';\r\n    \r\n        this.frame.find('.menu .open').on('click', ()=>{\r\n            registerDlg.collection = this.model.data.vessels.map(v=>v.rs);\r\n            registerDlg.show();\r\n        })\r\n        this.frame.find('.menu .clean').on('click', (()=>{\r\n            this.model.data.vessels.length = 0;\r\n            this.model.save();\r\n            this.show();\r\n        }).bind(this));        \r\n    },\r\n    _clean = function () {\r\n        //this.startScreen.css({ visibility: \"hidden\" });\r\n        let count = this.model.data && this.model.data.vessels ? this.model.data.vessels.length : 0;\r\n        this.frame.find('.count').text(_gtxt('Lloyds.found') + count);\r\n    };\r\n\r\nMyCollectionView.prototype = Object.create(BaseView.prototype);\r\n\r\nMyCollectionView.prototype.inProgress = function (state) {\r\n    let progress = this.frame.find('.refresh div');\r\n    if (state)\r\n        progress.show();\r\n    else\r\n        progress.hide();\r\n};\r\n\r\nMyCollectionView.prototype.resize = function () { \r\n    let h = $('.iconSidebarControl-pane').height() - this.frame.find('.instruments').outerHeight()\r\n    - this.frame.find('.results').outerHeight() - this.frame.find('.menu').outerHeight();\r\n    this.container.height(h+1);\r\n};\r\n\r\nMyCollectionView.prototype.repaint = function () { \r\n    _clean.call(this);\r\n    BaseView.prototype.repaint.call(this); \r\n    this.frame.find('.exclude').each(((i, elm)=>{\r\n        let inst = this;\r\n        $(elm).on('click', ()=>{\r\n            $(elm).off('click');\r\n            //UPDATE LOCAL REGISTRY\r\n            inst.model.data.vessels.splice(i, 1);\r\n            inst.model.save();\r\n            inst.show();\r\n        })\r\n    }).bind(this));  \r\n};\r\n\r\nMyCollectionView.prototype.show = function () {\r\n    this.frame.show();\r\n    this.searchInput.focus();\r\n    BaseView.prototype.show.apply(this, arguments);\r\n};\r\n\r\nmodule.exports = MyCollectionView;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Views/MyCollectionView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/MyCollection.css\n// module id = 9\n// module chunks = 0","let NOSIDEBAR = false,\r\n    PRODUCTION = false,\r\n    SIDEBAR2 = false;\r\nif (has('NOSIDEBAR'))\r\n    NOSIDEBAR = true;\r\nif (has('SIDEBAR2'))\r\n    SIDEBAR2 = true;\r\nif (has('PRODUCTION'))\r\n    PRODUCTION = true;\r\n\r\nlet _calcHeight = function () {\r\n    let template = this.frame.find('.ais_vessel')[0] || this.frame.find('.ais_positions_date')[0],\r\n        h = template.getBoundingClientRect().height\r\n    if (NOSIDEBAR)\r\n        return h * 5;\r\n    else {\r\n        let H = $('.iconSidebarControl-pane').height() - this.topOffset;\r\n// console.log(template.getBoundingClientRect())\r\n// console.log(this.topOffset)\r\n// console.log(H)\r\n        return (H - H%h);\r\n    }\r\n};\r\n\r\nconst BaseView = function (model) {\r\n    model.view = this;\r\n    this.model = model;\r\n    this.gifLoader = '<img src=\"img/progress.gif\">';\r\n};\r\n\r\nlet _clean = function(){ \r\n    this.container.find('.info').off('click');\r\n    this.container.find('.position', ).off('click');   \r\n    let scrollCont = this.container.find('.mCSB_container')\r\n    if (scrollCont[0]){\r\n        scrollCont.empty();\r\n    }\r\n    else{\r\n        this.container.empty();\r\n    }\r\n};\r\n\r\nBaseView.prototype = function () {\r\n    return {\r\n        get isActive(){\r\n            return this.frame.is(\":visible\");\r\n        },\r\n        resize: function (clean) {\r\n            let h = _calcHeight.call(this);\r\n            if (this.startScreen){\r\n                this.startScreen.height(h);\r\n                this.container.css({ position:\"relative\", top: -h+\"px\" });\r\n            }\r\n            this.container.height(h);\r\n\r\n            if (clean){\r\n                this.container.empty()\r\n            }\r\n        },\r\n        repaint: function(){\r\n            _clean.call(this);            \r\n//console.log(this.model.data)\r\n            if (!this.model.data)\r\n                return;\r\n            let scrollCont = this.container.find('.mCSB_container'),\r\n            content = $(Handlebars.compile(this.tableTemplate)(this.model.data));          \r\n//console.log(scrollCont[0])\r\n            if (!scrollCont[0]) {\r\n                this.container.append(content).mCustomScrollbar(this.mcsbOptions);\r\n            }\r\n            else {\r\n                $(scrollCont).append(content);\r\n            }\r\n\r\n            var _this = this;\r\n            this.container.find('.info', ).on('click', function (e) {\r\n                let target = $(this),\r\n                    vessel = JSON.parse(target.attr('vessel'))\r\n//console.log(vessel)\r\n                _this.infoDialogView && _this.infoDialogView.show(vessel, (v) => {\r\n//console.log(v)\r\n                    vessel.xmin = vessel.xmax = v.longitude\r\n                    vessel.ymin = vessel.ymax = v.latitude\r\n                    if (vessel.hasOwnProperty('ts_pos_utc')) {\r\n                         vessel.ts_pos_utc = v.ts_pos_utc;\r\n                         vessel.ts_pos_org = v.ts_pos_org;\r\n                         v.dt_pos_utc && $(this).closest('tr').find('.date').html(v.dt_pos_utc);\r\n                    }\r\n                    target.attr('vessel', JSON.stringify(vessel))\r\n                });\r\n                e.stopPropagation();\r\n            });\r\n//             this.container.find('.ais_vessel').on('click', function () {\r\n// //console.log(JSON.parse($(this).find('.info').attr('vessel')))\r\n//                 let v = JSON.parse($(this).find('.info').attr('vessel'));                \r\n//                 v.lastPosition = true;\r\n//                 _this.infoDialogView.showPosition(v);\r\n//             });      \r\n        },\r\n        show: function () {\r\n            this.frame.show();\r\n            this.model.update();\r\n        },\r\n        hide: function () {\r\n            this.frame.hide();\r\n        }\r\n    }\r\n}();\r\n\r\nmodule.exports = BaseView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/BaseView.js","require(\"./SearchControl.css\")\r\n\r\nlet _searchString = \"\",\r\n_sparams = localStorage.getItem('lloyds_searchparams');\r\nconst SearchControl = function ({ tab, container, callback }) {\r\n\r\n    container.innerHTML = '<div class=\"filter\"><input type=\"text\" placeholder=\"' + _gtxt(\"Lloyds.search_placeholder\") + '\"/>' +\r\n        '<div class=\"preferences\"></div>' +\r\n        '<div class=\"searchremove\"><img class=\"search\" src=\"plugins/AIS/AISSearch/svg/search.svg\">' +\r\n        '<img class=\"remove clicable\" src=\"plugins/AIS/AISSearch/svg/remove.svg\"></div>' +\r\n        '</div>';\r\n    let suggestions = tab.appendChild(document.createElement('div')),\r\n        preferences = tab.appendChild(document.createElement('div'))\r\n    suggestions.classList.add(\"suggestions\");\r\n    preferences.classList.add(\"preferences\");\r\n    suggestions.innerHTML = '<div class=\"suggestion\">SOME VESSEL<br><span>mmsi:0, imo:0</span></div>';\r\n    preferences.innerHTML = '<div class=\"section\"> :</div>' +\r\n    '<div class=\"line\"><div class=\"checkbox imo disabled\"></div><div class=\"label\">IMO<label></div></div>' + \r\n    '<div class=\"line\"><div class=\"checkbox mmsi\"></div><div class=\"label\">MMSI<label></div></div>' + \r\n    '<div class=\"line\"><div class=\"checkbox name disabled\"></div><div class=\"label\"></div></div>' + \r\n    '<div class=\"line\"><div class=\"checkbox callsign\"></div><div class=\"label\"><label></div></div>' + \r\n    '<div class=\"line\"><div class=\"checkbox owner\"></div><div class=\"label\"><label></div></div>';\r\n    !_sparams && (_sparams = 'imo name'); \r\n    if (_sparams.search(/imo/)<0)\r\n        _sparams += ' imo'; \r\n    if (_sparams.search(/name/)<0)\r\n        _sparams += ' name';\r\n    let asparams =_sparams.split(' ');\r\nconsole.log(asparams)\r\n    asparams.forEach((p,i)=>{ preferences.querySelector('.'+p).classList.add('checked') })\r\n\r\n    this.frame = { find: (q) => { return container.querySelector(q) } }\r\n    this.searchInput = this.frame.find('.filter input');\r\n\r\n    let searchBut = this.frame.find('.filter .search'),\r\n        prefeBut = this.frame.find('.filter .preferences'),\r\n        removeBut = this.frame.find('.filter .remove'),\r\n        delay,\r\n        //suggestions = this.frame.find('.suggestions'),\r\n        suggestionsCount = 5,\r\n        suggestionsFrame = { first: 0, current: 0, last: suggestionsCount - 1 },\r\n        found = { values: [] },\r\n        searchDone = function () {\r\n            if (found.values.length > 0) {\r\n                _searchString = found.values[suggestionsFrame.current].vessel_name;\r\n                this.searchInput.value = (_searchString);\r\n                callback(found.values[suggestionsFrame.current]);\r\n            }\r\n            // else {\r\n            //     _clean.call(this);\r\n            // }\r\n        },\r\n        doSearch = function (actualId) {\r\n            let queries = [];\r\n            _sparams.split(' ').forEach(sp=>{       \r\n                queries.push(fetch(\"//www.kosmosnimki.ru/demo/lloyds/api/v1/Ship/Search/\" + sp + \"/\" + _searchString));\r\n            });\r\n            Promise.all(queries)\r\n            .then(a=>{\r\n//console.log(a)\r\n                return Promise.all(a.map(r=>{\r\n                    if (r.status != 200){\r\n                        console.log(r)                       \r\n                        return [];\r\n                    }\r\n                    else\r\n                        return r.json()\r\n                }))\r\n            })\r\n            .then(a=>{\r\n//console.log(actualId+\" \"+delay)\r\n//console.log(a)\r\n                if (actualId==delay){\r\n                    found = {values:[]};\r\n                    a.forEach(r=>{\r\n                        found.values = found.values.concat(\r\n                            r.map(v=>{\r\n                            return { vessel_name: v.Name, mmsi: v.MMSI, imo: v.IMO, vessel_type: v.Type, rs: v.RS, owner: v.RegisteredOwner, callsign: v.Callsign }\r\n                            })\r\n                        )\r\n                    });\r\n//console.log(found.values)\r\n                }\r\n                else \r\n                    return Promise.reject(\"stop\")                    \r\n            })\r\n            .then(function () { // SUCCEEDED\r\n//console.log(_searchString)\r\n                if (found.values.length == 0 || _searchString == \"\") {\r\n                    suggestions.style.display = 'none';\r\n                    return;\r\n                }\r\n\r\n                let scrollCont = suggestions.querySelector('.mCSB_container'),\r\n                    content = Handlebars.compile(\r\n                        '{{#each values}}<div class=\"suggestion\" id=\"{{@index}}\">{{vessel_name}}<br><span>mmsi:{{mmsi}}, imo:{{imo}}, {{callsign}}</span><br><span>{{owner}}</span></div>{{/each}}'\r\n                    )(found);\r\n                if (!scrollCont) {\r\n                    suggestions.innerHTML = (content);\r\n                    $(suggestions).mCustomScrollbar();\r\n                }\r\n                else\r\n                    scrollCont.innerHTML = (content);\r\n\r\n                let suggestion = suggestions.querySelectorAll('.suggestion');\r\n                if (suggestions.style.display != 'block') {\r\n                    let cr = this.frame.find('.filter').getBoundingClientRect();\r\n                    suggestions.style.display = 'block';\r\n                    suggestions.style.position = 'fixed';\r\n                    suggestions.style.left = cr.left + \"px\"; suggestions.style.top = (cr.bottom - 3) + \"px\";\r\n                    suggestions.style.width = (Math.round(cr.width) - 2) + \"px\";\r\n                    // $(suggestions).offset({ left: cr.left, top: cr.bottom - 3 });\r\n                    // $(suggestions).outerWidth(cr.width)\r\n                }\r\n\r\n                suggestions.style.height = suggestion[0].getBoundingClientRect().height *\r\n                    (found.values.length > suggestionsCount ? suggestionsCount : found.values.length) + \"px\";\r\n\r\n                suggestionsFrame = { first: 0, current: 0, last: suggestionsCount - 1 };\r\n                suggestion[suggestionsFrame.current].classList.add('selected');\r\n                suggestion.forEach(((el, i) =>\r\n                    el.onclick = (e => {\r\n                        suggestionsFrame.current = e.currentTarget.id;\r\n                        suggestions.style.display = 'none';\r\n                        searchDone.call(this);\r\n                    }).bind(this)\r\n                ).bind(this));\r\n            }.bind(this),\r\n            function (response) { // FAILED\r\n                if (response!=\"stop\")\r\n                    console.log(response);\r\n            });\r\n        };\r\n\r\n    tab.addEventListener('click', function(e){\r\n        preferences.style.display = 'none'\r\n    })  \r\n    prefeBut.onclick = function(e){\r\n        if (preferences.style.display != 'block') {\r\n            let cr = this.frame.find('.filter').getBoundingClientRect();\r\n            preferences.style.display = 'block';\r\n            preferences.style.position = 'fixed';\r\n            preferences.style.left = (cr.left + (cr.width-preferences.offsetWidth)/2) + \"px\"; \r\n            preferences.style.top = (cr.bottom + 10) + \"px\";\r\n            e.stopPropagation()\r\n        }\r\n    }.bind(this)\r\n\r\n    preferences.querySelectorAll('.line').forEach(el=>el.onclick = e=>{\r\n        let ch = el.querySelector('.checkbox');\r\n        if (!ch.classList.contains('disabled')) {\r\n            let sparam = ch.classList.value.replace(/ *(checked|checkbox) */g, '');\r\n            if (ch.classList.contains('checked')) {\r\n                ch.classList.remove('checked');\r\n                _sparams = _sparams.replace(new RegExp(sparam), '').replace(/ {2,}/g, ' ');\r\n            }\r\n            else {\r\n                ch.classList.add('checked');\r\n                _sparams = _sparams + ' ' + sparam;\r\n            }\r\n            _sparams = _sparams.replace(/^\\s+|\\s+$/g, '')\r\n            localStorage.setItem('lloyds_searchparams', _sparams);            \r\nconsole.log(_sparams)\r\n        }\r\n        e.stopPropagation()\r\n    })\r\n    \r\n    removeBut.onclick = (function (e) {\r\n        _searchString = '';\r\n        this.searchInput.value = ('');\r\n        this.searchInput.focus();\r\n        clearTimeout(delay)\r\n        removeBut.style.display = 'none';\r\n        searchBut.style.display = 'block';\r\n        suggestions.style.display = 'none';\r\n        //_clean.call(this);\r\n    }.bind(this));\r\n\r\n    this.searchInput.onkeydown = (function (e) {\r\n        let suggestion = suggestions.querySelector('.suggestion.selected');\r\n        if (suggestions.style.display == 'block') {\r\n            if (e.keyCode == 38) {\r\n                if (suggestionsFrame.current > 0) {\r\n                    suggestionsFrame.current--;\r\n                    suggestion.classList.remove('selected')\r\n                    suggestion.previousSibling.classList.add('selected');\r\n                }\r\n            }\r\n            else if (e.keyCode == 40) {\r\n                if (suggestionsFrame.current < found.values.length - 1) {\r\n                    suggestionsFrame.current++;\r\n                    suggestion.classList.remove('selected')\r\n                    suggestion.nextSibling.classList.add('selected');\r\n                }\r\n            }\r\n            if (suggestionsFrame.last < suggestionsFrame.current) {\r\n                suggestionsFrame.last = suggestionsFrame.current;\r\n                suggestionsFrame.first = suggestionsFrame.last - (suggestionsCount - 1);\r\n            }\r\n            if (suggestionsFrame.first > suggestionsFrame.current) {\r\n                suggestionsFrame.first = suggestionsFrame.current;\r\n                suggestionsFrame.last = suggestionsFrame.first + (suggestionsCount - 1);\r\n            }\r\n\r\n            $(suggestions).mCustomScrollbar(\"scrollTo\", \"#\" + suggestionsFrame.first, { scrollInertia: 0 });\r\n        }\r\n    });\r\n\r\n    let prepareSearchInput = function (temp, keyCode) {\r\n        removeBut.style.display = 'block';\r\n        searchBut.style.display = 'none';\r\n//console.log(\"delay clear\"+delay)\r\n//console.log(_searchString + \"==\"+ temp)\r\n        if (_searchString == temp && (!keyCode || keyCode != 13))\r\n            return false;\r\n\r\n        clearTimeout(delay);\r\n\r\n        _searchString = temp;\r\n        if (_searchString == \"\") {\r\n            removeBut.click();\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    this.searchInput.onkeyup = (function (e) {\r\n        let temp = (this.searchInput.value || \"\")\r\n            .replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n        if (!prepareSearchInput(temp, e.keyCode))\r\n            return;\r\n        if (e.keyCode == 13) {\r\n            suggestions.style.display = 'none';\r\n            searchDone.call(this);\r\n        }\r\n        else{\r\n            delay = setTimeout((() => {\r\n                doSearch.apply(this, [delay])\r\n            }).bind(this), 200);\r\n        }\r\n    }.bind(this));\r\n\r\n\r\n    this.searchInput.onpaste = function (e) {\r\n        let temp = ((e.originalEvent || window.clipboardData || e).clipboardData.getData('text') || \"\")\r\n            .replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n        if (!prepareSearchInput(temp))\r\n            return;\r\n        delay = setTimeout((() => {\r\n            doSearch.call(this, [delay])\r\n        }).bind(this), 200);\r\n    }.bind(this);\r\n\r\n}\r\n\r\nSearchControl.prototype.focus = function () {\r\n    this.searchInput.focus();\r\n}\r\n\r\nmodule.exports = SearchControl;\n\n\n// WEBPACK FOOTER //\n// ./src/Search/SearchControl.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Search/SearchControl.css\n// module id = 12\n// module chunks = 0","const Polyfill = require('../Polyfill');\r\nmodule.exports = function (searcher) {\r\n    let _actualUpdate,\r\n        _data = JSON.parse(localStorage.getItem(\"lloyds_collection\"));\r\n    if (!_data)\r\n        _data = { vessels: [] }; \r\n        // {\r\n        //     vessels: [\r\n        //         { vessel_name: 'ACACIA', mmsi: 371044000, imo: 9476599 },\r\n        //         { vessel_name: 'AKADEMIK FERSMAN', mmsi: 273455310, imo: 8313958 },\r\n        //         { vessel_name: 'BALTIMORE BRIDGE', mmsi: 371111000, imo: 9463281 }\r\n        //     ]};\r\n    return {\r\n        searcher: searcher,\r\n        isDirty: true,\r\n        get data() { return _data },\r\n        set data(value) { _data = value; },\r\n        save: function(){\r\n            localStorage.setItem(\"lloyds_collection\", JSON.stringify(_data));\r\n        },\r\n        update: function () {\r\n                this.view.repaint();\r\n        }\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Models/MyCollectionModel.js","module.exports = { \r\n\tfind: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn value;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn undefined;\r\n\t},\r\n\tfindIndex: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn i;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Polyfill.js","require(\"./RegisterDialog.css\")\r\nconst BaseView = require('./BaseView.js');\r\n\r\nconst RegisterDlgView = function ({ model }) {\r\n    BaseView.call(this, model);\r\n\r\n    Object.defineProperty(this, \"collection\", {\r\n        set: (value=>{\r\n//console.log(value)\r\n//console.log(this.model.data.vessels)\r\n        this.model.data.vessels = this.model.data.vessels.filter(v=>value.indexOf(v.RS)!==-1)\r\n//console.log(this.model.data.vessels)\r\n        let new_tasks = value.filter(v=>!this.model.data.vessels || !this.model.data.vessels.some(cv=>cv.RS==v));\r\n//console.log(new_tasks)\r\n        if (new_tasks.length>0){\r\n            this.model.tasks = new_tasks\r\n            .map(id=>fetch(\"//www.kosmosnimki.ru/demo/lloyds/api/v1/Ship/Get/\"+id))\r\n            this.model.isDirty = true;\r\n        }\r\n//console.log(this.model.isDirty)\r\n    }).bind(this)});\r\n\r\n    this.frame = $(Handlebars.compile('<div class=\"lloyds_register_dlg_view\">' +\r\n    '<div><table class=\"instruments unselectable\" border=0><tr><td>' + \r\n    '<div class=\"fieldstree_selector\"><span>{{i \"Lloyds.fieldsSelector\"}}</span></div><div class=\"rollout\"></div>' +\r\n    '<div class=\"fieldstree_display\" style=\"display:none\">' +\r\n    '<div class=\"select\"><div class=\"fieldstree_selector\"><span>{{i \"Lloyds.fieldsSelector\"}}</span></div><div class=\"rollout up\">&nbsp;</div></div>' +\r\n    '<hr>' + \r\n    '<div class=\"fieldstree_panel\"></div>' +\r\n    '</div>' +    \r\n    '</td><td><div class=\"refresh\" style=\"display:none\">' + this.gifLoader + '</div></td></tr></table></div>' +\r\n    '<div class=\"vessels_columns unselectable\"><table><tr>' + \r\n    '<td class=\"column\">&nbsp;</td>' + \r\n    '</tr></table></div><div class=\"vessels\"></div><div class=\"export button\"></div><iframe class=\"export download\" style=\"display:none\"></iframe>' +\r\n    '</div>')())\r\n    this.container = this.frame.find('.vessels');\r\n    let frame = this.frame;\r\n    this.mcsbOptions = {\r\n        axis: \"yx\",\r\n        callbacks: {\r\n            whileScrolling: function () {\r\n                if (this.mcs.direction==\"x\")\r\n                    frame.find('.vessels_columns table').css({position:\"relative\", left:this.mcs.left+\"px\"})\r\n            },\r\n            onScrollStart: function(){ \r\n                if(!frame.find('.fieldstree_display').is(':hover'))\r\n                    frame.find('.rollout.up:visible').mousedown() \r\n            }\r\n        }\r\n    };\r\n\r\n    // FIELDSSELECTOR\r\n    this.model.loadMeta().then((() => {\r\n        let feeldsTree = '<ul>';\r\n        for (let i = 0; i < this.model.data.columns.length; ++i) {\r\n            feeldsTree += '<li class=\"section\"><div class=\"lloyds_dialog_button branch_expand\" style=\"display:none\"/><div class=\"lloyds_dialog_button branch_shrink\"/>'+\r\n            '<input type=\"checkbox\" value=\"' + i + '\" '+(this.model.data.columns[i].checked?'checked':'')+'><label>' + this.model.data.columns[i].caption  + '</label>'\r\n            feeldsTree += '<ul>';\r\n            for (let j = 0; this.model.data.columns[i].nodes && j < this.model.data.columns[i].nodes.length; ++j) {\r\n                feeldsTree += '<li><div class=\"lloyds_dialog_button branch_expand\"/><div class=\"lloyds_dialog_button branch_shrink\" style=\"display:none\"/><input type=\"checkbox\" value=\"' + i+'.'+j + '\" '+\r\n                (this.model.data.columns[i].nodes[j].checked?'checked':'')+'><label>' + this.model.data.columns[i].nodes[j].caption + '</label>'\r\n                feeldsTree += '<ul style=\"display:none\">';\r\n                for (let k = 0; this.model.data.columns[i].nodes[j].nodes && k < this.model.data.columns[i].nodes[j].nodes.length; ++k) {\r\n                    if (this.model.data.columns[i].nodes[j].nodes[k]){\r\n                        if (this.model.data.columns[i].nodes[j].nodes[k].name==\"LRIMOShipNo\" ||\r\n                         this.model.data.columns[i].nodes[j].nodes[k].name==\"ShipName\"){\r\n                            this.model.data.columns[i].nodes[j].nodes[k].checked = true;\r\n                            this.model.data.columns[i].nodes[j].nodes[k].disabled = true;\r\n                         }\r\n\r\n                        feeldsTree += '<li><input type=\"checkbox\" value=\"' + i+'.'+j+'.'+k + '\" '+\r\n                        (this.model.data.columns[i].nodes[j].nodes[k].checked ? 'checked ':'')+\r\n                        (this.model.data.columns[i].nodes[j].nodes[k].disabled ? 'disabled=\"disabled\"':'')+                        \r\n                        '><label>' + this.model.data.columns[i].nodes[j].nodes[k].caption + ' <span>(' + this.model.data.columns[i].nodes[j].nodes[k].trans + ')</span>' + '</label></li>'\r\n                    }\r\n                }\r\n                feeldsTree += '</ul>';\r\n                feeldsTree += \"</li>\";\r\n            }\r\n            feeldsTree += '</ul>';\r\n            feeldsTree += \"</li>\";\r\n        }\r\n        feeldsTree += \"</ul>\";\r\n        this.feeldsTree = $(feeldsTree);\r\n    }).bind(this))\r\n}\r\n\r\nRegisterDlgView.prototype = Object.create(BaseView.prototype);\r\n\r\nconst _export = function(ev){\r\n    let form = new FormData(),\r\n    columns = [];\r\n    //this.frame.find('input.export:checked').each((i,v)=>v.classList[2] && _vesselsToExport.push(v.classList[2]))\r\n    if (!_vesselsToExport.length){\r\n        console.log('Nothing to export');\r\n        return;\r\n    }\r\n    this.frame.find('.column').each((i,c)=>c.classList[1] && columns.push(c.classList[1]))\r\n    form.append('vessels', _vesselsToExport) \r\n    form.append('columns', columns) \r\n    this.inProgress(true);\r\n    fetch(window.serverBase + \"plugins/ais/lloydsexport.ashx\",\r\n    {\r\n        method: \"POST\",\r\n        mode: 'cors',\r\n        body: form,\r\n        credentials: 'include'\r\n    })\r\n    .then(function(res){ return res.text(); })\r\n    .then(function(data){ \r\n        this.inProgress(false);\r\n        if (data.search(/ERROR:/)!=-1){\r\n            return Promise.reject(data)\r\n        }\r\n        this.frame.find(\".export.download\")[0].src = window.serverBase + \"plugins/ais/lloydsexport.ashx?id=\" + data\r\n    }.bind(this))\r\n    .catch((function(data){\r\n        this.inProgress(false);\r\n        console.log( data ) \r\n    }).bind(this))\r\n},\r\n_clean = function () {\r\n        this.container.empty();\r\n        this.container.attr(\"class\", \"vessels\")\r\n    },\r\n    _showFieldsTree = (e, panel) => {\r\n        if (!panel.is(':visible')) {\r\n            panel.show()\r\n            panel.offset(panel.siblings('.fieldstree_selector').offset())\r\n        }\r\n        else\r\n            panel.hide()\r\n        e.stopPropagation();\r\n    },\r\n    _showFieldsTreeBranch = (e, lbl)=>{\r\n        let b = $(e.currentTarget)\r\n        .hide()\r\n        .siblings(lbl).show();\r\n        if (lbl == '.branch_shrink')\r\n            b.siblings('ul').show();\r\n        else\r\n            b.siblings('ul').hide();\r\n        e.stopPropagation();\r\n    }\r\n    \r\nlet _dialog,\r\n    _dialogRect = JSON.parse(localStorage.getItem(\"lloyds_rect\")),\r\n    _dialogW = _dialogRect?_dialogRect.w:710, _dialogH = _dialogRect?_dialogRect.h:450,\r\n    _containerH = _dialogH - 215,\r\n    _vesselsToExport = []// _dialogRect?_dialogRect.ch:280;\r\n\r\nRegisterDlgView.prototype.show = function () {\r\n    if (!_dialog){\r\n        _clean.call(this);\r\n        BaseView.prototype.show.apply(this, arguments);\r\n        this.resize({dx:0, dy:0});\r\n\r\n        let canvas = this.frame,\r\n            screen = $('#all')[0],\r\n            sw = parseFloat(window.getComputedStyle(screen).width),\r\n            sh = parseFloat(window.getComputedStyle(screen).height),\r\n            posX = (sw - _dialogW) / 2.0,\r\n            posY = (sh - _dialogH) / 2.0,\r\n            isMaximized = false,\r\n            columns = this.model.data.columns,\r\n            columns_ts = this.model.data.columnsTs;\r\n\r\n        _dialog = showDialog(\"register\", canvas[0], {\r\n            /*width: _dialogW, height: _dialogH,*/ \r\n            posX: posX, posY: posY,\r\n            closeFunc: (() => { \r\n                _dialog = null; \r\n                localStorage.setItem(\"lloyds_columns\", JSON.stringify({timestamp: columns_ts, nodes:columns}));\r\n                localStorage.setItem(\"lloyds_rect\", JSON.stringify({w:_dialogW, h:_dialogH, ch:_containerH}));\r\n                this.frame.find('.export.download')[0].src = \"\";\r\n            }).bind(this)            \r\n        });\r\n        $(_dialog).dialog({\r\n            resizable: true, resize: ((event, ui) => {\r\n                this.resize({ dy: ui.size.height - _dialogH });\r\n                _dialogW = ui.size.width;\r\n                _dialogH = ui.size.height;\r\n                if (!$('.vessels .mCSB_scrollTools_horizontal').is(':visible'))                \r\n                    this.frame.find('.vessels_columns table').css({position:\"relative\", left:0})\r\n            }).bind(this),\r\n            /*width: _dialogW, height: _dialogH*/\r\n        });\r\n        $(_dialog).parent().css({'min-width': '600px', 'width': _dialogW, 'height': _dialogH})\r\n        $(_dialog).parent().find('.ui-dialog-content').css('min-width', '600px');\r\n        isMaximized = false;\r\n\r\n        // TITLEBAR\t\r\n        canvas.parent('div').css({ 'margin': '0', 'overflow': 'hidden' })\r\n        let titlebar = $(_dialog).parent().find('.ui-dialog-titlebar').css('padding', '0')\r\n            .html('<table class=\"lloyds_dialog_titlebar\"><tr>' +\r\n            '<td><div class=\"choose\">' + _gtxt(\"Lloyds.dlgTitle\") +\r\n            '</div></td>' +\r\n            '<td class=\"window_button\" id=\"expandbut\" title=\"' + _gtxt(\"Lloyds.expandButton\") + '\"><div class=\"lloyds_dialog_button expand\"></div></td>' +\r\n            '<td class=\"window_button\" id=\"shrink\" title=\"' + _gtxt(\"Lloyds.shrinkButton\") + '\" style=\"display:none\"><div class=\"lloyds_dialog_button shrink\"></div></td>' +\r\n            '<td class=\"window_button\" id=\"closebut\" title=\"' + _gtxt(\"Lloyds.closeButton\") + '\"><div class=\"lloyds_dialog_button close\"></div></td>' +\r\n            '</tr></table>');\r\n\r\n        $('#closebut', titlebar).on('click', (e) => { \r\n                if (isMaximized)\r\n                    this.resize({dy : _dialogH - parseFloat(window.getComputedStyle($('#all')[0]).height)});\r\n                $(_dialog).dialog(\"close\"); \r\n            }\r\n        )\r\n        $('#shrink', titlebar).on('click', (e) => {\r\n            $(e.currentTarget).hide()\r\n            $(_dialog).dialog({width:_dialogW, height:_dialogH});\r\n            titlebar.find('#expandbut').show();          \r\n            this.resize({dy : _dialogH - parseFloat(window.getComputedStyle($('#all')[0]).height)});\r\n            $(_dialog).dialog({ resizable: true });\r\n            isMaximized = false;\r\n        })\r\n        $('#expandbut', titlebar).on('click', (e) => {\r\n            $(e.currentTarget).hide()\r\n            let screen = $('#all')[0],\r\n                sw = parseFloat(window.getComputedStyle(screen).width),\r\n                sh = parseFloat(window.getComputedStyle(screen).height);\r\n            $(_dialog).dialog({width:sw, height:sh});\r\n            titlebar.find('#shrink').show();            \r\n            this.resize({dy : sh - _dialogH});\r\n            $(_dialog).dialog({ resizable: false });\r\n            isMaximized = true;\r\n        })\r\n\r\n        // EXPORT\r\n        this.frame.find('.export.button').click(_export.bind(this))    \r\n\r\n        // FIELDSSELECTOR\r\n        if (this.feeldsTree) {\r\n            $('.lloyds_register_dlg_view').parents('.ui-dialog').on(\"mousedown\", (e => {\r\n                this.frame.find('.rollout.up:visible').mousedown()\r\n            }).bind(this))\r\n           \r\n            this.frame.find('.fieldstree_panel').text('').append(this.feeldsTree).mCustomScrollbar();\r\n            this.frame.find('.fieldstree_selector').on('mousedown', (e => {\r\n                _showFieldsTree(e, this.frame.find('.fieldstree_display'));\r\n            }).bind(this));\r\n            this.frame.find('.rollout').on('mousedown', (e => {\r\n                _showFieldsTree(e, this.frame.find('.fieldstree_display'));\r\n            }).bind(this));\r\n            this.feeldsTree.find('.branch_expand').on('mousedown', e => _showFieldsTreeBranch(e, '.branch_shrink'));\r\n            this.feeldsTree.find('.branch_shrink').on('mousedown', e => _showFieldsTreeBranch(e, '.branch_expand'));\r\n            this.feeldsTree.find('input[type=\"checkbox\"]').on('mousedown', (e => {\r\n                let chb = e.currentTarget,\r\n                    id = chb.value.split(\".\"),\r\n                    node = columns[id[0]], parent;\r\n                for (let i=1; i<id.length; ++i){\r\n                    parent = node;\r\n                    node = node.nodes[id[i]];\r\n                }                \r\n                let s=[node], n; \r\n                while(s.length){\r\n                    n=s.pop(); \r\n                    if (!n.disabled)\r\n                        n.checked = !chb.checked;\r\n                    n.nodes && n.nodes.forEach(x=>s.push(x))\r\n                } \r\n                if (parent)      \r\n                    parent.checked = parent.nodes.every(x=>x.checked); \r\n//console.log(parent)\r\n//console.log(node)\r\n                if (chb.checked) {\r\n                    $(chb).parents('ul').siblings('input:not([disabled])').each((i, elm) => { elm.checked = false });\r\n                    $(chb).siblings('ul').find('input:not([disabled])').each((i, elm) => { elm.checked = false })\r\n                }\r\n                else {\r\n                    $(chb).siblings('ul').find('input').each((i, elm) => { elm.checked = true })\r\n                    let uls = $(chb).parents('ul')\r\n                    for (let i = 0; i < uls.length; ++i) {\r\n                        let inputs = uls.eq(i).find('li input'),\r\n                            checked = uls.eq(i).find('li input:checked');\r\n//console.log(inputs.length +\"==\"+ (checked.length+1))\r\n//console.log(uls.eq(i).siblings('input'))\r\n                        if (inputs.length == checked.length+1 && uls.eq(i).siblings('input')[0])\r\n                            uls.eq(i).siblings('input')[0].checked = true;\r\n                    }\r\n                }\r\n                this.repaint();\r\n                e.stopPropagation();\r\n            }).bind(this));\r\n            this.feeldsTree.find('label').on('mousedown', e => {\r\n                $(e.currentTarget).siblings('input[type=\"checkbox\"]').mousedown().click();\r\n                e.stopPropagation();\r\n            })\r\n        }\r\n    }\r\n};\r\n\r\nconst _repaintExport = function(){     \r\n    this.frame.find('.export.get:not(.all)').click((e=>{\r\n        if (!$(e.target).is(':checked')){\r\n            this.frame.find('.export.get.all')[0].checked=0;\r\n            _vesselsToExport.splice(_vesselsToExport.indexOf(e.target.classList[2]),1)\r\n        }\r\n        else{\r\n            _vesselsToExport.push(e.target.classList[2])\r\n        }\r\n    }).bind(this))\r\n    .each((i, el)=>{\r\n        el.checked = _vesselsToExport.indexOf(el.classList[2])!=-1?1:0;\r\n    })    \r\n\r\n    this.frame.find('.export.get.all').click((e=>{\r\n        _vesselsToExport.length = 0;\r\n        this.frame.find('.export.get:not(.all)').each((i,el)=>{\r\n            el.checked=$(e.target).is(':checked')?1:0;\r\n            if (el.checked)\r\n                _vesselsToExport.push(el.classList[2]);\r\n        })\r\n    }).bind(this))[0].checked = this.model.data.vessels.length==0 || this.frame.find('.export.get:not(.all):not(:checked)').length>0?0:1;\r\n}\r\n\r\nRegisterDlgView.prototype.repaint = function () {\r\n    if (!this.frame.is(\":visible\"))\r\n        return true;\r\n    if (this.model.data.columns)\r\n        this.frame.find('.vessels_columns').html(\r\n        Handlebars.compile('<table><tr><td><div class=\"column\"><input type=\"checkbox\" class=\"export get all\"><div></div></div></td>{{#each columns}}{{#each nodes}}{{#each nodes}}'+\r\n        '{{#if checked}}'+\r\n        '<td><div class=\"column {{name}}\">{{caption}}<div>{{trans}}</div></div></td>'+\r\n        '{{/if}}'+\r\n        '{{/each}}{{/each}}{{/each}}</tr></table>')\r\n        (this.model.data))\r\n\r\n    this.tableTemplate = '<table class=\"vessels_data\">{{#each vessels}}<tr>';\r\n    this.tableTemplate += '<td><div><input type=\"checkbox\" class=\"export get {{LRIMOShipNo}}\"></div></td>';\r\n    for (let i=0; i<this.model.data.columns.length; ++i)\r\n    for (let j=0; this.model.data.columns[i].nodes && j<this.model.data.columns[i].nodes.length; ++j)\r\n    for (let k=0; this.model.data.columns[i].nodes[j].nodes && k<this.model.data.columns[i].nodes[j].nodes.length; ++k)\r\n        if (this.model.data.columns[i].nodes[j].nodes[k].checked)\r\n            this.tableTemplate += '<td><div>{{'+this.model.data.columns[i].nodes[j].nodes[k].name+'}}</div></td>';\r\n    this.tableTemplate += '</tr>' +\r\n    '{{/each}}</table>{{#each msg}}<div class=\"msg\">{{txt}}</div>{{/each}}';\r\n\r\n    BaseView.prototype.repaint.apply(this, arguments);\r\n\r\n    _repaintExport.call(this);\r\n\r\n    let columns = this.frame.find('.vessels_columns tr:nth-of-type(1) td div:has(div)'),\r\n        cells = this.frame.find('.vessels_data tr:nth-of-type(1) td div'),\r\n        getOuterWidth = function(el){\r\n            let s = window.getComputedStyle(el),\r\n            w = parseFloat(s.width.replace(/\\D+$/, '')) // ,\r\n            // pl = parseFloat(s[\"padding-left\"].replace(/\\D+$/, '')),\r\n            // pr = parseFloat(s[\"padding-right\"].replace(/\\D+$/, '')),\r\n            // bl = parseFloat(s[\"border-left-width\"].replace(/\\D+$/, '')),\r\n            // br = parseFloat(s[\"border-right-width\"].replace(/\\D+$/, ''));\r\n//console.log(\"get \" + (w + pl + pr + bl + br) + \" = \" + w  + \" + \"+ pl + \" + \" + pr + \" + \" + bl + \" + \" + br)\r\n            return w; // + pl + pr + bl + br;\r\n        },\r\n        setOuterWidth = function(el, w1){\r\n        //     let s = window.getComputedStyle(el),\r\n        //     pl = parseFloat(s[\"padding-left\"].replace(/\\D+$/, '')),\r\n        //     pr = parseFloat(s[\"padding-right\"].replace(/\\D+$/, '')),\r\n        //     bl = parseFloat(s[\"border-left-width\"].replace(/\\D+$/, '')),\r\n        //     br = parseFloat(s[\"border-right-width\"].replace(/\\D+$/, ''));\r\n            let w = w1; // - (pl + pr + bl + br);\r\n//console.log(\"set \" + w + \" = \" + w1 + \" - \"+ pl + \" - \" + pr + \" - \" + bl + \" - \" + br)\r\n            el.style.width = w  + \"px\";\r\n        };\r\n    if (cells.length > 0) {\r\n        $('.vessels_data tr:last-child').after('<tr>'+$('.vessels_columns table tr').html()+'</tr>')\r\n        let cont_w = this.frame.find('.vessels').width()\r\n        this.frame.find('.vessels_data').width(cont_w)\r\n            .parent().width(cont_w);\r\n        columns.each((i, el) => {\r\n            let w = getOuterWidth(cells[i])\r\n            setOuterWidth(el, w)\r\n            setOuterWidth(cells[i], w)\r\n            setOuterWidth(cells.eq(i).parent()[0], w)\r\n            //console.log(cells.eq(i).outerWidth() + \" \" + getOuterWidth(cells[i])+\" \"+$(el).outerWidth())        \r\n        }) \r\n        let calc_w = getOuterWidth(this.frame.find('.vessels_data')[0]); \r\n//console.log(\"cont_w \"+cont_w + \" calc_w \"+calc_w)\r\n        if (calc_w>cont_w){\r\n            setOuterWidth(this.frame.find('.vessels_data')[0], calc_w)\r\n            setOuterWidth(this.frame.find('.vessels_data').parent()[0], calc_w)\r\n        }\r\n        $('.vessels_data tr:last-child').remove()\r\n    }\r\n};\r\n\r\nRegisterDlgView.prototype.inProgress = function (state) {\r\n    let progress = this.frame.find('.refresh');\r\n    if (state)\r\n        progress.show();\r\n    else\r\n        progress.hide();\r\n};\r\n\r\nRegisterDlgView.prototype.resize = function ({dx, dy}) {\r\n    _containerH += dy;\r\n    this.container.height(_containerH);\r\n    \r\n    // let calc_w = parseFloat(getComputedStyle(this.container[0]).width),\r\n    //     columns = this.frame.find('.vessels_columns tr:nth-of-type(1) td div');\r\n    // if (calc_w>columns.length*200){\r\n    //     this.frame.find('.vessels_data').width(calc_w)\r\n    //     .parent().width(calc_w);  \r\n    // }\r\n};\r\n\r\nmodule.exports = RegisterDlgView;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Views/RegisterDlgView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/RegisterDialog.css\n// module id = 16\n// module chunks = 0","let _actualUpdate;\r\nmodule.exports = function (searcher) {\r\n    let returnInstance = {\r\n        data:{vessels:[]},\r\n        isDirty: false,\r\n        loadMeta : ()=>beforeLoad,\r\n        tasks: [],\r\n        load: function () {\r\n            let inst = this;\r\n            return beforeLoad.then(res => {\r\n                return Promise.all(inst.tasks)\r\n                .then(r=>Promise.all(r.map(z=>z.json())))\r\n                .then(r=>{\r\n                    let rr=[]\r\n                    r.forEach((v, i)=>{\r\n                        rr.push({RS:parseInt(v.RS, 10), version:v.version}) \r\n                        v.data.forEach(ds=>ds.properties.forEach(p=>{rr[i][p.name]=p.value}))\r\n                    })\r\n                    inst.data.vessels = inst.data.vessels.concat(rr);\r\n//console.log(inst.data.vessels)\r\n                }) \r\n            })\r\n        },\r\n        update: function () {\r\n            if (!this.isDirty){   \r\n                let inst = this;   \r\n                setTimeout(function wait() {\r\n                    if (inst.view.repaint()){\r\n                        console.log(\"wait\")\r\n                        setTimeout(wait, 10);\r\n                    }\r\n                  }, 10);\r\n                return;\r\n            }\r\n            _actualUpdate = new Date().getTime();\r\n            let inst = this,\r\n                actualUpdate = _actualUpdate;\r\n            this.view.inProgress(true);\r\n            this.load().then(function (res) {\r\n                if (_actualUpdate == actualUpdate) {\r\n                    inst.isDirty = false;\r\n                    inst.view.inProgress(false);            \r\n                    inst.view.repaint();\r\n                }\r\n            }, function (json) {\r\n                inst.data = null;\r\n                //console.log(json)\r\n                if ((json.Status && json.Status.toLowerCase() == \"auth\") ||\r\n                    (json.ErrorInfo && json.ErrorInfo.some && json.ErrorInfo.some(function (r) { return r.Status.toLowerCase() == \"auth\" })))\r\n                    inst.data = { msg: [{ txt: _gtxt(\"AISSearch2.auth\") }], vessels: [] };\r\n                else {\r\n                    //inst.data = {msg:[{txt:\"!!!\"}], vessels:[]};\r\n                    console.log(json);\r\n                }\r\n                inst.view.inProgress(false);\r\n                inst.view.repaint();\r\n            });\r\n        }\r\n    },\r\n    beforeLoad = new Promise((resolve, reject) => {\r\n        let columnsJson = JSON.parse(localStorage.getItem(\"lloyds_columns\"));\r\n//columnsJson && console.log((new Date().getTime()-columnsJson.timestamp)/60000)\r\n        //if (!columnsJson || ((new Date().getTime()-columnsJson.timestamp)/60000>24*60))\r\n            let promise = FormData.prototype.set ?\r\n            fetch(\"//www.kosmosnimki.ru/demo/lloyds/api/v1/Ship/Meta\")\r\n            .then(r=>r.json()) :\r\n            new Promise((resolve)=>{\r\n                throw new Error(\"IE!!!\");\r\n            });\r\n\r\n            promise.then(r=>{   \r\n                let checked = [], convert = a=>a.map(p=>{return {id:p.id, name: p.name1, trans: p.name3, caption: p.name2, nodes:null, checked: checked.indexOf(p.id)!=-1};})\r\n                if (columnsJson){\r\n                    columnsJson.nodes.forEach((e0, i0)=>{e0.nodes.forEach((e1, i1)=>{e1.nodes.forEach((e2, i2)=>{if (e2.checked) checked.push(e2.id)})})})\r\n                    // checked = [columnsJson.a, columnsJson.b, columnsJson.c]\r\n                    // console.log(checked)\r\n                }\r\n                returnInstance.data.columnsTs = new Date().getTime();\r\n                returnInstance.data.columns = [\r\n                    {name: \"general\", caption: \" \", nodes:[\r\n                        {name: \"identification\", caption: r[0].name, nodes:convert(r[0].attributes)},\r\n                        {name: \"type\", caption: r[1].name, nodes:convert(r[1].attributes)},\r\n                        {name: \"safety\", caption: r[4].name, nodes:convert(r[4].attributes)},\r\n                        {name: \"codes\", caption: r[15].name, nodes:convert(r[15].attributes)},\r\n                    ]},\r\n                    {name: \"subjects\", caption: \"\", nodes:[\r\n                        {name: \"owners\", caption: r[2].name, nodes:convert(r[2].attributes)},\r\n                        {name: \"builders\", caption: r[3].name, nodes:convert(r[3].attributes)}\r\n                    ]},\r\n                    {name: \"history\", caption: \"  \", nodes:[\r\n                        {name: \"history\", caption: r[5].name, nodes:convert(r[5].attributes)},\r\n\r\n                    ]},\r\n                    {name: \"techical_data\", caption: \" \", nodes:[\r\n                        {name: \"features\", caption: r[6].name, nodes:convert(r[6].attributes)},\r\n                        {name: \"dimensions\", caption: r[7].name, nodes:convert(r[7].attributes)},\r\n                        {name: \"hull\", caption: r[8].name, nodes:convert(r[8].attributes)},\r\n                        {name: \"tanks\", caption: r[9].name, nodes:convert(r[9].attributes)},\r\n                        {name: \"fuel\", caption: r[12].name, nodes:convert(r[12].attributes)}\r\n                    ]},\r\n                    {name: \"equipment\", caption: \"\", nodes:[\r\n                        {name: \"cargo_structures\", caption: r[10].name, nodes:convert(r[10].attributes)},\r\n                        {name: \"engines\", caption: r[11].name, nodes:convert(r[11].attributes)},\r\n                        {name: \"energy_facilities\", caption: r[13].name, nodes:convert(r[13].attributes)},\r\n                        {name: \"thrusters\", caption: r[14].name, nodes:convert(r[14].attributes)}\r\n                    ]},\r\n                ];\r\n                if (columnsJson){\r\n                    returnInstance.data.columns.forEach(c=>{\r\n                        c.nodes.forEach(n=>{\r\n                            n.checked = n.nodes.every(nn=>nn.checked)\r\n                        });\r\n                        c.checked = c.nodes.every(n=>n.checked);\r\n                    })\r\n                }\r\n                else{                   \r\n                    returnInstance.data.columns[0].nodes[0].nodes.forEach(n=>n.checked=true)\r\n                    returnInstance.data.columns[0].nodes[0].checked = true;                 \r\n                    returnInstance.data.columns[0].nodes[1].nodes.forEach(n=>n.checked=true)\r\n                    returnInstance.data.columns[0].nodes[1].checked = true;\r\n                }\r\n                resolve();\r\n            })\r\n            .catch(e=>{console.log(e); reject(e)})\r\n        // else{           \r\n        //     returnInstance.data.columnsTs = columnsJson.timestamp; \r\n        //     returnInstance.data.columns = columnsJson.nodes;            \r\n        //     resolve();\r\n        // }\r\n    });\r\n    return returnInstance;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Models/RegisterModel.js","module.exports = function (options) {\r\n    const _baseUrl = document.location.href.replace(/^(https?:).+/, \"$1\") + \r\n    (window.serverBase.replace(/^https?:/, \"\") || '//maps.kosmosnimki.ru/'),\r\n        _aisServices = _baseUrl + \"Plugins/AIS/\",\r\n        _serverScript = _baseUrl + 'VectorLayer/Search.ashx';\r\n    const { aisLastPoint:_aisLastPoint, \r\n        screenSearchLayer:_screenSearchLayer, \r\n        aisLayerID:_aisLayerID, \r\n        historyLayer:_historyLayer \r\n    } = options;\r\n\r\n    return {\r\n        baseUrl: _baseUrl,\r\n        aisServices: _aisServices,\r\n        getBorder: function () {\r\n            var lmap = nsGmx.leafletMap;\r\n            var dFeatures = lmap.gmxDrawing.getFeatures();\r\n            if (dFeatures.length) { return dFeatures[dFeatures.length - 1].toGeoJSON(); }\r\n            var latLngBounds = lmap.getBounds(),\r\n                sw = latLngBounds.getSouthWest(),\r\n                ne = latLngBounds.getNorthEast(),\r\n                min = { x: sw.lng, y: sw.lat },\r\n                max = { x: ne.lng, y: ne.lat },\r\n                minX = min.x,\r\n                maxX = max.x,\r\n                geo = { type: 'Polygon', coordinates: [[[minX, min.y], [minX, max.y], [maxX, max.y], [maxX, min.y], [minX, min.y]]] },\r\n                w = (maxX - minX) / 2;\r\n\r\n            if (w >= 180) {\r\n                geo = { type: 'Polygon', coordinates: [[[-180, min.y], [-180, max.y], [180, max.y], [180, min.y], [-180, min.y]]] };\r\n            }\r\n            else if (maxX > 180 || minX < -180) {\r\n                var center = ((maxX + minX) / 2) % 360;\r\n                if (center > 180) { center -= 360; }\r\n                else if (center < -180) { center += 360; }\r\n                minX = center - w; maxX = center + w;\r\n                if (minX < -180) {\r\n                    geo = {\r\n                        type: 'MultiPolygon', coordinates: [\r\n                            [[[-180, min.y], [-180, max.y], [maxX, max.y], [maxX, min.y], [-180, min.y]]],\r\n                            [[[minX + 360, min.y], [minX + 360, max.y], [180, max.y], [180, min.y], [minX + 360, min.y]]]\r\n                        ]\r\n                    };\r\n                } else if (maxX > 180) {\r\n                    geo = {\r\n                        type: 'MultiPolygon', coordinates: [\r\n                            [[[minX, min.y], [minX, max.y], [180, max.y], [180, min.y], [minX, min.y]]],\r\n                            [[[-180, min.y], [-180, max.y], [maxX - 360, max.y], [maxX - 360, min.y], [-180, min.y]]]\r\n                        ]\r\n                    };\r\n                }\r\n            }\r\n            return geo;\r\n        },\r\n\r\n        formatTime: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleTimeString();\r\n        },\r\n        formatDate: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleDateString();\r\n        },\r\n        formatDateTime: function (d, local) {\r\n            if (d.isNaN)\r\n                return \"\";\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleString().replace(/,/, \"\");\r\n        },\r\n\r\n        formatDate2: function (d, local) {\r\n            var dd, m, y, h, mm;\r\n            if (local) {\r\n                dd = (\"0\" + d.getDate()).slice(-2);\r\n                m = (\"0\" + (d.getMonth() + 1)).slice(-2);\r\n                y = d.getFullYear();\r\n                h = (\"0\" + d.getHours()).slice(-2);\r\n                mm = (\"0\" + d.getMinutes()).slice(-2);\r\n                return dd + \".\" + m + \".\" + y + \" \" + h + \":\" + mm +\r\n                    \" (\" + (\"0\" + d.getUTCHours()).slice(-2) + \":\" + (\"0\" + d.getUTCMinutes()).slice(-2) + \" UTC)\";\r\n            }\r\n            else {\r\n                dd = (\"0\" + d.getUTCDate()).slice(-2);\r\n                m = (\"0\" + (d.getUTCMonth() + 1)).slice(-2);\r\n                y = d.getUTCFullYear();\r\n                h = (\"0\" + d.getUTCHours()).slice(-2);\r\n                mm = (\"0\" + d.getUTCMinutes()).slice(-2);\r\n                var\r\n                    ldd = (\"0\" + d.getDate()).slice(-2),\r\n                    lm = (\"0\" + (d.getMonth() + 1)).slice(-2),\r\n                    ly = d.getFullYear(),\r\n                    lh = (\"0\" + d.getHours()).slice(-2),\r\n                    lmm = (\"0\" + d.getMinutes()).slice(-2),\r\n                    offset = -d.getTimezoneOffset() / 60;\r\n                return dd + \".\" + m + \".\" + y + \" <span class='utc'>\" + h + \":\" + mm + \" UTC</span> (\" + lh + \":\" + lmm + \")\"\r\n                //return dd+\".\"+m+\".\"+y+\" \"+h+\":\"+mm+\" UTC <br>\"+\r\n                //\"<span class='small'>(\"+ldd+\".\"+lm+\".\"+ly+\" \"+lh+\":\"+lmm+\" UTC\"+(offset>0?\"+\":\"\")+offset+\")</span>\";\r\n            }\r\n        },\r\n        searchString: function (searchString, isfuzzy, callback) {\r\n            //console.log(\"//www.kosmosnimki.ru/demo/lloyds/api/v1/Ship/Search/\"+searchString)\r\n            //L.gmxUtil.sendCrossDomainPostRequest(\"//www.kosmosnimki.ru/demo/lloyds/api/v1/Ship/Search/\"+searchString, request, callback);\r\n        }\r\n    };\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/Search/Searcher.js"],"sourceRoot":""}