{"version":3,"sources":["webpack:///webpack/bootstrap 1291d0921a9f6dd13392","webpack:///./src/entry.js","webpack:///./src/All.css","webpack:///./src/Locale.js","webpack:///./src/Constants.js","webpack:///./src/RcPluginPanel.js","webpack:///./src/Controls/SelectControl.js","webpack:///./src/Controls/SelectControl.css","webpack:///./src/ViewsFactory.js","webpack:///./src/Views/RcView.js","webpack:///./src/Views/RcView.css","webpack:///./src/Views/RcBaseView.js","webpack:///./src/Models/RcModel.js"],"names":["require","Constants","pluginName","PLUGIN_NAME","menuId","MENU_ID","cssTable","CSS_TABLE","modulePath","MODULE_PATH","PluginPanel","ViewsFactory","publicInterface","afterViewer","params","map","groups","layers","Groups","split","g","replace","forEach","i","a","push","options","viewFactory","pluginPanel","sidebar","window","iconSidebarWidget","tab","createTabFunction","icon","active","inactive","hint","_gtxt","tabDiv","querySelector","create","setPane","position","showOnTop","createTab","append","innerHTML","addEventListener","e","_activeTabId","show","$","removeClass","_renderTabs","activeTabId","setTimeout","open","gmxCore","addModule","css","_translationsHash","addtext","PluginName","module","exports","getModulePath","SelectControl","_leftMenuBlock","_canvas","document","createElement","_views","_activeView","_isReady","_instruments","className","_toggleTimeline","layerID","add","tlc","nsGmx","timeLineControl","layer","gmxMap","layersByID","_map","leafletMap","addControl","addLayer","removeLayer","_addCalendar","calendar","mapDateInterval","widgets","commonCalendar","getDateInterval","dateInterval","DateInterval","set","get","on","setDateInterval","bind","CalendarWidget","name","container","dateMin","Date","dateMax","dateFormat","minimized","showSwitcher","tr","insertCell","db","getUTCDayBoundary","dateBegin","dateEnd","_create","sidebarPane","gs","localStorage","getItem","activGroup","indexOf","select","concat","filter","v","instruments","frame","_returnInstance","call","resize","callback","_isOptionsDisplayed","_select","_optionsList","_selected","o","join","body","_arrow","_options","querySelectorAll","_hideOptions","style","display","classList","remove","_setOptionsRect","selectedRc","getBoundingClientRect","bw","parseInt","getComputedStyle","borderWidth","isNaN","width","top","bottom","left","length","srcElement","id","RcView","RcModel","_m","RcBaseView","model","vid","Object","defineProperty","height","tableTemplate","handler","ls","JSON","parse","timeline","checkTimeline","lid","props","_gmx","properties","Temporal","IsRasterCatalog","Quicklook","setItem","stringify","prototype","inProgress","state","background","backgroundImage","toggleTimeline","n","temp","layerState","group","groupID","innerText","removeItem","j","visible","last","setVisibility","target","getGmxProperties","cb","type","repaint","apply","arguments","nl","groupState","_calcHeight","H","topOffset","BaseView","view","gifLoader","_clean","scrollCont","find","empty","isActive","rc","clean","h","startScreen","data","content","Handlebars","compile","mCustomScrollbar","update","hide","DEFAULT_VECTOR_LAYER_ZINDEXOFFSET","_layers","_data","members","_serverUrl","location","protocol","serverBase","_addLayer","currentZoom","getZoom","updateZIndex","rawTree","LayerOrder","rcMinZoom","RCMinZoomForRasters","setZIndexOffset","propsHostName","mapName","MapID","hostName","visibility","layerOnMap","L","gmx","createLayer","zIndexOffset","srs","skipTiles","isGeneralized","mapOptions","l","isDirty","load","actualUpdate","Promise","all","resolve","reject","sendCrossDomainJSONRequest","m","response","Status","toLowerCase","groupName","then","responses","Result","layerAttr","LayerID","description","title","timelineIcon","_layersTree","CreateTimelineIcon","catch","console","log","ex"],"mappings":"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","file":"RasterCatalogPlugin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1291d0921a9f6dd13392","require(\"./All.css\");\r\nrequire(\"./Locale.js\");\r\nconst Constants = require(\"./Constants.js\");\r\n\r\nconst pluginName = Constants.PLUGIN_NAME,\r\n    menuId = Constants.MENU_ID,\r\n    cssTable = Constants.CSS_TABLE,\r\n    modulePath = Constants.MODULE_PATH;\r\n\r\nconst PluginPanel = require('./RcPluginPanel.js'),\r\n    ViewsFactory = require('./ViewsFactory');\r\n\r\nconst publicInterface = {\r\n    pluginName: pluginName,\r\n    afterViewer: function (params, map) { \r\n/*\r\n        params.Groups =  `NOAA-20, MODIS`;\r\n        params.Layers1 = `9C267B2AC5084155A3FD0CAF2B23E420, \r\n            07208267CAE54F44B0D6B61065E36FA7,\r\n        8C549B3B6D3741DD98E480CAE02F2798`;\r\n        params.Layers2 = `A66138C36BA249D68183B09232AC3194,\r\n                533FCC7439DA4A2EB97A2BE77887A462,\r\n                60EA8F7A8C1B4AC38B59529695605276,\r\n                EB271FC4D2AD425A9BAA78ADEA041AB9`;\r\n*/\r\n\r\n        let groups = [],\r\n        layers = [];\r\n        if (params.Groups)\r\n            groups = params.Groups.split(',').map(g=>g.replace(/^\\s+/, '').replace(/\\s+$/, ''));\r\n        groups.forEach((g,i)=>{\r\n            let a =  params[`Layers${i+1}`].split(',').map(g=>g.replace(/^\\s+/, '').replace(/\\s+$/, ''));\r\n            layers.push(a);\r\n        });\r\n//console.log(groups, layers);\r\n\r\n        const options = {\r\n            modulePath: modulePath,            \r\n            groups: groups, \r\n            layers: layers\r\n            },\r\n            viewFactory = new ViewsFactory(options),\r\n            pluginPanel = new PluginPanel(viewFactory, groups);\r\n        pluginPanel.menuId = menuId;\r\n\r\n        let sidebar = window.iconSidebarWidget,\r\n        tab = window.createTabFunction({\r\n                    icon: \"RasterCatalog\", //menuId,\r\n                    active: \"RasterCatalog_sidebar-icon\",\r\n                    inactive: \"RasterCatalog_sidebar-icon\",\r\n                    hint: _gtxt('RasterCatalog.title')\r\n                })()\r\n\r\n        let tabDiv = tab.querySelector('.RasterCatalog');\r\n        pluginPanel.create(sidebar.setPane(\r\n            menuId, {\r\n                position: params.showOnTop ? -100 : 0,\r\n                createTab: ()=>{\r\n                    !tab.querySelector('.RasterCatalog') && tab.append(tabDiv);                    \r\n                    tab.querySelector('.RasterCatalog').innerHTML = '<svg xmlns=\"http://www.w3.org/2000/svg\" style=\"width:16; height:16\" viewBox=\"0 0 16 16\">' +\r\n                    '<path d=\"M15.15,0H0.88A0.83,0.83,0,0,0,0,.88V15.15A0.83,0.83,0,0,0,.88,16H15.15A0.83,0.83,0,0,0,16,15.15V0.88A0.83,0.83,0,0,0,15.15,0ZM14.25,14.25H1.75V1.75h12.5v12.5Z\"/>' +\r\n                    '<circle cx=\"7\" cy=\"5\" r=\"1.4\"/>' +\r\n                    '<path d=\"M 3 10 L 6 7 L 8 10 L 13 5 L 13 7 L 8 12 L 6 9 L 3 12 z\"/>' +\r\n                    '</svg>';\r\n                    return tab;\r\n                }\r\n            }\r\n        ));\r\n        sidebar.addEventListener('opened', function (e) {\r\n            if (sidebar._activeTabId == menuId)\r\n                pluginPanel.show();\r\n        });\r\n        \r\n        if (params.showOnTop) { // hack\r\n            $('div[data-pane-id]').removeClass('iconSidebarControl-pane-active')\r\n            sidebar._renderTabs({ activeTabId: menuId });\r\n            setTimeout(() => sidebar.open(menuId), 50);\r\n        }\r\n\r\n    }\r\n}\r\n\r\ngmxCore.addModule(pluginName, publicInterface, {\r\n    css: cssTable + '.css'\r\n});\n\n\n// WEBPACK FOOTER //\n// ./src/entry.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/All.css\n// module id = 1\n// module chunks = 0","\r\n    _translationsHash.addtext('rus', {\r\n        'RasterCatalog.title': 'Каталог растров',\r\n        'RasterCatalog.filter': 'Съемочная система',\r\n        'RasterCatalog.timeline': 'Таймлайн',\r\n        'RasterCatalog.all': 'Все',\r\n        'RasterCatalog.calendar_today':'сегодня',\r\n\r\n    });\r\n    _translationsHash.addtext('eng', {\r\n        'RasterCatalog.title': 'Rasters catalog',\r\n        'RasterCatalog.filter': 'System',\r\n        'RasterCatalog.timeline': 'Timeline',\r\n        'RasterCatalog.all': 'All',\r\n        'RasterCatalog.calendar_today':'today',\r\n\r\n    });\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Locale.js","const PluginName = 'RasterCatalog';\r\nmodule.exports = {\r\n    PLUGIN_NAME: PluginName,\r\n    MENU_ID: PluginName + \"Plugin\",\r\n    CSS_TABLE: PluginName + \"Plugin\",\r\n    MODULE_PATH: gmxCore.getModulePath(PluginName)\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Constants.js","\r\nrequire('./All.css');\r\nconst SelectControl = require('./Controls/SelectControl.js');\r\nmodule.exports = function (viewFactory, groups) {\r\n    let _leftMenuBlock,\r\n        _canvas = document.createElement('div'),\r\n        _views = viewFactory.create(),\r\n        _activeView = _views[0],\r\n        _isReady = false,\r\n        _instruments = document.createElement('div');\r\n\r\n        _canvas.className = 'rc_panel';        \r\n        _instruments.className = 'rc_instruments';\r\n        _instruments.innerHTML = `<table><tr><td>${_gtxt('RasterCatalog.filter')}</td><td><div class=\"rc_filter\"></div></td></tr></table>\r\n        <table><tr><td style=\"padding-right: 55px;\"><div class=\"calendar\"></div></td>\r\n        </tr></table>`;\r\n        /*\r\n        `<table><tr><td>${_gtxt('RasterCatalog.filter')}</td><td><div class=\"rc_filter\"></div></td></tr></table>\r\n        <table><tr><td style=\"padding-right: 55px;\"><div class=\"calendar\"></div></td>\r\n        </tr> \r\n        <tr><td>       \r\n        <span>${_gtxt('RasterCatalog.timeline')}</span>\r\n        <label class=\"sync-switch switch\"><input type=\"checkbox\"><div class=\"sync-switch-slider switch-slider round\"></div></label>\r\n        </td></tr>\r\n        </table>`;\r\n        */\r\n////////////////////////////////////////\r\n\r\n    const _toggleTimeline = function(layerID, add){\r\n        let tlc = nsGmx.timeLineControl,\r\n            layer = nsGmx.gmxMap.layersByID[layerID];\r\n        if (add) {\r\n            if (!tlc._map) { nsGmx.leafletMap.addControl(tlc); }\r\n            tlc.addLayer(layer);\r\n        } else {\r\n            if (tlc._map)\r\n            tlc.removeLayer(layer);\r\n        }    \r\n    },  \r\n    _addCalendar = function(){\r\n            \r\n        let calendar = _canvas.querySelector('.calendar');\r\n        // walkaround with focus at first input in ui-dialog\r\n        calendar.innerHTML = ('<span class=\"ui-helper-hidden-accessible\"><input type=\"text\"/></span>');\r\n\r\n        let mapDateInterval = nsGmx.widgets.commonCalendar.getDateInterval(),\r\n            dateInterval = new nsGmx.DateInterval();\r\n\r\n        dateInterval\r\n            .set('dateBegin', mapDateInterval.get('dateBegin'))\r\n            .set('dateEnd', mapDateInterval.get('dateEnd'))\r\n            .on('change', function (e) {\r\n//console.log(dateInterval.get('dateBegin')) \r\n                nsGmx.widgets.commonCalendar.setDateInterval(dateInterval.get('dateBegin'), dateInterval.get('dateEnd'));\r\n            }.bind(this));\r\n\r\n        this.calendar = new nsGmx.CalendarWidget({\r\n            dateInterval: dateInterval,\r\n            name: 'catalogInterval',\r\n            container: calendar,\r\n            dateMin: new Date(0, 0, 0),\r\n            dateMax: new Date(3015, 1, 1),\r\n            dateFormat: 'dd.mm.yy',\r\n            minimized: false,\r\n            showSwitcher: false\r\n        })\r\n\r\n        let tr = calendar.querySelector('tr:nth-of-type(1)');\r\n        tr.insertCell(2).innerHTML = '&nbsp;&nbsp;–&nbsp;&nbsp;';\r\n        tr.insertCell(5).innerHTML = \r\n        '&nbsp;&nbsp;<img class=\"default_date\" style=\"cursor:pointer\" title=\"'+_gtxt('RasterCatalog.calendar_today')+'\" src=\"plugins/AIS/AISSearch/svg/calendar.svg\">';\r\n    \r\n        calendar.querySelector('.default_date').addEventListener('click', () => {\r\n            let db = nsGmx.DateInterval.getUTCDayBoundary(new Date());\r\n            this.calendar.getDateInterval().set('dateBegin', db.dateBegin);\r\n            this.calendar.getDateInterval().set('dateEnd', db.dateEnd);\r\n            nsGmx.widgets.commonCalendar.setDateInterval(db.dateBegin, db.dateEnd);\r\n        });\r\n\r\n    },  \r\n    _create = function (sidebarPane) {\r\n        _canvas.append(_instruments);\r\n        this.sidebarPane.append(_canvas);\r\n\r\n        /*\r\n        let timelineSwitch = _instruments.querySelector('.switch input');\r\n        timelineSwitch.addEventListener('click', e => {\r\n            let ls = JSON.parse(localStorage.getItem('layerState'));\r\n            let layers = _activeView.container.querySelectorAll('.rc_content li table');\r\n            for (let i = 0; i < layers.length; ++i) {\r\n//console.log(layers[i].id, nsGmx.gmxMap.layersByID[layers[i].id.replace(/^layer/, '')]._gmx)\r\n                let lid = layers[i].id.replace(/^layer/, ''),\r\n                props = nsGmx.gmxMap.layersByID[lid]._gmx && nsGmx.gmxMap.layersByID[lid]._gmx.properties;\r\n                if (layers[i].getBoundingClientRect().width) \r\n                    if (nsGmx.timeLineControl && props && props.Temporal && (props.IsRasterCatalog || (props.Quicklook && props.Quicklook !== 'null')))               \r\n                    if (timelineSwitch.checked)\r\n                        _toggleTimeline(lid, true);\r\n                    else\r\n                        _toggleTimeline(lid, false);\r\n            }\r\n        })\r\n        */\r\n\r\n        let gs = localStorage.getItem('groupState'),\r\n            activGroup = !gs ? 0 : (groups.indexOf(gs) + 1);\r\n        const select = new SelectControl(_instruments.querySelector('.rc_filter'), [_gtxt('RasterCatalog.all')].concat(groups), activGroup, _activeView.filter.bind(_activeView));\r\n    \r\n        _views.forEach((v, i) => {\r\n                    v.instruments = _instruments;\r\n                    _canvas.append(v.frame);\r\n                });\r\n \r\n        _activeView && _activeView.show();\r\n    }\r\n\r\n    const _returnInstance = {\r\n        create: function(sidebarPane){\r\n            this.sidebarPane = sidebarPane;\r\n            _create.call(this);\r\n            _addCalendar.call(this);\r\n        },\r\n        show: function () {\r\n            if (!_isReady) { \r\n                //_create.call(this);\r\n                _views.forEach((v, i) => {\r\n                    v.resize();\r\n                });             \r\n                _isReady = true;\r\n            }\r\n            //_activeView && _activeView.show();\r\n        }\r\n    };\r\n    return _returnInstance;\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/RcPluginPanel.js","require(\"./SelectControl.css\");\r\n\r\nmodule.exports = function(container, options, active, callback){\r\n    let _isOptionsDisplayed = false,\r\n    _select = document.createElement('div'),\r\n    _optionsList = document.createElement('div'),\r\n    _selected = active; \r\n\r\n    _select.className = 'rc_select';\r\n    _select.innerHTML = `<span class=\"group_name\">${options[active]}</span><span class=\"icon-down-open\"></span>`;\r\n    _optionsList.className = 'rc_groups_list';\r\n    _optionsList.innerHTML = options.map((o, i)=>`<div class=\"rc_group\" id=\"${i}\">${o}</div>`).join('');\r\n    \r\n    container.append(_select);\r\n    document.body.append(_optionsList);\r\n\r\n    const _arrow = _select.querySelector('.icon-down-open'),\r\n    _options = _optionsList.querySelectorAll('.rc_group'),\r\n    _hideOptions = function(){\r\n            _optionsList.style.display = 'none';\r\n            _optionsList.querySelectorAll('.rc_group')[_selected].classList.remove('selected');\r\n            _arrow.classList.remove('icon-up-open');\r\n            _arrow.classList.add('icon-down-open');\r\n            _isOptionsDisplayed = false;\r\n    };\r\n\r\n    let _setOptionsRect = function(){\r\n        let selectedRc = _select.getBoundingClientRect(),\r\n            bw = parseInt(getComputedStyle(_optionsList).borderWidth);\r\n        if (isNaN(bw)) bw = 0;\r\n        _optionsList.style.width = selectedRc.width - 2 * bw + \"px\";\r\n        _optionsList.style.top = selectedRc.bottom - 3 + \"px\";\r\n        _optionsList.style.left = selectedRc.left + \"px\";  \r\n    }  \r\n\r\n    for (let i=0; i<_options.length; ++i)\r\n        _options[i].addEventListener('click', e=>{\r\n            _hideOptions();\r\n            _selected = parseInt(e.srcElement.id);  \r\n            _select.querySelector('.group_name').innerHTML = options[_selected];          \r\n            callback(_selected);\r\n        });\r\n\r\n    _optionsList.addEventListener('mouseleave', e=>{\r\n        _hideOptions();\r\n    });\r\n    _select.addEventListener('click', e=>{\r\n//console.log(_isOptionsDisplayed)\r\n        if (_isOptionsDisplayed){\r\n            _hideOptions();\r\n        }\r\n        else{\r\n            _setOptionsRect();\r\n            _optionsList.style.display = 'block';\r\n            _optionsList.querySelectorAll('.rc_group')[_selected].classList.add('selected');\r\n            _arrow.classList.remove('icon-down-open');\r\n            _arrow.classList.add('icon-up-open');\r\n            _isOptionsDisplayed = true;\r\n        }\r\n    });\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Controls/SelectControl.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Controls/SelectControl.css\n// module id = 7\n// module chunks = 0","const RcView = require('./Views/RcView'),\r\n      RcModel = require('./Models/RcModel');\r\n\r\nmodule.exports = function (options) {\r\n    const _m = new RcModel(options);\r\n    return {\r\n        create: function () {\r\n            return [new RcView(_m, 'first')];\r\n        }\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/ViewsFactory.js","require(\"./RcView.css\");\r\nconst RcBaseView = require('./RcBaseView.js');\r\nconst Constants= require('../Constants.js');\r\nconst RcView = function (model, vid){\r\n    RcBaseView.call(this, model);\r\n    //this.topOffset = 80;\r\n    Object.defineProperty(this, 'topOffset',  { get: function () { \r\n        return document.querySelector('.rc_instruments').getBoundingClientRect().height;\r\n    }});\r\n    this.frame = document.createElement('div');\r\n    this.frame.className = 'rc_view';\r\n    this.frame.classList.add(vid);\r\n    this.frame.innerHTML = `<div class=\"rc_all\">\r\n    <div><ul class=\"rc_content\"><li><div><div></li></ul></div>    \r\n    </div>`;\r\n    \r\n    this.container = this.frame.querySelector('.rc_all'); \r\n\r\n    this.tableTemplate = '{{#if msg}}<div>{{msg}}</div>{{/if}}' +\r\n        '<ul class=\"rc_content\">{{#each groups}}' + \r\n        '<li class=\"rc_layer_group\"><ul><div class=\"rc_group_name\">{{name}}</div>' +\r\n        '{{#each layers}}' +\r\n        '<li class=\"rc_layer\"><table id=\"layer{{id}}\"><tr><td class=\"timeline-icon\"></td>' +\r\n        '<td class=\"visibility\"><img src=\"' + Constants.MODULE_PATH +'img/unchecked.png\"><img src=\"' + Constants.MODULE_PATH +'img/checked.png\"></td>' +\r\n        '<td>{{title}}</td></tr><tr><td></td><td></td><td class=\"rc_layer_desc\">{{{description}}}</td></tr></table></li>' +\r\n        '{{/each}}</ul></li>' +\r\n        '{{/each}}</ul>';\r\n\r\n    let handler = function (e) {\r\n        let ls = JSON.parse(localStorage.getItem('layerState'));\r\n        if (!ls) ls = {};\r\n        if (!ls[e.layerID]) ls[e.layerID] = {};\r\n        if (!ls[e.layerID].timeline){\r\n            ls[e.layerID].timeline = true;\r\n\r\n            let checkTimeline = true,\r\n            layers = this.container.querySelectorAll('table');\r\n            for(var i=0; i<layers.length; ++i){\r\n                let lid = layers[i].id.replace(/^layer/, ''),\r\n//console.log(ls[lid])\r\n                props = nsGmx.gmxMap.layersByID[lid]._gmx && nsGmx.gmxMap.layersByID[lid]._gmx.properties;\r\n                if (props && props.Temporal && (props.IsRasterCatalog || (props.Quicklook && props.Quicklook !== 'null'))) \r\n                if ((!ls[lid] || !ls[lid].timeline) && layers[i].getBoundingClientRect().width){\r\n                    checkTimeline = false;\r\n                    break;\r\n                }\r\n            }\r\n            /* \r\n            if (checkTimeline)\r\n                this.instruments.querySelector('.switch input').checked = 1;\r\n            */\r\n        }\r\n        else{\r\n            ls[e.layerID].timeline = false;\r\n            /* \r\n            if (this.container.querySelector('#layer' + e.layerID).getBoundingClientRect().width)\r\n                this.instruments.querySelector('.switch input').checked = 0;\r\n            */    \r\n        }\r\n        localStorage.setItem('layerState', JSON.stringify(ls));\r\n    }\r\n    nsGmx.timeLineControl.on('layerAdd', handler.bind(this));\r\n    nsGmx.timeLineControl.on('layerRemove', handler.bind(this));\r\n};\r\n\r\n\r\nRcView.prototype = Object.create(RcBaseView.prototype);\r\n\r\nRcView.prototype.inProgress = function (state) {\r\n    if (state){\r\n        this.frame.style.background = 'url(\\'img/progress.gif\\') center no-repeat';\r\n    }\r\n    else{\r\n        this.frame.style.backgroundImage = 'none';\r\n    }\r\n};\r\n\r\nlet toggleTimeline = function(layerID, add){\r\n    let tlc = nsGmx.timeLineControl,\r\n        layer = nsGmx.gmxMap.layersByID[layerID];\r\n    if (add) {\r\n        if (!tlc._map) { nsGmx.leafletMap.addControl(tlc); }\r\n        tlc.addLayer(layer);\r\n    } else {\r\n        if (tlc._map)\r\n        tlc.removeLayer(layer);\r\n    }    \r\n}\r\n\r\nRcView.prototype.filter = function (n) {\r\n    const groups = this.container.querySelectorAll('.rc_content .rc_layer_group'),\r\n    temp = localStorage.getItem('layerState'),\r\n    layerState = JSON.parse(temp);\r\n    let checkTimeline = true;\r\n    for (let i=0; i < groups.length; ++i){\r\n        let group = groups[i].querySelector('.rc_group_name'),\r\n            groupID = group.innerText,\r\n            layers = groups[i].querySelectorAll('table');\r\n        if (0==n)\r\n            localStorage.removeItem('groupState');            \r\n        if ((i+1)==n)\r\n            localStorage.setItem('groupState', groupID);\r\n\r\n        if (n==0 || (i+1)==n){\r\n            groups[i].style.display = 'block';  \r\n\r\n            for (let j=0; j<layers.length; ++j){\r\n                let lid = layers[j].id.replace(/^layer/, '');\r\n//console.log(layers[j].id, layerState[lid])\r\n                if (layerState && layerState[lid]){\r\n                    if (layerState[lid].visible)\r\n                        nsGmx.leafletMap.addLayer(nsGmx.gmxMap.layersByID[lid]);\r\n                    if (layerState[lid].timeline)\r\n                        toggleTimeline( lid, true);\r\n                    else\r\n                        checkTimeline = false;\r\n                }\r\n                else{                    \r\n                    let props = nsGmx.gmxMap.layersByID[lid]._gmx && nsGmx.gmxMap.layersByID[lid]._gmx.properties;\r\n                    if (props && props.Temporal && (props.IsRasterCatalog || (props.Quicklook && props.Quicklook !== 'null')))   \r\n                        checkTimeline = false;\r\n                }\r\n            }\r\n        }\r\n        else{\r\n            for (let j=0; j<layers.length; ++j){\r\n                let lid = layers[j].id.replace(/^layer/, '');\r\n                nsGmx.leafletMap.removeLayer(nsGmx.gmxMap.layersByID[lid]);\r\n                toggleTimeline( lid, false);\r\n            }\r\n            groups[i].style.display = 'none';\r\n        }\r\n    }    \r\n    localStorage.setItem('layerState', temp);\r\n    /*\r\n    this.instruments.querySelector('.switch input').checked = groups.length && checkTimeline ? 1 : 0;\r\n    */\r\n};\r\n\r\nlet last, \r\nsetVisibility = function (e) {\r\n//console.log(e.target.getGmxProperties().name, e.type);\r\n        let lid = e.target.getGmxProperties().name;//e.target.options.layerID;   \r\n        if (last == lid) {\r\n            last = null;\r\n            return;\r\n        }\r\n        last = lid;    \r\n        let ls = JSON.parse(localStorage.getItem('layerState'));\r\n        if (!ls) ls = {};\r\n        if (!ls[lid]) ls[lid] = {};\r\n        let cb = document.querySelectorAll('.rc_view #layer' + lid + ' .visibility img');\r\n//console.log(lid, nsGmx.gmxMap.layersByID[lid], nsGmx.gmxMap.layersByID[lid]._map)\r\n        if (e.type=='add') { //nsGmx.gmxMap.layersByID[lid]._map\r\n            ls[lid].visible = true;\r\n            cb[0].style.display = 'none';\r\n            cb[1].style.display = 'inline';\r\n        }\r\n        else {\r\n            ls[lid].visible = false;\r\n            cb[0].style.display = 'inline';\r\n            cb[1].style.display = 'none';\r\n        }\r\n        localStorage.setItem('layerState', JSON.stringify(ls));\r\n    }\r\n\r\nRcView.prototype.repaint = function () {\r\n    RcBaseView.prototype.repaint.apply(this, arguments);\r\n\r\n    let nl = this.container.querySelectorAll('.rc_content li table'),\r\n    groupState = localStorage.getItem('groupState');\r\n//console.log(groupState);\r\n    for (let i=0; i<nl.length; ++i){\r\n        let cb = nl[i].querySelectorAll('.visibility img'),\r\n        lid = nl[i].id.replace(/^layer/, '');\r\n\r\n        nsGmx.gmxMap.layersByID[lid].on('add', setVisibility.bind(this));\r\n        nsGmx.gmxMap.layersByID[lid].on('remove', setVisibility.bind(this));\r\n\r\n        cb[1].style.display = 'none';\r\n\r\n        cb[0].addEventListener('click', e=>{\r\n            cb[0].style.display = 'none';\r\n            cb[1].style.display = 'inline';\r\n            nsGmx.leafletMap.addLayer(nsGmx.gmxMap.layersByID[lid]);\r\n        });\r\n        cb[1].addEventListener('click', e=>{\r\n            cb[0].style.display = 'inline';\r\n            cb[1].style.display = 'none';\r\n            nsGmx.leafletMap.removeLayer(nsGmx.gmxMap.layersByID[lid]);\r\n        });\r\n    }\r\n\r\n    if (groupState){\r\n        nl = this.container.querySelectorAll('.rc_content .rc_group_name');\r\n        for (let i=0; i<nl.length; ++i)\r\n            if (nl[i].innerText==groupState){\r\n                this.filter(i+1);\r\n                break;\r\n            }\r\n    }\r\n    else\r\n        this.filter(0);\r\n\r\n};\r\n\r\nmodule.exports = RcView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/RcView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/RcView.css\n// module id = 10\n// module chunks = 0","\r\nlet _calcHeight = function () {\r\n    let H = $('.iconSidebarControl-pane').height() - this.topOffset;\r\n    return (H);\r\n};\r\n\r\nconst BaseView = function (model) {\r\n    model.view = this;\r\n    this.model = model;\r\n    this.gifLoader = '<img src=\"img/progress.gif\">';\r\n};\r\n\r\nlet _clean = function(){ \r\n    let scrollCont = $(this.container).find('.mCSB_container');\r\n    if (scrollCont[0])\r\n        scrollCont.empty();\r\n    else\r\n        $(this.container).empty();\r\n//console.log(\"EMPTY ON BASE.CLEAN\")\r\n};\r\n\r\nBaseView.prototype = function () {\r\n    return {\r\n        get isActive(){\r\n            let rc = this.frame.getBoundingClientRect();\r\n            return rc.width==0 && rc.height==0;\r\n        },\r\n        resize: function (clean) {\r\n            let h = _calcHeight.call(this);\r\n            if (this.startScreen){\r\n                this.startScreen.height(h);\r\n                $(this.container).css({ position:\"relative\", top: -h+\"px\" });\r\n            }\r\n            $(this.container).height(h);\r\n\r\n            if (clean){\r\n                $(this.container).empty()\r\n            }\r\n        },\r\n        repaint: function(){\r\n            _clean.call(this);  \r\n            if (!this.model.data)\r\n                return;\r\n            let scrollCont = $(this.container).find('.mCSB_container'),\r\n            content = $(Handlebars.compile(this.tableTemplate)(this.model.data));\r\n            if (!scrollCont[0]) {\r\n                $(this.container).append(content).mCustomScrollbar();\r\n            }\r\n            else {\r\n                $(scrollCont).append(content);\r\n            }\r\n        },\r\n        show: function () {\r\n            this.frame.style.display = 'block';\r\n            this.model.update();\r\n        },\r\n        hide: function () {\r\n            this.frame.style.display = 'none';\r\n        }\r\n    }\r\n}();\r\n\r\nmodule.exports = BaseView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/RcBaseView.js","const DEFAULT_VECTOR_LAYER_ZINDEXOFFSET = 2000000;\r\nmodule.exports = function ({groups, layers}) {\r\n    let _layers = [],\r\n    _data = {groups: []};\r\n    groups.forEach((g, i)=>{\r\n        _layers.push({group:g, members: layers[i]});\r\n    } );\r\n\r\n    let _serverUrl = document.location.protocol + window.serverBase.replace(/^[^:]+:/, '');\r\n    let _addLayer = function (layer) {\r\n        let currentZoom = nsGmx.leafletMap.getZoom();\r\n        function updateZIndex(layer) {\r\n            var props = layer.getGmxProperties();\r\n            switch (nsGmx.gmxMap.rawTree.properties.LayerOrder) {\r\n                case 'VectorOnTop':\r\n                    if (props.type === 'Vector') {\r\n                        if (props.IsRasterCatalog) {\r\n                            var rcMinZoom = props.RCMinZoomForRasters;\r\n                            layer.setZIndexOffset(currentZoom < rcMinZoom ? DEFAULT_VECTOR_LAYER_ZINDEXOFFSET : 0);\r\n                        } else {\r\n                            layer.setZIndexOffset(DEFAULT_VECTOR_LAYER_ZINDEXOFFSET);\r\n                        }\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n\r\n        var name = layer.properties.name;\r\n\r\n        // hack to avoid API defaults by initFromDescription;\r\n        var propsHostName = window.serverBase.replace(/https?:\\/\\//, '');\r\n        propsHostName = propsHostName.replace(/\\//g, '');\r\n\r\n        layer.properties.mapName = nsGmx.gmxMap.properties.MapID;\r\n        layer.properties.hostName = propsHostName;\r\n\r\n        if (!nsGmx.gmxMap.layersByID[name]) {\r\n            var visibility = typeof layer.properties.visible != 'undefined' ? layer.properties.visible : false,\r\n                rcMinZoom = layer.properties.RCMinZoomForRasters,\r\n                layerOnMap = L.gmx.createLayer(layer, {\r\n                    layerID: name,\r\n                    hostName: propsHostName,\r\n                    zIndexOffset: null,\r\n                    srs: nsGmx.leafletMap.options.srs || '',\r\n                    skipTiles: nsGmx.leafletMap.options.skipTiles || '',\r\n                    isGeneralized: window.mapOptions && 'isGeneralized' in window.mapOptions ? window.mapOptions.isGeneralized : true\r\n                });\r\n\r\n            updateZIndex(layerOnMap);\r\n            nsGmx.gmxMap.addLayer(layerOnMap);\r\n\r\n            //nsGmx.leafletMap.addLayer(layerOnMap);\r\n\r\n            //layerOnMap.getGmxProperties().changedByViewer = true;\r\n\r\n            nsGmx.leafletMap.on('zoomend', function (e) {\r\n                currentZoom = nsGmx.leafletMap.getZoom();\r\n\r\n                for (var l = 0; l < nsGmx.gmxMap.layers.length; l++) {\r\n                    var layer = nsGmx.gmxMap.layers[l];\r\n\r\n                    updateZIndex(layer);\r\n                }\r\n            });\r\n            return layerOnMap;\r\n        }\r\n    };\r\n\r\n    return {\r\n        isDirty: true,\r\n        get data() { return _data; },\r\n        load: function (actualUpdate) {\r\n            return Promise.all(_layers.map(l => {\r\n                let a = l.members.map(m =>\r\n                    new Promise((resolve, reject) => {\r\n                        sendCrossDomainJSONRequest(_serverUrl + 'Layer/GetLayerJson.ashx?NeedAttrValues=false&LayerName=' + m, response => {\r\n                            if (response.Status && response.Status.toLowerCase() == 'ok')\r\n                                resolve(response);\r\n                            else\r\n                                reject(response);\r\n                        });\r\n                    })\r\n                );\r\n                a.push(Promise.resolve({groupName: l.group}));\r\n                return Promise.all(a);\r\n            }\r\n            ));\r\n        },\r\n        update: function () {\r\n            if (this.isDirty) {\r\n                this.view.inProgress(true);\r\n                this.load()\r\n                    .then((groups => {\r\n//console.log(groups)                    \r\n                        groups.forEach(responses=>{  \r\n                            let group = {layers:[]};\r\n                            responses.forEach(response=>{\r\n                                if (response.Result) {\r\n                                    let props = response.Result.properties;\r\n                                    _addLayer(response.Result);\r\n                                    let layerAttr = {\r\n                                        id: props.LayerID,\r\n                                        description: props.description,\r\n                                        title: props.title\r\n                                    };\r\n                                    if (nsGmx.timeLineControl && props.Temporal && (props.IsRasterCatalog || (props.Quicklook && props.Quicklook !== 'null')))\r\n                                        layerAttr.timelineIcon = window._layersTree.CreateTimelineIcon({ name: props.LayerID });\r\n                                    group.layers.push(layerAttr);\r\n                                }\r\n                                else\r\n                                    group.name = response.groupName;\r\n                            });\r\n                            _data.groups.push(group);\r\n                        });\r\n//console.log(_data)\r\n                        this.view.inProgress(false);\r\n                        this.view.repaint();\r\n\r\n                        _data.groups.forEach(g=>{\r\n                            g.layers.forEach(l=>{\r\n                                if (l.timelineIcon)\r\n                                    document.querySelector('#layer' + l.id + ' .timeline-icon').append(l.timelineIcon);\r\n                            });\r\n                        });\r\n\r\n                        this.isDirty = false;\r\n                    }).bind(this))\r\n                    .catch((ex => {\r\n                        console.log(ex)\r\n                        this.view.inProgress(false);\r\n                    }).bind(this));\r\n            }\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Models/RcModel.js"],"sourceRoot":""}