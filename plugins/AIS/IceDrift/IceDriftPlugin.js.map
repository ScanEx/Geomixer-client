{"version":3,"sources":["webpack:///webpack/bootstrap 54adbab903c1458f2e46","webpack:///./src/entry.js","webpack:///./src/All.css","webpack:///./src/Locale.js","webpack:///./src/PluginPanel.js","webpack:///./src/Utils.js"],"names":["require","pluginName","menuId","toolbarIconId","cssTable","modulePath","gmxCore","getModulePath","PluginPanel","publicInterface","afterViewer","params","map","lmap","nsGmx","leafletMap","iconOpt","id","togglable","title","_gtxt","icon","L","control","gmxIcon","on","ev","target","options","isActive","panel","hide","show","addControl","button","document","querySelector","innerHTML","addModule","css","_translationsHash","addtext","Utils","module","exports","pluginButton","_find","path","parent","_serverBase","serverBase","replace","location","protocol","_lmap","_gmap","gmxMap","_panel","createElement","classList","add","body","appendChild","_saveBut","_cancelBut","_countBut","_upBut","_downBut","_spinner","_period","_messsagePan","_progress","_speedPercent","_traceIcon","divIcon","html","iconAnchor","_startIcon","iconUrl","_trace","_marker","_isSuccess","response","Status","toLowerCase","_searchLayer","Promise","resolve","reject","sendCrossDomainJSONRequest","properties","MapID","Result","_createLayer","mapName","Date","getTime","r","name","then","layerID","_layerPromise","searchResult","count","existedLayerID","layers","LayerID","layersByID","once","e","layer","setTimeout","removeLayer","window","_mapHelper","updateUnloadEvent","_layersTree","addLayerToTree","_showProgress","visible","style","display","_prepareAll","controls","forEach","c","remove","disabled","_map","addLayer","_saveTrace","trace","objects","tp","i","push","start_date","end_date","wind_speed","wind_angle","percent","distance","type","geometry","coordinates","lng","lat","action","sendCrossDomainPostRequest","WrapStyle","LayerName","JSON","stringify","geometry_cs","length","_onCancel","contains","_cleanTrace","_setReady","_onSave","gmx","layersVersion","chkVersion","catch","console","log","_spin","dir","cur","parseInt","slice","_countRun","speedPercent","parseFloat","value","placeholder","isNaN","period","latlng","_latlng","nearest","test","a","intnum","Math","floor","mantissa","drawMarker","tracePoint","mrk","marker","addTo","_icon","background","border","forecastPoint","startPoint","azimuth","lat2","asin","sin","PI","cos","atan2","toString","getForecast","point","moment","momentBase","UTC","getFullYear","getMonth","getDate","qs","getUTCDate","getUTCMonth","getUTCFullYear","getUTCHours","values","fields","f","nextMoment","interval","Speed","Angle","pointNext","tasksChain","reduce","p","acqdatetime","_cleanStartMarker","addEventListener","_sentinelLayers","setActive","_returnInstance","_msgBox","_onSentinelLayerClick","_init","ctrl","l","content","showDialog","_setCrossCursor","disablePopup","_unsetCrossCursor","enablePopup","rc","_container","getBoundingClientRect","shift","getComputedStyle","borderSpacing","top","bottom","left","off"],"mappings":"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","file":"IceDriftPlugin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 54adbab903c1458f2e46","require(\"./All.css\")\r\nrequire(\"./Locale.js\")\r\n\r\n\r\nconst pluginName = 'IceDriftPlugin',\r\n    menuId = pluginName,\r\n    toolbarIconId = pluginName, \r\n    cssTable = pluginName,\r\n    modulePath = gmxCore.getModulePath(pluginName);\r\n\r\nconst PluginPanel = require('./PluginPanel.js');\r\n\r\nconst publicInterface = {\r\n    pluginName: pluginName,\r\n    afterViewer: function (params, map) {\r\n\r\n        const lmap = nsGmx.leafletMap,\r\n        iconOpt = {\r\n            id: 'IceDrift',\r\n            togglable: true,\r\n            title: _gtxt(pluginName + '.iconTitle')\r\n        },\r\n        icon = L.control.gmxIcon(iconOpt).on('statechange', function (ev) {\r\n            if (!ev.target.options.isActive){\r\n                panel.hide();\r\n            }\r\n            else{\r\n                panel.show(ev.target);\r\n            }\r\n        });\r\n        lmap.addControl(icon);\r\n        const panel = new PluginPanel(icon);\r\n\r\n        const button = document.querySelector('.leaflet-gmx-iconSvg-' + iconOpt.id);\r\n        button.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" id=\"Слой_1\" data-name=\"Слой 1\" viewBox=\"0 0 24 24\">\r\n            <defs><style>.cls-1{opacity:0.5;}</style></defs><title>iceberg</title>\r\n            <path d=\"M17.42,13h-12A.46.46,0,0,1,5,12.48l.29-3.93a.48.48,0,0,1,.48-.43H7.23a.47.47,0,0,0,.42-.24l.83-1.54h1L10.17,5a.27.27,0,0,1,.09-.12L11.55,3.7a.49.49,0,0,1,.54-.08L14.5,4.73a.53.53,0,0,1,.22.2l.63,1.17a.47.47,0,0,0,.42.24h.89l1.23,6.09A.46.46,0,0,1,17.42,13ZM7.06,11.07H15a.46.46,0,0,0,.47-.54L15,8.24h-.75l-1-1.88a.45.45,0,0,0-.21-.2l-.85-.39-.35.31L10.67,8.24h-1L8.88,9.77a.48.48,0,0,1-.43.25H7.14Z\"/><g class=\"cls-1\"><path d=\"M5.43,11.16h12a.44.44,0,0,1,.48.44l-.29,3.52a.46.46,0,0,1-.48.38H15.62a.47.47,0,0,0-.42.22l-.83,1.37h-1l-.73,1.2a.28.28,0,0,1-.09.1l-1.28,1.07a.54.54,0,0,1-.55.07l-2.41-1a.42.42,0,0,1-.21-.18l-.63-1a.53.53,0,0,0-.43-.22H6.2L5,11.65A.43.43,0,0,1,5.43,11.16Zm10.36,1.7H7.85a.43.43,0,0,0-.47.49l.47,2H8.6l1,1.68a.4.4,0,0,0,.22.18l.85.36.34-.29,1.16-1.93h1L14,14a.49.49,0,0,1,.42-.22h1.31Z\"/></g><path d=\"M19,13H4a.48.48,0,0,1-.48-.46v-1A.48.48,0,0,1,4,11.07H19a.48.48,0,0,1,.48.46v1A.48.48,0,0,1,19,13Z\"/>\r\n            </svg>`;\r\n\r\n\r\n    }\r\n}\r\n\r\ngmxCore.addModule(pluginName, publicInterface, {\r\n    css: cssTable + '.css'\r\n});\n\n\n// WEBPACK FOOTER //\n// ./src/entry.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/All.css\n// module id = 1\n// module chunks = 0","\r\n    _translationsHash.addtext('rus', {\r\n        'IceDriftPlugin.iconTitle': 'Расчет дрейфа льда',\r\n        'IceDriftPlugin.count': 'Рассчитать',\r\n        'IceDriftPlugin.save': 'Сохранить',\r\n        'IceDriftPlugin.period': 'Срок прогноза',\r\n        'IceDriftPlugin.speedPercent': 'Процент от скорсти ветра',        \r\n        'IceDriftPlugin.showSentinel': 'Включите слой Sentinel-1',\r\n        'IceDriftPlugin.setPeriod': 'Введите срок прогноза и нажмите рассчитать',\r\n        'IceDriftPlugin.setStart': 'Кликните на снимке на ледовое образование',\r\n        'IceDriftPlugin.abbrHour': 'ч',\r\n        'IceDriftPlugin.noWindData': 'Нет данных о ветре. Измените дату.',\r\n        'IceDriftPlugin.cancel': 'Отменить',\r\n        'IceDriftPlugin.inavalidValue': 'Недопустимое значение',\r\n    });\r\n    _translationsHash.addtext('eng', {\r\n        'IceDriftPlugin.iconTitle': 'Ice drift forecast',\r\n        'IceDriftPlugin.count': 'Count',\r\n        'IceDriftPlugin.save': 'Save',\r\n        'IceDriftPlugin.period': 'Period',\r\n        'IceDriftPlugin.speedPercent': 'Wind speed percent', \r\n        'IceDriftPlugin.showSentinel': 'Activate Sentinel-1 layer',\r\n        'IceDriftPlugin.setPeriod': 'Choose period and press count',\r\n        'IceDriftPlugin.setStart': 'Set marker on ice object',\r\n        'IceDriftPlugin.abbrHour': 'h',\r\n        'IceDriftPlugin.noWindData': 'No wind data. Change date.',\r\n        'IceDriftPlugin.cancel': 'Cancel',\r\n        'IceDriftPlugin.inavalidValue': 'Invalid value',\r\n    });\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Locale.js","\r\nconst Utils = require('./Utils.js');\r\nmodule.exports = function (pluginButton) {\r\n    const _find = function(path, parent){\r\n        if(!parent)\r\n            parent = document;\r\n        return parent.querySelector(path);\r\n    }; \r\n\r\n    const _serverBase = (serverBase && serverBase.replace(/[^:]+:/, document.location.protocol)) || (document.location.protocol + '//geomixer.scanex.ru/'),\r\n    _lmap = nsGmx.leafletMap,\r\n    _gmap = nsGmx.gmxMap,\r\n    _panel = document.createElement('div');\r\n    _panel.classList.add('IceDrift');\r\n    _panel.classList.add('panel');\r\n    _panel.innerHTML = `<table>\r\n    <tr><td class=\"button save disabled unselectable control\" unselectable=\"on\">${_gtxt(\"IceDriftPlugin.save\")}</td>\r\n    <td class=\"button cancel disabled unselectable control\" unselectable=\"on\">${_gtxt(\"IceDriftPlugin.cancel\")}</td></tr>\r\n    <tr><td class=\"control\">\r\n\r\n    <table border=\"0\" class=\"speedpercent disabled\" style=\"width: 140px;\"><tbody><tr><td class=\"unselectable\" unselectable=\"on\">${_gtxt(\"IceDriftPlugin.speedPercent\")}</td><td rowspan=\"2\">\r\n    <input type=\"text\" placeholder=\"2\" style=\"width: 40px;margin: 6px;\"></td></tr></tbody></table> \r\n    \r\n    </td>\r\n    <td style=\"width:1px\"><div>\r\n    <table class=\"spinner disabled\" border=\"0\">\r\n    <tbody><tr><td rowspan=\"3\" style=\"padding-right: 6px; white-space:nowrap\">${_gtxt(\"IceDriftPlugin.period\")}</td><td class=\"button up unselectable\" unselectable=\"on\">\r\n<svg width=\"8\" height=\"6\" viewBox=\"0 0 8 8\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\r\n <polygon points=\"0 8, 8 8, 4 0\"></polygon>   \r\n</svg></td></tr>\r\n    <tr><td class=\"period unselectable\" unselectable=\"on\">00 ${_gtxt(\"IceDriftPlugin.abbrHour\")}</td></tr>\r\n    <tr><td class=\"button down unselectable\" unselectable=\"on\"><svg width=\"8\" height=\"6\" viewBox=\"0 0 8 8\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\r\n <polygon points=\"0 0, 4 8, 8 0\"></polygon>   \r\n</svg></td></tr>\r\n    </tbody></table>\r\n    </div></td></tr>\r\n    <tr><td class=\"button count disabled unselectable control\" unselectable=\"on\">${_gtxt(\"IceDriftPlugin.count\")}</td><td></td></tr>\r\n    <tr><td colspan=\"2\"><div class=\"message unselectable\" unselectable=\"on\"><img src=\"${_serverBase}api/img/progress.gif\"><i>${_gtxt(\"IceDriftPlugin.setStart\")}</i></div></td></tr>\r\n    </table>`;\r\n    document.body.appendChild(_panel);\r\n    const _saveBut = _find('.save', _panel),\r\n    _cancelBut = _find('.cancel', _panel),\r\n    _countBut = _find('.count', _panel),\r\n    _upBut = _find('.up', _panel),\r\n    _downBut = _find('.down', _panel),\r\n    _spinner = _find('.spinner', _panel),\r\n    _period = _find('.period', _panel),\r\n    _messsagePan = _find('.message i', _panel),\r\n    _progress = _find('.message img', _panel),\r\n    _speedPercent = _find('.speedpercent', _panel),\r\n\r\n    _traceIcon = L.divIcon({\r\n        html: '<div class=\"iceDriftMrk\" style=\"width:8px;height:8px;border:solid 1px blue\"></div>',\r\n        iconAnchor: [4, 5] \r\n    }),        \r\n    _startIcon = L.icon({\r\n        iconUrl: _serverBase + 'api/img/flag_blau1.png',\r\n        iconAnchor: [6, 34]\r\n    }),\r\n    _trace = [];\r\n    \r\n    let _marker;\r\n    const _isSuccess = function(response){\r\n        return response.Status && response.Status.toLowerCase()=='ok';\r\n    },\r\n    _searchLayer = function(){\r\n        return new Promise((resolve, reject)=>{\r\n            sendCrossDomainJSONRequest(`${_serverBase}Layer/Search2.ashx?` +\r\n            `page=0&pageSize=1&orderby=title desc`+\r\n            `&query=([Title] containsIC 'icedrift${_gmap.properties.MapID}')`, response=>{\r\n                if (_isSuccess(response))\r\n                    resolve(response.Result);\r\n                else\r\n                    reject(response);\r\n            })\r\n        })\r\n    },\r\n    _createLayer = function(){        \r\n        return new Promise((resolve, reject)=>{\r\n            sendCrossDomainJSONRequest(_serverBase + 'VectorLayer/CreateVectorLayer.ashx?' + \r\n            'title=icedrift' + _gmap.options.mapName + ' ' + (new Date()).getTime() + '&columns=[' + \r\n            '{\"Name\":\"forecast_id\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"forecast_id\\\\\"\"},' + \r\n            '{\"Name\":\"start_date\",\"ColumnSimpleType\":\"Datetime\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"start_date\\\\\"\"},' + \r\n            '{\"Name\":\"end_date\",\"ColumnSimpleType\":\"Datetime\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"end_date\\\\\"\"},' + \r\n            '{\"Name\":\"wind_speed\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"wind_speed\\\\\"\"},' + \r\n            '{\"Name\":\"wind_angle\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"wind_angle\\\\\"\"},' + \r\n            '{\"Name\":\"percent\",\"ColumnSimpleType\":\"Float\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"percent\\\\\"\"},' + \r\n            '{\"Name\":\"distance\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"distance\\\\\"\"},' + \r\n            '{\"Name\":\"type\",\"ColumnSimpleType\":\"String\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"type\\\\\"\"},' + \r\n            '{\"Name\":\"comments\",\"ColumnSimpleType\":\"String\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"comments\\\\\"\"}' + \r\n            ']&geometrytype=point&TemporalLayer=true&TemporalColumnName=start_date', \r\n            r=>{\r\n                if (_isSuccess(r)){\r\n//console.log('created')\r\n                    resolve(r.Result.properties.name);\r\n                }\r\n                else\r\n                    reject(r);\r\n            });\r\n        })\r\n        .then(layerID=>{   \r\n            return new Promise((resolve, reject)=>{\r\n                sendCrossDomainJSONRequest(_serverBase + `Layer/UpdateSecurity.ashx?LayerID=${layerID}&SecurityInfo={\"DefAccess\":\"editrows\",\"Users\":[]}`,\r\n                    r => {\r\n                        if (_isSuccess(r)) {\r\n                            resolve(layerID);\r\n                        }\r\n                        else\r\n                            reject(r);\r\n                    });\r\n            });\r\n        });\r\n    },\r\n    // _addPercentColumn = function(lid, resolve, reject, vessels){        \r\n    //     console.log(\"add percent column\");\r\n    //             sendCrossDomainJSONRequest(_serverBase + 'VectorLayer/Update.ashx?VectorLayerID=' + lid +\r\n    //                 '&columns=[{\"Name\":\"mmsi\",\"OldName\":\"mmsi\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"mmsi\\\\\"\"},{\"Name\":\"imo\",\"OldName\":\"imo\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"imo\\\\\"\"},{\"Name\":\"gmx_id\",\"OldName\":\"gmx_id\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":true,\"IsIdentity\":true,\"IsComputed\":false,\"expression\":\"\\\\\"gmx_id\\\\\"\"},{\"Name\":\"group\",\"OldName\":\"group\",\"ColumnSimpleType\":\"String\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"group\\\\\"\"},{\"Name\":\"style\",\"ColumnSimpleType\":\"String\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"style\\\\\"\"}]',\r\n    //                 function (response) {\r\n    //                     if (response.Status.toLowerCase() == \"ok\")\r\n    //                         setTimeout(function run() {\r\n    //                             sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n    //                                 \"AsyncTask.ashx?TaskID=\" + response.Result.TaskID, function (response) {\r\n    //                                     if (response.Status.toLowerCase() == \"ok\")\r\n    //                                         if (!response.Result.Completed)\r\n    //                                             setTimeout(run, 1000);\r\n    //                                         else {\r\n    //                                             if(response.Result.ErorInfo)\r\n    //                                                 reject(response);\r\n    //                                             else\r\n    //                                                 resolve(vessels);\r\n    //                                         }\r\n    //                                     else \r\n    //                                         reject(response);\r\n    //                                 });\r\n    //                         }, 1000);\r\n    //                 });\r\n    // }, \r\n    _layerPromise = _searchLayer()\r\n    .then(searchResult=>{\r\n//console.log(searchResult)\r\n        if (searchResult.count==0)\r\n            return _createLayer();\r\n        else{\r\n//console.log('exists')\r\n            const existedLayerID = searchResult.layers[0].LayerID;\r\n            if (!_gmap.layersByID[existedLayerID]){\r\n                _lmap.once('layeradd', e=>{\r\n                    if (e.layer && e.layer.options.layerID==existedLayerID)   \r\n                        setTimeout(()=>{\r\n                            _lmap.removeLayer(_gmap.layersByID[existedLayerID]);\r\n                            window._mapHelper.updateUnloadEvent(false);\r\n                        }, 200); \r\n                });\r\n                window._layersTree.addLayerToTree(existedLayerID);\r\n                //window._mapHelper.updateUnloadEvent(false);\r\n            }\r\n            return existedLayerID;\r\n        }\r\n    });\r\n\r\n    const _showProgress = function(visible){\r\n        if (visible){\r\n            _messsagePan.innerHTML = '&nbsp;';\r\n            _progress.style.display = 'inline';\r\n        }\r\n        else\r\n            _progress.style.display = 'none';\r\n    },\r\n    _prepareAll = function(){\r\n        const controls = [_saveBut, _cancelBut, _countBut, _spinner, _speedPercent];\r\n        controls.forEach(c=>{\r\n            c.classList.remove('disabled'); \r\n            c.classList.add('disabled');\r\n        });\r\n        _showProgress(false);\r\n        _messsagePan.innerHTML = _gtxt(\"IceDriftPlugin.setStart\");\r\n        _find('input', _speedPercent).disabled = true;\r\n        _layerPromise\r\n        .then(layerID=>{\r\n            const layer = _gmap.layersByID[layerID];\r\n            if (layer && !layer._map){\r\n                _lmap.addLayer(layer);\r\n            }\r\n        });\r\n    },  \r\n    _saveTrace = function(layerID, trace){                \r\n        const objects = [];\r\n        trace.forEach((tp, i)=>objects.push({properties:{\r\n                start_date: tp.start_date && tp.start_date.getTime()/1000,\r\n                end_date: tp.end_date && tp.end_date.getTime()/1000,\r\n                wind_speed: tp.wind_speed,\r\n                wind_angle: tp.wind_angle,\r\n                percent: tp.percent,\r\n                distance: tp.distance,\r\n                type: i==0?'start point':'forecast point',\r\n                //comments:                   \r\n            }, \r\n            geometry:{type:'Point', coordinates :[tp.lng, tp.lat]}, action:'insert'}));\r\n//console.log(objects);\r\n        return new Promise((resolve, reject)=>{\r\n            sendCrossDomainPostRequest(`${_serverBase}VectorLayer/ModifyVectorObjects.ashx`, \r\n            {WrapStyle: 'message', LayerName: layerID, objects: JSON.stringify(objects), geometry_cs: 'EPSG:4326'}, r=>{\r\n//console.log('response', r);  \r\n                if (_isSuccess(r))\r\n                    resolve(r.Result);\r\n                else\r\n                    reject(r);\r\n            });\r\n        })\r\n        .then(r=>{\r\n//console.log(r);  \r\n            objects.length = 0;\r\n            r.forEach(id=>{\r\n                objects.push({id:id, properties:{'forecast_id': r[0]}, action:'update'})\r\n            })\r\n            return new Promise((resolve, reject)=>{         \r\n                sendCrossDomainPostRequest(`${_serverBase}VectorLayer/ModifyVectorObjects.ashx`,\r\n                {WrapStyle: 'message', LayerName: layerID, objects: JSON.stringify(objects)}, r=>{\r\n                    if (_isSuccess(r))\r\n                        resolve(r.Result);\r\n                    else\r\n                        reject(r);\r\n                });\r\n            });\r\n        });\r\n    },\r\n    _onCancel = function(){\r\n        if (_cancelBut.classList.contains('disabled'))\r\n            return;\r\n        _cleanTrace();\r\n        _setReady();\r\n    },\r\n    _onSave = function(){\r\n        if (_saveBut.classList.contains('disabled'))\r\n            return;\r\n\r\n        // 1.6 Save trace and Set ready again\r\n        _showProgress(true);\r\n        _layerPromise\r\n        .then(layerID=>{\r\n            const layer = _gmap.layersByID[layerID];\r\n            if (layer){\r\n                if (!layer._map)\r\n                    _lmap.addLayer(layer);\r\n                return layerID;\r\n            }\r\n            else{\r\n                return _searchLayer()\r\n                .then(searchResult=>{\r\n                    //     const layerID = result.layers[0].LayerID;\r\n                    //     if (!_gmap.layersByID[layerID]){\r\n                    //         return new Promise((resolve, reject)=>{\r\n                    //             sendCrossDomainJSONRequest(`${_serverBase}layer/GetLayerJson.ashx?NeedAttrValues=false&LayerName=${layerID}`, r=>{\r\n                    //                 if (_isSuccess(r)){\r\n                    //                     Utils.addLayer(r.Result);\r\n                    //                     resolve(layerID);\r\n                    //                 }\r\n                    //                 else\r\n                    //                     reject(r);\r\n                    //             })\r\n                    //         });\r\n                    //     }\r\n                    //     else\r\n                    //         return layerID;\r\n                    window._layersTree.addLayerToTree(searchResult.layers[0].LayerID);\r\n                    window._mapHelper.updateUnloadEvent(false);\r\n                    return searchResult.layers[0].LayerID;\r\n                });\r\n            }         \r\n        })\r\n        .then(layerID=>{\r\n//console.log(layerID)                \r\n            return _saveTrace(layerID, _trace).then(()=>layerID);\r\n        })\r\n        .then(layerID=>{\r\n            _cleanTrace();\r\n            _setReady();\r\n            L.gmx.layersVersion.chkVersion(_gmap.layersByID[layerID]);\r\n            _showProgress(false);\r\n            \r\n            window._mapHelper.updateUnloadEvent(false);\r\n        })\r\n        .catch(console.log);\r\n    },\r\n    _spin = function(dir){\r\n        if (_spinner.classList.contains('disabled'))\r\n            return;\r\n\r\n        let cur = parseInt(_period.innerHTML, 10);\r\n        if (dir == 'up' && cur < 48)\r\n            cur += 6;\r\n        if (dir == 'down' && 0 < cur)\r\n            cur -= 6;\r\n        _period.innerHTML = `${(\"0\" + cur).slice(-2)} ${_gtxt(\"IceDriftPlugin.abbrHour\")}`;\r\n\r\n        // 1.5 Enable Count Button\r\n        if (cur==0)        \r\n            _countBut.classList.add('disabled');\r\n        else\r\n            _countBut.classList.remove('disabled');\r\n    },\r\n    _countRun = function(){\r\n        if (_countBut.classList.contains('disabled'))\r\n            return;\r\n\r\n        let speedPercent = _find('input', _speedPercent);\r\n        speedPercent = parseFloat((speedPercent.value!=''?speedPercent.value:speedPercent.placeholder).replace(/,/, '.'));\r\n        if (isNaN(speedPercent) || 100<speedPercent || speedPercent<=0){\r\n            _messsagePan.innerHTML = _gtxt('IceDriftPlugin.inavalidValue');\r\n            return;\r\n        }\r\n\r\n        const period = parseInt(_period.innerHTML, 10),\r\n        latlng = _marker._latlng,\r\n        nearest = function(test){\r\n            const a = [0, 0.25, 0.5, 0.75, 1];\r\n            const intnum = Math.floor(test),\r\n            mantissa = test-intnum;\r\n            let i = (a.length-1)/2;\r\n            if (mantissa==a[i]) return a[i];\r\n            if (mantissa<a[i])\r\n                i/=2;\r\n            else\r\n                i+=i/2;\r\n            if (mantissa == a[i]) return a[i];\r\n            if (mantissa<a[i])\r\n                return intnum+(mantissa-a[i-1]<=a[i]-mantissa || a[i-1]==mantissa ? a[i-1] : a[i]);\r\n            else \r\n                return intnum+(a[i+1]-mantissa<=mantissa-a[i] || a[i+1]==mantissa ? a[i+1] : a[i]);\r\n        },\r\n        drawMarker = function(tracePoint){\r\n            const mrk = L.marker([tracePoint.lat, tracePoint.lng], {icon: _traceIcon}).addTo(_lmap);\r\n            mrk._icon.style.background = 'none';\r\n            mrk._icon.style.border = 'none';\r\n            tracePoint.marker = mrk;\r\n        },\r\n        forecastPoint = function(startPoint, distance, azimuth){ \r\n            // lat2 = asin(sin(lat1)*cos(d/R) + cos(lat1)*sin(d/R)*cos(θ))\r\n            // lon2 = lon1 + atan2(sin(θ)*sin(d/R)*cos(lat1), cos(d/R)−sin(lat1)*sin(lat2))\r\n            // asin          = arcsin()   \r\n            // d             = distance (in any unit)   \r\n            // R             = Radius of the earth (in the same unit as above)  \r\n            // and hence d/r = is the angular distance (in radians)  \r\n            // atan2(a,b)    = arctan(b/a)  \r\n            // θ is the bearing (in radians, clockwise from north);  \r\n\r\n            //latitude of second point = la2 =  asin(sin la1 * cos Ad  + cos la1 * sin Ad * cos θ), and\r\n            //longitude  of second point = lo2 = lo1 + atan2(sin θ * sin Ad * cos la1 , cos Ad – sin la1 * sin la2)\r\n\r\n            const lat2 = Math.asin(Math.sin(Math.PI*startPoint.lat/180) * Math.cos(distance/6371000)  + Math.cos (Math.PI*startPoint.lat/180) * Math.sin(distance/6371000) * Math.cos(Math.PI*azimuth/180)),\r\n            atan2 = Math.atan2(Math.sin(Math.PI*azimuth/180) * Math.sin(distance/6371000) * Math.cos(Math.PI*startPoint.lat/180), \r\n                               Math.cos(distance/6371000) - Math.sin(Math.PI*startPoint.lat/180) * Math.sin(lat2))\r\n            return {\r\n                lat:  lat2/Math.PI*180, \r\n                lng: startPoint.lng + atan2/Math.PI*180,\r\n                toString: function(){return `LatLng(${this.lat}, ${this.lng})`}\r\n            }\r\n        },\r\n        getForecast = function ({point, moment, distance}) {\r\n            const tracePoint = {start_date: moment, lat: point.lat, lng: point.lng};\r\n            if (distance)\r\n                tracePoint.distance = distance;\r\n            return new Promise((resolve, reject) => {\r\n                let  momentBase = new Date(Date.UTC(moment.getFullYear(), moment.getMonth(), moment.getDate(), 0, 0, 0));\r\n                while (moment.getTime()>=(momentBase.getTime() + 21600000)){\r\n                    momentBase = new Date(momentBase.getTime() + 21600000);\r\n                }\r\n                const qs = `${('0'+momentBase.getUTCDate()).slice(-2)}.${('0'+(momentBase.getUTCMonth()+1)).slice(-2)}.${momentBase.getUTCFullYear()} ${('0'+momentBase.getUTCHours()).slice(-2)}:00:00`;\r\n//console.log(qs);\r\n                sendCrossDomainJSONRequest(_serverBase + `VectorLayer/Search.ashx?` +\r\n                    `columns=[{\"Value\":\"[Lat]\"},{\"Value\":\"[Lon]\"},{\"Value\":\"[Speed]\"},{\"Value\":\"[Angle]\"},{\"Value\":\"[DateTime]\"},{\"Value\":\"[BeaufortScale]\"}]&` +\r\n                    `layer=7CB878E2BE274837B291E592B2530C39&query=\"Lat\"=${nearest(point.lat)} and \"Lon\"=${nearest(point.lng)} and \"DateTime\"='${qs}'`\r\n                    , response => {\r\n                        if (response.Status && response.Status.toLowerCase() == 'ok') {\r\n                            if (response.Result.values.length==0){\r\n                                reject();\r\n                                _showProgress(false);\r\n                                _messsagePan.innerHTML = _gtxt(\"IceDriftPlugin.noWindData\");\r\n                                setTimeout(()=>{\r\n                                    _setReady();\r\n                                }, 1500);\r\n                                return;\r\n                            }\r\n                            const fields = {};\r\n                            response.Result.fields.forEach((f,i)=>{fields[f]=i});\r\n                            const nextMoment = new Date(momentBase.getTime() + 21600000),\r\n                            interval = (nextMoment.getTime()-moment.getTime())/1000;\r\n                            \r\n                            tracePoint.wind_speed = response.Result.values[0][fields.Speed];\r\n                            tracePoint.wind_angle = response.Result.values[0][fields.Angle];\r\n                            tracePoint.percent = speedPercent;\r\n                            tracePoint.end_date = nextMoment;\r\n                            _trace.push(tracePoint);\r\n\r\n//console.log(`${point} speed=${tracePoint.wind_speed} azimuth=${tracePoint.wind_angle} interval=${interval} d=${0.02*tracePoint.wind_speed*interval}`); \r\n                            const distance = (speedPercent/100) * tracePoint.wind_speed * interval, \r\n                            pointNext = forecastPoint(point, distance, tracePoint.wind_angle + 180);\r\n                            resolve({point: pointNext, moment: nextMoment, distance: distance});\r\n                        }\r\n                        else\r\n                            reject(response);\r\n                    }\r\n                );\r\n            });\r\n        },\r\n        tasksChain = [];\r\n\r\n        for (let i=period-6; i>0; i-=6){\r\n            tasksChain.push(getForecast);\r\n        }\r\n        tasksChain.reduce((p, f) => p.then(f), getForecast({point: latlng, moment: _marker.acqdatetime}))\r\n        .then(({point, moment, distance})=>{\r\n            _trace.push({start_date: moment, lat: point.lat, lng: point.lng, distance: distance});\r\n            _trace.forEach(drawMarker);\r\n\r\n            _showProgress(false);\r\n            _messsagePan.innerHTML = '&nbsp;';\r\n            _saveBut.classList.remove('disabled');\r\n            _cancelBut.classList.remove('disabled');\r\n        })\r\n        .catch(console.log);      \r\n        \r\n        _cleanStartMarker();        \r\n        _period.innerHTML = `00 ${_gtxt(\"IceDriftPlugin.abbrHour\")}`;\r\n        _spinner.classList.add('disabled');\r\n        _speedPercent.classList.add('disabled');\r\n        _find('input', _speedPercent).disabled = true;\r\n        _countBut.classList.add('disabled');\r\n        _showProgress(true);\r\n    };\r\n\r\n    _saveBut.addEventListener('click', _onSave);\r\n    _cancelBut.addEventListener('click', _onCancel);\r\n    _upBut.addEventListener('click', ()=>_spin('up'));\r\n    _downBut.addEventListener('click', ()=>_spin('down'));\r\n    _countBut.addEventListener('click', _countRun);    \r\n    _lmap.on('layerremove', e=>{\r\n        for (let i=0; i<_sentinelLayers.length; ++i){\r\n            if (_sentinelLayers[i].options.layerID==e.layer.options.layerID){\r\n                pluginButton.setActive(false);\r\n                _returnInstance.hide();\r\n                return;\r\n            }\r\n        }\r\n    })\r\n\r\n    let _msgBox;\r\n    const _sentinelLayers = [],\r\n    _onSentinelLayerClick = function(e){\r\n\r\n        // 1.4 Set Start Point and enable Spinner\r\n        _marker = L.marker(e.latlng, { icon: _startIcon });\r\n        _marker.acqdatetime = new Date(e.gmx.properties.acqdatetime*1000);\r\n        _marker.addTo(_lmap);\r\n\r\n        _spinner.classList.remove('disabled');\r\n        _messsagePan.innerHTML = _gtxt('IceDriftPlugin.setPeriod');\r\n        \r\n        _speedPercent.classList.remove('disabled');\r\n        _find('input', _speedPercent).disabled = false;\r\n    },\r\n    _init = function(ctrl){\r\n        _sentinelLayers.length = 0;\r\n        const l = _gmap.layersByID['AF64ECA6B32F437CB6AC72B5E6F85B97'];\r\n        if (l._map)\r\n            _sentinelLayers.push(l);                \r\n        if (!_sentinelLayers.length){\r\n            ctrl.setActive(false);\r\n            let content = document.createElement(\"div\");\r\n            content.innerHTML = '<div style=\"padding-left:20px\">' + _gtxt('IceDriftPlugin.showSentinel') + '</div>';\r\n            if (!_msgBox)\r\n                _msgBox = showDialog(_gtxt('IceDriftPlugin.iconTitle'), content, 200, 80, 0,0, null, ()=>{_msgBox=null});\r\n            return false;\r\n        }\r\n        else{\r\n            return true;\r\n        }\r\n    },\r\n//  _mouseoverHandlers = {}, _mousemoveHandlers = {}, _clickHandlers = {},\r\n    _setCrossCursor =  function(){                       \r\n//             _gmap.layers.forEach(l=>{\r\n//                             if (l._events && l._events.mouseover && l._events.mouseover.length){\r\n//                                 _mouseoverHandlers[l._gmx.layerID] = l._events.mouseover.map(h=>h);\r\n//                                 l._events.mouseover.length = 0;\r\n//                             }\r\n//                             if (l._events && l._events.mousemove && l._events.mousemove.length){\r\n//                                 _mousemoveHandlers[l._gmx.layerID] = l._events.mousemove.map(h=>h);\r\n//                                 l._events.mousemove.length = 0;\r\n//                             }\r\n//                             if (l._events && l._events.click && l._events.click.length){\r\n//                                 _clickHandlers[l._gmx.layerID] = l._events.click.map(h=>h);\r\n//                                 l._events.click.length = 0;\r\n//                             }\r\n//             });\r\n// console.log('_setCrossCursor')\r\n//             _lmap.getContainer().style.cursor = 'crosshair';\r\n        _sentinelLayers.forEach(l=>l.disablePopup());\r\n    },\r\n    _unsetCrossCursor =  function(){ \r\n        // _gmap.layers.forEach(l=>{\r\n        //     if (l._gmx && _mouseoverHandlers[l._gmx.layerID]){\r\n        //         l._events.mouseover = _mouseoverHandlers[l._gmx.layerID].map(h=>h);\r\n        //         l._events.mousemove = _mousemoveHandlers[l._gmx.layerID].map(h=>h);\r\n        //         l._events.click = _clickHandlers[l._gmx.layerID].map(h=>h);\r\n        //     }\r\n        // });                      \r\n        // _lmap.getContainer().style.cursor = '';         \r\n        _sentinelLayers.forEach(l=>l.enablePopup());\r\n    },\r\n    _setReady = function(){\r\n        _prepareAll();                \r\n        \r\n        // 1.3 Bind Insert Start Point observer   \r\n        _setCrossCursor();         \r\n        _sentinelLayers.forEach(l=>{\r\n            l.once('click', _onSentinelLayerClick);\r\n            //l.unbindPopup();\r\n        });\r\n    },\r\n    _cleanTrace = function(){\r\n        _trace.forEach(tp=>_lmap.removeLayer(tp.marker));\r\n        _trace.length = 0;\r\n    },\r\n    _cleanStartMarker = function(){\r\n        if (_marker) {\r\n            _lmap.removeLayer(_marker);\r\n            _marker = null;\r\n        }        \r\n    };\r\n\r\n    const _returnInstance = {\r\n        show: function (ctrl) {\r\n            // 1.1 Check Sentinel Layers\r\n            if (_init(ctrl)){  \r\n\r\n                // 1.2 Show Form\r\n                const rc = ctrl._container.getBoundingClientRect(),\r\n                    shift = parseInt(getComputedStyle(_find('table', _panel)).borderSpacing);\r\n                _panel.style.top = rc.bottom + 'px';\r\n                _panel.style.left = rc.left - shift + 'px';\r\n                \r\n                _setReady();\r\n            }\r\n\r\n        },\r\n        hide: function(){ \r\n            // 2.1 HideForm\r\n            _panel.style.top = '-1000px';\r\n            _panel.style.left = '-1000px';\r\n\r\n            // 2.2 Cleean Map\r\n            _cleanTrace();\r\n            _cleanStartMarker();        \r\n            _layerPromise\r\n            .then(layerID=>{\r\n                const layer = _gmap.layersByID[layerID]\r\n                if (layer && layer._map)\r\n                    _lmap.removeLayer(layer);\r\n            });\r\n\r\n            // 2.3 Unbind Layers observers\r\n            _sentinelLayers.forEach(l => {\r\n                //l.bindPopup();\r\n                l.off('click', _onSentinelLayerClick);\r\n            });\r\n            _unsetCrossCursor();\r\n        }\r\n    };\r\n    return _returnInstance;\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/PluginPanel.js","\r\nmodule.exports =  {\r\n\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/Utils.js"],"sourceRoot":""}