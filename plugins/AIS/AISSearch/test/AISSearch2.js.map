{"version":3,"sources":["webpack:///webpack/bootstrap bfcf3b89b4639ce2f98d","webpack:///./src/entry.js","webpack:///./src/all.css","webpack:///./src/Views/AisView.css","webpack:///./src/locale.js","webpack:///./src/aisPluginPanel.js","webpack:///./src/ViewsFactory.js","webpack:///./src/Views/ScreenSearchView.js","webpack:///./src/Views/BaseView.js","webpack:///./src/Models/ScreenSearchModel.js","webpack:///./src/Views/MyFleetView.js","webpack:///./src/Models/MyFleetModel.js","webpack:///./src/Polyfill.js","webpack:///./src/Views/DbSearchView.js","webpack:///./src/Views/DbSearch.css","webpack:///./src/Models/DbSearchModel.js","webpack:///./src/Views/InfoDialogView.js","webpack:///./src/Views/infodialog.js","webpack:///./src/Views/infodialog.css","webpack:///./src/Views/VesselInfoScreen.js","webpack:///./src/Views/VesselInfoScreen.css","webpack:///./src/Search/Searcher.js","webpack:///./src/Toolbox.js"],"names":["NOSIDEBAR","PRODUCTION","SIDEBAR2","require","Handlebars","registerHelper","context","mmsi","imo","JSON","stringify","pluginName","menuId","toolbarIconId","cssTable","modulePath","gmxCore","getModulePath","highlight","L","marker","icon","className","iconAnchor","iconSize","iconUrl","zIndexOffset","AisPluginPanel","ViewsFactory","publicInterface","afterViewer","params","map","options","aisLayerID","screenSearchLayer","searchLayer","aisLastPoint","historyLayer","tracksLayerID","key","toLowerCase","myFleetLayers","split","id","replace","viewFactory","layersByID","nsGmx","gmxMap","setLayerClickHandler","layer","removeEventListener","addEventListener","e","gmx","properties","hasOwnProperty","infoDialogView","show","forLayers","layersId","i","length","aisPluginPanel","lmap","leafletMap","iconOpt_mf","togglable","title","_gtxt","text","icon_mf","control","gmxIcon","on","ev","target","isActive","$","width","css","hide","addControl","sidebar","window","iconSidebarWidget","sidebarControl","sidebarPane","setPane","position","showOnTop","createTab","createTabFunction","active","inactive","hint","_activeTabId","removeClass","_renderTabs","activeTabId","setTimeout","open","location","search","a","substr","x","filter","c","indexOf","y","vessel","setLatLng","addTo","fitBounds","maxZoom","animate","addModule","_translationsHash","addtext","module","exports","_leftMenuBlock","_canvas","_div","_activeView","_views","create","_isReady","_createTabs","tabsTemplate","workCanvas","append","compile","v","frame","tabs","_this","forEach","tab","eq","resize","is","each","addClass","click","_returnInstance","parentWorkCanvas","removeLayer","attr","insertAfter","blockItem","leftPanelItem","blockTitle","panelCanvas","toggleTitle","isCollapsed","leftMenu","createWorkCanvas","gmxControlIconManager","get","_iconClick","path","call","ScreenSearchView","ScreenSearchModel","MyFleetView","MyFleetModel","DbSearchView","DbSearchModel","InfoDialogView","Searcher","Toolbox","_tools","_searcher","_mfm","_ssm","aisLayerSearcher","myFleetModel","_dbsm","_dbsv","model","tools","_ssv","_mfv","_idv","aisView","myFleetMembersView","BaseView","apply","arguments","topOffset","gifLoader","container","find","tableTemplate","cleanFilter","filterReady","filterInput","delay","doFilter","setFilter","repaint","filterString","val","clearTimeout","bind","keyup","input","keyCode","needUpdate","isDirty","update","widgets","commonCalendar","getDateInterval","prototype","Object","_clean","inProgress","state","progress","_firstRowsPos","_firstRowsNum","_firstRowsShift","_setEventHandlers","thisInst","off","parse","xmin","xmax","longitude","ymin","ymax","latitude","ts_pos_utc","ts_pos_org","dt_pos_utc","closest","html","stopPropagation","lastPosition","showPosition","data","vessels","start","Date","scrollCont","empty","tempFirst","slice","content","msg","mcsTopPctPrev","rowH","mCustomScrollbar","callbacks","onBeforeUpdate","console","log","onUpdate","whileScrolling","mcs","topPct","end","height","scrollInertia","timeout","focus","_calcHeight","template","h","getBoundingClientRect","H","view","clean","startScreen","top","_actualUpdate","load","actualUpdate","Promise","resolve","all","reject","searchScreen","dateInterval","border","group","json","Status","dataSrc","Result","values","d","vessel_name","mf_member","formatDate","Math","floor","getTime","maxid","vessel_type","sog","cog","heading","icon_rot","round","placeVesselTypeIcon","RegExp","then","markMembers","ErrorInfo","some","r","txt","elm","checked","_hideOnMap","displayingMyFleet","currentTarget","myfleet","hideAllOnMap","count","filtered","selectAll","selectOne","push","hideOnMap","_filteredState","_displayngState","prepare","dlg","changeFilter","Polyfill","_myFleetLayers","_vessels","_mapID","String","_queryMapLayers","buildedTree","gmxProperties","MapID","fetchMyFleet","lid","sendCrossDomainJSONRequest","baseUrl","response","f","fields","j","nickname","Nickname","layers","LayerID","name","_data","value","findIndex","errors","promises","searchNames","reduce","p","lat","lon","vt","member","formatDateTime","sort","b","membCounter","vv","splice","remove","gmx_id","predicate","list","thisArg","undefined","_searchString","_setSearchInputValue","s","searchBut","removeBut","searchInput","_highlight","calendar","mapDateInterval","DateInterval","set","historyInterval","dateBegin","dateEnd","CalendarWidget","dateMin","dateMax","dateFormat","minimized","showSwitcher","td","after","db","getUTCDayBoundary","setDateInterval","classList","toString","reset","suggestions","trg","suggestionsCount","suggestionsFrame","first","current","last","found","searchDone","doSearch","searcher","searchString","suggestion","cr","offset","left","bottom","outerWidth","innerHeight","keydown","prev","next","prepareSearchInput","temp","originalEvent","clipboardData","getData","visibility","_vi_template","_prepare_history","displaingTrack","positions","el","dates","modelDate","setUTCHours","trackDate","open_pos","ind","vi_cont","siblings","parent","infoDialog","parseInt","positionMap","getDates","showTrack","calendarInterval","interval","defineProperty","positionDate","checkInterval","zoom","getZoom","_round","isNeg","power","pow","_addUnit","u","_toDd","D","lng","dir","deg","toFixed","_formatPosition","cog_sog","heading_rot","rot","x_y","eta","ts_eta","tm_pos_utc","_formatTime","tm_pos_loc","_formatDate","dt_pos_loc","eta_utc","eta_loc","draught","source","local","setMinutes","getMinutes","getTimezoneOffset","toLocaleTimeString","toLocaleDateString","searchPositionsAgg","parseResponse","groups","obj","dt","t","counter","k","ErrorMessage","displayInfoDialog","VesselInfoScreen","infoDialogCascade","allIinfoDialogs","vesselInfoScreen","aisServices","_showPosition","_updateView","displayed","getmore","dialog","isNew","dialogOffset","closeFunc","event","openVesselInfoScreen","pos","ui","addUnit","formatVessel","ts_pos_loc","isNaN","toDd","ddToDms","dms","min","sec","commands","myFleetMembersModel","add","canvas","menu","appendTo","photo","underphoto","buttons","dialogW","dialogH","posX","posY","showDialog","vessel2","moreInfo","smallShipIcon","vesselPropTempl","registry_name","swap","mi","resizable","extend","titlebar","scheme","document","href","serverBase","replaceWith","error","menubuttons","openpage","showpos","addremoveIcon","addremove","filterUpdating","info","onDone","_ais","_galery","_register","_regcap","_leftPanel","_minh","_lloyds","menuAction","preview","showPicture","errmsg","change","submit","$img","jQuery","imgURL","attributes","prop","$svg","removeAttr","querySelector","style","offsetHeight","parentElement","mia","querySelectorAll","panel","display","theme","div","w","innerWidth","documentElement","clientWidth","body","clientHeight","offsetWidth","drawGallery","gallery","galcontent","drawAis","ledokol","aiscontent","innerHTML","flag_country","callsign","nav_status","destination","drawRegister","regcontent","drawTable","article","pn","desc","description","pv","drawRMR","innerText","version","drawLloyds","regSwitches","item","cl","contains","onFail","wait","ship","registerServerUrl","lloydsServerUrl","rmr","fetch","RS","catch","_baseUrl","_aisServices","_serverScript","_aisLastPoint","_screenSearchLayer","_aisLayerID","_historyLayer","getBorder","dFeatures","gmxDrawing","getFeatures","toGeoJSON","latLngBounds","getBounds","sw","getSouthWest","ne","getNorthEast","max","minX","maxX","geo","type","coordinates","center","formatTime","toLocaleString","formatDate2","dd","m","mm","getDate","getMonth","getFullYear","getHours","getUTCHours","getUTCMinutes","getUTCDate","getUTCMonth","getUTCFullYear","ldd","lm","ly","lh","lmm","callback","request","WrapStyle","orderdirection","orderby","columns","query","join","toISOString","gmxUtil","sendCrossDomainPostRequest","searchPositions","searchById","aid","isfuzzy","toUpperCase","arr","pagesize","avessels","queryParams","minx","miny","maxx","maxy","toJSON","_layersByID","_aisLayer","_tracksLayer","_displaingTrack","_displayingMyFleet","_filtered","_filterFunc","args","mmsiArr","len","_setTrackFilter","_map","addLayer","removeFilter","_setMyFleetFilter"],"mappings":"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","file":"AISSearch2Test.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap bfcf3b89b4639ce2f98d","let NOSIDEBAR = false,\r\n    PRODUCTION = false,\r\n    SIDEBAR2 = false;\r\nif (has('NOSIDEBAR'))\r\n    NOSIDEBAR = true;\r\nif (has('SIDEBAR2'))\r\n    SIDEBAR2 = true;\r\nif (has('PRODUCTION'))\r\n    PRODUCTION = true;\r\n\r\nrequire(\"./all.css\")\r\nrequire(\"./Views/AisView.css\")\r\nrequire(\"./locale.js\")\r\n\r\nHandlebars.registerHelper('aisinfoid', function (context) {\r\n    return context.mmsi + \" \" + context.imo;\r\n});\r\n\r\nHandlebars.registerHelper('aisjson', function (context) {\r\n    return JSON.stringify(context);\r\n});\r\n\r\nconst pluginName = PRODUCTION ? 'AISPlugin' : 'AISSearch2Test',\r\n    menuId = 'AISSearch',\r\n    toolbarIconId = null, \r\n    cssTable = PRODUCTION ? 'AISPlugin' : 'AISSearch2',\r\n    modulePath = gmxCore.getModulePath(pluginName);\r\n\r\nconst highlight = L.marker([0, 0], {icon:L.icon({\r\n    className:\"ais_highlight-icon\", \r\n    iconAnchor:[12, 12], \r\n    iconSize:[25,25], \r\n    iconUrl:'plugins/ais/aissearch/highlight.png'}), zIndexOffset:1000});\r\n\r\nconst AisPluginPanel = require('./aisPluginPanel.js'),\r\n      ViewsFactory = require('./ViewsFactory');\r\nconst publicInterface = {\r\n    pluginName: pluginName,\r\n    afterViewer: function (params, map) {\r\n        const options = {\r\n            aisLayerID: params.aisLayerID,// || '8EE2C7996800458AAF70BABB43321FA4',\t// searchById\t\t\t\r\n            screenSearchLayer: params.searchLayer,// || '8EE2C7996800458AAF70BABB43321FA4', // screen search\t\t\t\t\r\n            aisLastPoint: params.aisLastPoint || '303F8834DEE2449DAF1DA9CD64B748FE', // db search\r\n            historyLayer: params.historyLayer,\t\r\n            tracksLayerID: params.tracksLayerID || '13E2051DFEE04EEF997DC5733BD69A15',\r\n\r\n            modulePath: modulePath,\r\n            highlight: highlight\r\n        };\r\n        for (var key in params) \r\n            if (key.toLowerCase() == \"myfleet\") {\r\n                options.myFleetLayers = params[key].split(\",\").map(function (id) {\r\n                    return id.replace(/\\s/, \"\");\r\n                });\r\n                break;\r\n            }\r\n        const viewFactory = new ViewsFactory(options);\r\n        const   layersByID = nsGmx.gmxMap.layersByID,\r\n                setLayerClickHandler = function (layer) {\r\n                layer.removeEventListener('click')\r\n                layer.addEventListener('click', function (e) {\r\n                    //console.log(e)\r\n                    if (e.gmx && e.gmx.properties.hasOwnProperty(\"imo\"))\r\n                        viewFactory.infoDialogView.show(e.gmx.properties)\r\n                })\r\n                },\r\n                forLayers = function (layer) {\r\n                    if (layer) {\r\n                        //setLocaleDate(layer)\r\n                        setLayerClickHandler(layer)\r\n                    }\r\n                }\r\n\r\n        for (var key in params) {\r\n            let layersId = params[key].split(\",\").map(function (id) {\r\n                return id.replace(/\\s/, \"\");\r\n            });\r\n            for (var i = 0; i < layersId.length; ++i) {\r\n//console.log(layersId[i])\r\n                forLayers(layersByID[layersId[i]]);\r\n            }\r\n        }\r\n        \r\n        const aisPluginPanel = new AisPluginPanel(viewFactory);\r\n        aisPluginPanel.menuId = menuId;\r\n\r\n        if (NOSIDEBAR) {            \r\n            let lmap = nsGmx.leafletMap,    \r\n                iconOpt_mf = {\r\n                id: menuId, //toolbarIconId,\r\n                className: \"VesselSearchTool\",\r\n                togglable: true,\r\n                title: _gtxt('AISSearch2.caption')\r\n            };\r\n            if (toolbarIconId)\r\n                iconOpt_mf.id = toolbarIconId;\r\n            else\r\n                iconOpt_mf.text = _gtxt('AISSearch2.capShort');            \r\n            let icon_mf = L.control.gmxIcon(iconOpt_mf).on('statechange', function (ev) {\r\n                if (ev.target.options.isActive) {\r\n                    aisPluginPanel.show();\r\n                    $('.ais_view .instruments').width('100%');\r\n                    $('.ais_tab div').css('font-size', '12px');\r\n                }\r\n                else {\r\n                    aisPluginPanel.hide();\r\n                }\r\n            });\r\n            lmap.addControl(icon_mf);\r\n        }\r\n        else {\r\n            let sidebar = SIDEBAR2 ? window.iconSidebarWidget : window.sidebarControl;\r\n            aisPluginPanel.sidebarPane =  sidebar.setPane(\r\n                    menuId, { \r\n                        position: params.showOnTop ? -100 : 0,\r\n                        createTab: window.createTabFunction({\r\n                            icon: menuId,\r\n                            active: \"ais_sidebar-icon-active\",\r\n                            inactive: \"ais_sidebar-icon\",\r\n                            hint: _gtxt('AISSearch2.caption')\r\n                        })\r\n                    }\r\n                )\r\n            sidebar.addEventListener('opened', function (e) {\r\n                if (sidebar._activeTabId==menuId)                \r\n                    aisPluginPanel.show();\r\n            });\r\n            if (params.showOnTop) { // hack\r\n                $('div[data-pane-id]').removeClass('iconSidebarControl-pane-active')\r\n                sidebar._renderTabs({ activeTabId: menuId });\r\n                setTimeout(() => sidebar.open(menuId), 50);\r\n            }\r\n        }\r\n\r\n        if (location.search.search(/x=[^y=]+y=/i) != -1) {\r\n            var a = location.search.toLowerCase().substr(1).split('&'),\r\n                x = a.filter(function (c) { return !c.indexOf(\"x=\") })[0].substr(2),\r\n                y = a.filter(function (c) { return !c.indexOf(\"y=\") })[0].substr(2)\r\n            highlight.vessel = null;\r\n            highlight.setLatLng([y, x]).addTo(nsGmx.leafletMap);    \r\n            nsGmx.leafletMap.fitBounds([\r\n                [y, x],\r\n                [y, x]\r\n            ], {\r\n                    maxZoom: 9,//config.user.searchZoom,\r\n                    animate: false\r\n            }) \r\n        }\r\n    }\r\n};\r\n\r\ngmxCore.addModule(pluginName, publicInterface, {\r\n    css: cssTable + '.css'\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/entry.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/all.css\n// module id = 1\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/AisView.css\n// module id = 3\n// module chunks = 0","\r\n    _translationsHash.addtext('rus', {\r\n        'AISSearch2.title': 'Поиск судов',\r\n        'AISSearch2.title1': 'Найдено судов',\r\n        'AISSearch2.title2': '<b>Данных не найдено!</b>',\r\n        'AISSearch2.error': '<b>Ошибка при получении данных!</b>',\r\n        'AISSearch2.iconTitle': 'Поиск судов по экрану',\r\n        'AISSearch2.placeholder_0': 'Поиск по адресам, координатам',\r\n        'AISSearch2.placeholder_1': 'Поиск судна по названию / MMSI',\r\n        // 'AISSearch2.placeholder_1': 'Поиск судна по названию / MMSI. Поиск по адресам, координатам, кадастровым номерам'\r\n        'AISSearch2.myFleetDialog': 'Мой флот',\r\n        'AISSearch2.vesselName': 'название',\r\n        'AISSearch2.vesselAdd': 'добавить',\r\n        'AISSearch2.vesselRemove': 'удалить',\r\n        'AISSearch2.vesselExclude': 'исключить',\r\n        'AISSearch2.myFleetMembers': 'Состав',\r\n        'AISSearch2.myFleetMember': 'мой флот',\r\n        'AISSearch2.info': 'информация',\r\n        'AISSearch2.found':'Найдено: ',\r\n        'AISSearch2.filter':'Введите название или mmsi или imo судна',\r\n        'AISSearch2.filterName':'Введите название судна',\r\n        'AISSearch2.screen':'По экрану',\r\n        'AISSearch2.database':'По базе данных',\r\n        'AISSearch2.capShort': 'Поиск судов',\r\n        'AISSearch2.caption': 'Поиск судов и \"Мой флот\"',\r\n        'AISSearch2.refresh': 'обновить',\r\n        'AISSearch2.refreshing': 'обновляется',\r\n        'AISSearch2.nomyfleet': 'Сервис не доступен',\r\n        'AISSearch2.auth': 'Требуется авторизация',\r\n        'AISSearch2.vessel_name': 'Название',\r\n        'AISSearch2.mmsi': 'MMSI',\r\n        'AISSearch2.imo': 'IMO',\r\n        'AISSearch2.flag_country': 'Страна',\r\n        'AISSearch2.vessel_type': 'Тип судна',\r\n        'AISSearch2.draught': 'Осадка',\r\n        'AISSearch2.destination': 'Назначение',\r\n        'AISSearch2.nav_status': 'Статус',\r\n        'AISSearch2.last_sig': 'Последний сигнал',\r\n        'AISSearch2.show_track': 'трек за сутки',\r\n        'AISSearch2.hide_track': 'скрыть трек',\r\n\t\t'AISSearch2.source': 'Источник данных',\r\n\t\t'AISSearch2.sais': 'спутниковый AIS',\r\n\t\t'AISSearch2.tais': 'береговой AIS',\r\n\t\t'AISSearch2.lon': 'Долгота',\r\n\t\t'AISSearch2.lat': 'Широта',\r\n\t\t'AISSearch2.historyTab': 'История',\r\n        'AISSearch2.voyageInfo': 'Параметры движения',\r\n        'AISSearch2.DbSearchTab':'БАЗА ДАННЫХ',\r\n        'AISSearch2.ScreenSearchTab':'СУДА НА ЭКРАНЕ',\r\n        'AISSearch2.MyFleetTab':'МОЙ ФЛОТ',\r\n        'AISSearch2.dailyTrack':'трек за сутки',\r\n        'AISSearch2.myFleetOnly':'Только мой флот',\r\n        'AISSearch2.show_pos':'показать положение и историю',\r\n        'AISSearch2.show_info':'информация о судне'\r\n    });\r\n    _translationsHash.addtext('eng', {\r\n        'AISSearch2.title': 'Searching vessels',\r\n        'AISSearch2.title1': 'Vessels found',\r\n        'AISSearch2.title2': '<b>Vessels not found!</b>',\r\n        'AISSearch2.error': '<b>Vessels not found!</b>',\r\n        'AISSearch2.iconTitle': 'Search vessels within the view area',\r\n        'AISSearch2.placeholder_0': 'Search for addresses, coordinates',\r\n        'AISSearch2.placeholder_1': 'Search by vessel name / MMSI',\r\n        // 'AISSearch2.placeholder_1' : 'Search by vessel name / MMSI. Search by addresses, coordinates, cadastre number'\r\n        'AISSearch2.myFleetDialog': 'My fleet',\r\n        'AISSearch2.vesselName': 'name',\r\n        'AISSearch2.vesselAdd': 'add',\r\n        'AISSearch2.vesselRemove': 'remove',\r\n        'AISSearch2.vesselExclude': 'exclude',\r\n        'AISSearch2.myFleetMembers': 'Members',\r\n        'AISSearch2.myFleetMember': 'my fleet',\r\n        'AISSearch2.info': 'info',\r\n        'AISSearch2.found':'Found ',\r\n        'AISSearch2.filter':'Insert vessel name or mmsi or imo',\r\n        'AISSearch2.filterName':'Insert vessel name',\r\n        'AISSearch2.screen':'On screen',\r\n        'AISSearch2.database':'In database',\r\n        'AISSearch2.capShort': 'Vessel Search',\r\n        'AISSearch2.caption': 'Vessel Search & My Fleet',\r\n        'AISSearch2.refresh': 'refresh',\r\n        'AISSearch2.refreshing': 'refreshing',\r\n        'AISSearch2.nomyfleet': 'Service is unavailable',\r\n        'AISSearch2.auth': 'Authorization required',\r\n        'AISSearch2.vessel_name': 'Name',\r\n        'AISSearch2.mmsi': 'MMSI',\r\n        'AISSearch2.imo': 'IMO',\r\n        'AISSearch2.flag_country': 'Flag',\r\n        'AISSearch2.vessel_type': 'Vessel type',\r\n        'AISSearch2.draught': 'Draught',\r\n        'AISSearch2.destination': 'Destination',\r\n        'AISSearch2.nav_status': 'Navigation status',\r\n        'AISSearch2.last_sig': 'Last signal',\r\n        'AISSearch2.show_track': 'show track',\r\n        'AISSearch2.hide_track': 'hide track',\r\n\t\t'AISSearch2.source': 'Source',\r\n\t\t'AISSearch2.sais': 'S-AIS',\r\n\t\t'AISSearch2.tais': 'T-AIS',\r\n\t\t'AISSearch2.lon': 'Longitude',\r\n\t\t'AISSearch2.lat': 'Latitude',\r\n\t\t'AISSearch2.historyTab': 'History',\r\n\t\t'AISSearch2.voyageInfo': 'Voyage Info',\r\n        'AISSearch2.DbSearchTab':'DATA BASE',\r\n        'AISSearch2.ScreenSearchTab':'VESSELS ON SCREEN',\r\n        'AISSearch2.MyFleetTab':'MY FLEET',\r\n        'AISSearch2.dailyTrack':'Daily Track',\r\n        'AISSearch2.myFleetOnly':'My Fleet Only',\r\n        'AISSearch2.show_pos':'position and history',\r\n        'AISSearch2.show_info':'vessel data'\r\n    });\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/locale.js","let NOSIDEBAR = false,\r\n    PRODUCTION = false,\r\n    SIDEBAR2 = false;\r\nif (has('NOSIDEBAR'))\r\n    NOSIDEBAR = true;\r\nif (has('SIDEBAR2'))\r\n    SIDEBAR2 = true;\r\nif (has('PRODUCTION'))\r\n    PRODUCTION = true;\r\n\r\n\r\nmodule.exports = function (viewFactory) {\r\n    let _leftMenuBlock,\r\n        _canvas = _div(null),\r\n        _activeView,\r\n        _views = viewFactory.create(),\r\n        // _aisSearchView,\r\n        // _myFleetMembersView,\r\n        // _historyView,\r\n        //_gifLoader = '<img src=\"img/progress.gif\">',\r\n        _isReady = false,\r\n        _createTabs = function () {\r\n            let tabsTemplate = '<table class=\"ais_tabs\" border=0><tr>' +\r\n                '<td class=\"ais_tab dbsearch_tab unselectable\" unselectable=\"on\">' +\r\n                '<div>{{i \"AISSearch2.DbSearchTab\"}}</div>' +\r\n                '</td><td class=\"ais_tab scrsearch_tab unselectable\" unselectable=\"on\">' +\r\n                '<div>{{i \"AISSearch2.ScreenSearchTab\"}}</div>' +\r\n                '</td><td class=\"ais_tab myfleet_tab unselectable\" unselectable=\"on\">' + // ACTIVE\r\n                '<div>{{i \"AISSearch2.MyFleetTab\"}}</div>' +\r\n                '</td></tr></table>'\r\n\r\n            if (NOSIDEBAR)\r\n                $(_leftMenuBlock.workCanvas).append(_canvas);\r\n            else\r\n                $(this.sidebarPane).append(_canvas);\r\n\r\n            $(_canvas).append(Handlebars.compile(tabsTemplate));\r\n            $(_canvas).append(_views.map(v => v.frame));\r\n    \r\n            let tabs = $('.ais_tab', _canvas),\r\n                _this = this;           \r\n            _views.forEach((v,i) =>{\r\n                v.tab = tabs.eq(i);\r\n                v.resize(true);\r\n            }); \r\n            tabs.on('click', function () {\r\n                if (!$(this).is('.active')) {\r\n                    let target = this;\r\n                    tabs.each(function (i, tab) {\r\n                        if (!$(tab).is('.active') && target == tab) {\r\n                            $(tab).addClass('active');\r\n                            _views[i].show();\r\n                            _activeView = _views[i];\r\n                        }\r\n                        else {\r\n                            $(tab).removeClass('active');\r\n                            _views[i].hide();\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            // Show the first tab\r\n            tabs.eq(0).removeClass('active').click();\r\n\r\n            if (NOSIDEBAR) {\r\n                _returnInstance.hide = function () {\r\n                    $(_leftMenuBlock.parentWorkCanvas).hide();\r\n                    nsGmx.leafletMap.removeLayer(highlight);\r\n                }\r\n\r\n                $(_leftMenuBlock.parentWorkCanvas)\r\n                    .attr('class', 'left_aispanel')\r\n                    .insertAfter('.layers-before');\r\n                var blockItem = _leftMenuBlock.leftPanelItem,\r\n                    blockTitle = $('.leftmenu-path', blockItem.panelCanvas);\r\n                var toggleTitle = function () {\r\n                    if (blockItem.isCollapsed())\r\n                        blockTitle.show();\r\n                    else\r\n                        blockTitle.hide();\r\n                }\r\n                $(blockItem).on('changeVisibility', toggleTitle);\r\n                toggleTitle();\r\n            }\r\n\r\n            // All has been done at first time\r\n            _isReady = true;\r\n        },\r\n\r\n    _returnInstance = {\r\n        show: function () {\r\n            let lmap = nsGmx.leafletMap;\r\n            if (NOSIDEBAR && !_leftMenuBlock)\r\n                _leftMenuBlock = new leftMenu();\r\n\r\n            if ((NOSIDEBAR && (!_leftMenuBlock.createWorkCanvas(\"aispanel\",\r\n                function () { lmap.gmxControlIconManager.get(this.menuId)._iconClick() },\r\n                { path: [_gtxt('AISSearch2.caption')] })\r\n            )) || (!_isReady)) // SIDEBAR\r\n            {\r\n                _createTabs.call(this);\r\n            }\r\n            else{\r\n                if (NOSIDEBAR){\r\n                    $(_leftMenuBlock.parentWorkCanvas)\r\n                    .insertAfter('.layers-before');\r\n                }            \r\n                _activeView && _activeView.show();\r\n            }\r\n        }\r\n    };\r\n    return _returnInstance;\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/aisPluginPanel.js","const ScreenSearchView = require('./Views/ScreenSearchView'),\r\n    ScreenSearchModel = require('./Models/ScreenSearchModel'),\r\n    MyFleetView = require('./Views/MyFleetView'),\r\n    MyFleetModel = require('./Models/MyFleetModel'),\r\n    DbSearchView = require('./Views/DbSearchView'),\r\n    DbSearchModel = require('./Models/DbSearchModel'),\r\n    InfoDialogView = require('./Views/InfoDialogView'),\r\n    Searcher = require('./Search/Searcher'),\r\n    Toolbox = require('./Toolbox.js');\r\n\r\nmodule.exports = function (options) {\r\n    const _tools = new Toolbox(options),\r\n        //_layersByID = nsGmx.gmxMap.layersByID,\r\n        _searcher = new Searcher(options),\r\n        _mfm = new MyFleetModel(_searcher),\r\n        _ssm = new ScreenSearchModel({ aisLayerSearcher: _searcher, myFleetModel: _mfm }),\r\n        _dbsm = new DbSearchModel(_searcher),\r\n        _dbsv = new DbSearchView({model:_dbsm, highlight:options.highlight, tools:_tools}),\r\n        _ssv = new ScreenSearchView(_ssm),\r\n        _mfv = new MyFleetView(_mfm, _tools),\r\n        _idv = new InfoDialogView({\r\n            tools:_tools,\r\n            aisLayerSearcher: _searcher, \r\n            modulePath: options.modulePath,\r\n            aisView: _dbsv, \r\n            myFleetMembersView: _mfv\r\n        });\r\n        _ssv.infoDialogView = _idv;\r\n        _mfv.infoDialogView = _idv;\r\n        _dbsv.infoDialogView = _idv;\r\n    return {\r\n        get infoDialogView(){\r\n            return _idv;\r\n        },\r\n        create: function () {\r\n            return [ _dbsv, _ssv, _mfv ];\r\n        }\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/ViewsFactory.js","const BaseView = require('./BaseView.js');\r\nconst ScreenSearchView = function (model) {\r\n    BaseView.apply(this, arguments);\r\n    this.topOffset = 180;\r\n    this.frame = $(Handlebars.compile('<div class=\"ais_view search_view\">' +\r\n\r\n        '<table border=0 class=\"instruments\">' +\r\n        //'<tr><td colspan=\"2\"><div class=\"filter\"><input type=\"text\" placeholder=\"{{i \"AISSearch2.filter\"}}\"/><i class=\"icon-flclose clicable\"></div></td></tr>'+\r\n        '<tr><td><div class=\"filter\"><input type=\"text\" placeholder=\"{{i \"AISSearch2.filterName\"}}\"/>' +\r\n        '<div><img class=\"search clicable\" src=\"plugins/AIS/AISSearch/svg/search.svg\">' +\r\n        '<img class=\"remove clicable\" src=\"plugins/AIS/AISSearch/svg/remove.svg\">' +\r\n        '</div></div>' +\r\n        '<div>&nbsp;</div>'+\r\n        '</td></tr>' + \r\n        '</table>' +\r\n\r\n        '<table class=\"results\">'+\r\n        '<tr><td class=\"count\"></td>' +\r\n        '<td><div class=\"refresh clicable\" title=\"{{i \"AISSearch2.refresh\"}}\"><div>' + this.gifLoader + '</div></div></td></tr>' +\r\n        '</table>'+\r\n        // '<table class=\"start_screen\"><tr><td>'+\r\n        // '<img src=\"plugins/AIS/AISSearch/svg/steer-weel.svg\">'+\r\n        // '<div>Здесь будут отображаться<br>результаты поиска</div></td></tr></table>'+\r\n        '<div class=\"ais_vessels\">'+\r\n        '<div class=\"ais_vessel\">' +\r\n        '<table border=0><tr><td><div class=\"position\">NO VESSELS</div><div>mmsi: 0 imo: 0</div></td>' +\r\n        '<td><i class=\"icon-ship\" vessel=\"\" title=\"\"></i></td>' +\r\n        '<td><span class=\"date\"></span></td>'+\r\n        '<td><div class=\"info\" vessel=\"aisjson this\" title=\"i AISSearch2.info\">' +\r\n        '<img src=\"plugins/AIS/AISSearch/svg/info.svg\">' +\r\n        '</div></td></tr></table>' +\r\n        '</div>' +       \r\n        '</div>' +\r\n        \r\n        '</div>'\r\n    )());\r\n    this.container = this.frame.find('.ais_vessels');\r\n    //this.startScreen = this.frame.find('.start_screen');\r\n    this.tableTemplate = '{{#each vessels}}' +\r\n        '<div class=\"ais_vessel\">' +\r\n        '<table border=0><tr><td><div class=\"position\">{{vessel_name}}</div><div>mmsi: {{mmsi}} imo: {{imo}}</div></td>' +       \r\n        '<td><img src=\"{{icon}}\" class=\"rotateimg{{icon_rot}}\"></td>' +\r\n        \r\n        //'<td><i class=\"icon-ship\" vessel=\"{{aisinfoid this}}\" style=\"{{mf_member}}\" title=\"{{i \"AISSearch2.myFleetMember\"}}\"></i></td>' +\r\n        '<td><span vessel=\"{{aisinfoid this}}\" style=\"{{mf_member}}\" title=\"{{i \"AISSearch2.myFleetMember\"}}\">'+        \r\n        '<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"14px\" height=\"14px\" viewBox=\"0 0 14 14\" xml:space=\"preserve\">' +\r\n        '<g style=\"fill: #48aff1;\">' +\r\n        '<path class=\"st0\" d=\"M13.4,11H0.6c-0.2,0-0.4,0.1-0.5,0.3c-0.1,0.2-0.1,0.4,0,0.6l1.2,1.8C1.4,13.9,1.6,14,1.8,14h9.9   c0.2,0,0.3-0.1,0.4-0.2l1.7-1.8c0.2-0.2,0.2-0.4,0.1-0.7C13.9,11.1,13.7,11,13.4,11z\"/>' +\r\n        '<path class=\"st0\" d=\"M9.3,9.7h2.9c0.2,0,0.4-0.1,0.5-0.3c0.1-0.2,0.1-0.4,0-0.6L9.8,4.5C9.7,4.3,9.4,4.2,9.2,4.3   C8.9,4.4,8.7,4.6,8.7,4.9v4.3C8.7,9.5,9,9.7,9.3,9.7z\"/>' +\r\n        '<path class=\"st0\" d=\"M1.2,9.7H7c0.3,0,0.6-0.3,0.6-0.6V0.6c0-0.3-0.2-0.5-0.4-0.6C6.9-0.1,6.7,0,6.5,0.3L0.7,8.8   C0.6,9,0.5,9.2,0.6,9.4C0.7,9.6,0.9,9.7,1.2,9.7z\"/>' +\r\n        '</g>' +\r\n        '</svg></span></td>'+\r\n        \r\n        '<td><span class=\"date\">{{ts_pos_utc}}</span></td>'+\r\n        '<td><div class=\"info\" vessel=\"{{aisjson this}}\" title=\"{{i \"AISSearch2.info\"}}\">' +\r\n        '<img src=\"plugins/AIS/AISSearch/svg/info.svg\">' +\r\n        '</div></td></tr></table>' +\r\n        '</div>' +\r\n        '{{/each}}' +\r\n        '{{#each msg}}<div class=\"msg\">{{txt}}</div>{{/each}}';\r\n\r\n    let cleanFilter = this.frame.find('.remove'),\r\n        filterReady = this.frame.find('.search'),\r\n        filterInput = this.frame.find('input'),\r\n        delay,\r\n        doFilter = function(){\r\n            this.model.setFilter();             \r\n            this.repaint();\r\n//console.log(\"doFilter\")\r\n        };\r\n        cleanFilter.click(function(e){\r\n            if (this.model.filterString === '')\r\n                return;\r\n            filterInput.val('');\r\n            this.model.filterString = '';  \r\n            clearTimeout(delay)\r\n            doFilter.call(this);\r\n            //nsGmx.leafletMap.removeLayer(highlight);\r\n        }.bind(this))\r\n        filterInput.keyup(function(e){            \r\n            let input = filterInput.val() || \"\";\r\n            input = input.replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n            if (input===\"\"){\r\n                filterReady.show();\r\n                cleanFilter.hide();\r\n            }\r\n            else{\r\n                cleanFilter.show();\r\n                filterReady.hide();\r\n            }\r\n\r\n            if (input==this.model.filterString && e.keyCode!=13)\r\n                return;\r\n            this.model.filterString = input; \r\n            if (e.keyCode==13)\r\n                this.model.filterString += '\\r' ;  \r\n            clearTimeout(delay)\r\n            delay = setTimeout((() => { doFilter.call(this) }).bind(this), 500);\r\n            //nsGmx.leafletMap.removeLayer(highlight);\r\n        }.bind(this))\r\n    \r\n    let needUpdate = function(){\r\n        this.model.isDirty = true;\r\n        if (this.container.is(':visible')) {\r\n \r\n            clearTimeout(delay)\r\n            delay = setTimeout((() => { this.model.update() }).bind(this), 300);  \r\n        }\r\n    };\r\n    nsGmx.leafletMap.on('moveend', needUpdate.bind(this));\r\n    nsGmx.widgets.commonCalendar.getDateInterval().on('change', needUpdate.bind(this));\r\n};\r\n\r\nScreenSearchView.prototype = Object.create(BaseView.prototype);\r\n\r\nlet _clean = function () {\r\n    this.frame.find('.count').text(_gtxt('AISSearch2.found') + 0); \r\n};\r\n\r\nScreenSearchView.prototype.inProgress = function (state) {\r\n    let progress = this.frame.find('.refresh div');\r\n    if (state)\r\n        progress.show();\r\n    else\r\n        progress.hide();\r\n};\r\n\r\nlet\r\n_firstRowsPos = 0,\r\n_firstRowsNum = 40,\r\n_firstRowsShift = 20,\r\n_setEventHandlers = function(){\r\n    let thisInst = this;\r\n    this.container.find('.info', ).off('click').on('click', function (e) {\r\n        let target = $(this),\r\n            vessel = JSON.parse(target.attr('vessel'))\r\n//console.log(vessel)\r\n        thisInst.infoDialogView && thisInst.infoDialogView.show(vessel, (v) => {\r\n//console.log(v)\r\n            vessel.xmin = vessel.xmax = v.longitude\r\n            vessel.ymin = vessel.ymax = v.latitude\r\n            if (vessel.hasOwnProperty('ts_pos_utc')) {\r\n                 vessel.ts_pos_utc = v.ts_pos_utc;\r\n                 vessel.ts_pos_org = v.ts_pos_org;\r\n                 v.dt_pos_utc && $(this).closest('tr').find('.date').html(v.dt_pos_utc);\r\n            }\r\n            target.attr('vessel', JSON.stringify(vessel))\r\n        });\r\n        e.stopPropagation();\r\n    });\r\n    this.container.find('.ais_vessel').off('click').on('click', function () {\r\n//console.log(JSON.parse($(this).find('.info').attr('vessel')))\r\n        let v = JSON.parse($(this).find('.info').attr('vessel'));                \r\n        v.lastPosition = true;\r\n        thisInst.infoDialogView.showPosition(v);\r\n    }); \r\n//console.log(\"repaint \"+(new Date()-start)+\"ms\" )      \r\n}\r\n\r\nScreenSearchView.prototype.repaint = function () {\r\n    _clean.call(this);\r\n    this.frame.find('.count').text(_gtxt('AISSearch2.found')+this.model.data.vessels.length);   \r\n    //BaseView.prototype.repaint.apply(this, arguments);\r\n    ////////////////////////////////////////////////////\r\n    let start = new Date();\r\n\r\n    //_clean.call(this);\r\n    this.container.find('.info').off('click');\r\n    this.container.find('.ais_vessel', ).off('click');   \r\n    let scrollCont = this.container.find('.mCSB_container')\r\n    if (scrollCont[0])\r\n        scrollCont.empty();\r\n    else\r\n        this.container.empty();\r\n    if (!this.model.data)\r\n        return;\r\n    let thisInst = this,\r\n        tempFirst = this.model.data.vessels.slice(0, _firstRowsNum),\r\n        content = $(Handlebars.compile(this.tableTemplate)({msg:this.model.data.msg, vessels:tempFirst})),\r\n        mcsTopPctPrev = 0,\r\n        rowH;\r\n    _firstRowsPos = _firstRowsNum;\r\n\r\n    if (!scrollCont[0]) {\r\n        this.container.mCustomScrollbar(\"destroy\").append(content).mCustomScrollbar({\r\n            //scrollInertia: 0,//this.model.data.vessels.length > _firstRowsNum ? 0 : 600,\r\n            callbacks:{\r\n                onBeforeUpdate: function(){console.log(\"onBeforeUpdate\")},\r\n                onUpdate: function(){console.log(\"onUpdate\")},\r\n                //onScroll:function(){\r\n                whileScrolling: /*scrollingHandler*/function(){                    \r\n//console.log(\"% \" + this.mcs.topPct + \" pos\" + _firstRowsPos)\r\n                    if (this.mcs.topPct==100 && mcsTopPctPrev != 100 && thisInst.model.data.vessels.length > _firstRowsPos){\r\n                        let start = _firstRowsPos - _firstRowsNum + _firstRowsShift,\r\n                            end = _firstRowsPos + _firstRowsShift;\r\n                        if (thisInst.model.data.vessels.length-start <= thisInst.container.height()/rowH)\r\n                            start = thisInst.model.data.vessels.length - _firstRowsNum;\r\n///console.log(\">\"+start+\", \"+end)\r\n                        tempFirst = thisInst.model.data.vessels.slice(start, end),\r\n                        _firstRowsPos += _firstRowsShift;                       \r\n                        let scrollCont = thisInst.container.find('.mCSB_container');\r\n                        scrollCont.html(Handlebars.compile(thisInst.tableTemplate)({vessels:tempFirst}));  \r\n//console.log(\"h=\"+rowH) \r\n                        setTimeout(()=>{\r\n                            thisInst.container.mCustomScrollbar(\"scrollTo\",\r\n                                -rowH * _firstRowsShift + thisInst.container.height(), {\r\n                                    scrollInertia: 0,\r\n                                    callbacks: false\r\n                                });\r\n                            _setEventHandlers.call(thisInst);\r\n                        }, 200);\r\n                    }\r\n                    if (this.mcs.topPct == 0 && mcsTopPctPrev != 0 && _firstRowsPos > _firstRowsNum) {\r\n//console.log(_firstRowsPos)\r\n                        let start = _firstRowsPos - _firstRowsShift - _firstRowsNum,\r\n                            end = _firstRowsPos - _firstRowsShift;\r\n//console.log(\"<\"+start + \", \" + end)\r\n                        tempFirst = thisInst.model.data.vessels.slice(start, end),\r\n                        _firstRowsPos -= _firstRowsShift;                       \r\n                        let scrollCont = thisInst.container.find('.mCSB_container');\r\n                        scrollCont.html(Handlebars.compile(thisInst.tableTemplate)({ vessels: tempFirst })); \r\n//console.log(\"h=\"+rowH)\r\n                        setTimeout(() => {\r\n                            thisInst.container.mCustomScrollbar(\"scrollTo\",\r\n                                rowH * _firstRowsShift, {\r\n                                    scrollInertia: 0,\r\n                                    callbacks: false\r\n                                })\r\n                            _setEventHandlers.call(thisInst);\r\n                        }, 200);\r\n                    }\r\n                    mcsTopPctPrev = this.mcs.topPct;\r\n                }\r\n            }\r\n        });\r\n        scrollCont = this.container.find('.mCSB_container');\r\n        rowH = scrollCont.height()/$('.ais_vessel', scrollCont).length;\r\n    }\r\n    else {\r\n        scrollCont.append(content);\r\n        this.container.mCustomScrollbar(\"scrollTo\", \"top\", {scrollInertia:0, callbacks:false, timeout:200});\r\n    }\r\n    _setEventHandlers.call(this);\r\n\r\n};\r\n\r\nScreenSearchView.prototype.show = function () {\r\n    BaseView.prototype.show.apply(this, arguments);\r\n    this.frame.find('.filter input').focus();\r\n};\r\n\r\nmodule.exports = ScreenSearchView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/ScreenSearchView.js","let NOSIDEBAR = false,\r\n    PRODUCTION = false,\r\n    SIDEBAR2 = false;\r\nif (has('NOSIDEBAR'))\r\n    NOSIDEBAR = true;\r\nif (has('SIDEBAR2'))\r\n    SIDEBAR2 = true;\r\nif (has('PRODUCTION'))\r\n    PRODUCTION = true;\r\n\r\nlet _calcHeight = function () {\r\n    let template = this.frame.find('.ais_vessel')[0] || this.frame.find('.ais_positions_date')[0],\r\n        h = template.getBoundingClientRect().height\r\n    if (NOSIDEBAR)\r\n        return h * 5;\r\n    else {\r\n        let H = $('.iconSidebarControl-pane').height() - this.topOffset;\r\n// console.log(template.getBoundingClientRect())\r\n// console.log(this.topOffset)\r\n// console.log(H)\r\n        return (H - H%h);\r\n    }\r\n};\r\n\r\nconst BaseView = function (model) {\r\n    model.view = this;\r\n    this.model = model;\r\n    this.gifLoader = '<img src=\"img/progress.gif\">';\r\n};\r\n\r\nlet _clean = function(){ \r\n    this.container.find('.info').off('click');\r\n    this.container.find('.position', ).off('click');   \r\n    let scrollCont = this.container.find('.mCSB_container')\r\n    if (scrollCont[0])\r\n        scrollCont.empty();\r\n    else\r\n        this.container.empty();\r\n//console.log(\"EMPTY ON BASE.CLEAN\")\r\n};\r\n\r\nBaseView.prototype = function () {\r\n    return {\r\n        get isActive(){\r\n            return this.frame.is(\":visible\");\r\n        },\r\n        resize: function (clean) {\r\n            let h = _calcHeight.call(this);\r\n            if (this.startScreen){\r\n                this.startScreen.height(h);\r\n                this.container.css({ position:\"relative\", top: -h+\"px\" });\r\n            }\r\n            this.container.height(h);\r\n\r\n            if (clean){\r\n                this.container.empty()\r\n            }\r\n        },\r\n        repaint: function(){\r\n            _clean.call(this);            \r\n//console.log(this.model.data)\r\n            if (!this.model.data)\r\n                return;\r\n            let scrollCont = this.container.find('.mCSB_container'),\r\n            content = $(Handlebars.compile(this.tableTemplate)(this.model.data));\r\n            if (!scrollCont[0]) {\r\n                this.container.append(content).mCustomScrollbar();\r\n            }\r\n            else {\r\n                $(scrollCont).append(content);\r\n            }\r\n\r\n            var _this = this;\r\n            this.container.find('.info', ).on('click', function (e) {\r\n                let target = $(this),\r\n                    vessel = JSON.parse(target.attr('vessel'))\r\n//console.log(vessel)\r\n                _this.infoDialogView && _this.infoDialogView.show(vessel, (v) => {\r\n//console.log(v)\r\n                    vessel.xmin = vessel.xmax = v.longitude\r\n                    vessel.ymin = vessel.ymax = v.latitude\r\n                    if (vessel.hasOwnProperty('ts_pos_utc')) {\r\n                         vessel.ts_pos_utc = v.ts_pos_utc;\r\n                         vessel.ts_pos_org = v.ts_pos_org;\r\n                         v.dt_pos_utc && $(this).closest('tr').find('.date').html(v.dt_pos_utc);\r\n                    }\r\n                    target.attr('vessel', JSON.stringify(vessel))\r\n                });\r\n                e.stopPropagation();\r\n            });\r\n            this.container.find('.ais_vessel').on('click', function () {\r\n//console.log(JSON.parse($(this).find('.info').attr('vessel')))\r\n                let v = JSON.parse($(this).find('.info').attr('vessel'));                \r\n                v.lastPosition = true;\r\n                _this.infoDialogView.showPosition(v);\r\n            });      \r\n        },\r\n        show: function () {\r\n            this.frame.show();\r\n            this.model.update();\r\n        },\r\n        hide: function () {\r\n            this.frame.hide();\r\n        }\r\n    }\r\n}();\r\n\r\nmodule.exports = BaseView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/BaseView.js","module.exports = function ({aisLayerSearcher, myFleetModel}) {\r\n    let _actualUpdate;\r\n    return {\r\n        filterString: \"\",\r\n        isDirty: true,\r\n        load: function (actualUpdate) {\r\n            if (!this.isDirty) {\r\n                return Promise.resolve();\r\n            }\r\n            let thisInst = this;\r\n            return Promise.all([new Promise(function (resolve, reject) {\r\n                aisLayerSearcher.searchScreen({\r\n                    dateInterval: nsGmx.widgets.commonCalendar.getDateInterval(),\r\n                    border: true,\r\n                    group: true\r\n                }, function (json) {\r\n//console.log(json.Result.values[0][12])\r\n                    if (json.Status.toLowerCase() == \"ok\") {\r\n                        thisInst.dataSrc = {\r\n                            vessels: json.Result.values.map(function (v) {\r\n                                let d = new Date(v[12]),//nsGmx.widgets.commonCalendar.getDateInterval().get('dateBegin'),\r\n                                vessel = {\r\n                                    vessel_name: v[0], mmsi: v[1], imo: v[2], mf_member: 'visibility:hidden', \r\n                                    ts_pos_utc: aisLayerSearcher.formatDate(d), ts_pos_org: Math.floor(d.getTime()/1000),\r\n                                    xmin: v[4], xmax: v[5], ymin: v[6], ymax: v[7], maxid: v[3],\r\n                                    vessel_type: v[8], sog: v[9], cog: v[10], heading: v[11]\r\n                                };\r\n                                vessel.icon_rot = Math.round(vessel.cog/15)*15;\r\n                                aisLayerSearcher.placeVesselTypeIcon(vessel);\r\n                                return vessel;\r\n                            })\r\n                        };\r\n                        if (_actualUpdate == actualUpdate) {\r\n                            //console.log(\"ALL CLEAN\")\r\n                            //console.log(\"1>\"+new Date(thisInst._actualUpdate))\r\n                            //console.log(\"2>\"+new Date(actualUpdate))\r\n                            thisInst.isDirty = false;\r\n                        }\r\n                        resolve();\r\n                    }\r\n                    else {\r\n                        reject(json);\r\n                    }\r\n                });\r\n            })\r\n                ,myFleetModel.load()\r\n            ]);\r\n        },\r\n        setFilter: function () {\r\n            this.filterString = this.filterString.replace(/\\r+$/, \"\");\r\n            if (this.dataSrc){\r\n                if (this.filterString != \"\") {\r\n                    this.data = {\r\n                        vessels: this.dataSrc.vessels.filter(((v)=>{\r\n                            return v.vessel_name.search(new RegExp(\"\\\\b\" + this.filterString, \"ig\")) != -1;\r\n                        }).bind(this))\r\n                    };\r\n                }\r\n                else {\r\n                    this.data = { vessels: this.dataSrc.vessels.map((v)=>v) };\r\n                }\r\n            }\r\n        },\r\n        update: function () {\r\n//let start = new Date();\r\n            if (!this.isDirty)\r\n                return;\r\n            _actualUpdate = new Date().getTime();\r\n            let thisInst = this,\r\n                actualUpdate = _actualUpdate;\r\n            this.view.inProgress(true);\r\n            //this.filterString&&console.log(this.filterString+\" \"+this.filterString.search(/\\r$/))\r\n            //this.filterString&&console.log(this.filterString.replace(/^\\s+/, \"\").replace(/\\s+\\r*$/, \"\")!=\"\")            \r\n\r\n            this.load(actualUpdate).then(function () {\r\n                //console.log(\"LOADED \"+(new Date().getTime()-thisInst._actualUpdate)+\"ms\")\r\n                //console.log(\"3>\"+new Date(thisInst._actualUpdate))\r\n                //console.log(\"4>\"+new Date(actualUpdate))\r\n                if (_actualUpdate == actualUpdate) {\r\n                    if (thisInst.dataSrc)\r\n                        myFleetModel.markMembers(thisInst.dataSrc.vessels);\r\n                    thisInst.setFilter();\r\n//console.log(\"load \"+(new Date()-start)+\"ms\")                  \r\n                    thisInst.view.inProgress(false);\r\n                    thisInst.view.repaint();\r\n                }\r\n            }, function (json) {\r\n                thisInst.dataSrc = null;\r\n//console.logconsole.log(json)\r\n                if (json.Status.toLowerCase() == \"auth\" ||\r\n                    (json.ErrorInfo && json.ErrorInfo.some && json.ErrorInfo.some(function (r) { return r.Status.toLowerCase() == \"auth\" })))\r\n                    thisInst.data = { msg: [{ txt: _gtxt(\"AISSearch2.auth\") }], vessels: [] };\r\n                else {\r\n                    //thisInst.data = {msg:[{txt:\"!!!\"}], vessels:[]};\r\n                    console.log(json);\r\n                }\r\n                thisInst.view.inProgress(false);\r\n                thisInst.view.repaint();\r\n            });\r\n        }\r\n    };\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/Models/ScreenSearchModel.js","const BaseView = require('./BaseView.js');\r\nconst MyFleetView = function (model, tools){\r\n    _tools = tools;\r\n    BaseView.call(this, model);\r\n    this.topOffset = 160;\r\n    this.frame = $(Handlebars.compile('<div class=\"ais_view myfleet_view\">' +\r\n    '<table class=\"instruments\">'+\r\n    '<tr><td>'+\r\n    '<label class=\"sync-switch switch\"><input type=\"checkbox\">'+\r\n    '<div class=\"sync-switch-slider switch-slider round\"></div></label>' +\r\n    '<span class=\"sync-switch-slider-description\">{{i \"AISSearch2.myFleetOnly\"}}</span>'+\r\n    '</td>' +\r\n    '</table>'+    \r\n    '<table class=\"results\">'+\r\n    '<td><input type=\"checkbox\" checked></td>' +\r\n    '<td class=\"count\"></td>' +\r\n    '<td><div class=\"refresh clicable\"><div>' + this.gifLoader + '</div></div></td></tr>' +\r\n    '</table>'+\r\n    '<div class=\"ais_vessels\">'+\r\n    '<div class=\"ais_vessel\">' +\r\n    '<table border=0><tr>' +\r\n    '<td><input type=\"checkbox\" checked></td>' +\r\n    '<td><div class=\"position\">vessel_name</div><div>mmsi: mmsi imo: imo</div></td>' +\r\n    '<td></td>' +  \r\n    '<td><span class=\"date\">ts_pos_utc</span></td>'+\r\n    //'<td><div class=\"info\" vessel=\"aisjson this\" title=\"i AISSearch2.info\">' +\r\n    //'<img src=\"plugins/AIS/AISSearch/svg/info.svg\"><div></td>' +\r\n    '</tr></table>' +\r\n    '</div>' +      \r\n    '</div>' +\r\n    '</div>')());\r\n    this.container = this.frame.find('.ais_vessels'); \r\n    this.frame.find('.results input[type=\"checkbox\"]').on(\"click\", ((e)=>{\r\n        this.frame.find('.ais_vessel input[type=\"checkbox\"]').each((i, elm)=>{\r\n            elm.checked = e.target.checked;\r\n        }) \r\n        _hideOnMap.call(this);\r\n    }).bind(this)); \r\n    this.frame.find('.instruments .switch input[type=\"checkbox\"]').on(\"click\", ((e)=>{\r\n        _tools.displayingMyFleet = null;\r\n        if (e.currentTarget.checked && this.model.data.vessels) {\r\n            let myfleet = this.model.data.vessels.map(v => v.mmsi);\r\n            if (myfleet.length > 0)\r\n                _tools.displayingMyFleet = myfleet;\r\n        }\r\n        _tools.hideAllOnMap();\r\n    }).bind(this)); \r\n\r\n    this.tableTemplate = '{{#each vessels}}' +\r\n    '<div class=\"ais_vessel\">' +\r\n    '<table border=0><tr>' +\r\n    '<td><input type=\"checkbox\" checked></td>' +\r\n    '<td><div class=\"position\">{{vessel_name}}</div><div>mmsi: {{mmsi}} imo: {{imo}}</div></td>' +\r\n    '<td><img src=\"{{icon}}\" class=\"course rotateimg{{icon_rot}}\">' +\r\n    '<div class=\"info\" vessel=\"{{aisjson this}}\" title=\"{{i \"AISSearch2.info\"}}\">' +\r\n    '<img src=\"plugins/AIS/AISSearch/svg/info.svg\"></div>' + \r\n    '</td>' +  \r\n    '<td>' +\r\n    '<div class=\"ais_info_dialog_close-button exclude\" title=\"{{i \"AISSearch2.vesselExclude\"}}\"></div>' +\r\n    '<span class=\"date\">{{dt_pos_utc}}</span></td>'+\r\n    '</tr></table>' +\r\n    '</div>' +\r\n    '{{/each}}' +\r\n    '{{#each msg}}<div class=\"msg\">{{txt}}</div>{{/each}}';\r\n};\r\n\r\nMyFleetView.prototype = Object.create(BaseView.prototype);\r\n\r\nMyFleetView.prototype.inProgress = function (state) {\r\n    let progress = this.frame.find('.refresh div');\r\n    if (state)\r\n        progress.show();\r\n    else\r\n        progress.hide();\r\n};\r\n\r\nlet _clean = function(){  \r\n    if (this.frame.find('.ais_vessel')[0])\r\n        this.frame.find('.ais_vessel input[type=\"checkbox\"]').off('click');\r\n    let count = this.model.data && this.model.data.vessels ? this.model.data.vessels.length : 0;\r\n    this.frame.find('.count').text(_gtxt('AISSearch2.found') + count);\r\n},\r\n_tools,\r\n_hideOnMap = function(){\r\n    _tools.filtered = [];\r\n    let selectAll = this.frame.find('.results input[type=\"checkbox\"]'),\r\n        selectOne = this.frame.find('.ais_vessel input[type=\"checkbox\"]');\r\n    for (let i = 0; i < selectOne.length; i++)\r\n        if (!selectOne[i].checked) {\r\n            _tools.filtered.push(this.model.data.vessels[i].mmsi);\r\n            selectAll[0].checked = false;\r\n        }\r\n    if (_tools.filtered.length == 0)\r\n        selectAll[0].checked = true;\r\n\r\n    _tools.hideOnMap();    \r\n};\r\n\r\nMyFleetView.prototype.repaint = function () {\r\n    _clean.call(this);  \r\n    BaseView.prototype.repaint.apply(this, arguments);\r\n    \r\n    _tools.filtered = _filteredState.map(mmsi=>mmsi);\r\n    //_displayngState && (_tools.displayingMyFleet = _displayngState.map(v=>v));\r\n    if (_displayngState)\r\n        _tools.displayingMyFleet = this.model.data.vessels.map(v=>v.mmsi)\r\n\r\n    if (_tools.displayingMyFleet)\r\n        this.frame.find('.instruments .switch input[type=\"checkbox\"]')[0].checked = true;\r\n    this.frame.find('.results input[type=\"checkbox\"]')[0].checked = !_tools.filtered.length; \r\n    _tools.hideAllOnMap();\r\n\r\n    this.frame.find('.ais_vessel input[type=\"checkbox\"]').each(((i, elm)=>{\r\n        let mmsi = this.model.data.vessels[i].mmsi;\r\n        elm.checked = _tools.filtered.indexOf(mmsi)<0;\r\n        $(elm).on('click', (e) => {\r\n            e.stopPropagation();\r\n            _hideOnMap.call(this);\r\n        });\r\n    }).bind(this));\r\n    this.frame.find('.ais_vessel .exclude').each(((i, elm)=>{\r\n        let view = this;\r\n        $(elm).on('click', (e) => {\r\n            e.stopPropagation();\r\n            $(elm).off('click');\r\n            let vessel = view.model.data.vessels[i];\r\n            view.prepare(vessel);\r\n            let dlg = $('.ui-dialog:contains(\"' + vessel.mmsi + '\")');\r\n            if (dlg[0]){ \r\n                dlg.find('.button.addremove').click();\r\n            }\r\n            else{\r\n                view.model.changeFilter(vessel).then(function () {\r\n                    if (view.isActive)\r\n                        view.show();\r\n                })\r\n            }\r\n        })\r\n    }).bind(this));\r\n\r\n};\r\n\r\nlet _filteredState = [], _displayngState;\r\n\r\nMyFleetView.prototype.prepare = function (vessel) {\r\n    if (this.isActive){\r\n        _filteredState = _tools.filtered.filter(mmsi=>mmsi!=vessel.mmsi);\r\n        _displayngState = _tools.displayingMyFleet ? _tools.displayingMyFleet.filter(mmsi=>mmsi!=vessel.mmsi) : null;   \r\n        if (_displayngState && _displayngState.length==0)\r\n            _displayngState = null;\r\n    }\r\n}\r\n\r\nMyFleetView.prototype.hide = function () {\r\n    if (this.isActive){\r\n        _filteredState = _tools.filtered.map(v=>v);\r\n        _displayngState = _tools.displayingMyFleet ? _tools.displayingMyFleet.map(v=>v) : null;\r\n\r\n        _tools.filtered = [];   \r\n        _tools.displayingMyFleet = null;\r\n        _tools.hideAllOnMap();\r\n    }\r\n    BaseView.prototype.hide.apply(this, arguments);\r\n}\r\n// MyFleetView.prototype.show = function () {\r\n//     BaseView.prototype.show.apply(this, arguments); \r\n// }\r\nmodule.exports = MyFleetView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/MyFleetView.js","const Polyfill = require('../Polyfill');\r\nmodule.exports = function (aisLayerSearcher) {\r\n\r\n    let _myFleetLayers = [],\r\n        _vessels = [],\r\n        _mapID = String($(_queryMapLayers.buildedTree).find(\"[MapID]\")[0].gmxProperties.properties.MapID),\r\n        fetchMyFleet = function (lid) {\r\n            return new Promise(function (resolve, reject) {\r\n                //console.log(lid)\r\n                sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl + \"VectorLayer/Search.ashx?layer=\" + lid,\r\n                    function (response) {\r\n                        //console.log(response);\r\n                        if (response.Status.toLowerCase() == \"ok\") {\r\n                            let v = response.Result.values,\r\n                                f = response.Result.fields;\r\n                            for (let i = 0; i < v.length; ++i) {\r\n                                _vessels.push({})\r\n                                for (let j = 0; j < f.length; ++j)\r\n                                    _vessels[i][f[j]] = v[i][j];\r\n                            }\r\n                        }\r\n                        else\r\n                            console.log(response);\r\n                        resolve(response);\r\n                    });\r\n            })\r\n        };\r\n    new Promise((resolve, reject) => {\r\n        sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n            \"User/GetUserInfo.ashx\",\r\n            function (response) {\r\n                if (response.Status.toLowerCase() == \"ok\" && response.Result)\r\n                    resolve(response);\r\n            });\r\n    })\r\n        .then((response) => {\r\n            let nickname = response.Result.Nickname;\r\n            return new Promise((resolve, reject) => {\r\n                sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                    \"Layer/Search2.ashx?page=0&pageSize=50&orderby=title &query=([Title]='myfleet\" + _mapID + \"' and [OwnerNickname] containsIC '\" + nickname + \"')\",\r\n                    function (response) {\r\n                        if (response.Status.toLowerCase() == \"ok\" && response.Result.count > 0)\r\n                            resolve(response);\r\n                        else\r\n                            reject(response);\r\n                    });\r\n            })\r\n        })\r\n        .then((response) => {\r\n            //console.log('resolved')\r\n            let lid = response.Result.layers[0].LayerID;\r\n            _myFleetLayers.push(lid);\r\n            fetchMyFleet(lid)\r\n            //.then(()=>console.log(_vessels));\r\n        },\r\n        (response) => {\r\n            //console.log('rejected');\r\n            sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                'VectorLayer/CreateVectorLayer.ashx?Title=myfleet' + _mapID + '&geometrytype=point&Columns=' +\r\n                '[{\"Name\":\"mmsi\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"mmsi\\\\\"\"},{\"Name\":\"imo\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"imo\\\\\"\"}]',\r\n                function (response) {\r\n                    if (response.Status.toLowerCase() == \"ok\")\r\n                        _myFleetLayers.push(response.Result.properties.name)\r\n                    else\r\n                        console.log(response);\r\n                });\r\n        });\r\n\r\n    let _actualUpdate,\r\n        _data;\r\n    return {\r\n        isDirty: true,\r\n        get data() { return _data; },\r\n        set data(value) { _data = value; },\r\n        findIndex: function (vessel) {\r\n            if (_vessels.length == 0)\r\n                return -1;\r\n            return Polyfill.findIndex(_vessels, function (v) {\r\n                return v.mmsi == vessel.mmsi && v.imo == vessel.imo;\r\n            })\r\n        },\r\n        load: function (actualUpdate) {\r\n            var _this = this;\r\n\r\n            if (_myFleetLayers.length == 0)\r\n                this.data = { msg: [{ txt: _gtxt(\"AISSearch2.nomyfleet\") }], vessels: [] };\r\n\r\n            if (_myFleetLayers.length == 0 || !this.isDirty)\r\n                return Promise.resolve();\r\n\r\n            _vessels = [];\r\n            var errors = [],\r\n                promises = _myFleetLayers.map(fetchMyFleet)\r\n\r\n            return Promise.all(promises)\r\n                .then(function () {\r\n//console.log(_vessels)                    \r\n                    if (_vessels.length == 0)\r\n                        return Promise.resolve({ Status: \"ok\", Result: { values: [] } });\r\n\r\n                    return new Promise(function (resolve, reject) {\r\n                        aisLayerSearcher.searchNames(\r\n                            _vessels,\r\n                            //vessels.map(function(v){return v.mmsi}), \r\n                            //vessels.map(function(v){return v.imo}),\r\n                            function (response) {\r\n                                resolve(response);\r\n                            });\r\n                    });\r\n                }\r\n                )\r\n                .then(function (response) {\r\n//console.log(response)  \r\n                    //console.log(\"LOAD MY FLEET FINISH\")               \r\n                    if (response.Status.toLowerCase() == \"ok\") {\r\n                        _this.data = {\r\n                            vessels: response.Result.values.reduce(function (p, c) {\r\n                                var mmsi = response.Result.fields.indexOf(\"mmsi\"),\r\n                                    vessel_name = response.Result.fields.indexOf(\"vessel_name\"),\r\n                                    ts_pos_utc = response.Result.fields.indexOf(\"ts_pos_utc\"),\r\n                                    imo = response.Result.fields.indexOf(\"imo\"),\r\n                                    lat = response.Result.fields.indexOf(\"longitude\"),\r\n                                    lon = response.Result.fields.indexOf(\"latitude\"),\r\n                                    vt = response.Result.fields.indexOf(\"vessel_type\"),\r\n                                    cog = response.Result.fields.indexOf(\"cog\"),\r\n                                    sog = response.Result.fields.indexOf(\"sog\");\r\n                                if (!p.some(function (v) { return v.mmsi == c[mmsi] })) {\r\n                                    var d = new Date(c[ts_pos_utc] * 1000),\r\n                                        member = {\r\n                                        vessel_name: c[vessel_name], mmsi: c[mmsi], imo: c[imo],\r\n                                        ts_pos_utc: aisLayerSearcher.formatDateTime(d), dt_pos_utc: aisLayerSearcher.formatDate(d),\r\n                                        ts_pos_org: c[ts_pos_utc],\r\n                                        xmin: c[lat], xmax: c[lat], ymin: c[lon], ymax: c[lon],\r\n                                        vessel_type: c[vt], cog: c[cog], sog: c[sog]\r\n                                        };\r\n                                        member.icon_rot = Math.round(member.cog/15)*15;\r\n                                        aisLayerSearcher.placeVesselTypeIcon(member);\r\n                                    p.push(member);\r\n                                }\r\n                                return p;\r\n                            }, [])\r\n                        };\r\n                        _this.data.vessels.sort(function (a, b) { return +(a.vessel_name > b.vessel_name) || +(a.vessel_name === b.vessel_name) - 1; })\r\n                        _this.isDirty = false;\r\n                        return Promise.resolve();\r\n                    }\r\n                    else {\r\n                        return Promise.reject(response);\r\n                    }\r\n                });\r\n        },\r\n        update: function () {\r\n            //if (!this.isDirty)\r\n            //    return;\r\n            _actualUpdate = new Date().getTime();\r\n            let _this = this,\r\n                actualUpdate = _actualUpdate;\r\n            this.view.inProgress(true);\r\n\r\n            this.load(actualUpdate).then(function () {\r\n                if (_actualUpdate == actualUpdate) {\r\n                    _this.view.inProgress(false);\r\n//console.log(_this.data)\r\n                    _this.view.repaint();\r\n                }\r\n            }, function (json) {\r\n                _this.dataSrc = null;\r\n                console.log(json)\r\n                if (json.Status.toLowerCase() == \"auth\" ||\r\n                    (json.ErrorInfo && json.ErrorInfo.some && json.ErrorInfo.some(function (r) { return r.Status.toLowerCase() == \"auth\" })))\r\n                    _this.data = { msg: [{ txt: _gtxt(\"AISSearch2.auth\") }], vessels: [] };\r\n                else {\r\n                    //_this.data = {msg:[{txt:\"!!!\"}], vessels:[]};\r\n                    console.log(json);\r\n                }\r\n                _this.view.inProgress(false);\r\n                _this.view.repaint();\r\n            });\r\n        },\r\n        markMembers: function (vessels) {\r\n            //console.log(vessels.length)\r\n            if (this.data && this.data.vessels){\r\n                let membCounter = 0;\r\n                this.data.vessels.forEach(function (v) {\r\n                    let i = Polyfill.findIndex(vessels, function (vv) { return v.mmsi == vv.mmsi && v.imo == v.imo });\r\n                    if (i>-1){\r\n                        let member = vessels[i]\r\n                        member.mf_member = \"visibilty:visible\";\r\n                        vessels.splice(i, 1);\r\n                        vessels.splice(membCounter++, 0, member);\r\n                    }\r\n                });\r\n            }\r\n        },\r\n        changeFilter: function (vessel) {\r\n            //console.log(vessel);\r\n            //console.log(_vessels);\r\n            var remove = false;\r\n            for (var i = 0; i < _vessels.length; ++i) {\r\n                if (_vessels[i].imo == vessel.imo && _vessels[i].mmsi == vessel.mmsi) {\r\n                    remove = _vessels[i].gmx_id;\r\n                    _vessels.splice(i, 1);\r\n                }\r\n            }\r\n            //console.log(remove);\r\n            return new Promise((resolve, reject) => {\r\n                if (!remove)\r\n                    sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                        'VectorLayer/ModifyVectorObjects.ashx?LayerName=' + _myFleetLayers[0] +\r\n                        '&objects=[{\"properties\":{ \"imo\": ' + vessel.imo + ', \"mmsi\": ' + vessel.mmsi + '},' +\r\n                        '\"geometry\":{\"type\":\"Point\",\"coordinates\":[0,0]},\"action\":\"insert\"}]',\r\n                        function (response) {\r\n                            if (response.Status.toLowerCase() == \"ok\") {\r\n                                resolve();\r\n                                _vessels.push({ \"mmsi\": vessel.mmsi, \"imo\": vessel.imo, \"gmx_id\": response.Result[0] });\r\n                            }\r\n                            else\r\n                                reject(response);\r\n                        })\r\n                else\r\n                    sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                        'VectorLayer/ModifyVectorObjects.ashx?LayerName=' + _myFleetLayers[0] +\r\n                        '&objects=[{\"id\":' + remove + ',\"action\":\"delete\"}]',\r\n                        function (response) {\r\n                            if (response.Status.toLowerCase() == \"ok\")\r\n                                resolve();\r\n                            else\r\n                                reject(response);\r\n                        })\r\n            })\r\n                .then(\r\n                function () {\r\n                    this.isDirty = true;\r\n                    //console.log(this.data);\r\n                    //L.gmx.layersVersion.chkVersion();\r\n                    return Promise.resolve();\r\n                }.bind(this),\r\n                function (response) {\r\n                    console.log(response);\r\n                    return Promise.reject();\r\n                });\r\n        }\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Models/MyFleetModel.js","module.exports = { \r\n\tfind: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn value;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn undefined;\r\n\t},\r\n\tfindIndex: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn i;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Polyfill.js","require(\"./DbSearch.css\")\r\nconst BaseView = require('./BaseView.js');\r\n\r\nlet _searchString = \"\",\r\n    _setSearchInputValue = function (s) {\r\n        let searchBut = this.frame.find('.filter .search'),\r\n            removeBut = this.frame.find('.filter .remove'),\r\n            _searchString = s;\r\n        this.searchInput.val(_searchString);\r\n        if (s != \"\") {\r\n            removeBut.show();\r\n            searchBut.hide();\r\n        }\r\n        else\r\n            removeBut.click();\r\n    },\r\n    _highlight,\r\n    _tools;\r\n\r\nconst DbSearchView = function ({ model, highlight, tools }) {\r\n    BaseView.call(this, model);\r\n    _highlight = highlight;\r\n    _tools = tools;\r\n    this.topOffset = 240;\r\n    this.frame = $(Handlebars.compile('<div class=\"ais_view search_view\">' +\r\n        '<table border=0 class=\"instruments\">' +\r\n        '<tr><td colspan=\"2\"><div class=\"filter\"><input type=\"text\" placeholder=\"{{i \"AISSearch2.filter\"}}\"/>' +\r\n        '<div><img class=\"search clicable\" src=\"plugins/AIS/AISSearch/svg/search.svg\">' +\r\n        '<img class=\"remove clicable\" src=\"plugins/AIS/AISSearch/svg/remove.svg\">' +\r\n        '</div></div>' +\r\n\r\n        '</td></tr>' +\r\n        '<tr><td class=\"time\"><span class=\"label\">Время:</span>' +\r\n        '<span class=\"utc on unselectable\" unselectable=\"on\">UTC</span><span class=\"local unselectable\" unselectable=\"on\">Местное</span></td>' +\r\n        '<tr><td><div class=\"calendar\"></div></td>' +\r\n        '<td style=\"padding-left:5px\"><div class=\"refresh clicable\" title=\"{{i \"AISSearch2.refresh\"}}\"><div>' + this.gifLoader + '</div></div></td></tr>' +\r\n        '</table>' +\r\n\r\n        '<table class=\"start_screen\"><tr><td>' +\r\n        '<img src=\"plugins/AIS/AISSearch/svg/steer-weel.svg\">' +\r\n        '<div>Здесь будут отображаться<br>результаты поиска по названию,<br>' +\r\n        'IMO илм MMSI судна' +\r\n        '</div></td></tr></table>' +\r\n\r\n        '<div class=\"ais_history\">' +\r\n        '<table class=\"ais_positions_date\"><tr><td>NO HISTORY FOUND</td></tr></table>' +\r\n        '</div>' +\r\n        '<div class=\"suggestions\"><div class=\"suggestion\">SOME VESSEL<br><span>mmsi:0, imo:0</span></div></div>' +\r\n        '</div>'\r\n    )());\r\n    this.container = this.frame.find('.ais_history');\r\n    this.startScreen = this.frame.find('.start_screen');\r\n    this.tableTemplate = '{{#if msg}}<div class=\"message\">{{msg}}</div>{{/if}}' +\r\n        '{{#each vessels}}' +\r\n        '<table class=\"ais_positions_date\" border=0><tr>' +\r\n        '<td><div class=\"open_positions ui-helper-noselect icon-right-open\" title=\"{{i \"AISSearch2.voyageInfo\"}}\"></div></td>' +\r\n        '<td><span class=\"date\">{{{ts_pos_utc}}}</span></td>' +\r\n        '<td><div class=\"track\" date=\"{{{ts_pos_utc}}}\"><input type=\"checkbox\" title=\"{{i \"AISSearch2.dailyTrack\"}}\"></div></td>' +\r\n        '<td><div class=\"count\">{{count}}</div></td></tr></table>' +\r\n        '<div id=\"voyage_info{{n}}\"></div>' +\r\n        '{{/each}}';\r\n\r\n    let calendar = this.frame.find('.calendar');\r\n\r\n    // walkaround with focus at first input in ui-dialog\r\n    calendar.append('<span class=\"ui-helper-hidden-accessible\"><input type=\"text\"/></span>')\r\n    let mapDateInterval = nsGmx.widgets.commonCalendar.getDateInterval(),\r\n        dateInterval = new nsGmx.DateInterval();\r\n    dateInterval\r\n        .set('dateBegin', mapDateInterval.get('dateBegin'))\r\n        .set('dateEnd', mapDateInterval.get('dateEnd'))\r\n        .on('change', function (e) {\r\n            //console.log(this.model.historyInterval) \r\n            //console.log('CHANGE ' + dateInterval.get('dateBegin').toUTCString() + ' ' + dateInterval.get('dateEnd').toUTCString()) \r\n            this.model.historyInterval = { dateBegin: dateInterval.get('dateBegin'), dateEnd: dateInterval.get('dateEnd') };\r\n            this.model.isDirty = true;\r\n            this.show();\r\n        }.bind(this));\r\n\r\n    this.calendar = new nsGmx.CalendarWidget({\r\n        dateInterval: dateInterval,\r\n        name: 'searchInterval',\r\n        container: calendar,\r\n        dateMin: new Date(0, 0, 0),\r\n        dateMax: new Date(3015, 1, 1),\r\n        dateFormat: 'dd.mm.yy',\r\n        minimized: false,\r\n        showSwitcher: false,\r\n        dateBegin: new Date(),\r\n        dateEnd: new Date(2000, 10, 10),\r\n        //buttonImage: 'img/calendar.png'\r\n    })\r\n\r\n    let td = calendar.find('tr:nth-of-type(1) td');\r\n    td.eq(1).after('<td style=\"font-weight:bold\">&nbsp;&nbsp;&ndash;&nbsp;&nbsp;</td>');\r\n    td.eq(td.length - 1).after('<td>&nbsp;&nbsp;<img class=\"default_date\" style=\"cursor:pointer\" title=\"сегодня\" src=\"plugins/AIS/AISSearch/svg/calendar.svg\"></td>');\r\n\r\n    calendar.find('.default_date').on('click', () => {\r\n        let db = nsGmx.DateInterval.getUTCDayBoundary(new Date());\r\n        this.calendar.getDateInterval().set('dateBegin', db.dateBegin);\r\n        this.calendar.getDateInterval().set('dateEnd', db.dateEnd);\r\n        nsGmx.widgets.commonCalendar.setDateInterval(db.dateBegin, db.dateEnd);\r\n    })\r\n\r\n    //sidebarControl && sidebarControl.on('closing', ()=>calendar.reset())\r\n    this.frame.on('click', ((e) => {\r\n        if (e.target.classList.toString().search(/CalendarWidget/) < 0) {\r\n            this.calendar.reset()\r\n        }\r\n        suggestions.hide();\r\n    }).bind(this));\r\n\r\n    this.frame.find('.time .utc,.local').click((e => {\r\n        let trg = $(e.currentTarget);\r\n        if (!trg.is('.on')) {\r\n            this.frame.find('.time span').removeClass(\"on\");\r\n            trg.addClass('on')\r\n            if (trg.is('.utc')) {\r\n                this.frame.find('.utc_time').show();\r\n                this.frame.find('.local_time').hide();\r\n                this.frame.find('.utc_date').show();\r\n                this.frame.find('.local_date').hide();\r\n            }\r\n            else {\r\n                this.frame.find('.utc_time').hide();\r\n                this.frame.find('.local_time').show();\r\n                this.frame.find('.utc_date').hide();\r\n                this.frame.find('.local_date').show();\r\n            }\r\n        }\r\n\r\n    }).bind(this));\r\n\r\n    this.searchInput = this.frame.find('.filter input');\r\n\r\n    let searchBut = this.frame.find('.filter .search'),\r\n        removeBut = this.frame.find('.filter .remove'),\r\n        delay,\r\n        suggestions = this.frame.find('.suggestions'),\r\n        suggestionsCount = 5,\r\n        suggestionsFrame = { first: 0, current: 0, last: suggestionsCount - 1 },\r\n        found = { values: [] },\r\n        searchDone = function () {\r\n            if (found.values.length > 0) {\r\n                _searchString = found.values[suggestionsFrame.current].vessel_name;\r\n                this.searchInput.val(_searchString);\r\n                let v = found.values[suggestionsFrame.current];\r\n                if (!this.vessel || this.vessel.mmsi != v.mmsi || !this.frame.find('.ais_positions_date')[0]) {\r\n                    this.vessel = v;\r\n                    this.show();\r\n                }\r\n            }\r\n            else {\r\n                _clean.call(this);\r\n            }\r\n        },\r\n        doSearch = function () {\r\n            //console.log(_searchString)\r\n            new Promise(function (resolve, reject) {\r\n                this.model.searcher.searchString(_searchString, true, function (response) {\r\n                    if (response.Status.toLowerCase() == \"ok\") {\r\n                        found = {\r\n                            values: response.Result.values.map(function (v) {\r\n                                return { vessel_name: v[0], mmsi: v[1], imo: v[2], ts_pos_utc: v[3], ts_pos_org: v[3], vessel_type: v[4] }\r\n                            })\r\n                        };\r\n                        resolve();\r\n                    }\r\n                    else {\r\n                        reject(response);\r\n                    }\r\n                })\r\n            }.bind(this))\r\n                .then(function () { // SUCCEEDED\r\n                    if (found.values.length == 0) {\r\n                        suggestions.hide();\r\n                        return;\r\n                    }\r\n\r\n                    let scrollCont = suggestions.find('.mCSB_container'),\r\n                        content = $(Handlebars.compile(\r\n                            '{{#each values}}<div class=\"suggestion\" id=\"{{@index}}\">{{vessel_name}}<br><span>mmsi:{{mmsi}}, imo:{{imo}}</span></div>{{/each}}'\r\n                        )(found));\r\n                    if (!scrollCont[0])\r\n                        suggestions.html(content).mCustomScrollbar();\r\n                    else\r\n                        $(scrollCont).html(content);\r\n\r\n                    let suggestion = suggestions.find('.suggestion');\r\n                    if (!suggestions.is(':visible')) {\r\n                        let cr = this.frame.find('.filter')[0].getBoundingClientRect();\r\n                        suggestions.show();\r\n                        suggestions.offset({ left: cr.left, top: cr.bottom - 3 });\r\n                        suggestions.outerWidth(cr.width)\r\n                    }\r\n\r\n                    suggestions.innerHeight(suggestion[0].getBoundingClientRect().height *\r\n                        (found.values.length > suggestionsCount ? suggestionsCount : found.values.length));\r\n                    suggestionsFrame = { first: 0, current: 0, last: suggestionsCount - 1 };\r\n                    suggestion.eq(suggestionsFrame.current).addClass('selected');\r\n                    suggestion.click(e => {\r\n                        suggestionsFrame.current = e.currentTarget.id;\r\n                        searchDone.call(this);\r\n                    });\r\n                    //console.log(\"doFilter2 \"+_searchString)\r\n                }.bind(this),\r\n                function (response) { // FAILED\r\n                    console.log(response);\r\n                });\r\n        };\r\n    removeBut.click(function (e) {\r\n        this.searchInput.val('');\r\n        this.searchInput.focus();\r\n        clearTimeout(delay)\r\n        removeBut.hide();\r\n        searchBut.show();\r\n        suggestions.hide();\r\n        _clean.call(this);\r\n        //nsGmx.leafletMap.removeLayer(highlight);\r\n    }.bind(this));\r\n    this.searchInput.keydown(function (e) {\r\n        let suggestion = suggestions.find('.suggestion.selected');\r\n        if (suggestions.is(':visible')) {\r\n            if (e.keyCode == 38) {\r\n                if (suggestionsFrame.current > 0) {\r\n                    suggestionsFrame.current--;\r\n                    suggestion.removeClass('selected').prev().addClass('selected');\r\n                }\r\n            }\r\n            else if (e.keyCode == 40) {\r\n                if (suggestionsFrame.current < found.values.length - 1) {\r\n                    suggestionsFrame.current++;\r\n                    suggestion.removeClass('selected').next().addClass('selected');\r\n                }\r\n            }\r\n            if (suggestionsFrame.last < suggestionsFrame.current) {\r\n                suggestionsFrame.last = suggestionsFrame.current;\r\n                suggestionsFrame.first = suggestionsFrame.last - (suggestionsCount - 1);\r\n            }\r\n            if (suggestionsFrame.first > suggestionsFrame.current) {\r\n                suggestionsFrame.first = suggestionsFrame.current;\r\n                suggestionsFrame.last = suggestionsFrame.first + (suggestionsCount - 1);\r\n            }\r\n            suggestions.mCustomScrollbar(\"scrollTo\", \"#\" + suggestionsFrame.first, { scrollInertia: 0 });\r\n        }\r\n    });\r\n\r\n    let prepareSearchInput = function (temp, keyCode) {\r\n        removeBut.show();\r\n        searchBut.hide();\r\n        if (_searchString == temp && (!keyCode || keyCode != 13))\r\n            return false;\r\n        _searchString = temp;\r\n        clearTimeout(delay);\r\n        if (_searchString == \"\") {\r\n            removeBut.click();\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    this.searchInput.keyup(function (e) {\r\n        let temp = (this.searchInput.val() || \"\")\r\n            .replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n        if (!prepareSearchInput(temp, e.keyCode))\r\n            return;\r\n        if (e.keyCode == 13) {\r\n            suggestions.hide();\r\n            searchDone.call(this);\r\n        }\r\n        else\r\n            delay = setTimeout((() => {\r\n                doSearch.call(this)\r\n            }).bind(this), 200);\r\n        //nsGmx.leafletMap.removeLayer(highlight);\r\n    }.bind(this));\r\n    this.searchInput.on(\"paste\", function (e) {\r\n        let temp = ((e.originalEvent || window.clipboardData).clipboardData.getData('text') || \"\")\r\n            .replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n        if (!prepareSearchInput(temp))\r\n            return;\r\n        delay = setTimeout((() => {\r\n            doSearch.call(this)\r\n        }).bind(this), 200);\r\n    }.bind(this));\r\n};\r\n\r\nDbSearchView.prototype = Object.create(BaseView.prototype);\r\n\r\nlet _clean = function () {\r\n    this.frame.find('.open_positions').off('click');\r\n    this.frame.find('.ais_positions_date .track input[type=\"checkbox\"]').off('click');\r\n    let scrollCont = this.container.find('.mCSB_container')\r\n    if (scrollCont[0])\r\n        scrollCont.empty();\r\n    else\r\n        this.container.empty();\r\n    //console.log(\"EMPTY ON SELF.CLEAN \"+this)\r\n    this.startScreen.css({ visibility: \"hidden\" });\r\n    nsGmx.leafletMap.removeLayer(_highlight);\r\n};\r\n\r\nDbSearchView.prototype.inProgress = function (state) {\r\n    let progress = this.frame.find('.refresh div');\r\n    if (state)\r\n        progress.show();\r\n    else\r\n        progress.hide();\r\n};\r\n\r\nlet _vi_template = '<table class=\"ais_positions\">' +\r\n    '{{#each positions}}' +\r\n    '<tr>' +\r\n    '<td><img class=\"show_info\" id=\"show_info{{@index}}\" src=\"plugins/AIS/AISSearch/svg/info.svg\"></td>' +\r\n    '<td><span class=\"utc_time\">{{tm_pos_utc}}</span><span class=\"local_time\">{{tm_pos_loc}}</span></td>' +\r\n    '<td><span class=\"utc_date\">{{dt_pos_utc}}</span><span class=\"local_date\">{{dt_pos_loc}}</span></td>' +\r\n    '<td><img src=\"{{icon}}\" class=\"rotateimg{{icon_rot}}\"></td>' +\r\n    '<td><img src=\"{{source}}\"></td>' +\r\n    '<td>{{longitude}}&nbsp;&nbsp;{{latitude}}</td>' +\r\n    '<td><div class=\"show_pos\" id=\"show_pos{{@index}}\"><img src=\"plugins/AIS/AISSearch/svg/center.svg\"></div></td>' +\r\n    '</tr>' +\r\n    '<tr><td colspan=\"7\" class=\"more\"><hr><div class=\"vi_more\">' +\r\n\r\n    '<div class=\"c1\">COG | SOG:</div><div class=\"c2\">&nbsp;{{cog}} {{#if cog_sog}}&nbsp;{{/if}} {{sog}}</div>' +\r\n    '<div class=\"c1\">HDG | ROT:</div><div class=\"c2\">&nbsp;{{heading}} {{#if heading_rot}}&nbsp;{{/if}} {{rot}}</div>' +\r\n    '<div class=\"c1\">Осадка:</div><div class=\"c2\">&nbsp;{{draught}}</div>' +\r\n    '<div class=\"c1\">Назначение:</div><div class=\"c2\">&nbsp;{{destination}}</div>' +\r\n    '<div class=\"c1\">Статус:</div><div class=\"c2\">&nbsp;{{nav_status}}</div>' +\r\n    '<div class=\"c1\">ETA:</div><div class=\"c2\">&nbsp;<span class=\"utc_time\">{{eta_utc}}</span><span class=\"local_time\">{{eta_loc}}</span></div>' +\r\n\r\n    '</div></td></tr>' +\r\n    '{{/each}}' +\r\n    '</table>';\r\n\r\nlet _prepare_history = function(){   \r\n//console.log(_tools.displaingTrack)     \r\n    if (this.model.data.vessels.length>0 && _tools.displaingTrack && \r\n        _tools.displaingTrack.mmsi==this.model.data.vessels[0].positions[0].mmsi){            \r\n        this.frame.find('.ais_positions_date').each((i, el) => {\r\n            if (_tools.displaingTrack.dates) {\r\n                let modelDate = new Date(this.model.data.vessels[i].positions[0].ts_pos_org * 1000).setUTCHours(0, 0, 0, 0)\r\n                for (let j = 0; j < _tools.displaingTrack.dates.list.length; ++j) {\r\n                    let trackDate = _tools.displaingTrack.dates.list[j];\r\n                    if (modelDate === trackDate.getTime()) {\r\n                        $(el).find('.track input')[0].checked = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            else\r\n                $(el).find('.track input')[0].checked = true;\r\n        });\r\n    }\r\n}\r\n\r\nDbSearchView.prototype.repaint = function () {\r\n    _clean.call(this);\r\n    BaseView.prototype.repaint.apply(this, arguments); \r\n\r\n    _prepare_history.call(this);\r\n\r\n    let open_pos = this.frame.find('.open_positions');\r\n    open_pos.each((ind, elm) => {\r\n        $(elm).click(((e) => {\r\n            let icon = $(e.target),\r\n                vi_cont = this.frame.find('#voyage_info' + ind);\r\n\r\n            if (icon.is('.icon-down-open')) {\r\n                icon.removeClass('icon-down-open').addClass('.icon-right-open');\r\n                vi_cont.find('.ais_positions td[class!=\"more\"]').off('click')\r\n                vi_cont.empty();\r\n            }\r\n            else {\r\n                icon.addClass('icon-down-open').removeClass('.icon-right-open');\r\n                vi_cont.html(Handlebars.compile(_vi_template)(this.model.data.vessels[ind]));\r\n                if (this.frame.find('.time .local').is('.on')) {\r\n                    vi_cont.find('.utc_time').hide();\r\n                    vi_cont.find('.local_time').show();\r\n                    vi_cont.find('.utc_date').hide();\r\n                    vi_cont.find('.local_date').show();\r\n                }\r\n                vi_cont.find('.ais_positions td[class!=\"more\"]').click((e) => {\r\n                    let td = $(e.currentTarget);\r\n                    if (td.is('.active')) {\r\n                        td.removeClass('active')\r\n                        td.siblings().removeClass('active')\r\n                        td.parent().next().find('td').removeClass('active')\r\n                    }\r\n                    else {\r\n                        td.addClass('active')\r\n                        td.siblings().addClass('active')\r\n                        td.parent().next().find('td').addClass('active')\r\n                    }\r\n                });\r\n                let infoDialog = this.infoDialogView,\r\n                    vessel = this.vessel;\r\n                vi_cont.find('.ais_positions .show_info').click(((e) => {\r\n                    let i = e.currentTarget.id.replace(/show_info/, \"\"),\r\n                        position = this.model.data.vessels[ind].positions[i];\r\n                    position.vessel_name = vessel.vessel_name;\r\n                    position.imo = vessel.imo;\r\n                    position.latitude = position.ymax;\r\n                    position.longitude = position.xmax;\r\n                    //console.log(vessel)\r\n                    //console.log(position)\r\n                    infoDialog.show(position, false);\r\n                    e.stopPropagation();\r\n                }).bind(this));\r\n                vi_cont.find('.ais_positions .show_pos').click(((e) => {\r\n                    //showPosition\r\n                    let i = e.currentTarget.id.replace(/show_pos/, \"\"),\r\n                        vessel = this.model.data.vessels[ind].positions[parseInt(i)];\r\n                    this.positionMap(vessel, this.calendar.getDateInterval());\r\n                    this.frame.find('.track input')[ind].checked = true;                    \r\n                    let dates = getDates.call(this);\r\n                    this.showTrack({mmsi:this.model.data.vessels[0].positions[0].mmsi}, dates);\r\n                    e.stopPropagation();\r\n                }).bind(this));\r\n            }\r\n        }).bind(this))\r\n    })\r\n\r\n    let getDates = function(){\r\n        let dates = [];\r\n        this.frame.find('.ais_positions_date .track').each((i, el)=>{            \r\n            if ($('input', el)[0].checked)\r\n                dates.push(\r\n                    new Date(new Date(1000*this.model.data.vessels[i].positions[0].ts_pos_utc).setUTCHours(0,0,0,0))\r\n                );\r\n        })\r\n        return dates;\r\n    };\r\n\r\n    this.frame.find('.ais_positions_date .track input[type=\"checkbox\"]').click(((e)=>{\r\n        let calendarInterval = this.calendar.getDateInterval(),\r\n        interval = {dateBegin:calendarInterval.get(\"dateBegin\"), dateEnd:calendarInterval.get(\"dateEnd\")};\r\n        nsGmx.widgets.commonCalendar.setDateInterval(interval.dateBegin, interval.dateEnd);\r\n        let dates = getDates.call(this);\r\n        this.showTrack({mmsi:this.model.data.vessels[0].positions[0].mmsi}, dates);\r\n    }).bind(this));\r\n\r\n    if (this.model.data.vessels.length == 1)\r\n        open_pos.eq(0).click();\r\n\r\n    if (this.vessel.lastPosition)\r\n        this.positionMap(this.vessel, this.calendar.getDateInterval());\r\n};\r\n\r\n\r\nObject.defineProperty(DbSearchView.prototype, \"vessel\", {\r\n    get() {\r\n        return this.model.vessel;\r\n    },\r\n    set(v) {\r\n        _setSearchInputValue.call(this, v.vessel_name);\r\n\r\n        let positionDate = nsGmx.DateInterval.getUTCDayBoundary(new Date(v.ts_pos_org * 1000));\r\n        this.model.vessel = null;\r\n        let checkInterval = this.calendar.getDateInterval();\r\n// console.log(positionDate.dateBegin + '<' + checkInterval.get('dateBegin'))\r\n// console.log(checkInterval.get('dateEnd') + '<' + positionDate.dateEnd)\r\n        if (positionDate.dateBegin < checkInterval.get('dateBegin') || checkInterval.get('dateEnd') < positionDate.dateEnd){\r\n            this.calendar.getDateInterval().set('dateBegin', positionDate.dateBegin);\r\n            this.calendar.getDateInterval().set('dateEnd', positionDate.dateEnd);      \r\n            this.model.historyInterval = { dateBegin: positionDate.dateBegin, dateEnd: positionDate.dateEnd };\r\n        }\r\n        else\r\n            this.model.historyInterval = { dateBegin: checkInterval.get('dateBegin'), dateEnd: checkInterval.get('dateEnd') };\r\n        this.model.vessel = v;\r\n        this.model.isDirty = true;\r\n    }\r\n});\r\n\r\nDbSearchView.prototype.show = function () {\r\n    this.frame.show();\r\n    this.searchInput.focus();\r\n    if (!this.vessel)\r\n        return;\r\n    BaseView.prototype.show.apply(this, arguments);\r\n};\r\n\r\nDbSearchView.prototype.hide = function () {\r\n    //console.log('hide DbSearchView')\r\n    BaseView.prototype.hide.apply(this, arguments);\r\n};\r\n\r\nDbSearchView.prototype.showTrack = function (vessel, dates) {\r\n    let dlg = $('.ui-dialog:contains(\"' + vessel.mmsi + '\")');\r\n    $('.showtrack').attr('title', _gtxt('AISSearch2.show_track'))\r\n        .removeClass('ais active');\r\n    if (dlg[0]) \r\n        dlg.find('.showtrack').attr('title', _gtxt('AISSearch2.hide_track'))\r\n        .addClass('ais active')\r\n    _tools.showTrack([vessel.mmsi], dates);\r\n};\r\n\r\nDbSearchView.prototype.positionMap = function (vessel, interval) {\r\n    if (interval) {    \r\n        interval = {dateBegin:interval.get(\"dateBegin\"), dateEnd:interval.get(\"dateEnd\")};\r\n        nsGmx.widgets.commonCalendar.setDateInterval(interval.dateBegin, interval.dateEnd);\r\n    }\r\n\r\n    let xmin = vessel.xmin ? vessel.xmin : vessel.longitude,\r\n        xmax = vessel.xmax ? vessel.xmax : vessel.longitude,\r\n        ymin = vessel.ymin ? vessel.ymin : vessel.latitude,\r\n        ymax = vessel.ymax ? vessel.ymax : vessel.latitude,\r\n        zoom = nsGmx.leafletMap.getZoom();\r\n    nsGmx.leafletMap.fitBounds([\r\n        [ymin, xmin],\r\n        [ymax, xmax]\r\n    ], {\r\n            maxZoom: (zoom < 9 ? 12 : zoom),\r\n            animate: false\r\n        });\r\n    nsGmx.leafletMap.removeLayer(_highlight);\r\n    _highlight.vessel = vessel;\r\n    _highlight.setLatLng([ymax, xmax]).addTo(nsGmx.leafletMap);\r\n};\r\n\r\nmodule.exports = DbSearchView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/DbSearchView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/DbSearch.css\n// module id = 14\n// module chunks = 0","module.exports = function (aisLayerSearcher) {\r\n    let _actualUpdate,\r\n        _round = function (d, p) {\r\n            let isNeg = d < 0,\r\n                power = Math.pow(10, p)\r\n            return d ? ((isNeg ? -1 : 1) * (Math.round((isNeg ? d = -d : d) * power) / power)) : d\r\n        },\r\n        _addUnit = function (v, u) {\r\n            return v != null && v != \"\" ? v + u : \"\";\r\n        },\r\n        _toDd = function (D, lng) {\r\n            let dir = D < 0 ? lng ? 'W' : 'S' : lng ? 'E' : 'N',\r\n                deg = Math.round((D < 0 ? D = -D : D) * 1000000) / 1000000\r\n            return deg.toFixed(2) + \" \"//\"°\"\r\n                + dir\r\n        },\r\n        _formatPosition = function (vessel) {\r\n            vessel.cog_sog = vessel.cog && vessel.sog\r\n            vessel.heading_rot = vessel.heading && vessel.rot\r\n            vessel.x_y = vessel.longitude && vessel.latitude\r\n            let d = new Date(vessel.ts_pos_utc * 1000)\r\n            let eta = new Date(vessel.ts_eta * 1000)\r\n            vessel.tm_pos_utc = _formatTime(d);\r\n            vessel.tm_pos_loc = _formatTime(d, true);\r\n            vessel.dt_pos_utc = _formatDate(d);\r\n            vessel.dt_pos_loc = _formatDate(d, true);\r\n            vessel.eta_utc = aisLayerSearcher.formatDateTime(eta);\r\n            vessel.eta_loc = aisLayerSearcher.formatDateTime(eta, true);\r\n            vessel.icon_rot = Math.round(vessel.cog/15)*15;\r\n            vessel.cog = _addUnit(_round(vessel.cog, 5), \"°\");\r\n            vessel.rot = _addUnit(_round(vessel.rot, 5), \"°/мин\");\r\n            vessel.heading = _addUnit(_round(vessel.heading, 5), \"°\");\r\n            vessel.draught = _addUnit(_round(vessel.draught, 5), \" м\");\r\n            //vessel.length = _addUnit(vessel.length, \" м\");\r\n            //vessel.width = _addUnit(vessel.width, \" м\");\r\n            vessel.source = 'plugins/AIS/AISSearch/svg/satellite-ais.svg'//vessel.source=='T-AIS'?_gtxt('AISSearch2.tais'):_gtxt('AISSearch2.sais');\r\n            \r\n            vessel.xmin = vessel.longitude;\r\n            vessel.xmax = vessel.longitude;           \r\n            vessel.ymin = vessel.latitude;\r\n            vessel.ymax = vessel.latitude; \r\n\r\n            vessel.longitude = _toDd(vessel.longitude, true);\r\n            vessel.latitude = _toDd(vessel.latitude);\r\n            aisLayerSearcher.placeVesselTypeIcon(vessel);\r\n            vessel.sog = _addUnit(_round(vessel.sog, 5), \" уз\");\r\n\r\n            return vessel;\r\n        },\r\n        _formatTime = function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleTimeString();\r\n        },\r\n        _formatDate = function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleDateString();\r\n        }\r\n    return {\r\n        searcher: aisLayerSearcher,\r\n        filterString: \"\",\r\n        isDirty: false,\r\n        load: function (actualUpdate) {\r\n            if (!this.isDirty)\r\n                return Promise.resolve();\r\n            //return new Promise((resolve)=>setTimeout(resolve, 1000))\r\n            //console.log('LOAD ' + _historyInterval['dateBegin'].toUTCString() + ' ' + _historyInterval['dateEnd'].toUTCString())     \r\n            var _this = this;\r\n            return new Promise((resolve) => {\r\n                aisLayerSearcher.searchPositionsAgg([_this.vessel.mmsi], _this.historyInterval, function (response) {\r\n                    if (parseResponse(response)) {\r\n                        let position, positions = [],\r\n                            fields = response.Result.fields,\r\n                            groups = response.Result.values.reduce((p, c) => {\r\n                                let obj = {}, d;\r\n                                for (var j = 0; j < fields.length; ++j) {\r\n                                    obj[fields[j]] = c[j];\r\n                                    if (fields[j] == 'ts_pos_utc'){\r\n                                        let dt = c[j], t = dt - dt % (24 * 3600);\r\n                                        d = new Date(t * 1000);\r\n                                        obj['ts_pos_org'] = c[j];\r\n                                    }\r\n                                }\r\n                                if (p[d]) {\r\n                                    p[d].positions.push(_formatPosition(obj));\r\n                                    p[d].count = p[d].count + 1;\r\n                                }\r\n                                else\r\n                                    p[d] = { ts_pos_utc: _formatDate(d), positions: [_formatPosition(obj)], count: 1 };\r\n                                return p;\r\n                            }, {});\r\n                        let counter = 0;\r\n                        for (var k in groups) {\r\n                            groups[k][\"n\"] = counter++;\r\n                            positions.push(groups[k]);\r\n                        }\r\n                        /*\r\n                        positions.sort((a, b) => {\r\n                            if (a.ts_pos_org > b.ts_pos_org) return -1\r\n                            if (a.ts_pos_org < b.ts_pos_org) return 1;\r\n                            return 0;\r\n                        })\r\n                        */\r\n                        resolve({ Status: \"ok\", Result: { values: positions } });\r\n                    }\r\n                    else\r\n                        resolve(response)\r\n                })\r\n            })\r\n                .then(function (response) {\r\n                    //console.log(response)       \r\n                    _this.isDirty = false;\r\n                    if (response.Status.toLowerCase() == \"ok\") {\r\n                        _this.data = { vessels: response.Result.values }\r\n                        return Promise.resolve();\r\n                    }\r\n                    else {\r\n                        return Promise.reject(response);\r\n                    }\r\n                });\r\n        },\r\n        update: function () {\r\n            if (!this.isDirty)\r\n                return;\r\n\r\n            _actualUpdate = new Date().getTime();\r\n            let _this = this,\r\n                actualUpdate = _actualUpdate;\r\n            this.view.inProgress(true);\r\n            //this.filterString&&console.log(this.filterString+\" \"+this.filterString.search(/\\r$/))\r\n            //this.filterString&&console.log(this.filterString.replace(/^\\s+/, \"\").replace(/\\s+\\r*$/, \"\")!=\"\")            \r\n\r\n            this.load(actualUpdate).then(function () {\r\n                //console.log(\"LOADED \"+(new Date().getTime()-_this._actualUpdate)+\"ms\")\r\n                //console.log(\"3>\"+new Date(_this._actualUpdate))\r\n                //console.log(\"4>\"+new Date(actualUpdate))\r\n                if (_actualUpdate == actualUpdate) {\r\n//_this.data.vessels && (_this.data.vessels.length>0) && console.log(_this.data.vessels[0].positions[0])                    \r\n                    _this.view.inProgress(false);\r\n                    _this.view.repaint();\r\n                }\r\n            }, function (json) {\r\n                _this.dataSrc = null;\r\n                console.log(json)\r\n                if (json.Status.toLowerCase() == \"auth\" ||\r\n                    (json.ErrorInfo && json.ErrorInfo.some &&\r\n                        json.ErrorInfo.some(function (r) { return r.Status.toLowerCase() == \"auth\" })) ||\r\n                    (json.ErrorInfo && json.ErrorInfo.ErrorMessage.search(/not access/i) != -1))\r\n                    _this.data = { msg: _gtxt(\"AISSearch2.auth\"), vessels: [] };\r\n                else {\r\n                    //_this.data = {msg:[{txt:\"!!!\"}], vessels:[]};\r\n                    console.log(json);\r\n                }\r\n                _this.view.inProgress(false);\r\n                _this.view.repaint();\r\n            });\r\n        }\r\n    };\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/Models/DbSearchModel.js","const displayInfoDialog = require('./infodialog.js'),\r\n      Polyfill = require('../Polyfill'),\r\n      VesselInfoScreen = require('./VesselInfoScreen');\r\n\r\nlet infoDialogCascade = [],\r\n    allIinfoDialogs = [],\r\n    vesselInfoScreen;\r\n\r\nmodule.exports = function ({\r\n    tools,\r\n    aisLayerSearcher: aisLayerSearcher,\r\n    modulePath: modulePath,\r\n    aisView: aisView, myFleetMembersView: myFleetMembersView }) {\r\n\r\n    vesselInfoScreen  = new VesselInfoScreen({modulePath: modulePath, aisServices: aisLayerSearcher.aisServices});\r\n    const _showPosition = function(vessel){ \r\n        aisView.vessel = vessel;\r\n        if (aisView.tab)\r\n        if (aisView.tab.is('.active'))\r\n            aisView.show();\r\n        else\r\n            aisView.tab.click();    \r\n    }, \r\n    _updateView = function (displayed, vessel, getmore){\r\n        if (displayed.vessel.ts_pos_utc!=vessel.ts_pos_utc){\r\n            $(displayed.dialog).dialog(\"close\")\r\n            return true;\r\n        }\r\n        else\r\n            return false;\r\n    };\r\n    return {\r\n        showPosition: function(vessel){  \r\n            _showPosition(vessel);\r\n            aisView.showTrack(vessel);\r\n        },\r\n        show: function (vessel, getmore) {\r\n            let ind = Polyfill.findIndex(allIinfoDialogs, function (d) { \r\n                return d.vessel.imo == vessel.imo && d.vessel.mmsi == vessel.mmsi \r\n            }),\r\n            isNew = true,\r\n            dialogOffset;\r\n            if (ind >= 0) {\r\n                isNew = false;\r\n                let displayed = allIinfoDialogs[ind];\r\n                dialogOffset = $(displayed.dialog).parent().offset();\r\n                ind = Polyfill.findIndex(infoDialogCascade, function (d) { return d.id == displayed.dialog.id })\r\n                if(!_updateView(displayed, vessel)){\r\n                    $(displayed.dialog).parent().insertAfter($('.ui-dialog').eq($('.ui-dialog').length - 1));\r\n                    return;\r\n                }\r\n            }\r\n\r\n            let dialog = displayInfoDialog({\r\n                vessel: vessel,\r\n                getmore: getmore,\r\n                displaingTrack: tools.displaingTrack,\r\n                closeFunc: function (event) {\r\n                    let ind = Polyfill.findIndex(infoDialogCascade, function (d) { return d.id == dialog.id });\r\n                    if (ind >= 0)\r\n                        infoDialogCascade.splice(ind, 1);\r\n                    ind = Polyfill.findIndex(allIinfoDialogs, function (d) { return d.dialog.id == dialog.id });\r\n                    if (ind >= 0)\r\n                        allIinfoDialogs.splice(ind, 1);\r\n                },\r\n                aisLayerSearcher: aisLayerSearcher,\r\n                modulePath:modulePath, \r\n                aisView: aisView,\r\n                myFleetMembersView: myFleetMembersView\r\n            },\r\n                {\r\n                    openVesselInfoScreen: vesselInfoScreen.open,\r\n                    showTrack: tools.showTrack,\r\n                    showPosition: _showPosition\r\n                })\r\n\r\n            if (!dialogOffset && infoDialogCascade.length > 0) {\r\n                let pos = $(infoDialogCascade[infoDialogCascade.length - 1]).parent().position();\r\n                dialogOffset = {left:pos.left - 10, top:pos.top + 10};\r\n            }\r\n            if (dialogOffset)\r\n                $(dialog).dialog(\"option\", \"position\", [dialogOffset.left, dialogOffset.top]);\r\n            if (ind >= 0)\r\n                infoDialogCascade.splice(ind, 0, dialog);\r\n            else if(isNew)\r\n                infoDialogCascade.push(dialog);\r\n\r\n            allIinfoDialogs.push({ vessel: vessel, dialog: dialog });\r\n            $(dialog).on(\"dialogdragstop\", function (event, ui) {\r\n                var ind = Polyfill.findIndex(infoDialogCascade, function (d) { return d.id == dialog.id });\r\n                if (ind >= 0)\r\n                    infoDialogCascade.splice(ind, 1);\r\n            });\r\n\r\n        }\r\n    };\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/Views/InfoDialogView.js","require(\"./infodialog.css\")\r\n\r\nlet addUnit = function (v, u) {\r\n\treturn v != null && v != \"\" ? v + u : \"\";\r\n},\r\n\tformatDate,\r\n\tformatDateTime,\r\n\tround = function (d, p) {\r\n\t\tlet isNeg = d < 0,\r\n\t\t\tpower = Math.pow(10, p)\r\n\t\treturn d ? ((isNeg ? -1 : 1) * (Math.round((isNeg ? d = -d : d) * power) / power)) : d\r\n\t},\r\n\tformatVessel = function (vessel) {\r\n\t\tlet d = new Date(vessel.ts_pos_utc * 1000);\r\n\t\tvessel.ts_pos_org = vessel.ts_pos_utc;\r\n\t\tvessel.dt_pos_utc = formatDate(d);\r\n\t\tvessel.ts_pos_utc = formatDateTime(d);\r\n\t\tvessel.ts_pos_loc = \"<br><span class='local'>\" + formatDateTime(d, true) + \"</span>\";\r\n\t\tvessel.ts_eta = vessel.ts_eta ? formatDateTime(new Date(vessel.ts_eta * 1000)) : \"\";\r\n\t\tvessel.cog = !isNaN(vessel.cog)?addUnit(round(vessel.cog, 5), \"°\"):vessel.cog;\r\n\t\tvessel.sog = !isNaN(vessel.sog)?addUnit(round(vessel.sog, 5), \" уз\"):vessel.sog;\r\n\t\tvessel.rot = !isNaN(vessel.rot)?addUnit(round(vessel.rot, 5), \"°/мин\"):vessel.rot;\r\n\t\tvessel.heading = !isNaN(vessel.heading)?addUnit(round(vessel.heading, 5), \"°\"):vessel.heading;\r\n\t\tvessel.draught = !isNaN(vessel.draught)?addUnit(round(vessel.draught, 5), \" м\"):vessel.draught;\r\n\t\tvessel.length = !isNaN(vessel.length)?addUnit(vessel.length, \" м\"):vessel.length;\r\n\t\tvessel.width = !isNaN(vessel.width)?addUnit(vessel.width, \" м\"):vessel.width;\r\n\t\tvessel.source = vessel.source == 'T-AIS' ? _gtxt('AISSearch2.tais') : _gtxt('AISSearch2.sais');\r\n\t\treturn vessel;\r\n\t},\r\n\ttoDd = function (D, lng) {\r\n\t\tlet dir = D < 0 ? lng ? 'W' : 'S' : lng ? 'E' : 'N',\r\n\t\t\tdeg = Math.round((D < 0 ? D = -D : D) * 1000000) / 1000000\r\n\t\treturn deg + \"°\" + dir\r\n\t},\r\n\tddToDms = function (D, lng) {\r\n\t\tlet dms = {\r\n\t\t\tdir: D < 0 ? lng ? 'W' : 'S' : lng ? 'E' : 'N',\r\n\t\t\tdeg: 0 | (D < 0 ? D = -D : D),\r\n\t\t\tmin: 0 | D % 1 * 60,\r\n\t\t\tsec: (0 | D * 60 % 1 * 6000) / 100\r\n\t\t};\r\n\t\treturn dms.deg + \"°\" + dms.min + \"'\" + dms.sec + \"\\\" \" + dms.dir\r\n\t}\r\n\r\nmodule.exports = function ({ vessel, closeFunc, aisLayerSearcher, getmore,\r\n\tmodulePath,\r\n\taisView,\r\n\tdisplaingTrack,\r\n\tmyFleetMembersView, aisPluginPanel }, commands) {\r\n\r\n\tformatDate = aisLayerSearcher.formatDate;\r\n\tformatDateTime = aisLayerSearcher.formatDateTime;\r\n\r\n\tlet myFleetMembersModel = myFleetMembersView.model,\r\n\t\tadd = myFleetMembersModel && myFleetMembersModel.findIndex(vessel) < 0\r\n\r\n\tlet canvas = $('<div class=\"ais_myfleet_dialog\"/>'),\r\n\t\tmenu = $('<div class=\"column1 menu\"></div>').appendTo(canvas),\r\n\t\tphoto = $('<div class=\"photo\"><div></div></div>').appendTo(menu),\r\n\t\tunderphoto = $('<div class=\"underphoto\"><div></div></div>').appendTo(menu),\r\n\t\tcontent = Handlebars.compile(\r\n\t\t\t'<div class=\"column2 content\">' +\r\n\t\t\t'</div>')(vessel),\r\n\t\tbuttons = $('<div class=\"column3 buttons\"></div>'),\r\n\t\tgifLoader = '<img src=\"img/progress.gif\">'\r\n\t//console.log(content);\r\n\r\n\tcanvas.append(content).append(buttons)\r\n\r\n\tlet searchInput = $('.leaflet-ext-search'),\r\n\t\tdialogW = 610, dialogH = 250,\r\n\t\tposX = searchInput.offset().left + searchInput.width() - dialogW,\r\n\t\tposY = searchInput.offset().top + searchInput.height() + 10,\r\n\t\tdialog = showDialog(vessel.vessel_name, canvas[0], { width: dialogW, height: dialogH, posX: posX, posY:posY, \r\n\t\tcloseFunc: closeFunc }),\r\n\t\tvessel2,\r\n\t\tmoreInfo = function (v) {\r\n\t\t\tlet smallShipIcon = '<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"14px\" height=\"14px\" viewBox=\"0 0 14 14\" style=\"margin-left: 10px\" xml:space=\"preserve\">' +\r\n\t\t\t\t'<g style=\"fill: #48aff1;\">' +\r\n\t\t\t\t'<path class=\"st0\" d=\"M13.4,11H0.6c-0.2,0-0.4,0.1-0.5,0.3c-0.1,0.2-0.1,0.4,0,0.6l1.2,1.8C1.4,13.9,1.6,14,1.8,14h9.9   c0.2,0,0.3-0.1,0.4-0.2l1.7-1.8c0.2-0.2,0.2-0.4,0.1-0.7C13.9,11.1,13.7,11,13.4,11z\"/>' +\r\n\t\t\t\t'<path class=\"st0\" d=\"M9.3,9.7h2.9c0.2,0,0.4-0.1,0.5-0.3c0.1-0.2,0.1-0.4,0-0.6L9.8,4.5C9.7,4.3,9.4,4.2,9.2,4.3   C8.9,4.4,8.7,4.6,8.7,4.9v4.3C8.7,9.5,9,9.7,9.3,9.7z\"/>' +\r\n\t\t\t\t'<path class=\"st0\" d=\"M1.2,9.7H7c0.3,0,0.6-0.3,0.6-0.6V0.6c0-0.3-0.2-0.5-0.4-0.6C6.9-0.1,6.7,0,6.5,0.3L0.7,8.8   C0.6,9,0.5,9.2,0.6,9.4C0.7,9.6,0.9,9.7,1.2,9.7z\"/>' +\r\n\t\t\t\t'</g>' +\r\n\t\t\t\t'</svg>',\r\n\t\t\t\tvesselPropTempl = '<div class=\"vessel_prop vname\"><b>{{vessel_name}}</b>' + smallShipIcon + '</div>' +\r\n\t\t\t\t\t'<div class=\"vessel_prop altvname\"><b>' + (vessel2.registry_name && vessel2.registry_name != vessel2.vessel_name ? vessel2.registry_name : '') + '&nbsp;</b></div>'\r\n\r\n\t\t\t$('.content', canvas).append(Handlebars.compile(\r\n\t\t\t\t'<div class=\"vessel_props1\">' + vesselPropTempl +\r\n\t\t\t\t'<table>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">Тип судна: </div></td><td><div class=\"vessel_prop value\">{{vessel_type}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">Флаг: </div></td><td><div class=\"vessel_prop value\">{{flag_country}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">IMO: </div></td><td><div class=\"vessel_prop value\">{{imo}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">MMSI: </div></td><td><div class=\"vessel_prop value mmsi\">{{mmsi}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">Позывной: </div></td><td><div class=\"vessel_prop value mmsi\">{{callsign}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.source\"}}: </div></td><td><div class=\"vessel_prop value\">{{source}}</div></td></tr>' +\r\n\t\t\t\t'</table>' +\r\n\t\t\t\t'</div>'\r\n\t\t\t)(v));\r\n\r\n\t\t\t$('.content', canvas).append(Handlebars.compile(\r\n\t\t\t\t'<div class=\"vessel_props2\">' + vesselPropTempl +\r\n\t\t\t\t'<table>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">COG | SOG: </div></td><td><div class=\"vessel_prop value\">{{cog}}&nbsp;&nbsp;&nbsp;{{sog}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">HDG | ROT: </div></td><td><div class=\"vessel_prop value\">{{heading}}&nbsp;&nbsp;&nbsp;{{rot}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.draught\"}}: </div></td><td><div class=\"vessel_prop value\">{{draught}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.destination\"}}: </div></td><td><div class=\"vessel_prop value\">{{destination}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.nav_status\"}}: </div></td><td><div class=\"vessel_prop value\">{{nav_status}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">ETA: </div></td><td><div class=\"vessel_prop value\">{{ts_eta}}</div></td></tr>' +\r\n\r\n\t\t\t\t'</div>'\r\n\t\t\t)(v));\r\n\r\n\t\t\t$(underphoto).append('<table><tr>' +\r\n\t\t\t\t'<td class=\"ais_refresh\"><svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" height=\"16\" width=\"16\"><g class=\"nc-icon-wrapper\" fill=\"#444444\"><polyline data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 15,16 7,16 7,13 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 15,18 17,16 15,14 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" data-stroke=\"none\" fill=\"#444444\" points=\"15,18 17,16 15,14 \" stroke-linejoin=\"miter\" stroke-linecap=\"square\" style=\"stroke: currentColor;fill: currentColor;\"/> <polyline data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 9,8 17,8 17,11 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\"9,6 7,8 9,10 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" data-stroke=\"none\" fill=\"#444444\" points=\"9,6 7,8 9,10 \" stroke-linejoin=\"miter\" stroke-linecap=\"square\" style=\"stroke: currentColor;fill: currentColor;\"/> <rect x=\"2\" y=\"1\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" width=\"20\" height=\"22\" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/></g></svg></td>' +\r\n\t\t\t\t'<td><div class=\"vessel_prop coordinates\"><span class=\"small\">' +\r\n\t\t\t\ttoDd(v.latitude, false) + ' ' + toDd(v.longitude, true) +\r\n\t\t\t\t'</small></div></td>' +\r\n\t\t\t\t'</tr></table>'\r\n\t\t\t);\r\n\r\n\t\t\tlet swap = \"<span class='small'>\" + ddToDms(v.latitude, false) + \" \" + ddToDms(v.longitude, true) + \"</span>\"\r\n\t\t\t$('.ais_refresh', underphoto).click((e) => {\r\n\t\t\t\tlet mi = $('.coordinates', underphoto),\r\n\t\t\t\t\tt = mi.html()\r\n\t\t\t\tmi.html(swap)\r\n\t\t\t\tswap = t\r\n\t\t\t})\r\n\r\n\t\t\t$('.vessel_props2', canvas).hide()\r\n\t\t\t$('.vessel_prop.vname svg', canvas).css('visibility', add ? 'hidden' : 'visible')\r\n\r\n\t\t}\r\n\r\n\t$(dialog).dialog({ resizable: false });\r\n\r\n\tif (!getmore) {\r\n\t\tvessel2 = $.extend({}, vessel);\r\n\t\tmoreInfo(formatVessel(vessel2));\r\n\t}\r\n\telse\r\n\t\taisLayerSearcher.searchNames([{ mmsi: vessel.mmsi, imo: vessel.imo }], function (response) {\r\n\t\t\tif (parseResponse(response)) {\r\n\t\t\t\tvessel2 = {};\r\n\t\t\t\tfor (var i = 0; i < response.Result.fields.length; ++i)\r\n\t\t\t\t\tvessel2[response.Result.fields[i]] = response.Result.values[0][i];\r\n\t\t\t\tmoreInfo(formatVessel(vessel2));\r\n\t\t\t\t$('.date', titlebar).html('<span class=\"utc\">' + vessel2.ts_pos_utc + ' UTC</span>' + vessel2.ts_pos_loc);\r\n\t\t\t\tif (typeof (getmore) == \"function\")\r\n\t\t\t\t\tgetmore(vessel2)\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tconsole.log(response)\r\n\t\t})\r\n\r\n\t// IMAGE\t\r\n\tlet scheme = document.location.href.replace(/^(https?:).+/, \"$1\");\r\n\r\n\t$('<img src=\"' + scheme + window.serverBase.replace(/^https?:/, \"\")+'plugins/ais/getphoto.ashx?mmsi=' + vessel.mmsi + '\">')\r\n\t.load(function () {\t\r\n\t\tif (this)\r\n\t\t\t$('div', photo).replaceWith(this);\t\r\n\t}).error(function(){\t\t\r\n\t\t$('<img src=\"' + scheme + '//photos.marinetraffic.com/ais/showphoto.aspx?size=thumb&mmsi=' + vessel.mmsi + '\">').load(function () {\r\n\t\t\t\tif (this)\r\n\t\t\t\t\t$('div', photo).replaceWith(this);\r\n\t\t});\r\n\t});\r\n\t\r\n\r\n\t// BUTTONS\r\n\tlet menubuttons = $('<div class=\"menubuttons\"></div>').appendTo(buttons)\r\n\r\n\tlet openpage = $('<div class=\"button openpage\" title=\"' + _gtxt('AISSearch2.show_info') + '\">' +\r\n\t\t'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">' +\r\n\t\t'<g class=\"nc-icon-wrapper\" style=\"fill:currentColor\">' +\r\n\t\t'<path d=\"M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 9h2V7h-2v2z\"/>' +\r\n\t\t'</g>' +\r\n\t\t'</svg>'\r\n\t\t+ '</div>')\r\n\t\t.appendTo(menubuttons)\r\n\t\t.on('click', () => commands.openVesselInfoScreen.call(null, vessel, vessel2));\r\n\r\n\tlet showpos = $('<div class=\"button showpos\" title=\"' + _gtxt('AISSearch2.show_pos') + '\">' +\r\n\t\t'<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" width=\"20\" height=\"20\"><g class=\"nc-icon-wrapper\" fill=\"#444444\"><polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 1,7 1,1 7,1 \" stroke-linejoin=\"miter\"/> <polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 17,1 23,1 23,7 \" stroke-linejoin=\"miter\"/> <polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 23,17 23,23 17,23 \" stroke-linejoin=\"miter\"/> <polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 7,23 1,23 1,17 \" stroke-linejoin=\"miter\"/> <rect style=\"stroke:currentColor\" x=\"8\" y=\"8\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" width=\"8\" height=\"8\" stroke-linejoin=\"miter\"/></g></svg>' +\r\n\t\t'</div>')\r\n\t\t.appendTo(menubuttons)\r\n\t\t.on('click', function () {\r\n\t\t\tif (!vessel.ts_pos_org)\r\n\t\t\t\tvessel.ts_pos_org = vessel.ts_pos_utc;\r\n\t\t\tvessel.lastPosition = true;\r\n\t\t\tcommands.showPosition(vessel);\r\n\t\t\t// if(showtrack.is('.active'))\r\n\t\t\t// \tcommands.showTrack.call(null, [vessel.mmsi])\r\n\t\t});\r\n\t//if (tracksLayer){\r\n\t// let templ = '<div class=\"button showtrack\" title=\"' + _gtxt('AISSearch2.show_track') + '\">' +\r\n\t// \t'<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" width=\"20\" height=\"20\"><g class=\"nc-icon-wrapper\" fill=\"#444444\"><path style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" d=\"M4,13V5 c0-2.209,1.791-4,4-4h0c2.209,0,4,1.791,4,4v14c0,2.209,1.791,4,4,4h0c2.209,0,4-1.791,4-4v-8\" stroke-linejoin=\"miter\"/> <circle style=\"stroke:currentColor\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" cx=\"20\" cy=\"4\" r=\"3\" stroke-linejoin=\"miter\"/> <circle style=\"stroke:currentColor\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" cx=\"4\" cy=\"20\" r=\"3\" stroke-linejoin=\"miter\"/></g></svg>' +\r\n\t// \t'</div>',\r\n\t\t// activateTrackBut = function () {\r\n\t\t// \t$('.showtrack').attr('title', _gtxt('AISSearch2.show_track'))\r\n\t\t// \t\t.removeClass('ais active');\r\n\t\t// \tshowtrack.attr('title', _gtxt('AISSearch2.hide_track'))\r\n\t\t// \t\t.addClass('ais active');\r\n\t\t// },\r\n\t\t// showtrack = $(templ)\r\n\t\t\t//.appendTo(menubuttons)\r\n\t\t\t// .on('click', function () {\r\n\t\t\t// \tif (showtrack.attr('title') != _gtxt('AISSearch2.hide_track')) {\r\n\t\t\t// \t\tcommands.showTrack.call(null, [vessel.mmsi])\r\n\t\t\t// \t\tactivateTrackBut();\r\n\t\t\t// \t}\r\n\t\t\t// \telse {\r\n\t\t\t// \t\t$('.showtrack').attr('title', _gtxt('AISSearch2.show_track'))\r\n\t\t\t// \t\t\t.removeClass('ais active');\r\n\t\t\t// \t\tcommands.showTrack.call(null, [])\r\n\t\t\t// \t}\r\n\t\t\t// });\r\n\t// if (!displaingTrack.mmsi || displaingTrack.mmsi != vessel.mmsi) {\r\n\t// \tshowtrack.attr('title', _gtxt('AISSearch2.show_track'))\r\n\t// }\r\n\t// else {\r\n\t// \tshowtrack.attr('title', _gtxt('AISSearch2.hide_track'))\r\n\t// \t\t.addClass('ais active');\r\n\t// }\r\n\t//}\r\n\r\n\tlet addremoveIcon = function (add) {\r\n\t\treturn (add ? '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><g class=\"nc-icon-wrapper\" fill=\"#444444\" style=\"fill: currentColor;\"><path d=\"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z\"/></g></svg>'\r\n\t\t\t: '<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"24px\" height=\"24px\" viewBox=\"0 0 24 24\" style=\"enable-background:new 0 0 24 24;fill: currentColor;\" xml:space=\"preserve\"><g><path class=\"st0\" d=\"M4,6H2v14c0,1.1,0.9,2,2,2h14v-2H4V6z M20,2H8C6.9,2,6,2.9,6,4v12c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2V4    C22,2.9,21.1,2,20,2z M19,11h-4v4h-2v-4H9V9h4V5h2v4h4V11z\"/></g><rect x=\"9\" y=\"5\" class=\"st0\" width=\"10\" height=\"4\"/><rect x=\"9\" y=\"11\" class=\"st0\" width=\"10\" height=\"4\"/></g></svg>')\r\n\t}\r\n\t//if (myFleetMembersModel && myFleetMembersModel.data && myFleetMembersModel.data.vessels) {\r\n\t\tlet addremove = $('<div class=\"button addremove\">' + addremoveIcon(add) + '</div>')\r\n\t\t\t//.css('background-image','url('+modulePath+'svg/'+(add?'add':'rem')+'-my-fleet.svg)')\r\n\t\t\t.attr('title', add ? 'добавить в мой флот' : 'удалить из моего флота')\r\n\t\t\t.appendTo(menubuttons)\r\n\t\tif (myFleetMembersModel.filterUpdating)\r\n\t\t\taddremove.addClass('disabled');\r\n\t\taddremove.on('click', function () {\r\n\t\t\tif (addremove.is('.disabled'))\r\n\t\t\t\treturn;\r\n\r\n\t\t\t$('.addremove').addClass('disabled')\r\n\t\t\taddremove.hide()\r\n\t\t\tprogress.append(gifLoader)\r\n\r\n\t\t\tmyFleetMembersView.prepare(vessel);\r\n\t\t\tmyFleetMembersModel.changeFilter(vessel).then(function () {\r\n\t\t\t\tadd = myFleetMembersModel.findIndex(vessel) < 0;\r\n\t\t\t\tvar info = $('.icon-ship[vessel=\"' + vessel.mmsi + ' ' + vessel.imo + '\"]');\r\n\t\t\t\tinfo.css('visibility', !add ? 'visible' : 'hidden');\r\n\t\t\t\t$('.vessel_prop.vname svg', canvas).css('visibility', add ? 'hidden' : 'visible')\r\n\r\n\t\t\t\taddremove.attr('title', add ? 'добавить в мой флот' : 'удалить из моего флота')\r\n\t\t\t\t\t.html(addremoveIcon(add))\r\n\t\t\t\t//.css('background-image','url('+modulePath+'svg/'+(add?'add':'rem')+'-my-fleet.svg)')\r\n\r\n\t\t\t\tprogress.text('');\r\n\t\t\t\t$('.addremove').removeClass('disabled').show()\r\n\t\t\t\tif (myFleetMembersView.isActive)\r\n\t\t\t\t\tmyFleetMembersView.show();\r\n\t\t\t});\r\n\t\t});\r\n\t//}\r\n\r\n\tlet progress = $('<div class=\"progress\"></div>')\r\n\t\t.appendTo(menubuttons);\r\n\r\n\t// TITLEBAR\t\r\n\tcanvas.parent('div').css({ 'margin': '0', 'overflow': 'hidden' })\r\n\tlet titlebar = $(dialog).parent().find('.ui-dialog-titlebar').css('padding', '0')\r\n\t\t.html('<table class=\"ais_info_dialog_titlebar\">' +\r\n\t\t'<tr><td><div class=\"date\">' +\r\n\t\t(!getmore ? Handlebars.compile('<span class=\"utc\">{{{ts_pos_utc}}} UTC</span>{{{ts_pos_loc}}}')(vessel2 ? vessel2 : vessel) : '') +\r\n\t\t'</div></td>' +\r\n\t\t'<td><div class=\"choose done\"><span unselectable=\"on\" class=\"chooser\">Общие сведения</span></div></td>' +\r\n\t\t'<td><div class=\"choose\"><span unselectable=\"on\" class=\"chooser\">Параметры движении</span></div></td>' +\r\n\t\t'<td id=\"closebut\" title=\"закрыть\"><div class=\"ais_info_dialog_close-button\" title=\"закрыть\"></div></td></tr>' +\r\n\t\t'</table>'),\r\n\t\tonDone = function (e) { e.stopPropagation(); $('.choose', titlebar).removeClass('done'); $(e.currentTarget).parent().addClass('done'); }\r\n\r\n\t$('#closebut', titlebar).on('click', (e) => {$(dialog).dialog(\"close\"); })\r\n\t.on('mouseover', (e) => { \r\n\t\t$('.ais_info_dialog_close-button', titlebar).css('background', 'url(\"data:image/svg+xml;charset=utf8,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\'%3E%3Cline x1=\\'0\\' y1=\\'0\\' x2=\\'12\\' y2=\\'12\\' style=\\'stroke:%2348aff1;stroke-width:2px\\'/%3E%3Cline x1=\\'0\\' y1=\\'12\\' x2=\\'12\\' y2=\\'0\\' style=\\'stroke:%2348aff1;stroke-width:2px\\'/%3E%3C/svg%3E\") no-repeat')\r\n\t})\r\n\t.on('mouseout', (e) => { \r\n\t\t$('.ais_info_dialog_close-button', titlebar).attr('style', '')\r\n\t})\r\n\t//url(\"data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3Cline x1='0' y1='0' x2='12' y2='12' style='stroke:%2348aff1;stroke-width:2px'/%3E%3Cline x1='0' y1='12' x2='12' y2='0' style='stroke:%2348aff1;stroke-width:2px'/%3E%3C/svg%3E\") no-repeat\r\n\t$('.chooser', titlebar).eq(0).on('mousedown', (e) => { onDone(e); $('.vessel_props1', canvas).show(); $('.vessel_props2', canvas).hide() })\r\n\t$('.chooser', titlebar).eq(1).on('mousedown', (e) => { onDone(e); $('.vessel_props2', canvas).show(); $('.vessel_props1', canvas).hide() })\r\n\t$('.date span', titlebar).on('mousedown', (e) => { e.stopPropagation(); })\r\n\r\n\t//$( dialog ).on( \"dialogdragstart\", function( e, ui ) {console.log(e);console.log(ui)} );\r\n\r\n\treturn dialog\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Views/infodialog.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/infodialog.css\n// module id = 18\n// module chunks = 0","require(\"./VesselInfoScreen.css\")\r\n\r\nmodule.exports = function ({modulePath, aisServices}){\r\n        var _ais,  \r\n        _galery, \r\n        _register, \r\n        _regcap,    \r\n        _leftPanel,  \r\n        _minh,\r\n        _lloyds,\r\n        resize,\r\n        menuAction,       \r\n\t    scheme = document.location.href.replace(/^(https?:).+/, \"$1\"),\r\n        show = function(vessel){\r\n//console.log(vessel) \r\n            $(\"body\").append(''+  \r\n'<table class=\"vessel-info-page overlay\">' +\r\n        '<tr>' +\r\n            '<td>' +\r\n'<table class=\"vessel-info-page container\">' +\r\n    '<tr>' +\r\n        '<td class=\"column1\">' +\r\n                '<table>' +\r\n                    '<tr>' +\r\n                        '<td>' +\r\n                            '<div>' +\r\n                                '<div class=\"title\">' +\r\n                                   '<div class=\"cell\">'+vessel.vessel_name+'<div class=\"timestamp\">'+vessel.ts_pos_utc+'</div></div>  ' +                  \r\n                                '</div>' +\r\n                                '<div class=\"menu\">' +\r\n                                '<div class=\"ais cell menu-item active\"><img src=\"'+modulePath+'svg/info_gen.svg\" class=\"icon\">Основные сведения</div>' +\r\n                                '<div class=\"register cell menu-item\"><img src=\"'+modulePath+'svg/info.svg\" class=\"icon\">Регистр</div>' +\r\n                                '<div class=\"galery cell menu-item\"><img src=\"'+modulePath+'svg/photogallery.svg\" class=\"icon\">Фотогалерея <div class=\"counter\">0</div></div>' +\r\n                               '</div>' +\r\n                            '</div>  ' +\r\n                        '</td>' +\r\n                    '</tr>' +\r\n                    '<tr>' +\r\n                        '<td class=\"frame\">' +\r\n                                '<div class=\"photo\">' +\r\n                                    '<img src=\"'+modulePath+'svg/no-image.svg\" class=\"no-image\">' +\r\n                                '</div>  ' +  \r\n                        '</td>' +\r\n                    '</tr>' +\r\n                '</table>' +\r\n    '</td>' +\r\n    '<td class=\"column2\">' +\r\n        '<div class=\"close-button-holder\">' +\r\n            '<div class=\"close-button\" title=\"закрыть\"></div>' +\r\n        '</div>' +\r\n        '<div class=\"register panel\">' +\r\n            '<div class=\"caption\">' +\r\n                '<span style=\"display: inline-block;height: 100%;vertical-align: middle;width: 40px;\"></span>' +\r\n                '<img src=\"img/progress.gif\" style=\"vertical-align: middle\">' +\r\n            '</div>' +\r\n            '<div class=\"menu\">' +\r\n                '<div>' +\r\n                    '<table>' +\r\n                        '<tr>' +\r\n                            '<td><div class=\"general menu-item active\">Общие сведения</div></td>' +\r\n                            '<td><div class=\"build menu-item\">Сведения о постройке</div></td>' +\r\n                            '<td><div class=\"dimensions menu-item\">Размеры и скорость</div></td>' +\r\n                            '<td><div class=\"gears menu-item\">Оборудование</div></td>' +\r\n                        '</tr>' +\r\n                    '</table>' +\r\n                '</div>' +\r\n            '</div>' +\r\n            '<div class=\"content\">' +\r\n                '<div class=\"placeholder\"></div>' +\r\n            '</div>' +\r\n        '</div>' +\r\n\r\n        '<div class=\"galery panel\">' +   \r\n'<form action=\"' + aisServices + 'Upload.ashx\" class=\"uploadFile\" method=\"post\" enctype=\"multipart/form-data\" target=\"upload_target\" style=\"display:none\" >' +\r\n    '<input name=\"Filedata\" class=\"chooseFile\" type=\"file\">' +    \r\n    '<input name=\"imo\" type=\"hidden\" value=\"'+vessel.imo+'\">' +    \r\n    '<input name=\"mmsi\" type=\"hidden\" value=\"'+vessel.mmsi+'\">' +\r\n          //'<input type=\"submit\" name=\"submitBtn\" value=\"Upload\" />' +\r\n'</form>' + \r\n'<iframe id=\"upload_target\" name=\"upload_target\" src=\"#\" style=\"width:0;height:0;border:0px solid #fff;\"></iframe>' + \r\n            '<div class=\"placeholder\">' +\r\n                '<div class=\"photo\" onclick=\"document.querySelector(\\'.vessel-info-page .chooseFile\\').click();\"'+\r\n                ' style=\"background-image: url('+modulePath+'svg/add-image.svg);background-size: 50px;\"></div>' +                \r\n            '</div>' +\r\n        '</div>' +\r\n\r\n        '<div class=\"ais panel\">' +\r\n            '<div class=\"placeholder\"></div>' +\r\n        '</div>' +\r\n    '</td>' +\r\n    '</tr>' +\r\n'</table>' +\r\n            '</td>' +\r\n        '</tr>' +\r\n    '</table>'           \r\n            );\r\n        window.addEventListener(\"message\", function(e){\r\n            if (e.data.search(/\"uploaded\"\\:/)<0)\r\n                return;\r\n            var data = JSON.parse(e.data);    \r\n            if (data.id && parseInt(data.id)) { //uploaded:\r\n//console.log('UPLOADED '+id)\r\n                var counter = $('.vessel-info-page .menu-item .counter'), \r\n                count = parseInt(counter.text())+1;\r\n                counter.text(count).css('display', 'inline');\r\n                var preview = $(\"<div class='photo preview' id='\"+data.id+\"' style='background-image: url(\"+aisServices+\"getphoto.ashx?id=\"+data.id+\")'/>\");\r\n                $('.vessel-info-page .uploader').replaceWith(preview);\r\n                preview.click(showPicture);\r\n//console.log(preview)\r\n            }\r\n            else {//uploadError:            \r\n                $('.vessel-info-page .uploader').remove();\r\n                console.log(data.errmsg)\r\n            }  \r\n        }, false);\r\n\r\n        $('<img src=\"' + scheme + window.serverBase.replace(/^https?:/, \"\")+'plugins/ais/getphoto.ashx?mmsi=' + vessel.mmsi + '\">')\r\n        .load(function () {\t\r\n            if (this)\r\n                $('.column1 .photo img.no-image').replaceWith(this);\t\r\n        }).error(function(){\t\t\t\r\n            $('<img src=\"' + scheme + '//photos.marinetraffic.com/ais/showphoto.aspx?size=thumb&mmsi=' + vessel.mmsi + '\">').load(function () {\r\n                    if (this)\r\n                        $('.column1 .photo img.no-image').replaceWith(this);\r\n            });\r\n        });\r\n\r\n        $('.vessel-info-page .chooseFile').change(function(){            \r\n            $('<div class=\"photo uploader\" style=\"background-image:url(img/progress.gif);background-size:20px;\"></div>')\r\n            .insertAfter($('.vessel-info-page .galery .placeholder .photo').eq(0));\r\n            $('.vessel-info-page .uploadFile')[0].submit();\r\n        })\r\n        $('.vessel-info-page .close-button').click(function(){\r\n            $('.vessel-info-page.overlay').remove();\r\n        });\r\n/**/\r\n        $('.vessel-info-page .menu img[src$=\".svg\"]').each(function() {\r\n            var $img = jQuery(this);\r\n            var imgURL = $img.attr('src');\r\n            var attributes = $img.prop(\"attributes\");\r\n\r\n            $.get(imgURL, function(data) {\r\n                // Get the SVG tag, ignore the rest\r\n                var $svg = jQuery(data).find('svg');\r\n\r\n                // Remove any invalid XML tags\r\n                $svg = $svg.removeAttr('xmlns:a');\r\n\r\n                // Loop through IMG attributes and apply on SVG\r\n                $.each(attributes, function() {\r\n                    $svg.attr(this.name, this.value);\r\n                });\r\n\r\n                // Replace IMG with SVG\r\n                $img.replaceWith($svg);\r\n            }, 'xml');\r\n        });\r\n\r\n        _ais = document.querySelector('.vessel-info-page .column2 .ais') \r\n        _galery = document.querySelector('.vessel-info-page .column2 .galery')\r\n        _register = document.querySelector('.vessel-info-page .column2 .register .content')\r\n        _regcap = document.querySelector('.vessel-info-page .column2 .register .caption')    \r\n        _leftPanel = document.querySelector('.vessel-info-page .column1 table')      \r\n        _minh = 420\r\n        resize = function(){\r\n            var h = Math.floor(window.innerHeight*0.8);\r\n            if (h>_minh){\r\n                _leftPanel.style.height = _ais.style.height = _galery.style.height = h + \"px\";\r\n                _register.style.height = h - _regcap.offsetHeight + \"px\";\r\n            }\r\n            else{\r\n                _leftPanel.style.height = _ais.style.height = _galery.style.height = _minh + \"px\";\r\n                _register.style.height = _minh - _regcap.offsetHeight + \"px\";\r\n            }      \r\n        }\r\n        menuAction = function(e){\r\n            var target = e.currentTarget, p = target.parentElement, mia;\r\n            while(!(mia = p.querySelectorAll('.menu-item')) || mia.length<2){\r\n                p = p.parentElement;\r\n            }\r\n            for (var j=0; j<mia.length; ++j){\r\n                    //console.log( mia[j])\r\n                mia[j].className = mia[j].className.replace(/ active/, \"\");\r\n                var panel = document.querySelector('.panel.' + mia[j].classList[0]);\r\n                if (panel){\r\n                    if (mia[j]!=target)\r\n                    panel.style.display = \"none\";\r\n                    else{\r\n                    panel.style.display = \"block\";\r\n                    }\r\n                }\r\n            }\r\n            target.className += \" active\"\r\n            resize(); \r\n        }\r\n\r\n        window.addEventListener(\"resize\", resize, false); \r\n    \r\n        var mia = document.querySelectorAll('.column1 .menu-item');\r\n        for (var i=0; i<mia.length; ++i){\r\n            mia[i].addEventListener('click', menuAction)\r\n        }\r\n    \r\n        resize();    \r\n        $(_ais).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        $(_galery).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        $(_register).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        document.querySelector('.vessel-info-page .container').style.display = \"table\";  \r\n    },\r\n    showPicture = function(){\r\n//console.log($(this))\r\n            $('.vessel-info-page .picture').remove();\r\n            var div = $('<div class=\"picture\" style=\"display:none;position:absolute;\"></div>')\r\n            .insertAfter('.vessel-info-page.container').click(function(){this.remove()});\r\n            $('<img src=\"'+aisServices+'getphoto.ashx?id='+this.id+'\">').load(function() {\r\n                    if (this){\r\n                        var w = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,\r\n                        h = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\r\n                        div.append(this)\r\n                        .css('display', 'table')\r\n                        .offset({\r\n                            left:(w-this.offsetWidth)/2,\r\n                            top:(h-this.offsetHeight)/2})\r\n//console.log($(this))\r\n//console.log(window.screen.width+\"-\"+$(this)[0].offsetWidth)\r\n//console.log((window.screen.width-$(this)[0].offsetWidth)/2)\r\n                    }\r\n            });\r\n        },\r\n    drawGallery = function(gallery){\r\n        if (gallery.length>0)\r\n            $('.vessel-info-page .menu-item .counter').text(gallery.length).css('display', 'inline');   \r\n        var galcontent = $(\".vessel-info-page .galery .placeholder\")\r\n        for (var i=0; i<gallery.length; ++i)\r\n            galcontent.append(\"<div class='photo preview' id='\"+gallery[i]+\"' style='background-image: url(\"+aisServices+\"getphoto.ashx?id=\"+gallery[i]+\")'/>\" )             \r\n        $('.photo.preview').click(showPicture)\r\n        resize();     \r\n    },\r\n    drawAis = function(ledokol){\r\n    var aiscontent = document.querySelector(\".vessel-info-page .ais .placeholder\")\r\n    aiscontent.innerHTML = \"\" +                \r\n    \"<div class='caption'><div>ИНФОРМАЦИЯ О СУДНЕ</div></div>\" +\r\n    \"<table>\" +\r\n        \"<tr><td>Название судна</td><td><b>\"+ledokol.vessel_name+(ledokol.registry_name?\" (\"+ledokol.registry_name+\")\":\"\")+\"</b></td></tr>\" +\r\n        \"<tr><td>IMO</td><td>\"+ledokol.imo+\"</td></tr>\" +\r\n        \"<tr><td>MMSI</td><td>\"+ledokol.mmsi+\"</td></tr>\" +\r\n        \"<tr><td>Тип</td><td>\"+ledokol.vessel_type+\"</td></tr>\" +\r\n        \"<tr><td>Флаг</td><td>\"+ledokol.flag_country+\"</td></tr>\" +\r\n        \"<tr><td>Позывной</td><td>\"+ledokol.callsign+\"</td></tr>\" +\r\n        \"<tr><td>Длина</td><td>\"+ledokol.length+\"</td></tr>\" +\r\n        \"<tr><td>Ширина</td><td>\"+ledokol.width+\"</td></tr>\" +\r\n    \"</table>\" +\r\n    \"<div class='caption'><div>СВЕДЕНИЯ О ДВИЖЕНИИ</div></div>\" +\r\n    \"<table>\" +\r\n        \"<tr><td>Навигационный статус</td><td>\"+ledokol.nav_status+\"</td></tr>\" +\r\n        \"<tr><td>COG</td><td>\"+ledokol.cog+\"</td></tr>\" +\r\n        \"<tr><td>SOG</td><td>\"+ledokol.sog+\"</td></tr>\" +\r\n        \"<tr><td>HDG</td><td>\"+ledokol.heading+\"</td></tr>\" +\r\n        \"<tr><td>ROT</td><td>\"+ledokol.rot+\"</td></tr>\" +\r\n        \"<tr><td>Осадка</td><td>\"+ledokol.draught+\"</td></tr>\" +\r\n        \"<tr><td>Назначение</td><td>\"+ledokol.destination+\"</td></tr>\" +\r\n        \"<tr><td>Расчетное время прибытия</td><td>\"+ledokol.ts_eta+\"</td></tr>\" +\r\n    \"</table>\";     \r\n        resize();        \r\n    },\r\n    drawRegister = function(ledokol){\r\n        let regcontent = _register.querySelector(\".placeholder\"),\r\n        drawTable = function(groups, article, display){\r\n            let s = \"<div class='panel \"+article+\" article' style='display:\"+display+\"'>\";\r\n            for(let i=0; i<groups.length; ++i){\r\n                if (!groups[i])\r\n                    continue;\r\n                s += \"<div class='group'>\"+groups[i].name+\"</div><table>\"\r\n                for(let j=0; j<groups[i].properties.length; ++j){\r\n                    let pn = groups[i].properties[j].name,\r\n                    desc = groups[i].properties[j].description, \r\n                    pv = groups[i].properties[j].value\r\n                    s+= \"<tr><td>\"+pn+\r\n                    (desc ? \"<div class='description'>\" + desc + \"</div>\" : \"\")+ \r\n                    \"</td><td>\"+(pn==\"Название судна\"||pn==\"Латинское название\"?\"<b>\"+pv+\"</b>\":pv)+\"</td></tr>\"\r\n                }\r\n                s += \"</table>\"\r\n            }\r\n            s += \"</div>\"\r\n            return s;\r\n        }\t\r\n\r\n        _regcap.innerHTML = \"<table class='register-title'>\"+\r\n        \"<tr><td><span class='switch active'>РМРС</span> <span class='switch'>Lloyd's register</span></td></tr>\"+\r\n        \"<tr><td><span class='update'></span></td></tr>\"+\r\n        \"</table>\";\r\n\r\n        let drawRMR = function(){\r\n            if (ledokol) {\r\n                regcontent.innerHTML =\r\n                    drawTable([ledokol.data[0], ledokol.data[1], ledokol.data[9]], \"general\", \"block\") +\r\n                    drawTable([ledokol.data[2]], \"build\", \"none\") +\r\n                    drawTable([ledokol.data[3]], \"dimensions\", \"none\") +\r\n                    drawTable([ledokol.data[4], ledokol.data[5], ledokol.data[6], ledokol.data[7], ledokol.data[8]], \"gears\", \"none\");\r\n                _regcap.querySelector('.update').innerText = \"Обновление базы данных \" + ledokol.version.replace(/ \\S+$/g, '');\r\n            }\r\n            else{\r\n                regcontent.innerHTML = \"\";\r\n                _regcap.querySelector('.update').innerHTML = \"&nbsp;\"; \r\n            }\r\n        },\r\n        drawLloyds = function(){\r\n            regcontent.innerHTML =\r\n                drawTable([_lloyds.data[1], _lloyds.data[2], _lloyds.data[0]], \"general\", \"block\") +\r\n                drawTable([_lloyds.data[9]], \"build\", \"none\") +\r\n                drawTable([_lloyds.data[8]], \"dimensions\", \"none\") +\r\n                drawTable([_lloyds.data[3], _lloyds.data[4], _lloyds.data[5], _lloyds.data[6], _lloyds.data[7]], \"gears\", \"none\");\r\n            _regcap.querySelector('.update').innerText = \"Обновление базы данных \" + _lloyds.version.replace(/ \\S+$/g, '');   \r\n        },\r\n        regSwitches = _regcap.querySelectorAll(\".switch\");\r\n        regSwitches.forEach((item, i)=>item.addEventListener('click', e => {\r\n            let cl = e.currentTarget.classList;\r\n            if (!cl.contains('active')) {\r\n                _regcap.querySelector(\".switch.active\").classList.remove('active');\r\n                cl.add('active');\r\n                switch (i){\r\n                    case 0:\r\n                        drawRMR();\r\n                        break;\r\n                    case 1:\r\n                        if (_lloyds)\r\n                            drawLloyds();\r\n                        else\r\n                            regcontent.innerHTML = \"\";                        \r\n                        break;\r\n                }           \r\n                resize();   \r\n                mia[0].click();\r\n            }\r\n        }));\r\n        var mia = document.querySelectorAll('.column2 .menu-item');\r\n        for (var i=0; i<mia.length; ++i){\r\n            mia[i].addEventListener('click', menuAction)\r\n        }\r\n        drawRMR();             \r\n        resize(); \r\n        if (!ledokol)        \r\n            regSwitches[1].click();         \r\n    }\r\n\t\r\n\tlet open = function(vessel, vessel2){\r\n                    show(vessel2);\r\n                    var onFail = function(error){\r\n                        if (error!='register_no_data')\r\n                            console.log(error)\r\n                        _regcap.innerHTML = \"\";\r\n                    } \r\n                    new Promise(function(resolve, reject){\r\n                        (function wait(){\r\n                            if(!vessel2)\r\n                                setTimeout(wait, 100);\r\n                        })();\r\n                        resolve(vessel2)\r\n                    })\r\n                    .then(function(ship){\r\n//console.log(ship)\r\n                        drawAis(ship)\r\n                    }, \r\n                    onFail);\r\n                    var registerServerUrl = scheme + \"//kosmosnimki.ru/demo/register/api/v1/\",\r\n                        lloydsServerUrl = scheme + \"//kosmosnimki.ru/demo/lloyds/api/v1/\",\r\n                        rmr;\r\n                    if(vessel.imo && vessel.imo!=0 && vessel.imo!=-1){\r\n                        fetch(registerServerUrl+\"Ship/Search/\"+vessel.imo+\"/ru\")\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            if (ship.length>0)\r\n                                return fetch(registerServerUrl+\"Ship/Get/\"+ship[0].RS+\"/ru\")\r\n                            else\r\n                                return Promise.resolve({json:()=>null});\r\n                            //else\r\n                            //    return Promise.reject('register_no_data');\r\n                        })\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            //console.log(ship)\r\n                            rmr = ship;\r\n                            if (rmr)\r\n                                drawRegister(rmr);\r\n                            return fetch(lloydsServerUrl+\"Ship/Search/\"+vessel.imo+\"/ru\");\r\n                        })                        \r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            if (ship.length>0)\r\n                                return fetch(lloydsServerUrl+\"Ship/Get/\"+ship[0].RS+\"/ru\")\r\n                            else\r\n                                return Promise.reject('register_no_data');\r\n                        })\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            _lloyds = ship;\r\n                            if (!rmr)\r\n                                drawRegister(rmr);\r\n                        })\r\n                        .catch( onFail );\r\n                    }\r\n                    else                    \r\n                        _regcap.innerHTML = \"\";\r\n\r\n                    new Promise(function(resolve, reject){\r\n                        sendCrossDomainJSONRequest(aisServices + \r\n                            \"gallery.ashx?mmsi=\"+vessel.mmsi+\"&imo=\"+vessel.imo, function(response){\r\n                            if (response.Status==\"ok\") \r\n                                resolve(response.Result);\r\n                            else\r\n                                reject(response)\r\n                        });\r\n                    })\r\n                    .then(function(gallery){\r\n                        drawGallery(gallery)\r\n                    }, \r\n                    onFail);\r\n                }\r\n        \r\n    return {\r\n\t\topen:open,\r\n            show: show,\r\n            drawRegister: drawRegister,\r\n            drawAis: drawAis,\r\n            drawGallery:drawGallery\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Views/VesselInfoScreen.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/VesselInfoScreen.css\n// module id = 20\n// module chunks = 0","module.exports = function (options) {\r\n    const _baseUrl = window.serverBase || document.location.href.replace(/^(https?:).+/, \"$1\") + '//maps.kosmosnimki.ru/',\r\n        _aisServices = _baseUrl + \"Plugins/AIS/\",\r\n        _serverScript = _baseUrl + 'VectorLayer/Search.ashx';\r\n    const { aisLastPoint:_aisLastPoint, \r\n        screenSearchLayer:_screenSearchLayer, \r\n        aisLayerID:_aisLayerID, \r\n        historyLayer:_historyLayer \r\n    } = options;\r\n\r\n    return {\r\n        baseUrl: _baseUrl,\r\n        aisServices: _aisServices,\r\n        getBorder: function () {\r\n            var lmap = nsGmx.leafletMap;\r\n            var dFeatures = lmap.gmxDrawing.getFeatures();\r\n            if (dFeatures.length) { return dFeatures[dFeatures.length - 1].toGeoJSON(); }\r\n            var latLngBounds = lmap.getBounds(),\r\n                sw = latLngBounds.getSouthWest(),\r\n                ne = latLngBounds.getNorthEast(),\r\n                min = { x: sw.lng, y: sw.lat },\r\n                max = { x: ne.lng, y: ne.lat },\r\n                minX = min.x,\r\n                maxX = max.x,\r\n                geo = { type: 'Polygon', coordinates: [[[minX, min.y], [minX, max.y], [maxX, max.y], [maxX, min.y], [minX, min.y]]] },\r\n                w = (maxX - minX) / 2;\r\n\r\n            if (w >= 180) {\r\n                geo = { type: 'Polygon', coordinates: [[[-180, min.y], [-180, max.y], [180, max.y], [180, min.y], [-180, min.y]]] };\r\n            }\r\n            else if (maxX > 180 || minX < -180) {\r\n                var center = ((maxX + minX) / 2) % 360;\r\n                if (center > 180) { center -= 360; }\r\n                else if (center < -180) { center += 360; }\r\n                minX = center - w; maxX = center + w;\r\n                if (minX < -180) {\r\n                    geo = {\r\n                        type: 'MultiPolygon', coordinates: [\r\n                            [[[-180, min.y], [-180, max.y], [maxX, max.y], [maxX, min.y], [-180, min.y]]],\r\n                            [[[minX + 360, min.y], [minX + 360, max.y], [180, max.y], [180, min.y], [minX + 360, min.y]]]\r\n                        ]\r\n                    };\r\n                } else if (maxX > 180) {\r\n                    geo = {\r\n                        type: 'MultiPolygon', coordinates: [\r\n                            [[[minX, min.y], [minX, max.y], [180, max.y], [180, min.y], [minX, min.y]]],\r\n                            [[[-180, min.y], [-180, max.y], [maxX - 360, max.y], [maxX - 360, min.y], [-180, min.y]]]\r\n                        ]\r\n                    };\r\n                }\r\n            }\r\n            return geo;\r\n        },\r\n\r\n        formatTime: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleTimeString();\r\n        },\r\n        formatDate: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleDateString();\r\n        },\r\n        formatDateTime: function (d, local) {\r\n            if (d.isNaN)\r\n                return \"\";\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleString().replace(/,/, \"\");\r\n        },\r\n\r\n        formatDate2: function (d, local) {\r\n            var dd, m, y, h, mm;\r\n            if (local) {\r\n                dd = (\"0\" + d.getDate()).slice(-2);\r\n                m = (\"0\" + (d.getMonth() + 1)).slice(-2);\r\n                y = d.getFullYear();\r\n                h = (\"0\" + d.getHours()).slice(-2);\r\n                mm = (\"0\" + d.getMinutes()).slice(-2);\r\n                return dd + \".\" + m + \".\" + y + \" \" + h + \":\" + mm +\r\n                    \" (\" + (\"0\" + d.getUTCHours()).slice(-2) + \":\" + (\"0\" + d.getUTCMinutes()).slice(-2) + \" UTC)\";\r\n            }\r\n            else {\r\n                dd = (\"0\" + d.getUTCDate()).slice(-2);\r\n                m = (\"0\" + (d.getUTCMonth() + 1)).slice(-2);\r\n                y = d.getUTCFullYear();\r\n                h = (\"0\" + d.getUTCHours()).slice(-2);\r\n                mm = (\"0\" + d.getUTCMinutes()).slice(-2);\r\n                var\r\n                    ldd = (\"0\" + d.getDate()).slice(-2),\r\n                    lm = (\"0\" + (d.getMonth() + 1)).slice(-2),\r\n                    ly = d.getFullYear(),\r\n                    lh = (\"0\" + d.getHours()).slice(-2),\r\n                    lmm = (\"0\" + d.getMinutes()).slice(-2),\r\n                    offset = -d.getTimezoneOffset() / 60;\r\n                return dd + \".\" + m + \".\" + y + \" <span class='utc'>\" + h + \":\" + mm + \" UTC</span> (\" + lh + \":\" + lmm + \")\"\r\n                //return dd+\".\"+m+\".\"+y+\" \"+h+\":\"+mm+\" UTC <br>\"+\r\n                //\"<span class='small'>(\"+ldd+\".\"+lm+\".\"+ly+\" \"+lh+\":\"+lmm+\" UTC\"+(offset>0?\"+\":\"\")+offset+\")</span>\";\r\n            }\r\n        },\r\n        placeVesselTypeIcon: function(vessel){\r\n            switch (vessel.vessel_type.toLowerCase()) {\r\n                case \"cargo\":\r\n                    vessel.icon = \"http://maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Ccargo-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                case \"tanker\":\r\n                    vessel.icon = \"http://maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Ctanker-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                case \"fishing\":\r\n                    vessel.icon = \"http://maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Cfishing-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                case \"passenger\":\r\n                    vessel.icon = \"http://maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Cpassenger-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;                \r\n                case \"hsc\":\r\n                    vessel.icon = \"http://maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Chighspeed-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                case \"pleasure craft\":\r\n                case \"sailing\":\r\n                    vessel.icon = \"http://maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Cpleasure-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                case \"unknown\": \r\n                case \"reserved\": \r\n                case \"other\":\r\n                    vessel.icon = \"http://maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Cother-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                default:\r\n                    vessel.icon = \"http://maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Cspecialcraft-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n            }\r\n        },\r\n\r\n        searchPositionsAgg: function (vessels, dateInterval, callback) {\r\n            //console.log(dateInterval);\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _historyLayer, //'8EE2C7996800458AAF70BABB43321FA4',//\r\n                orderdirection: 'desc',\r\n                orderby: 'ts_pos_utc',\r\n                columns:'[{\"Value\":\"mmsi\"},{\"Value\":\"flag_country\"},{\"Value\":\"callsign\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"cog\"},{\"Value\":\"sog\"},{\"Value\":\"draught\"},{\"Value\":\"vessel_type\"},'+\r\n                '{\"Value\":\"destination\"},{\"Value\":\"ts_eta\"},{\"Value\":\"nav_status\"},{\"Value\":\"heading\"},{\"Value\":\"rot\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"}]',\r\n                \r\n                query: \"([mmsi] IN (\" + vessels.join(',') + \")) and '\" + dateInterval.dateBegin.toISOString() + \"'<=[ts_pos_utc] and [ts_pos_utc]<'\" + dateInterval.dateEnd.toISOString() + \"'\"\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchPositions: function (vessels, dateInterval, callback) {\r\n            //console.log(\"searchById\");\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _historyLayer, //'8EE2C7996800458AAF70BABB43321FA4',//\r\n                //orderdirection: 'desc',\r\n                //orderby: 'ts_pos_utc',\r\n                query: \"([mmsi] IN (\" + vessels.join(',') + \")) and '\" + dateInterval.dateBegin.toISOString() + \"'<=[ts_pos_utc] and [ts_pos_utc]<'\" + dateInterval.dateEnd.toISOString() + \"'\"\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchById: function (aid, callback) {\r\n            //console.log(\"searchById\");\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _aisLayerID, //'8EE2C7996800458AAF70BABB43321FA4'\r\n                columns: '[{\"Value\":\"vessel_name\"},{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"}]',\r\n                query: \"([id] IN (\" + aid.join(',') + \"))\"\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchString: function (searchString, isfuzzy, callback) {\r\n            //console.log(_aisLastPoint+\", \"+_aisLayerID)\r\n            var query = \"\";\r\n            if (searchString) {\r\n                searchString = searchString.toUpperCase();\r\n                if (searchString.search(/[^\\d, ]/) === -1) {\r\n                    var arr = searchString.replace(/ /g, '').split(/,/);\r\n                    query = \"([mmsi] IN (\" + arr.join(',') + \"))\" +\r\n                        \"OR ([imo] IN (\" + arr.join(',') + \"))\"\r\n                } else {\r\n                    if (isfuzzy)\r\n                        query = '([vessel_name] startswith \\'' + searchString + '\\') OR ([vessel_name] contains \\' ' + searchString + '\\')';\r\n                    else\r\n                        query = '([vessel_name] startswith \\'' + searchString + '\\') OR ([vessel_name] contains \\' ' + searchString + '\\')';\r\n                }\r\n            }\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _aisLastPoint,\r\n                columns: '[{\"Value\":\"vessel_name\"},{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"vessel_type\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"}]',\r\n                //orderdirection: 'desc',\r\n                orderby: 'vessel_name',\r\n                query: query\r\n            };\r\n            if (isfuzzy)\r\n                request.pagesize = 1000;\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchNames: function (avessels, callback) {\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _aisLastPoint,\r\n                orderdirection: 'desc',\r\n                orderby: 'ts_pos_utc',\r\n                query: avessels.map(function (v) { return \"([mmsi]=\" + v.mmsi + (v.imo && v.imo != \"\" ? (\" and [imo]=\" + v.imo) : \"\") + \")\" }).join(\" or \")\r\n                //([mmsi] IN (\" + ammsi.join(',') + \"))\"+\r\n                //\"and ([imo] IN (\" + aimo.join(',') + \"))\"\r\n            };\r\n            //console.log(request)\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchScreen: function (options, callback) {\r\n            var lmap = nsGmx.leafletMap;\r\n            var latLngBounds = lmap.getBounds(),\r\n                sw = latLngBounds.getSouthWest(),\r\n                ne = latLngBounds.getNorthEast(),\r\n                min = { x: sw.lng, y: sw.lat },\r\n                max = { x: ne.lng, y: ne.lat };\r\n            let queryParams = { WrapStyle: 'window', minx: min.x, miny: min.y, maxx: max.x, maxy: max.y, layer: _screenSearchLayer },\r\n            //     layerTreeNode = $(_queryMapLayers.buildedTree).find(\"div[LayerID='\"+_screenSearchLayer+\"']\")[0];\r\n            // if (layerTreeNode){   \r\n            //     var gmxProp = layerTreeNode.gmxProperties.content.properties;\r\n            //     if (gmxProp.Temporal) {\r\n            //         queryParams.s = options.dateInterval.get('dateBegin').toJSON(),\r\n            //         queryParams.e = options.dateInterval.get('dateEnd').toJSON();\r\n            //     }\r\n            // }\r\n            dateInterval = nsGmx.widgets.commonCalendar.getDateInterval();\r\n            queryParams.s = options.dateInterval.get('dateBegin').toJSON(),\r\n            queryParams.e = options.dateInterval.get('dateEnd').toJSON();\r\n//console.log(queryParams);\r\n            L.gmxUtil.sendCrossDomainPostRequest(_aisServices + \"SearchScreen.ashx\",\r\n                queryParams,\r\n                callback);\r\n        }\r\n    };\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/Search/Searcher.js","module.exports = function (options) {\r\n    const _layersByID = nsGmx.gmxMap.layersByID,\r\n          _aisLayer = _layersByID[options.aisLayerID],\r\n          _tracksLayer = _layersByID[options.tracksLayerID],\r\n          _screenSearchLayer = _layersByID[options.screenSearchLayer];\r\n    let _displaingTrack = {mmsi:null},\r\n    _displayingMyFleet = null,\r\n    _filtered = [],\r\n    _filterFunc = function (args) {\r\n        let dates = _displaingTrack.dates ? _displaingTrack.dates.list : null,\r\n        mmsiArr = [];\r\n        mmsiArr.push(_displaingTrack.mmsi);\r\n\r\n        let mmsi = args.properties[1],\r\n            dt = new Date(new Date(args.properties[args.properties.length>20 ? 23 : 2]*1000).setUTCHours(0,0,0,0)),\r\n            i, j, len;\r\n        for (i = 0, len = mmsiArr.length; i < len; i++) {\r\n            if (mmsi === mmsiArr[i] && _filtered.indexOf(mmsi)<0 \r\n            && (!_displayingMyFleet || _displayingMyFleet.indexOf(mmsi)>=0)) { \r\n                if (dates)\r\n                    for (j=0; j<dates.length; ++j){\r\n                        if (dates[j].getTime()==dt.getTime()){\r\n                            return true;\r\n                        }\r\n                    }\r\n                else{\r\n                    return true; \r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }, \r\n    _setTrackFilter = function(){\r\n//console.log(_displaingTrack)\r\n        let lmap = nsGmx.leafletMap;\r\n        if (_aisLayer) {\r\n            if (_displaingTrack.mmsi) {\r\n                _aisLayer.setFilter(_filterFunc);\r\n                if (!_aisLayer._map) {\r\n                    lmap.addLayer(_aisLayer);\r\n                }\r\n            } else {\r\n                _aisLayer.removeFilter();\r\n                lmap.removeLayer(_aisLayer);\r\n            }\r\n        }\r\n        if (_tracksLayer) {\r\n            if (_displaingTrack.mmsi) {\r\n                _tracksLayer.setFilter(_filterFunc);\r\n                if (!_tracksLayer._map) {\r\n                    lmap.addLayer(_tracksLayer);\r\n                }\r\n            } else {\r\n                _tracksLayer.removeFilter();\r\n                lmap.removeLayer(_tracksLayer);\r\n            }\r\n        }\r\n    }, \r\n    _setMyFleetFilter = function(){\r\n        _setTrackFilter();\r\n//console.log(_displayingMyFleet)\r\n//console.log(_filtered)\r\n        let lmap = nsGmx.leafletMap;\r\n        if (_screenSearchLayer) {\r\n            if (_displayingMyFleet || _filtered.length) {\r\n                _screenSearchLayer.setFilter((args) => {\r\n                    let mmsi = args.properties[1];\r\n                    if (_filtered.indexOf(mmsi) < 0){\r\n                        if (_displayingMyFleet && _displayingMyFleet.indexOf(mmsi) < 0)\r\n                            return false;\r\n                        else\r\n                            return true;\r\n                    }\r\n                    else\r\n                        return false;\r\n                });\r\n            } else {\r\n                _screenSearchLayer.removeFilter();\r\n            }\r\n        }\r\n\r\n    };\r\n\r\n    return {\r\n        get displaingTrack(){ return _displaingTrack; },\r\n        set displaingTrack(value){ _displaingTrack = value; },\r\n        get displayingMyFleet(){ return _displayingMyFleet; },\r\n        set displayingMyFleet(value){ _displayingMyFleet = value; },\r\n        get filtered(){ return _filtered; },\r\n        set filtered(value){ _filtered = value; },\r\n        showTrack: function (mmsiArr, dates) { //bbox) {\r\n            _displaingTrack = { mmsi:mmsiArr && mmsiArr.length? mmsiArr[0] : null};\r\n            if (dates)\r\n                _displaingTrack.dates = { mmsi:mmsiArr[0], list:dates };\r\n            //if (bbox) { lmap.fitBounds(bbox, { maxZoom: 11 }); }\r\n            if (_aisLayer || _tracksLayer)\r\n                _displaingTrack.mmsi = mmsiArr[0];\r\n            else\r\n                _displaingTrack.mmsi = null;\r\n            _setTrackFilter();\r\n        },\r\n        hideOnMap: function () { \r\n            _setMyFleetFilter();\r\n        },\r\n        hideAllOnMap: function () { \r\n            _setMyFleetFilter();\r\n        }\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Toolbox.js"],"sourceRoot":""}