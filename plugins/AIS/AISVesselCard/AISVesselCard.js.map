{"version":3,"sources":["webpack:///webpack/bootstrap 1d2529ad17ec4347dab7","webpack:///./src/entry.js","webpack:///./src/all.css","webpack:///./src/Views/AisView.css","webpack:///./src/locale.js","webpack:///./src/Polyfill2.js","webpack:///./src/Views/InfoDialogView.js","webpack:///./src/Views/infodialog.js","webpack:///./src/Views/infodialog.css","webpack:///./src/Views/SpecialFloatView.js","webpack:///./src/Views/SpecialFloatView.css","webpack:///./src/Views/BaseFloatView.js","webpack:///./src/Polyfill.js","webpack:///./src/Views/VesselInfoScreen.js","webpack:///./src/Views/VesselInfoScreen.css","webpack:///./src/Search/Searcher.js","webpack:///./src/Toolbox.js"],"names":["PRODUCTION","SIDEBAR2","BETA","require","InfoDialogView","Searcher","Toolbox","Handlebars","registerHelper","context","mmsi","imo","JSON","stringify","pluginName","cssTable","modulePath","gmxCore","getModulePath","replace","document","location","href","highlight","L","marker","icon","className","iconAnchor","iconSize","iconUrl","zIndexOffset","ready","publicInterface","afterViewer","params","map","tools","options","aisLayerID","screenSearchLayer","searchLayer","aisLastPoint","historyLayer","tracksLayerID","lastPointLayerAlt","historyLayerAlt","tracksLayerAlt","key","toLowerCase","myFleetLayers","split","id","infoDialogView","aisLayerSearcher","layersByID","nsGmx","gmxMap","setLayerClickHandler","layer","removeEventListener","addEventListener","e","gmx","properties","hasOwnProperty","show","forLayers","layersId","i","length","addModule","css","_translationsHash","addtext","proto","matches","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","closest","selector","parentElement","Element","prototype","arr","window","CharacterData","DocumentType","args","forEach","item","push","Object","defineProperty","configurable","enumerable","writable","value","remove","parentNode","removeChild","append","argArr","Array","slice","call","arguments","docFrag","createDocumentFragment","argItem","isNode","Node","appendChild","createTextNode","String","Document","DocumentFragment","NodeList","displayInfoDialog","Polyfill","VesselInfoScreen","infoDialogCascade","allIinfoDialogs","vesselInfoScreen","module","exports","aisView","myFleetView","menuId","aisServices","_showPosition","vessel","track","tab","is","click","showTrack","iconSidebarWidget","open","_updateView","displayed","getmore","ts_pos_utc","$","dialog","showPosition","ind","findIndex","d","isNew","dialogOffset","parent","offset","insertAfter","eq","displayedTrack","closeFunc","event","splice","openVesselInfoScreen","pos","position","left","top","on","ui","SpecialFloatView","addUnit","v","u","formatDate","formatDateTime","round","p","isNeg","power","Math","pow","formatVessel","Date","ts_pos_org","dt_pos_utc","ts_pos_loc","ts_eta","cog","isNaN","sog","Translations","getLanguage","rot","heading","draught","width","source","_gtxt","toDd","D","lng","dir","deg","ddToDms","dms","min","sec","shipCams","commands","layers","l","_gmx","props","title","meta","MetaProperties","search","ships","Value","RegExp","name","urls","canvas","menu","appendTo","photo","underphoto","content","buttons","gifLoader","searchInput","dialogW","dialogH","posX","posY","height","showDialog","vessel_name","vessel2","moreInfo","smallShipIcon","vesselPropTempl","registry_name","compile","latitude","longitude","swap","mi","t","html","hide","resizable","extend","searchNames","response","parseResponse","Result","fields","values","titlebar","console","log","scheme","serverBase","load","replaceWith","error","menubuttons","openpage","shipCam","toString","setImages","moment","setMinutes","getMinutes","getTimezoneOffset","getFullYear","getMonth","getDate","getHours","getSeconds","images","url","protocol","view","special","showCamBut","b","currentTarget","classList","contains","visible","close","add","progress","find","onDone","stopPropagation","removeClass","addClass","attr","_cssClassName","BaseFloatView","apply","frame","innerHTML","FormData","set","contextMenu","createElement","cancelBubble","returnValue","bind","style","display","closeCom","querySelector","zinCom","zoutCom","img1Com","img2Com","twoimgCom","w","h","rc1","rc2","image1","image2","logos","showTwo","restoreSize","h1","floor","getBoundingClientRect","h2","zoomIn","image","wiw","wih","setPlace1","setPlace2","parseInt","zoomIn2","bottom","ceil","allowMove","src","closeCallback","srcElement","st","getComputedStyle","innerWidth","innerHeight","preventDefault","clientX","offsetWidth","right","clientY","offsetHeight","create","rc","imageUrl","timers","downloadingImage1","Image","onload","onerror","random","downloadingImage2","defaultView","getWindowWidth","intrerval","thisInst","timer","setTimeout","update","disposeTimer","clearTimeout","_getMaxZindex","dialogs","querySelectorAll","z","zMax","reduce","c","parseFloat","zIndex","x","y","body","dx","dy","rect","fx","fy","a","predicate","list","thisArg","undefined","_ais","_galery","_register","_regcap","_leftPanel","_minh","_lloyds","resize","menuAction","data","parse","counter","count","text","preview","showPicture","errmsg","change","submit","each","$img","jQuery","imgURL","attributes","prop","get","$svg","removeAttr","target","mia","j","panel","mCustomScrollbar","theme","div","documentElement","clientWidth","clientHeight","drawGallery","gallery","galcontent","drawAis","ledokol","aiscontent","vessel_type","flag_country","callsign","nav_status","destination","drawRegister","regcontent","drawTable","groups","article","s","pn","desc","description","pv","drawRMR","innerText","version","drawLloyds","regSwitches","cl","onFail","Promise","resolve","reject","wait","then","ship","registerServerUrl","lloydsServerUrl","rmr","fetch","json","RS","catch","sendCrossDomainJSONRequest","Status","_aisServices","_baseUrl","_serverScript","_aisLastPoint","_screenSearchLayer","_aisLayerID","_historyLayer","_lastPointLayerAlt","_vesselLegend","vesselLegend","baseUrl","getBorder","lmap","leafletMap","dFeatures","gmxDrawing","getFeatures","toGeoJSON","latLngBounds","getBounds","sw","getSouthWest","ne","getNorthEast","lat","max","minX","maxX","geo","type","coordinates","center","formatTime","local","temp","toLocaleTimeString","toLocaleDateString","toLocaleString","formatDate2","dd","m","mm","getUTCHours","getUTCMinutes","getUTCDate","getUTCMonth","getUTCFullYear","ldd","lm","ly","lh","lmm","placeVesselTypeIcon","getIconAlt","iconAlt","imgAlt","img","colorAlt","color","getIcon","searchPositionsAgg2","dateInterval","callback","dateBegin","toISOString","dateEnd","method","mode","cache","credentials","searchPositionsAgg2Mf","searchPositionsAgg","vessels","request","WrapStyle","orderdirection","orderby","columns","query","join","gmxUtil","sendCrossDomainPostRequest","searchPositions","searchById","aid","searchString2","isfuzzy","pagesize","searchString","toUpperCase","avessels","searchScreen","filter","toJSON","_lmap","_layersByID","_aisLayer","_curLegendLayer","_prevLegendLayer","_almmsi","_tlmmsi","_aldt","_tldt","_needAltLegend","getGmxProperties","indexOf","ex","_displayedVessels","_notDisplayedVessels","_filterFunc","mmsiArr","dt","setUTCHours","dates","getTime","_specialVesselFilters","_setVesselFilter","removeFilter","ai","tileAttributeIndexes","k","setFilter","f","_markers","_visibleMarkers","_icons","_getSvg","svg","httpRequest","XMLHttpRequest","onreadystatechange","readyState","responseText","send","_markerIcon","vtype","group_style","type_color","exec","_eraseMyFleetMarker","layerGroup","addTo","getLayers","removeLayer","_drawMyFleetMarker","markerTemplate","group","isVisible","di","widgets","commonCalendar","getDateInterval","parsedStyleKeys","label_line","label","label_color","label_shadow","text_shadow","marker_style","group_name","default","toFixed","divIcon","addLayer","_switchLayers","l1","l2","_map","_legendSwitchedHandlers","_legendSwitched","showAlternative","_round","_addUnit","_toDd","specialVesselFilters","hasAlternativeLayers","needAltLegend","removeMyFleetTrack","showMyFleetTrack","onclick","viewState","showHistoryTrack","restoreDefault","cleanMap","hideVesselsOnMap","comment","showVesselsOnMap","redrawMarkers","clearMyFleetMarkers","clearLayers","eraseMyFleetMarker","drawMyFleetMarker","highlightMarker","paths","fill","switchLegend","onLegendSwitched","handler","formatPosition","cog_sog","heading_rot","x_y","eta","tm_pos_utc","tm_pos_loc","dt_pos_loc","eta_utc","eta_loc","icon_rot","source_orig","xmin","xmax","ymin","ymax","hideAisData","isNeeded"],"mappings":"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","file":"AISVesselCard.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1d2529ad17ec4347dab7","let PRODUCTION = false,\r\n    SIDEBAR2 = false,\r\n    BETA = false;\r\nif (has('SIDEBAR2'))\r\n    SIDEBAR2 = true;\r\nif (has('PRODUCTION'))\r\n    PRODUCTION = true;\r\nif (has('BETA'))\r\n    BETA = true;\r\n\r\nrequire(\"./all.css\");\r\nrequire(\"./Views/AisView.css\");\r\nrequire(\"./locale.js\");\r\nrequire(\"./Polyfill2.js\");\r\n\r\nconst InfoDialogView = require('./Views/InfoDialogView'),\r\n      Searcher = require('./Search/Searcher'),\r\n      Toolbox = require('./Toolbox.js');\r\n\r\nHandlebars.registerHelper('aisinfoid', function (context) {\r\n    return context.mmsi + \" \" + context.imo;\r\n});\r\n\r\nHandlebars.registerHelper('aisjson', function (context) {\r\n    return JSON.stringify(context);\r\n});\r\n\r\nconst pluginName = 'AISVesselCard',//PRODUCTION ? (BETA ? 'AISPluginBeta' : 'AISPlugin') : 'AISSearch2Test',\r\n    cssTable = 'AISVesselCard',//PRODUCTION ? (BETA ? 'AISPluginBeta' : 'AISPlugin') : 'AISSearch2',\r\n    modulePath = gmxCore.getModulePath(pluginName).replace(/https*\\:\\/\\/[^\\/]+\\/api\\//, document.location.href.replace(/\\/[^\\/]+$/, '/'));\r\n\r\nconst highlight = L.marker([0, 0], {icon:L.icon({\r\n    className:\"ais_highlight-icon\", \r\n    iconAnchor:[12, 12], \r\n    iconSize:[25,25], \r\n    iconUrl:'plugins/ais/aissearch/highlight.png'}), zIndexOffset:1000});\r\n\r\nlet ready = false;\r\nconst publicInterface = {\r\n    pluginName: pluginName,\r\n    afterViewer: function (params, map) {\r\n        if (ready)\r\n            return;\r\n        ready = true;\r\n//console.log(\"ready\");\r\n        const tools = new Toolbox(params),\r\n            options = {\r\n                aisLayerID: params.aisLayerID,// || '8EE2C7996800458AAF70BABB43321FA4',\t// searchById\t\t\t\r\n                screenSearchLayer: params.searchLayer,// || '8EE2C7996800458AAF70BABB43321FA4', // screen search\r\n\r\n                aisLastPoint: params.aisLastPoint, // || '303F8834DEE2449DAF1DA9CD64B748FE', // db search\r\n                historyLayer: params.historyLayer,\r\n                tracksLayerID: params.tracksLayerID, // || '13E2051DFEE04EEF997DC5733BD69A15',\r\n\r\n                lastPointLayerAlt: params.lastPointLayerAlt,\r\n                historyLayerAlt: params.historyLayerAlt,\r\n                tracksLayerAlt: params.tracksLayerAlt,\r\n\r\n                modulePath: modulePath,\r\n                highlight: highlight,\r\n                tools: tools\r\n            };\r\n\r\n        for (var key in params) \r\n            if (key.toLowerCase() == \"myfleet\") {\r\n                options.myFleetLayers = params[key].split(\",\").map(function (id) {\r\n                    return id.replace(/\\s/, \"\");\r\n                });\r\n                break;\r\n            }\r\n        const infoDialogView = new InfoDialogView({\r\n                tools: tools,\r\n                aisLayerSearcher: new Searcher(options),\r\n                modulePath: modulePath\r\n            }),\r\n            layersByID = nsGmx.gmxMap.layersByID,\r\n            setLayerClickHandler = function (layer) {\r\n                layer.removeEventListener('click')\r\n                layer.addEventListener('click', function (e) {\r\n//console.log('layer', e)\r\n                    if (e.gmx && e.gmx.properties.hasOwnProperty(\"imo\"))\r\n                        infoDialogView.show(e.gmx.properties)\r\n                }, false)\r\n            },\r\n            forLayers = function (layer) {\r\n                try {\r\n                    if (layer) {\r\n                        setLayerClickHandler(layer)\r\n                    }\r\n                }\r\n                catch (e) { }\r\n            };\r\n\r\n        for (var key in params) {\r\n            let layersId = params[key].split(\",\").map(function (id) {\r\n                return id.replace(/\\s/, \"\");\r\n            });\r\n            for (var i = 0; i < layersId.length; ++i) {\r\n//console.log(layersId[i])\r\n                forLayers(layersByID[layersId[i]]);\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\n// warm up db connection\r\n//fetch('//geomixer.scanex.ru/Plugins/AIS/SearchScreenAsync.ashx?minx=03&miny=0&maxx=0&maxy=0&layer=EE5587AF1F70433AA878462272C0274C&s=3020-02-13T00:00:00.000Z&e=3020-02-14T00:00:00.000Z', {credentials: 'include'});\r\n\r\ngmxCore.addModule(pluginName, publicInterface, {\r\n    css: cssTable + '.css'\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/entry.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/all.css\n// module id = 1\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/AisView.css\n// module id = 3\n// module chunks = 0","\r\n    _translationsHash.addtext('rus', {\r\n        'AISSearch2.title': 'Поиск судов',\r\n        'AISSearch2.title1': 'Найдено судов',\r\n        'AISSearch2.title2': '<b>Данных не найдено!</b>',\r\n        'AISSearch2.error': '<b>Ошибка при получении данных!</b>',\r\n        'AISSearch2.iconTitle': 'Поиск судов по экрану',\r\n        'AISSearch2.placeholder_0': 'Поиск по адресам, координатам',\r\n        'AISSearch2.placeholder_1': 'Поиск судна по названию / MMSI',\r\n        // 'AISSearch2.placeholder_1': 'Поиск судна по названию / MMSI. Поиск по адресам, координатам, кадастровым номерам'\r\n        'AISSearch2.myFleetDialog': 'Мой флот',\r\n        'AISSearch2.vesselName': 'название',\r\n        'AISSearch2.vesselAdd': 'добавить',\r\n        'AISSearch2.vesselRemove': 'удалить',\r\n        'AISSearch2.vesselExclude': 'исключить',\r\n        'AISSearch2.myFleetMembers': 'Состав',\r\n        'AISSearch2.myFleetMember': 'мой флот',\r\n        'AISSearch2.info': 'информация',\r\n        'AISSearch2.position': 'положение',\r\n        'AISSearch2.found':'Найдено: ',\r\n        'AISSearch2.filter':'Введите название или mmsi или imo судна',\r\n        'AISSearch2.filterName':'Введите название судна',\r\n        'AISSearch2.screen':'По экрану',\r\n        'AISSearch2.database':'По базе данных',\r\n        'AISSearch2.capShort': 'Поиск судов',\r\n        'AISSearch2.caption': 'Поиск судов и \"Мой флот\"',\r\n        'AISSearch2.refresh': 'обновить',\r\n        'AISSearch2.refreshing': 'обновляется',\r\n        'AISSearch2.nomyfleet': 'Сервис не доступен',\r\n        'AISSearch2.auth': 'Требуется авторизация',\r\n        'AISSearch2.vessel_info':'ИНФОРМАЦИЯ О СУДНЕ',\r\n        'AISSearch2.vessel_voyage':'СВЕДЕНИЯ О ДВИЖЕНИИ',\r\n        'AISSearch2.vessel_name': 'Название',\r\n        'AISSearch2.mmsi': 'MMSI',\r\n        'AISSearch2.imo': 'IMO',\r\n        'AISSearch2.flag_country': 'Страна',\r\n        'AISSearch2.vessel_type': 'Тип судна',\r\n        'AISSearch2.flag': 'Флаг',\r\n        'AISSearch2.callsign': 'Позывной',\r\n        'AISSearch2.length': 'Длина',\r\n        'AISSearch2.width': 'Ширина',\r\n        'AISSearch2.draught': 'Осадка',\r\n        'AISSearch2.destination': 'Назначение',\r\n        'AISSearch2.eta': 'Расчетное время прибытия',\r\n        'AISSearch2.nav_status': 'Статус',\r\n        'AISSearch2.last_sig': 'Последний сигнал',\r\n        'AISSearch2.show_track': 'трек за сутки',\r\n        'AISSearch2.hide_track': 'скрыть трек',\r\n\t\t'AISSearch2.source': 'Источник данных',\r\n\t\t'AISSearch2.sais': 'спутниковый AIS',\r\n\t\t'AISSearch2.tais': 'береговой AIS',\r\n\t\t'AISSearch2.lon': 'Долгота',\r\n\t\t'AISSearch2.lat': 'Широта',\r\n\t\t'AISSearch2.historyTab': 'История',\r\n        'AISSearch2.voyageInfo': 'Параметры движения',\r\n        'AISSearch2.DbSearchTab':'БАЗА ДАННЫХ',\r\n        'AISSearch2.ScreenSearchTab':'СУДА НА ЭКРАНЕ',\r\n        'AISSearch2.MyFleetTab':'МОЙ ФЛОТ',\r\n        'AISSearch2.dailyTrack':'трек за сутки',\r\n        'AISSearch2.allDailyTracks':'все треки',\r\n        'AISSearch2.myFleetOnly':'только мой флот',\r\n        'AISSearch2.show_pos':'показать положение и историю',\r\n        'AISSearch2.show_info':'информация о судне',\r\n        'AISSearch2.time_switch':'Время',\r\n        'AISSearch2.time_local':'Местное',\r\n        'AISSearch2.legend_switch':'Раскраска судов',\r\n        'AISSearch2.legend_type':'По типу',\r\n        'AISSearch2.legend_speed':'По скорости',\r\n        'AISSearch2.calendar_today':'сегодня',\r\n        'AISSearh2.searchresults_view':'Здесь будут отображаться<br>результаты поиска по названию,<br>IMO илм MMSI судна',\r\n        'AISSearh2.myfleet_view':'Здесь будут отображаться<br>выбранные суда<br>',\r\n        'AISSearch2.dialog_tab_general':'Общие сведения',\r\n        'AISSearch2.dialog_tab_params':'Параметры движения',\r\n        'AISSearch2.close_but':'закрыть',\r\n        'AISSearch2.myfleet_add':'добавить в мой флот',\r\n        'AISSearch2.myfleet_remove':'удалить из моего флота',\r\n        'AISSearch2.infoscreen_gen':'Основные сведения',\r\n        'AISSearch2.infoscreen_reg':'Регистр',\r\n        'AISSearch2.infoscreen_gal':'Фотогалерея',\r\n        'AISSearch2.last_update':'Обновление базы данных',\r\n        'AISSearch2.reg_general_tab':'Общие сведения',\r\n        'AISSearch2.reg_build_tab':'Сведения о постройке',\r\n        'AISSearch2.reg_chars_tab':'Размеры и скорость',\r\n        'AISSearch2.reg_devs_tab':'Оборудование',\r\n        'AISSearch2.rmrs':'РМРС',\r\n        'AISSearch2.AddIntoGroup':'Добавить в группу:',\r\n        'AISSearch2.RemoveFromGroup':'Удалить из группы',        \r\n        'AISSearch2.AllGroup':'Все',        \r\n        'AISSearch2.NewGroup':'Новая группа',        \r\n        'AISSearch2.NewGroupName':'название',        \r\n        'AISSearch2.CreateGroup':'создать',        \r\n        'AISSearch2.DeleteGroup':'удалить группу',       \r\n        'AISSearch2.DeleteGroupCommand':'Удалить группу',      \r\n        'AISSearch2.DisplaySection':'Показать на карте:',    \r\n        'AISSearch2.DisplayVesselName':'название судна',    \r\n        'AISSearch2.DisplayGroupName':'название группы',    \r\n        'AISSearch2.DisplayCog':'курс',    \r\n        'AISSearch2.DisplaySog':'скорость',   \r\n        'AISSearch2.KnotShort':' уз',\r\n        'AISSearch2.thisVesselOnly':'Только это судно: ',\r\n        'AISSearch2.allTracks':'треки всех судов',\r\n        'AISSearch2.shipsTracks':'треки судов',\r\n        'AISSearch2.markerShadow':'Цвет обводки маркера',\r\n        'AISSearch2.labelColor':'Цвет подписи маркера',\r\n        'AISSearch2.labelShadow':'Цвет обводки подписи',\r\n        'AISSearch2.zoomin_com':'Увеличить',\r\n        'AISSearch2.zoomout_com':'Уменьшить',\r\n        'AISSearch2.image1_com':'Изображение 1',\r\n        'AISSearch2.image2_com':'Изображение 2',\r\n        'AISSearch2.twoimages_com':'Два изображения',\r\n        'AISSearch2.close_com':'Закрыть',\r\n        'AISSearch2.moving':'В движении',\r\n        'AISSearch2.standing':'Стоит\\\\дрейфует',\r\n        'AISSearch2.myFleetInclude': 'добавить в мой флот',\r\n        'AISSearch2.myFleetExclude': 'удалить из моего флота',\r\n        'AISSearch2.hideAisData': 'скрыть данные AIS',\r\n    });\r\n    _translationsHash.addtext('eng', {\r\n        'AISSearch2.title': 'Searching vessels',\r\n        'AISSearch2.title1': 'Vessels found',\r\n        'AISSearch2.title2': '<b>Vessels not found!</b>',\r\n        'AISSearch2.error': '<b>Vessels not found!</b>',\r\n        'AISSearch2.iconTitle': 'Search vessels within the view area',\r\n        'AISSearch2.placeholder_0': 'Search for addresses, coordinates',\r\n        'AISSearch2.placeholder_1': 'Search by vessel name / MMSI',\r\n        // 'AISSearch2.placeholder_1' : 'Search by vessel name / MMSI. Search by addresses, coordinates, cadastre number'\r\n        'AISSearch2.myFleetDialog': 'My fleet',\r\n        'AISSearch2.vesselName': 'name',\r\n        'AISSearch2.vesselAdd': 'add',\r\n        'AISSearch2.vesselRemove': 'remove',\r\n        'AISSearch2.vesselExclude': 'exclude',\r\n        'AISSearch2.myFleetMembers': 'Members',\r\n        'AISSearch2.myFleetMember': 'my fleet',\r\n        'AISSearch2.info': 'info',\r\n        'AISSearch2.position': 'position',\r\n        'AISSearch2.found':'Found ',\r\n        'AISSearch2.filter':'Insert vessel name or mmsi or imo',\r\n        'AISSearch2.filterName':'Insert vessel name',\r\n        'AISSearch2.screen':'On screen',\r\n        'AISSearch2.database':'In database',\r\n        'AISSearch2.capShort': 'Vessel Search',\r\n        'AISSearch2.caption': 'Vessel Search & My Fleet',\r\n        'AISSearch2.refresh': 'refresh',\r\n        'AISSearch2.refreshing': 'refreshing',\r\n        'AISSearch2.nomyfleet': 'Service is unavailable',\r\n        'AISSearch2.auth': 'Authorization required',\r\n        'AISSearch2.vessel_info':'VESSEL INFORMATION',\r\n        'AISSearch2.vessel_voyage':'VOYAGE INFORMATION',\r\n        'AISSearch2.vessel_name': 'Name',\r\n        'AISSearch2.mmsi': 'MMSI',\r\n        'AISSearch2.imo': 'IMO',\r\n        'AISSearch2.flag_country': 'Flag',\r\n        'AISSearch2.vessel_type': 'Vessel type',\r\n        'AISSearch2.flag': 'Flag',\r\n        'AISSearch2.callsign': 'Callsign',\r\n        'AISSearch2.length': 'Length',\r\n        'AISSearch2.width': 'Width',\r\n        'AISSearch2.draught': 'Draught',\r\n        'AISSearch2.destination': 'Destination',\r\n        'AISSearch2.eta': 'ETA',\r\n        'AISSearch2.nav_status': 'Navigation status',\r\n        'AISSearch2.last_sig': 'Last signal',\r\n        'AISSearch2.show_track': 'show track',\r\n        'AISSearch2.hide_track': 'hide track',\r\n\t\t'AISSearch2.source': 'Source',\r\n\t\t'AISSearch2.sais': 'S-AIS',\r\n\t\t'AISSearch2.tais': 'T-AIS',\r\n\t\t'AISSearch2.lon': 'Longitude',\r\n\t\t'AISSearch2.lat': 'Latitude',\r\n\t\t'AISSearch2.historyTab': 'History',\r\n\t\t'AISSearch2.voyageInfo': 'Voyage Info',\r\n        'AISSearch2.DbSearchTab':'DATA BASE',\r\n        'AISSearch2.ScreenSearchTab':'VESSELS ON SCREEN',\r\n        'AISSearch2.MyFleetTab':'MY FLEET',\r\n        'AISSearch2.dailyTrack':'daily track',\r\n        'AISSearch2.allDailyTracks':'all tracks',\r\n        'AISSearch2.myFleetOnly':'my fleet only',\r\n        'AISSearch2.show_pos':'position and history',\r\n        'AISSearch2.show_info':'vessel data',\r\n        'AISSearch2.time_switch':'Time',\r\n        'AISSearch2.time_local':'Local',\r\n        'AISSearch2.legend_switch':'Vessel legend',\r\n        'AISSearch2.legend_type':'Type',\r\n        'AISSearch2.legend_speed':'Speed',\r\n        'AISSearch2.calendar_today':'today',\r\n        'AISSearh2.searchresults_view':'Results View of Vessel Search<br>by Name,IMO or MMSI',\r\n        'AISSearh2.myfleet_view':'List of Special Selected<br>Vessels<br>',       \r\n        'AISSearch2.dialog_tab_general':'General',\r\n        'AISSearch2.dialog_tab_params':'Parameters',\r\n        'AISSearch2.close_but':'close',\r\n        'AISSearch2.myfleet_add':'include in my fleet',\r\n        'AISSearch2.myfleet_remove':'exclude from my fleet' ,\r\n        'AISSearch2.infoscreen_gen':'General',\r\n        'AISSearch2.infoscreen_reg':'Register',\r\n        'AISSearch2.infoscreen_gal':'Gallery',\r\n        'AISSearch2.last_update':'Last update',   \r\n        'AISSearch2.reg_general_tab':'General',\r\n        'AISSearch2.reg_build_tab':'Building',\r\n        'AISSearch2.reg_chars_tab':'Specification',\r\n        'AISSearch2.reg_devs_tab':'Equipment',        \r\n        'AISSearch2.rmrs':'RMRS',\r\n        'AISSearch2.AddIntoGroup':'Add into group',\r\n        'AISSearch2.RemoveFromGroup':'Remove from group',        \r\n        'AISSearch2.AllGroup':'All',        \r\n        'AISSearch2.NewGroup':'New group',        \r\n        'AISSearch2.NewGroupName':'name',        \r\n        'AISSearch2.CreateGroup':'create',        \r\n        'AISSearch2.DeleteGroup':'delete group',       \r\n        'AISSearch2.DeleteGroupCommand':'Delete group',      \r\n        'AISSearch2.DisplaySection':'Display on map:',    \r\n        'AISSearch2.DisplayVesselName':'vessel name',    \r\n        'AISSearch2.DisplayGroupName':'group name',    \r\n        'AISSearch2.DisplayCog':'cog',    \r\n        'AISSearch2.DisplaySog':'sog',   \r\n        'AISSearch2.KnotShort':' kn',\r\n        'AISSearch2.thisVesselOnly':'Only this ship ',\r\n        'AISSearch2.allTracks':'all ships tracks ',\r\n        'AISSearch2.shipsTracks':'ships tracks ',\r\n        'AISSearch2.markerShadow':'Marker highlight',\r\n        'AISSearch2.labelColor':'Label color',\r\n        'AISSearch2.labelShadow':'Label highlight',\r\n        'AISSearch2.zoomin_com':'Zoom in',\r\n        'AISSearch2.zoomout_com':'Zoom out',\r\n        'AISSearch2.image1_com':'Image 1',\r\n        'AISSearch2.image2_com':'Image 2',\r\n        'AISSearch2.twoimages_com':'Two images',\r\n        'AISSearch2.close_com':'Close',\r\n        'AISSearch2.moving':'Moving',\r\n        'AISSearch2.standing':'Standing',\r\n        'AISSearch2.myFleetInclude': 'include in my fleet',\r\n        'AISSearch2.myFleetExclude': 'exclude from my fleet',\r\n        'AISSearch2.hideAisData': 'hide ais data',\r\n    });\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/locale.js","// Element.closest\r\n(function(proto) {\r\n    proto.matches = proto.matches || proto.mozMatchesSelector || proto.msMatchesSelector || proto.oMatchesSelector || proto.webkitMatchesSelector;\r\n    proto.closest = proto.closest || function closest(selector) {\r\n        if (!this) return null;\r\n        if (this.matches(selector)) return this;\r\n        if (!this.parentElement) {return null}\r\n        else return this.parentElement.closest(selector)\r\n      };\r\n}(Element.prototype));\r\n\r\n// Element.remove\r\n(function() {\r\n    var arr = [window.Element, window.CharacterData, window.DocumentType];\r\n    var args = [];\r\n  \r\n    arr.forEach(function (item) {\r\n      if (item) {\r\n        args.push(item.prototype);\r\n      }\r\n    });  \r\n    // from:https://github.com/jserz/js_piece/blob/master/DOM/ChildNode/remove()/remove().md\r\n    (function (arr) {\r\n      arr.forEach(function (item) {\r\n        if (item.hasOwnProperty('remove')) {\r\n          return;\r\n        }\r\n        Object.defineProperty(item, 'remove', {\r\n          configurable: true,\r\n          enumerable: true,\r\n          writable: true,\r\n          value: function remove() {\r\n            this.parentNode && this.parentNode.removeChild(this);\r\n          }\r\n        });\r\n      });\r\n    })(args);\r\n  })();\r\n\r\n// Element.append, Document.append, DocumentFragment.append\r\n(function (arr) {\r\n  arr.forEach(function (item) {\r\n    if (item.hasOwnProperty('append')) {\r\n      return;\r\n    }\r\n    Object.defineProperty(item, 'append', {\r\n      configurable: true,\r\n      enumerable: true,\r\n      writable: true,\r\n      value: function append() {\r\n        var argArr = Array.prototype.slice.call(arguments),\r\n          docFrag = document.createDocumentFragment();\r\n        \r\n        argArr.forEach(function (argItem) {\r\n          var isNode = argItem instanceof Node;\r\n          docFrag.appendChild(isNode ? argItem : document.createTextNode(String(argItem)));\r\n        });\r\n        \r\n        this.appendChild(docFrag);\r\n      }\r\n    });\r\n  });\r\n})([Element.prototype, Document.prototype, DocumentFragment.prototype]);\r\n\r\n//NodeList.forEach\r\nNodeList.prototype[\"forEach\"] = NodeList.prototype[\"forEach\"] || Array.prototype[\"forEach\"];\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Polyfill2.js","const displayInfoDialog = require('./infodialog.js'),\r\n      Polyfill = require('../Polyfill'),\r\n      VesselInfoScreen = require('./VesselInfoScreen');\r\n\r\nlet infoDialogCascade = [],\r\n    allIinfoDialogs = [],\r\n    vesselInfoScreen;\r\n\r\nmodule.exports = function ({\r\n    tools,\r\n    aisLayerSearcher: aisLayerSearcher,\r\n    modulePath: modulePath,\r\n    aisView: aisView, \r\n    myFleetView: myFleetView,\r\n    menuId:menuId }) {\r\n\r\n    vesselInfoScreen  = new VesselInfoScreen({modulePath: modulePath, aisServices: aisLayerSearcher.aisServices});\r\n    const _showPosition = function(vessel, track){ \r\n\r\n        aisView.vessel = vessel;\r\n        if (aisView.tab)\r\n        if (aisView.tab.is('.active'))\r\n            aisView.show();\r\n        else\r\n            aisView.tab.click(); \r\n        aisView.showTrack(track);    \r\n        \r\n        \r\n        window.iconSidebarWidget.open(menuId);\r\n    }, \r\n    _updateView = function (displayed, vessel, getmore){\r\n        if (displayed.vessel.ts_pos_utc!=vessel.ts_pos_utc){\r\n            $(displayed.dialog).dialog(\"close\")\r\n            return true;\r\n        }\r\n        else\r\n            return false;\r\n    };\r\n    return {\r\n        showPosition: function(vessel){  \r\n            _showPosition(vessel, vessel);\r\n            //aisView.showTrack(vessel);\r\n        },\r\n        show: function (vessel, getmore) {\r\n            let ind = Polyfill.findIndex(allIinfoDialogs, function (d) { \r\n                return (!vessel.imo || d.vessel.imo == vessel.imo) && d.vessel.mmsi == vessel.mmsi \r\n            }),\r\n            isNew = true,\r\n            dialogOffset;\r\n//console.log(vessel, ind, allIinfoDialogs)\r\n            if (ind >= 0) {\r\n                isNew = false;\r\n                let displayed = allIinfoDialogs[ind];\r\n                dialogOffset = $(displayed.dialog).parent().offset();\r\n                ind = Polyfill.findIndex(infoDialogCascade, function (d) { return d.id == displayed.dialog.id })\r\n                if(!_updateView(displayed, vessel)){\r\n                    $(displayed.dialog).parent().insertAfter($('.ui-dialog').eq($('.ui-dialog').length - 1));\r\n                    return;\r\n                }\r\n            }\r\n\r\n            let dialog = displayInfoDialog({\r\n                vessel: vessel,\r\n                getmore: getmore,\r\n                displayedTrack: tools.displayedTrack,\r\n                closeFunc: function (event) {\r\n                    let ind = Polyfill.findIndex(infoDialogCascade, function (d) { return d.id == dialog.id });\r\n                    if (ind >= 0)\r\n                        infoDialogCascade.splice(ind, 1);\r\n                    ind = Polyfill.findIndex(allIinfoDialogs, function (d) { return d.dialog.id == dialog.id });\r\n                    if (ind >= 0)\r\n                        allIinfoDialogs.splice(ind, 1);\r\n                },\r\n                aisLayerSearcher: aisLayerSearcher,\r\n                modulePath:modulePath, \r\n                aisView: aisView,\r\n                myFleetView: myFleetView,\r\n                tools: tools\r\n            },\r\n                {\r\n                    openVesselInfoScreen: vesselInfoScreen.open,\r\n                    showTrack: tools.showTrack,\r\n                    showPosition: _showPosition\r\n                })\r\n\r\n            if (!dialogOffset && infoDialogCascade.length > 0) {\r\n                let pos = $(infoDialogCascade[infoDialogCascade.length - 1]).parent().position();\r\n                dialogOffset = {left:pos.left - 10, top:pos.top + 10};\r\n            }\r\n            if (dialogOffset)\r\n                $(dialog).dialog(\"option\", \"position\", [dialogOffset.left, dialogOffset.top]);\r\n            if (ind >= 0)\r\n                infoDialogCascade.splice(ind, 0, dialog);\r\n            else if(isNew)\r\n                infoDialogCascade.push(dialog);\r\n\r\n            allIinfoDialogs.push({ vessel: vessel, dialog: dialog });\r\n            $(dialog).on(\"dialogdragstop\", function (event, ui) {\r\n                var ind = Polyfill.findIndex(infoDialogCascade, function (d) { return d.id == dialog.id });\r\n                if (ind >= 0)\r\n                    infoDialogCascade.splice(ind, 1);\r\n            });\r\n\r\n        }\r\n    };\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/Views/InfoDialogView.js","require(\"./infodialog.css\")\r\nconst SpecialFloatView = require('./SpecialFloatView.js');\r\n\r\nlet addUnit = function (v, u) {\r\n\treturn v != null && v != \"\" ? v + u : \"\";\r\n},\r\n\tformatDate,\r\n\tformatDateTime,\r\n\tround = function (d, p) {\r\n\t\tlet isNeg = d < 0,\r\n\t\t\tpower = Math.pow(10, p)\r\n\t\treturn d ? ((isNeg ? -1 : 1) * (Math.round((isNeg ? d = -d : d) * power) / power)) : d\r\n\t},\r\n\tformatVessel = function (vessel) {\r\n\t\tlet d = new Date(vessel.ts_pos_utc * 1000);\r\n\t\tvessel.ts_pos_org = vessel.ts_pos_utc;\r\n\t\tvessel.dt_pos_utc = formatDate(d);\r\n\t\tvessel.ts_pos_utc = formatDateTime(d);\r\n\t\tvessel.ts_pos_loc = \"<br><span class='local'>\" + formatDateTime(d, true) + \"</span>\";\r\n\t\tvessel.ts_eta = vessel.ts_eta ? formatDateTime(new Date(vessel.ts_eta * 1000)) : \"\";\r\n\t\tvessel.cog = !isNaN(vessel.cog)?addUnit(round(vessel.cog, 5), \"°\"):vessel.cog;\r\n\t\tvessel.sog = !isNaN(vessel.sog)?addUnit(round(vessel.sog, 5), nsGmx.Translations.getLanguage()==\"rus\"?\" уз\":\" kn\"):vessel.sog;\r\n\t\tvessel.rot = !isNaN(vessel.rot)?addUnit(round(vessel.rot, 5), nsGmx.Translations.getLanguage()==\"rus\"?\"°/мин\":\"°/min\"):vessel.rot;\r\n\t\tvessel.heading = !isNaN(vessel.heading)?addUnit(round(vessel.heading, 5), \"°\"):vessel.heading;\r\n\t\tvessel.draught = !isNaN(vessel.draught)?addUnit(round(vessel.draught, 5), nsGmx.Translations.getLanguage()==\"rus\"?\" м\":\" m\"):vessel.draught;\r\n\t\tvessel.length = !isNaN(vessel.length)?addUnit(vessel.length, nsGmx.Translations.getLanguage()==\"rus\"?\" м\":\" m\"):vessel.length;\r\n\t\tvessel.width = !isNaN(vessel.width)?addUnit(vessel.width, nsGmx.Translations.getLanguage()==\"rus\"?\" м\":\" m\"):vessel.width;\r\n\t\tvessel.source = vessel.source == 'T-AIS' ? _gtxt('AISSearch2.tais') : _gtxt('AISSearch2.sais');\r\n\t\treturn vessel;\r\n\t},\r\n\ttoDd = function (D, lng) {\r\n\t\tlet dir = D < 0 ? lng ? 'W' : 'S' : lng ? 'E' : 'N',\r\n\t\t\tdeg = Math.round((D < 0 ? D = -D : D) * 1000000) / 1000000\r\n\t\treturn deg + \"°\" + dir\r\n\t},\r\n\tddToDms = function (D, lng) {\r\n\t\tlet dms = {\r\n\t\t\tdir: D < 0 ? lng ? 'W' : 'S' : lng ? 'E' : 'N',\r\n\t\t\tdeg: 0 | (D < 0 ? D = -D : D),\r\n\t\t\tmin: 0 | D % 1 * 60,\r\n\t\t\tsec: (0 | D * 60 % 1 * 6000) / 100\r\n\t\t};\r\n\t\treturn dms.deg + \"°\" + dms.min + \"'\" + dms.sec + \"\\\" \" + dms.dir\r\n\t},\r\n\tshipCams = {};\r\n\r\nmodule.exports = function ({ vessel, closeFunc, aisLayerSearcher, getmore,\r\n\tmodulePath,\taisView, displayedTrack,\r\n\tmyFleetView, tools }, commands) {\r\n\r\n\tif (!shipCams[vessel.mmsi]){\r\n\t\tnsGmx.gmxMap.layers.forEach(l => {\r\n\t\t\tif (l && l._gmx && l._gmx.properties) {\r\n\t\t\t\tlet props = l._gmx.properties,\r\n\t\t\t\t\ttitle = props.title,\r\n\t\t\t\t\tmeta = props.MetaProperties;\r\n\t\t\t\tif (title && (title.search(/^shipcam[^_]*_/) != -1) &&\r\n\t\t\t\tmeta.ships && (meta.ships.Value.search(new RegExp('\"'+vessel.mmsi+'\"'))!=-1)) {\r\n\t\t\t\t\tshipCams[vessel.mmsi] = { \r\n\t\t\t\t\t\tlayer: props.name,\r\n\t\t\t\t\t\turls: meta.urls.Value\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n//console.log(shipCams);\r\n\t}\r\n\r\n\tformatDate = aisLayerSearcher.formatDate;\r\n\tformatDateTime = aisLayerSearcher.formatDateTime;\r\n\r\n\t// let myFleetModel = myFleetView.model,\r\n\t// \tadd = myFleetModel && myFleetModel.findIndex(vessel) < 0;\r\n\r\n\tlet canvas = $('<div class=\"ais_myfleet_dialog\"/>'),\r\n\t\tmenu = $('<div class=\"column1 menu\"></div>').appendTo(canvas),\r\n\t\tphoto = $('<div class=\"photo\"><div></div></div>').appendTo(menu),\r\n\t\tunderphoto = $('<div class=\"underphoto\"><div></div></div>').appendTo(menu),\r\n\t\tcontent = $('<div class=\"column2 content\"></div>'),\r\n\t\tbuttons = $('<div class=\"column3 buttons\"></div>'),\r\n\t\tgifLoader = '<img src=\"img/progress.gif\">'\r\n\t//console.log(content);\r\n\r\n\tcanvas.append(content).append(buttons)\r\n\r\n\tlet searchInput = $('.leaflet-ext-search'),\r\n\t\tdialogW = 610, dialogH = 250,\r\n\t\tposX = searchInput.offset().left + searchInput.width() - dialogW,\r\n\t\tposY = searchInput.offset().top + searchInput.height() + 10,\r\n\t\tdialog = showDialog(vessel.vessel_name, canvas[0], { \r\n\t\t\twidth: dialogW, height: dialogH, posX: posX, posY:posY, \r\n\t\t\tcloseFunc: closeFunc \r\n\t\t}),\r\n\t\tvessel2,\r\n\t\tmoreInfo = function (v) {\r\n\t\t\tlet smallShipIcon = '<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"14px\" height=\"14px\" viewBox=\"0 0 14 14\" style=\"margin-left: 10px\" xml:space=\"preserve\">' +\r\n\t\t\t\t'<g style=\"fill: #48aff1;\">' +\r\n\t\t\t\t'<path class=\"st0\" d=\"M13.4,11H0.6c-0.2,0-0.4,0.1-0.5,0.3c-0.1,0.2-0.1,0.4,0,0.6l1.2,1.8C1.4,13.9,1.6,14,1.8,14h9.9   c0.2,0,0.3-0.1,0.4-0.2l1.7-1.8c0.2-0.2,0.2-0.4,0.1-0.7C13.9,11.1,13.7,11,13.4,11z\"/>' +\r\n\t\t\t\t'<path class=\"st0\" d=\"M9.3,9.7h2.9c0.2,0,0.4-0.1,0.5-0.3c0.1-0.2,0.1-0.4,0-0.6L9.8,4.5C9.7,4.3,9.4,4.2,9.2,4.3   C8.9,4.4,8.7,4.6,8.7,4.9v4.3C8.7,9.5,9,9.7,9.3,9.7z\"/>' +\r\n\t\t\t\t'<path class=\"st0\" d=\"M1.2,9.7H7c0.3,0,0.6-0.3,0.6-0.6V0.6c0-0.3-0.2-0.5-0.4-0.6C6.9-0.1,6.7,0,6.5,0.3L0.7,8.8   C0.6,9,0.5,9.2,0.6,9.4C0.7,9.6,0.9,9.7,1.2,9.7z\"/>' +\r\n\t\t\t\t'</g>' +\r\n\t\t\t\t'</svg>',\r\n\t\t\t\tvesselPropTempl = '<div class=\"vessel_prop vname\"><b>{{vessel_name}}</b>' + smallShipIcon + '</div>' +\r\n\t\t\t\t\t'<div class=\"vessel_prop altvname\"><b>' + (vessel2.registry_name && vessel2.registry_name != vessel2.vessel_name ? vessel2.registry_name : '') + '&nbsp;</b></div>'\r\n\r\n\t\t\t$('.content', canvas).append(Handlebars.compile(\r\n\t\t\t\t'<div class=\"vessel_props1\">' + vesselPropTempl +\r\n\t\t\t\t'<table>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.vessel_type\"}}: </div></td><td><div class=\"vessel_prop value\">{{vessel_type}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.flag\"}}: </div></td><td><div class=\"vessel_prop value\">{{flag_country}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">IMO: </div></td><td><div class=\"vessel_prop value\">{{imo}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">MMSI: </div></td><td><div class=\"vessel_prop value mmsi\">{{mmsi}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.callsign\"}}: </div></td><td><div class=\"vessel_prop value mmsi\">{{callsign}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.source\"}}: </div></td><td><div class=\"vessel_prop value\">{{source}}</div></td></tr>' +\r\n\t\t\t\t'</table>' +\r\n\t\t\t\t'</div>'\r\n\t\t\t)(v));\r\n\r\n\t\t\t$('.content', canvas).append(Handlebars.compile(\r\n\t\t\t\t'<div class=\"vessel_props2\">' + vesselPropTempl +\r\n\t\t\t\t'<table>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">COG | SOG: </div></td><td><div class=\"vessel_prop value\">{{cog}}&nbsp;&nbsp;&nbsp;{{sog}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">HDG | ROT: </div></td><td><div class=\"vessel_prop value\">{{heading}}&nbsp;&nbsp;&nbsp;{{rot}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.draught\"}}: </div></td><td><div class=\"vessel_prop value\">{{draught}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.destination\"}}: </div></td><td><div class=\"vessel_prop value\">{{destination}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.nav_status\"}}: </div></td><td><div class=\"vessel_prop value\">{{nav_status}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">ETA: </div></td><td><div class=\"vessel_prop value\">{{ts_eta}}</div></td></tr>' +\r\n\r\n\t\t\t\t'</div>'\r\n\t\t\t)(v));\r\n\r\n\t\t\t$(underphoto).append('<table><tr>' +\r\n\t\t\t\t'<td class=\"ais_refresh\"><svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" height=\"16\" width=\"16\"><g class=\"nc-icon-wrapper\" fill=\"#444444\"><polyline data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 15,16 7,16 7,13 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 15,18 17,16 15,14 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" data-stroke=\"none\" fill=\"#444444\" points=\"15,18 17,16 15,14 \" stroke-linejoin=\"miter\" stroke-linecap=\"square\" style=\"stroke: currentColor;fill: currentColor;\"/> <polyline data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 9,8 17,8 17,11 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\"9,6 7,8 9,10 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" data-stroke=\"none\" fill=\"#444444\" points=\"9,6 7,8 9,10 \" stroke-linejoin=\"miter\" stroke-linecap=\"square\" style=\"stroke: currentColor;fill: currentColor;\"/> <rect x=\"2\" y=\"1\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" width=\"20\" height=\"22\" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/></g></svg></td>' +\r\n\t\t\t\t'<td><div class=\"vessel_prop coordinates\"><span class=\"small\">' +\r\n\t\t\t\tddToDms(v.latitude, false) + ' ' + ddToDms(v.longitude, true) +\r\n\t\t\t\t'</small></div></td>' +\r\n\t\t\t\t'</tr></table>'\r\n\t\t\t);\r\n\r\n\t\t\tlet swap = \"<span class='small'>\" + toDd(v.latitude, false) + \" \" + toDd(v.longitude, true) + \"</span>\"\r\n\t\t\t$('.ais_refresh', underphoto).click((e) => {\r\n\t\t\t\tlet mi = $('.coordinates', underphoto),\r\n\t\t\t\t\tt = mi.html()\r\n\t\t\t\tmi.html(swap)\r\n\t\t\t\tswap = t\r\n\t\t\t})\r\n\r\n\t\t\t$('.vessel_props1', canvas).hide()\r\n\t\t\t$('.vessel_prop.vname svg', canvas).css('visibility', 'hidden')\r\n\r\n\t\t}\r\n\r\n\t$(dialog).dialog({ resizable: false });\r\n\r\n\tif (!getmore) {\r\n\t\tvessel2 = $.extend({}, vessel);\r\n\t\tmoreInfo(formatVessel(vessel2));\r\n\t}\r\n\telse\r\n\t\taisLayerSearcher.searchNames([{ mmsi: vessel.mmsi, imo: vessel.imo }], function (response) {\r\n\t\t\tif (parseResponse(response)) {\r\n\t\t\t\tvessel2 = {};\r\n\t\t\t\tfor (var i = 0; i < response.Result.fields.length; ++i)\r\n\t\t\t\t\tvessel2[response.Result.fields[i]] = response.Result.values[0][i];\r\n\t\t\t\tmoreInfo(formatVessel(vessel2));\r\n\t\t\t\t$('.date', titlebar).html('<span class=\"utc\">' + vessel2.ts_pos_utc + ' UTC</span>' + vessel2.ts_pos_loc);\r\n\t\t\t\tif (typeof (getmore) == \"function\")\r\n\t\t\t\t\tgetmore(vessel2)\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tconsole.log(response)\r\n\t\t})\r\n\r\n\t// IMAGE\t\r\n\tlet scheme = document.location.href.replace(/^(https?:).+/, \"$1\");\r\n\r\n\t$('<img src=\"' + scheme + window.serverBase.replace(/^https?:/, \"\")+'plugins/ais/getphoto.ashx?mmsi=' + vessel.mmsi + '\">')\r\n\t.load(function(){\t\r\n\t\tif (this) $('div', photo).replaceWith(this);\r\n\t})\r\n\t.error(function(){\t\t\r\n\t\t$('<img src=\"' + scheme + '//photos.marinetraffic.com/ais/showphoto.aspx?size=thumb&mmsi=' + vessel.mmsi + '\">')\r\n\t\t.load(function(){\r\n\t\t\t\tif (this) $('div', photo).replaceWith(this);\r\n\t\t})\r\n\t});\t\r\n\r\n\t// BUTTONS\r\n\tlet menubuttons = $('<div class=\"menubuttons\"></div>').appendTo(buttons)\r\n\r\n\tlet openpage = $('<div class=\"button openpage\" title=\"' + _gtxt('AISSearch2.show_info') + '\">' +\r\n\t\t'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">' +\r\n\t\t'<g class=\"nc-icon-wrapper\" style=\"fill:currentColor\">' +\r\n\t\t'<path d=\"M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 9h2V7h-2v2z\"/>' +\r\n\t\t'</g>' +\r\n\t\t'</svg>'\r\n\t\t+ '</div>')\r\n\t\t.appendTo(menubuttons)\r\n\t\t.on('click', () => commands.openVesselInfoScreen.call(null, vessel, vessel2));\r\n\r\n\r\n\tlet shipCam = shipCams[vessel.mmsi.toString()],\r\n\tsetImages = function(shipCam, vessel){\r\n\t\tlet moment = new Date(vessel.ts_pos_org*1000);\r\n\t\tmoment.setMinutes(moment.getMinutes() + moment.getTimezoneOffset())\r\n\t\tmoment = moment.getFullYear() + \"-\" + (moment.getMonth()+1) + \"-\" + moment.getDate() + \" \" + \r\n\t\tmoment.getHours() + \":\" + moment.getMinutes() + \":\" + moment.getSeconds();\r\n//console.log(moment)\t\r\n\t\tlet images = [];\r\n\t\tshipCam.urls.split(' ').forEach((url) => {\r\n\t\t\timages.push({url: serverBase.replace(/https?:/, document.location.protocol).replace(/\\/$/, \"\") + url.replace(/\"/g, '') + \r\n\t\t\t(url.search(/\\?/)!=-1?'&':'?') +\r\n\t\t\t'layer=' + shipCam.layer +\r\n\t\t\t'&mmsi=' + vessel.mmsi +\r\n\t\t\t'&ts=' + moment});\r\n\t\t});\r\n//console.log(images)\t\r\n\t\treturn images;\r\n\t}\r\n\r\n\tif (shipCam) {\r\n\t\tif (!shipCam.view) {\r\n\t\t\tshipCam.view = new SpecialFloatView(\r\n\t\t\t\tsetImages(shipCam, vessel2 ? vessel2 : vessel),\r\n\t\t\t\tvessel.mmsi\r\n\t\t\t);\r\n\t\t}\r\n\t\tlet special = shipCam.view;\r\n\t\t//console.log(special);\r\n\t\tlet showCamBut = $('<div class=\"ais button showcam\" title=\"' + _gtxt('AISSearch2.show_pos') + '\">' +\r\n\t\t\t'<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"22\" height=\"22\"><title>camera</title><g class=\"nc-icon-wrapper\" fill=\"#384b50\" style=\"fill:currentColor\"><path d=\"M21,4H17L15,1H9L7,4H3A3,3,0,0,0,0,7V19a3,3,0,0,0,3,3H21a3,3,0,0,0,3-3V7A3,3,0,0,0,21,4ZM12,18a5,5,0,1,1,5-5A5,5,0,0,1,12,18Z\"/></g></svg>' +\r\n\t\t\t'</div>')\r\n\t\t\t.appendTo(menubuttons)\r\n\t\t\t.on('click', function (e) {\r\n\t\t\t\tlet b = e.currentTarget\r\n\t\t\t\tif (b.classList.contains('active')) {\r\n\t\t\t\t\tb.classList.remove('active');\r\n\t\t\t\t\tshipCam.visible = false;\r\n\t\t\t\t\tspecial.close();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tb.classList.add('active');\r\n\t\t\t\t\tspecial.show(setImages(shipCam, vessel2 ? vessel2 : vessel), () => {\r\n\t\t\t\t\t\tb.classList.remove('active');\r\n\t\t\t\t\t\tshipCam.visible = false;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tshipCam.visible = true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t//console.log(showCamBut)\r\n\t\t//console.log(shipCams[vessel.mmsi.toString()].visible)\r\n\t\tif (shipCam.visible) {\r\n\t\t\tshowCamBut[0].classList.add('active');\r\n\t\t\tspecial.show(setImages(shipCam, vessel2 ? vessel2 : vessel), () => {\r\n\t\t\t\tshowCamBut[0].classList.remove('active');\r\n\t\t\t\tshipCam.visible = false;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tlet progress = $('<div class=\"progress\"></div>')\r\n\t\t.appendTo(menubuttons);\r\n\r\n\t// TITLEBAR\t\r\n\tcanvas.parent('div').css({ 'margin': '0', 'overflow': 'hidden' })\r\n\tlet titlebar = $(dialog).parent().find('.ui-dialog-titlebar').css('padding', '0')\r\n\t\t.html('<table class=\"ais_info_dialog_titlebar\">' +\r\n\t\t'<tr><td><div class=\"date\">' +\r\n\t\t(!getmore ? Handlebars.compile('<span class=\"utc\">{{{ts_pos_utc}}} UTC</span>{{{ts_pos_loc}}}')(vessel2 ? vessel2 : vessel) : '') +\r\n\t\t'</div></td>' +\r\n\t\t\r\n\t\t'<td><div class=\"choose chooser done\"><span unselectable=\"on\">'+_gtxt('AISSearch2.dialog_tab_params')+'</span></div></td>' +\r\n\t\t'<td><div class=\"choose chooser\"><span unselectable=\"on\">'+_gtxt('AISSearch2.dialog_tab_general')+'</span></div></td>' +\r\n\t\t\r\n\t\t'<td id=\"closebut\" title=\"'+_gtxt('AISSearch2.close_but')+'\"><div class=\"ais_info_dialog_close-button\" title=\"'+_gtxt(\"AISSearch2.close_but\")+'\"></div></td></tr>' +\r\n\t\t'</table>'),\r\n\t\tonDone = function (e) { \r\n\t\t\te.stopPropagation(); \r\n\t\t\t$('.choose', titlebar).removeClass('done'); \r\n\t\t\t$(e.currentTarget).addClass('done'); \r\n\t\t};\r\n\r\n\t$('#closebut', titlebar).on('click', (e) => {$(dialog).dialog(\"close\"); })\r\n\t.on('mouseover', (e) => { \r\n\t\t$('.ais_info_dialog_close-button', titlebar).css('background', 'url(\"data:image/svg+xml;charset=utf8,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\'%3E%3Cline x1=\\'0\\' y1=\\'0\\' x2=\\'12\\' y2=\\'12\\' style=\\'stroke:%2348aff1;stroke-width:2px\\'/%3E%3Cline x1=\\'0\\' y1=\\'12\\' x2=\\'12\\' y2=\\'0\\' style=\\'stroke:%2348aff1;stroke-width:2px\\'/%3E%3C/svg%3E\") no-repeat')\r\n\t})\r\n\t.on('mouseout', (e) => { \r\n\t\t$('.ais_info_dialog_close-button', titlebar).attr('style', '')\r\n\t})\r\n\t//url(\"data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3Cline x1='0' y1='0' x2='12' y2='12' style='stroke:%2348aff1;stroke-width:2px'/%3E%3Cline x1='0' y1='12' x2='12' y2='0' style='stroke:%2348aff1;stroke-width:2px'/%3E%3C/svg%3E\") no-repeat\r\n\t$('.chooser', titlebar).eq(1).on('mousedown', (e) => { onDone(e); $('.vessel_props1', canvas).show(); $('.vessel_props2', canvas).hide() })\r\n\t$('.chooser', titlebar).eq(0).on('mousedown', (e) => { onDone(e); $('.vessel_props2', canvas).show(); $('.vessel_props1', canvas).hide() })\r\n\t$('.date span', titlebar).on('mousedown', (e) => { e.stopPropagation(); })\r\n\r\n\t//$( dialog ).on( \"dialogdragstart\", function( e, ui ) {console.log(e);console.log(ui)} );\r\n\r\n\treturn dialog\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Views/infodialog.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/infodialog.css\n// module id = 8\n// module chunks = 0","require(\"./SpecialFloatView.css\")\r\nconst _cssClassName = \"special\";\r\nconst BaseFloatView = require('./BaseFloatView.js');\r\nconst SpecialFloatView = function (images, mmsi){\r\n    BaseFloatView.apply(this, arguments);\r\n    this.images = images;\r\n//console.log(this.images)\r\n    this.frame.innerHTML = '<div class=\"' + _cssClassName + '\"></div><img class=\"img1\"><img class=\"img2\">';\r\n    if (FormData.prototype.set && mmsi==273316240)\r\n        this.frame.innerHTML += '<table class=\"logos\"><tr><td><img src=\"plugins/AIS/AISSearch/png/anchors.png\" style=\"position: unset;\"></td></tr>' +\r\n        '<tr><td><img src=\"plugins/AIS/AISSearch/png/rscc-logo.png\" style=\"position: unset;\"></td></tr></table>';\r\n    else\r\n        this.frame.innerHTML += '<table class=\"logos\" style=\"background:none\"><tr><td></td></tr></table>';\r\n    this.left = -10000;\r\n\r\n    this.contextMenu = document.createElement(\"div\"); \r\n    this.contextMenu.className = 'mf_group_menu';\r\n    let html = '<div class=\"command zoomin\">' + _gtxt('AISSearch2.zoomin_com') + '</div>' +\r\n    '<div class=\"command zoomout\" style=\"display:none\">' + _gtxt('AISSearch2.zoomout_com') + '</div>'; \r\n    if (images.length == 2) {\r\n        html += '<div class=\"command image1\">' + _gtxt('AISSearch2.image1_com') + '</div>' +\r\n            '<div class=\"command image2\">' + _gtxt('AISSearch2.image2_com') + '</div>' +\r\n            '<div class=\"command twoimages\">' + _gtxt('AISSearch2.twoimages_com') + '</div>';\r\n    }\r\n    html += '<div class=\"command close\">' + _gtxt('AISSearch2.close_com') + '</div>';\r\n    this.contextMenu.innerHTML = html;\r\n\r\n    this.contextMenu.addEventListener('mousedown', (e=>{\r\n        if(e.stopPropagation) e.stopPropagation();\r\n        //if(e.preventDefault) e.preventDefault();\r\n        e.cancelBubble=true;\r\n        e.returnValue=false;\r\n    }).bind(this)); \r\n    this.contextMenu.addEventListener('mouseleave', (e=>{\r\n            this.contextMenu.style.display = \"none\";\r\n            this.contextMenu.remove();\r\n    }).bind(this));  \r\n\r\n    let closeCom = this.contextMenu.querySelector('.close'),\r\n    zinCom = this.contextMenu.querySelector('.zoomin'),\r\n    zoutCom = this.contextMenu.querySelector('.zoomout'),\r\n    img1Com = this.contextMenu.querySelector('.image1'),\r\n    img2Com = this.contextMenu.querySelector('.image2'),\r\n    twoimgCom = this.contextMenu.querySelector('.twoimages'),\r\n    l, t , w , h,\r\n    rc1, rc2,\r\n    content = this.frame.querySelector('.'+_cssClassName),    \r\n    image1 = this.frame.querySelector('img.img1'),\r\n    image2 = this.frame.querySelector('img.img2'),\r\n    logos = this.frame.querySelector('.logos'),\r\n    showTwo = false,\r\n    restoreSize = function(){\r\n        let h1 = Math.floor(image1.getBoundingClientRect().height),\r\n        h2 = Math.floor(image2.getBoundingClientRect().height);\r\n        if (h1)        \r\n            content.style.height = h1+\"px\"; \r\n        else if (h2)       \r\n            content.style.height = h2+\"px\";\r\n        showTwo = false;         \r\n    },\r\n    zoomIn = function(image, w, h, wiw, wih){\r\n        let setPlace1 = function(){\r\n            image.style.width = wiw + \"px\";\r\n            image.style.height = \"\";\r\n\r\n            image.style.left = 0;\r\n            image.style.top = Math.round((wih - image.getBoundingClientRect().height)/2) + \"px\";\r\n        },\r\n        setPlace2 = function(){\r\n            image.style.width = \"\";\r\n            image.style.height = wih + \"px\";\r\n \r\n            image.style.left = Math.round((wiw - image.getBoundingClientRect().width)/2) + \"px\"; \r\n            image.style.top = 0; \r\n        };\r\n        if(wiw/wih>1)\r\n            if(parseInt(w)/parseInt(h)>wiw/wih)\r\n                setPlace1();\r\n            else\r\n                setPlace2();\r\n        else\r\n            if(parseInt(w)/parseInt(h)>wiw/wih)\r\n                setPlace1();\r\n            else\r\n                setPlace2();\r\n    },\r\n    zoomIn2 = function(image1, image2, w, h, wiw, wih){\r\n        let setPlace1 = function(){\r\n            image1.style.width = wiw + \"px\";\r\n            image2.style.width = wiw + \"px\";\r\n            image1.style.height = \"\";\r\n            image2.style.height = \"\";\r\n\r\n            image1.style.left = 0;\r\n            image2.style.left = 0;\r\n            image1.style.top = Math.round(wih/2 - image1.getBoundingClientRect().height) + \"px\";           \r\n            image2.style.top = image1.getBoundingClientRect().bottom + \"px\"; \r\n        },\r\n        setPlace2 = function(){\r\n            image1.style.width = \"\";\r\n            image2.style.width = \"\";\r\n            image1.style.height = Math.ceil(wih/2) + \"px\";\r\n            image2.style.height = Math.floor(wih/2) + \"px\";\r\n\r\n            image1.style.top = 0;       \r\n            image2.style.top = image1.getBoundingClientRect().bottom + \"px\"; \r\n            image1.style.left = Math.round((wiw - image1.getBoundingClientRect().width)/2) + \"px\"; \r\n            image2.style.left = image1.style.left;             \r\n        };\r\n        if(wiw/wih>1)\r\n            if(parseInt(w)/parseInt(h)>wiw/wih)\r\n                setPlace1();\r\n            else\r\n                setPlace2();\r\n        else\r\n            if(parseInt(w)/parseInt(h)>wiw/wih)        \r\n                setPlace1();\r\n            else\r\n                setPlace2();\r\n    };\r\n    closeCom.addEventListener(\"click\",(e=>{ \r\n        !this.allowMove && zoutCom.click(); \r\n        this.contextMenu.remove(); \r\n        this.left = -10000;\r\n\r\n        image1.style.display = \"block\";\r\n        image2.style.display = \"none\";\r\n        restoreSize();\r\n\r\n        this.hide(); \r\n        image1.src = \"\";\r\n        image2.src = \"\";\r\n\r\n        this.closeCallback();\r\n    }).bind(this));\r\n    zinCom.addEventListener(\"click\",(e=>{\r\n        this.contextMenu.remove();\r\n        e.srcElement.style.display = 'none'; \r\n        zoutCom.style.display = 'block';\r\n        img1Com && (img1Com.style.display = 'none');\r\n        img2Com && (img2Com.style.display = 'none');\r\n        twoimgCom && (twoimgCom.style.display = 'none');\r\n        let st = getComputedStyle(content);\r\n        w = st.width; h = st.height; \r\n        l = this.left; t = this.top;\r\n        this.left = 0; \r\n        this.top = 0;  \r\n\r\n        content.style.width = window.innerWidth + \"px\";   \r\n        content.style.height = window.innerHeight + \"px\"; \r\n\r\n        rc1 = image1.getBoundingClientRect();\r\n        rc2 = image2.getBoundingClientRect();\r\n        let wiw = window.innerWidth, wih = window.innerHeight;\r\n// console.log((parseInt(w)+\"/ \"+parseInt(h)));\r\n// console.log(\"w/h \"+(parseInt(w)/parseInt(h)));\r\n// console.log(\"wiw/wih \"+(wiw/wih));\r\n\r\n        if (rc1.width && rc1.height && !rc2.width && !rc2.height){\r\n            zoomIn(image1, w, h, wiw, wih);\r\n            logos.style.left = image1.style.left;\r\n            logos.style.top = image1.style.top;\r\n        }\r\n        if (rc2.width && rc2.height && !rc1.width && !rc1.height){\r\n            zoomIn(image2, w, h, wiw, wih);\r\n            logos.style.left = image2.style.left;\r\n            logos.style.top = image2.style.top;\r\n        }\r\n        if (rc2.width && rc2.height && rc1.width && rc1.height){\r\n            zoomIn2(image1, image2, w, h, wiw, wih);\r\n            logos.style.left = image1.style.left;\r\n            logos.style.top = image1.style.top;\r\n        }\r\n\r\n        content.classList.add('zoomed_in');  \r\n        image1.classList.add('zoomed_in');   \r\n        image2.classList.add('zoomed_in'); \r\n        logos.classList.add('zoomed_in'); \r\n        this.allowMove = false;\r\n    }).bind(this));\r\n    zoutCom.addEventListener(\"click\",(e=>{\r\n        this.contextMenu.remove();\r\n        e.srcElement.style.display = 'none'; \r\n        zinCom.style.display = 'block';\r\n        img1Com && (img1Com.style.display = 'block');\r\n        img2Com && (img2Com.style.display = 'block');\r\n        twoimgCom && (twoimgCom.style.display = 'block');\r\n        this.left = l; \r\n        this.top = t;\r\n        content.style.width = w;   \r\n        content.style.height = h; \r\n\r\n        if (rc1.width && rc1.height) {     \r\n            image1.style.left = Math.floor(rc1.left) + \"px\";\r\n            image1.style.top = Math.floor(rc1.top) + \"px\";              \r\n            image1.style.height = Math.floor(rc1.height) + \"px\";\r\n            image1.style.width = Math.floor(rc1.width) + \"px\"; \r\n        }\r\n        if (rc2.width && rc2.height) {     \r\n            image2.style.left = Math.floor(rc2.left) + \"px\";\r\n            image2.style.top = Math.floor(rc2.top) + \"px\";       \r\n            image2.style.height = Math.floor(rc2.height) + \"px\";\r\n            image2.style.width = Math.floor(rc2.width) + \"px\";\r\n        }        \r\n        logos.style.left = 0;\r\n        logos.style.top = 0;\r\n\r\n        content.classList.remove('zoomed_in'); \r\n        image1.classList.remove('zoomed_in');   \r\n        image2.classList.remove('zoomed_in');   \r\n        logos.classList.remove('zoomed_in');  \r\n        this.allowMove = true;  \r\n    }).bind(this));\r\n    img1Com && img1Com.addEventListener(\"click\",(e=>{\r\n        this.contextMenu.remove();\r\n        restoreSize();\r\n        image1.style.top = 0;\r\n        image1.style.display = \"block\";\r\n        image2.style.display = \"none\";\r\n    }).bind(this));\r\n    img2Com && img2Com.addEventListener(\"click\",(e=>{\r\n        this.contextMenu.remove();\r\n        restoreSize();\r\n        image2.style.top = 0;\r\n        image2.style.display = \"block\";\r\n        image1.style.display = \"none\";\r\n    }).bind(this));\r\n    twoimgCom && twoimgCom.addEventListener(\"click\",(e=>{\r\n        showTwo = true;\r\n\r\n        this.contextMenu.remove();\r\n        image1.style.display = \"block\";\r\n        image2.style.display = \"block\"; \r\n        let h1 = Math.floor(image1.getBoundingClientRect().height),\r\n        h2 = Math.floor(image2.getBoundingClientRect().height);\r\n        image2.style.top = Math.floor(h1)+\"px\";\r\n        if (h1 || h2)\r\n            content.style.height = (h1 + h2) + \"px\"; \r\n    }).bind(this));\r\n    image1.addEventListener(\"click\", (e=>{\r\n        if(!this.allowMove)\r\n            zoutCom.click();\r\n    }).bind(this));\r\n    image2.addEventListener(\"click\", (e=>{\r\n        if(!this.allowMove)\r\n            zoutCom.click();\r\n    }).bind(this));\r\n    content.addEventListener(\"click\", (e=>{\r\n        if(!this.allowMove)\r\n            zoutCom.click();\r\n    }).bind(this));\r\n\r\n    this.frame.addEventListener(\"contextmenu\", (e=>{\r\n        e.preventDefault();\r\n        this.frame.append(this.contextMenu);\r\n        this.contextMenu.style.display = \"block\";\r\n\r\n        if ((e.clientX - 10 + this.contextMenu.offsetWidth) < window.innerWidth) { \r\n            this.contextMenu.style.left = (e.clientX - this.left - 10) + \"px\";\r\n            this.contextMenu.style.right = \"\";\r\n        }\r\n        else{ \r\n            this.contextMenu.style.right = (this.right - e.clientX - 10) + \"px\";\r\n            this.contextMenu.style.left = \"\";\r\n        }\r\n        if ((e.clientY - 10 + this.contextMenu.offsetHeight) < window.innerHeight) {\r\n            this.contextMenu.style.top = (e.clientY - this.top - 10) + \"px\";\r\n            this.contextMenu.style.bottom = \"\";\r\n        }\r\n        else {  \r\n            this.contextMenu.style.bottom = (this.bottom - e.clientY - 10) + \"px\";\r\n            this.contextMenu.style.top = \"\";\r\n        }       \r\n    }).bind(this));\r\n}\r\n\r\nSpecialFloatView.prototype = Object.create(BaseFloatView.prototype);\r\n\r\nSpecialFloatView.prototype.close = function(){ \r\n    this.contextMenu.querySelector('.close').click();\r\n}\r\n\r\nSpecialFloatView.prototype.show = function(images, closeCallback){    \r\n    BaseFloatView.prototype.show.apply(this, arguments);\r\n    this.closeCallback = closeCallback;\r\n    if (this.left>-9999 && images.length>1)\r\n        return; \r\n    this.images = images;  \r\n//console.log(this.images)  \r\n\r\n    let content = this.frame.querySelector('.'+_cssClassName),\r\n    image1 = this.frame.querySelector('img.img1'),\r\n    image2 = this.frame.querySelector('img.img2'),\r\n    rc = this.frame.getBoundingClientRect(),\r\n    imageUrl = this.images[0].url + (this.images[0].url.search(/\\?/)!=1?\"&r=\":\"?r=\"),\r\n    timers = [];\r\n \r\n    let downloadingImage1 = new Image();\r\n    downloadingImage1.onload = function(){\r\n        image1.src = this.src; \r\n        image1.style.left = 0; image1.style.top = 0;\r\n        image1.style.width = rc.width + \"px\";\r\n        //image1.style.height = getComputedStyle(image1).height;\r\n//console.log(downloadingImage1.width)  \r\n//console.log(getComputedStyle(image1).height)  \r\n//console.log(this.width)  \r\n//console.log(image1.getBoundingClientRect())  \r\n        if (image1.getBoundingClientRect().height)        \r\n            content.style.height = Math.floor(image1.getBoundingClientRect().height)+\"px\"; \r\n    };\r\n    downloadingImage1.onerror = function (e) {\r\n        image1.src = \"\";\r\n        image1.style.height = \"\"; \r\n    };\r\n    downloadingImage1.src = imageUrl + Math.random();\r\n\r\n    if (this.images[1]) {\r\n        let downloadingImage2 = new Image(),        \r\n        imageUrl = this.images[1].url + (this.images[1].url.search(/\\?/)!=1?\"&r=\":\"?r=\");\r\n        downloadingImage2.onload = function () {\r\n            image2.src = this.src;\r\n            image2.style.left = 0; image2.style.top = 0;\r\n            image2.style.width = rc.width + \"px\";\r\n            //image2.style.height = getComputedStyle(image2).height;\r\n            image2.style.display = \"none\";\r\n            //console.log(image1.getBoundingClientRect())\r\n        };\r\n        downloadingImage2.onerror = function (e) {\r\n            image2.src = \"\";\r\n            image2.style.height = \"\"; \r\n        };\r\n        downloadingImage2.src = imageUrl + Math.random();\r\n    }\r\n \r\n\r\n    if (this.left>-9999)\r\n        return; \r\n\r\n    this.left = document.defaultView.getWindowWidth() - this.width;\r\n    this.top = 0;\r\n\r\n//console.log(\"SET TIMERS\")\r\n\r\n    // UPDATE 1\r\n    let intrerval = 1000 * 60 * 1,\r\n    thisInst = this,\r\n    timer = setTimeout(function update() {\r\n//console.log(\"TIME1 \" + timer)\r\n        let downloadingImage1 = new Image();\r\n        downloadingImage1.onload = function () {\r\n            image1.src = downloadingImage1.src;\r\n        };\r\n        downloadingImage1.src = thisInst.images[0].url + (thisInst.images[0].url.search(/\\?/)!=1?\"&r=\":\"?r=\") + Math.random();\r\n//console.log(downloadingImage1.src)\r\n        timers[0] = setTimeout(update, intrerval);\r\n    }, intrerval);\r\n    timers.push(timer);\r\n\r\n    // UPDATE 2    \r\n    if (this.images[1]) {\r\n        timer = setTimeout(function update() {\r\n//console.log(\"TIME2 \" + timer)\r\n            let downloadingImage2 = new Image();\r\n            downloadingImage2.onload = function () {\r\n                image2.src = downloadingImage2.src;\r\n            };\r\n            downloadingImage2.src = thisInst.images[1].url + (thisInst.images[1].url.search(/\\?/)!=1?\"&r=\":\"?r=\") + Math.random();\r\n//console.log(downloadingImage2.src)\r\n            timers[1] = setTimeout(update, intrerval);\r\n        }, intrerval);\r\n        timers.push(timer)\r\n    }\r\n    \r\n    let closeCom = this.contextMenu.querySelector('.close');\r\n    this.disposeTimer && closeCom.removeEventListener(\"click\", this.disposeTimer);\r\n    this.disposeTimer = function () {\r\n//console.log(\"STOP TIME\")\r\n        timers.forEach(t=>clearTimeout(t));\r\n        timers.length = 0;\r\n    };\r\n    closeCom.addEventListener(\"click\", this.disposeTimer);\r\n}\r\n\r\nmodule.exports = SpecialFloatView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/SpecialFloatView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/SpecialFloatView.css\n// module id = 10\n// module chunks = 0","let _getMaxZindex = function(){\r\n    let dialogs = document.querySelectorAll('.ui-dialog'),\r\n    z,\r\n    zMax = Array.prototype.map.call(document.querySelectorAll('.ui-front'), e=>e).reduce((p,c)=>{\r\n        z = parseFloat(getComputedStyle(c).zIndex);\r\n        return isNaN(z) || z<=p ? p : z;\r\n    }, 0);\r\n    zMax = Array.prototype.map.call(document.querySelectorAll('.float_view'), e=>e).reduce((p,c)=>{\r\n        z = parseFloat(getComputedStyle(c).zIndex);\r\n        return isNaN(z) || z<=p ? p : z;\r\n    }, zMax);\r\n    return zMax;\r\n};\r\nconst BaseFloatView = function (){\r\n    let frame = document.createElement(\"div\"); \r\n    frame.className = \"float_view\";\r\n    frame.style.position = \"absolute\";\r\n    frame.style.display = \"none\";\r\n    let x, y;\r\n    frame.addEventListener('mousedown', e=>{\r\n        if (!this.allowMove)\r\n            return;\r\n            \r\n        x = e.clientX; y = e.clientY;\r\n        frame.style.zIndex = _getMaxZindex();\r\n        document.body.append(frame);\r\n            \r\n        if(e.stopPropagation) e.stopPropagation();\r\n        if(e.preventDefault) e.preventDefault();\r\n        e.cancelBubble=true;\r\n        e.returnValue=false;\r\n    });\r\n    frame.addEventListener('mouseup', e=>{\r\n        x = false; y = false;\r\n    });\r\n    document.body.addEventListener('mousemove', e=>{\r\n        if (!x && !y)\r\n            return;\r\n        let dx = e.clientX - x, dy = e.clientY - y,\r\n        rect = frame.getBoundingClientRect(),\r\n        fx = rect.left, fy = rect.top;\r\n        frame.style.left = fx + dx + \"px\";\r\n        frame.style.top = fy + dy + \"px\";\r\n        x = e.clientX; y = e.clientY;\r\n\r\n        if(e.stopPropagation) e.stopPropagation();\r\n        if(e.preventDefault) e.preventDefault();\r\n        e.cancelBubble=true;\r\n        e.returnValue=false;\r\n    }); \r\n    this.frame = frame;   \r\n    this.allowMove = true;\r\n}\r\n\r\nBaseFloatView.prototype = function () {\r\n    return {\r\n        get left(){ return this.frame.getBoundingClientRect().left; },\r\n        set left(v){ this.frame.style.left = v + \"px\"; },\r\n        get top(){ return this.frame.getBoundingClientRect().top; },\r\n        set top(v){ this.frame.style.top = v + \"px\"; },\r\n        get right(){ return this.frame.getBoundingClientRect().right; },\r\n        get bottom(){ return this.frame.getBoundingClientRect().bottom; },\r\n        get width(){ return this.frame.getBoundingClientRect().width; },\r\n        set width(v){ this.frame.style.width = v + \"px\"; },\r\n        get height(){ return this.frame.getBoundingClientRect().height; },\r\n        set height(v){ this.frame.style.height = v + \"px\"; },\r\n        show: function () {\r\n            this.frame.style.zIndex = _getMaxZindex();\r\n            document.body.append(this.frame);\r\n            this.frame.style.display = \"block\";\r\n        },\r\n        hide: function () {\r\n            this.frame.remove();\r\n        }\r\n    }\r\n}();\r\n\r\nmodule.exports = BaseFloatView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/BaseFloatView.js","module.exports = { \r\n\tfind: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn value;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn undefined;\r\n\t},\r\n\tfindIndex: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn i;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Polyfill.js","require(\"./VesselInfoScreen.css\")\r\n\r\nmodule.exports = function ({modulePath, aisServices}){\r\n        var _ais,  \r\n        _galery, \r\n        _register, \r\n        _regcap,    \r\n        _leftPanel,  \r\n        _minh,\r\n        _lloyds,\r\n        resize,\r\n        menuAction,       \r\n\t    scheme = document.location.href.replace(/^(https?:).+/, \"$1\"),\r\n        show = function(vessel){\r\n//console.log(vessel) \r\n            $(\"body\").append(''+  \r\n'<table class=\"vessel-info-page overlay\">' +\r\n        '<tr>' +\r\n            '<td>' +\r\n'<table class=\"vessel-info-page container\">' +\r\n    '<tr>' +\r\n        '<td class=\"column1\">' +\r\n                '<table>' +\r\n                    '<tr>' +\r\n                        '<td>' +\r\n                            '<div>' +\r\n                                '<div class=\"title\">' +\r\n                                   '<div class=\"cell\">'+vessel.vessel_name+'<div class=\"timestamp\">'+vessel.ts_pos_utc+'</div></div>  ' +                  \r\n                                '</div>' +\r\n                                '<div class=\"menu\">' +\r\n                                '<div class=\"ais cell menu-item active\"><img src=\"'+modulePath+'svg/info_gen.svg\" class=\"icon\">'+_gtxt(\"AISSearch2.infoscreen_gen\")+'</div>' +\r\n                                '<div class=\"register cell menu-item\"><img src=\"'+modulePath+'svg/info.svg\" class=\"icon\">'+_gtxt(\"AISSearch2.infoscreen_reg\")+'</div>' +\r\n                                '<div class=\"galery cell menu-item\"><img src=\"'+modulePath+'svg/photogallery.svg\" class=\"icon\">'+_gtxt(\"AISSearch2.infoscreen_gal\")+'<div class=\"counter\">0</div></div>' +\r\n                               '</div>' +\r\n                            '</div>  ' +\r\n                        '</td>' +\r\n                    '</tr>' +\r\n                    '<tr>' +\r\n                        '<td class=\"frame\">' +\r\n                                '<div class=\"photo\">' +\r\n                                    '<img src=\"'+modulePath+'svg/no-image.svg\" class=\"no-image\">' +\r\n                                '</div>  ' +  \r\n                        '</td>' +\r\n                    '</tr>' +\r\n                '</table>' +\r\n    '</td>' +\r\n    '<td class=\"column2\">' +\r\n        '<div class=\"close-button-holder\">' +\r\n            '<div class=\"close-button\" title=\"'+_gtxt(\"AISSearch2.close_but\")+'\"></div>' +\r\n        '</div>' +\r\n        '<div class=\"register panel\">' +\r\n            '<div class=\"caption\">' +\r\n                '<span style=\"display: inline-block;height: 100%;vertical-align: middle;width: 40px;\"></span>' +\r\n                '<img src=\"img/progress.gif\" style=\"vertical-align: middle\">' +\r\n            '</div>' +\r\n            '<div class=\"menu\">' +\r\n                '<div>' +\r\n                    '<table>' +\r\n                        '<tr>' +\r\n                            '<td><div class=\"general menu-item active\">'+_gtxt(\"AISSearch2.reg_general_tab\")+'</div></td>' +\r\n                            '<td><div class=\"build menu-item\">'+_gtxt(\"AISSearch2.reg_build_tab\")+'</div></td>' +\r\n                            '<td><div class=\"dimensions menu-item\">'+_gtxt(\"AISSearch2.reg_chars_tab\")+'</div></td>' +\r\n                            '<td><div class=\"gears menu-item\">'+_gtxt(\"AISSearch2.reg_devs_tab\")+'</div></td>' +\r\n                        '</tr>' +\r\n                    '</table>' +\r\n                '</div>' +\r\n            '</div>' +\r\n            '<div class=\"content\">' +\r\n                '<div class=\"placeholder\"></div>' +\r\n            '</div>' +\r\n        '</div>' +\r\n\r\n        '<div class=\"galery panel\">' +   \r\n'<form action=\"' + aisServices + 'Upload.ashx\" class=\"uploadFile\" method=\"post\" enctype=\"multipart/form-data\" target=\"upload_target\" style=\"display:none\" >' +\r\n    '<input name=\"Filedata\" class=\"chooseFile\" type=\"file\">' +    \r\n    '<input name=\"imo\" type=\"hidden\" value=\"'+vessel.imo+'\">' +    \r\n    '<input name=\"mmsi\" type=\"hidden\" value=\"'+vessel.mmsi+'\">' +\r\n          //'<input type=\"submit\" name=\"submitBtn\" value=\"Upload\" />' +\r\n'</form>' + \r\n'<iframe id=\"upload_target\" name=\"upload_target\" src=\"#\" style=\"width:0;height:0;border:0px solid #fff;\"></iframe>' + \r\n            '<div class=\"placeholder\">' +\r\n                '<div class=\"photo\" onclick=\"document.querySelector(\\'.vessel-info-page .chooseFile\\').click();\"'+\r\n                ' style=\"background-image: url('+modulePath+'svg/add-image.svg);background-size: 50px;\"></div>' +                \r\n            '</div>' +\r\n        '</div>' +\r\n\r\n        '<div class=\"ais panel\">' +\r\n            '<div class=\"placeholder\"></div>' +\r\n        '</div>' +\r\n    '</td>' +\r\n    '</tr>' +\r\n'</table>' +\r\n            '</td>' +\r\n        '</tr>' +\r\n    '</table>'           \r\n            );\r\n        window.addEventListener(\"message\", function(e){\r\n            if (e.data.search(/\"uploaded\"\\:/)<0)\r\n                return;\r\n            var data = JSON.parse(e.data);    \r\n            if (data.id && parseInt(data.id)) { //uploaded:\r\n//console.log('UPLOADED '+id)\r\n                var counter = $('.vessel-info-page .menu-item .counter'), \r\n                count = parseInt(counter.text())+1;\r\n                counter.text(count).css('display', 'inline');\r\n                var preview = $(\"<div class='photo preview' id='\"+data.id+\"' style='background-image: url(\"+aisServices+\"getphoto.ashx?id=\"+data.id+\")'/>\");\r\n                $('.vessel-info-page .uploader').replaceWith(preview);\r\n                preview.click(showPicture);\r\n//console.log(preview)\r\n            }\r\n            else {//uploadError:            \r\n                $('.vessel-info-page .uploader').remove();\r\n                console.log(data.errmsg)\r\n            }  \r\n        }, false);\r\n\r\n        $('<img src=\"' + scheme + window.serverBase.replace(/^https?:/, \"\")+'plugins/ais/getphoto.ashx?mmsi=' + vessel.mmsi + '\">')\r\n        .load(function () {\t\r\n            if (this)\r\n                $('.column1 .photo img.no-image').replaceWith(this);\t\r\n        }).error(function(){\t\t\t\r\n            $('<img src=\"' + scheme + '//photos.marinetraffic.com/ais/showphoto.aspx?size=thumb&mmsi=' + vessel.mmsi + '\">').load(function () {\r\n                    if (this)\r\n                        $('.column1 .photo img.no-image').replaceWith(this);\r\n            });\r\n        });\r\n\r\n        $('.vessel-info-page .chooseFile').change(function(){            \r\n            $('<div class=\"photo uploader\" style=\"background-image:url(img/progress.gif);background-size:20px;\"></div>')\r\n            .insertAfter($('.vessel-info-page .galery .placeholder .photo').eq(0));\r\n            $('.vessel-info-page .uploadFile')[0].submit();\r\n        })\r\n        $('.vessel-info-page .close-button').click(function(){\r\n            $('.vessel-info-page.overlay').remove();\r\n        });\r\n/**/\r\n        $('.vessel-info-page .menu img[src$=\".svg\"]').each(function() {\r\n            var $img = jQuery(this);\r\n            var imgURL = $img.attr('src');\r\n            var attributes = $img.prop(\"attributes\");\r\n\r\n            $.get(imgURL, function(data) {\r\n                // Get the SVG tag, ignore the rest\r\n                var $svg = jQuery(data).find('svg');\r\n\r\n                // Remove any invalid XML tags\r\n                $svg = $svg.removeAttr('xmlns:a');\r\n\r\n                // Loop through IMG attributes and apply on SVG\r\n                $.each(attributes, function() {\r\n                    $svg.attr(this.name, this.value);\r\n                });\r\n\r\n                // Replace IMG with SVG\r\n                $img.replaceWith($svg);\r\n            }, 'xml');\r\n        });\r\n\r\n        _ais = document.querySelector('.vessel-info-page .column2 .ais') \r\n        _galery = document.querySelector('.vessel-info-page .column2 .galery')\r\n        _register = document.querySelector('.vessel-info-page .column2 .register .content')\r\n        _regcap = document.querySelector('.vessel-info-page .column2 .register .caption')    \r\n        _leftPanel = document.querySelector('.vessel-info-page .column1 table')      \r\n        _minh = 420\r\n        resize = function(){\r\n            var h = Math.floor(window.innerHeight*0.8);\r\n            if (h>_minh){\r\n                _leftPanel.style.height = _ais.style.height = _galery.style.height = h + \"px\";\r\n                _register.style.height = h - _regcap.offsetHeight + \"px\";\r\n            }\r\n            else{\r\n                _leftPanel.style.height = _ais.style.height = _galery.style.height = _minh + \"px\";\r\n                _register.style.height = _minh - _regcap.offsetHeight + \"px\";\r\n            }      \r\n        }\r\n        menuAction = function(e){\r\n            var target = e.currentTarget, p = target.parentElement, mia;\r\n            while(!(mia = p.querySelectorAll('.menu-item')) || mia.length<2){\r\n                p = p.parentElement;\r\n            }\r\n            for (var j=0; j<mia.length; ++j){\r\n                    //console.log( mia[j])\r\n                mia[j].className = mia[j].className.replace(/ active/, \"\");\r\n                var panel = document.querySelector('.panel.' + mia[j].classList[0]);\r\n                if (panel){\r\n                    if (mia[j]!=target)\r\n                    panel.style.display = \"none\";\r\n                    else{\r\n                    panel.style.display = \"block\";\r\n                    }\r\n                }\r\n            }\r\n            target.className += \" active\"\r\n            resize(); \r\n        }\r\n\r\n        window.addEventListener(\"resize\", resize, false); \r\n    \r\n        var mia = document.querySelectorAll('.column1 .menu-item');\r\n        for (var i=0; i<mia.length; ++i){\r\n            mia[i].addEventListener('click', menuAction)\r\n        }\r\n    \r\n        resize();    \r\n        $(_ais).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        $(_galery).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        $(_register).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        document.querySelector('.vessel-info-page .container').style.display = \"table\";  \r\n    },\r\n    showPicture = function(){\r\n//console.log($(this))\r\n            $('.vessel-info-page .picture').remove();\r\n            var div = $('<div class=\"picture\" style=\"display:none;position:absolute;\"></div>')\r\n            .insertAfter('.vessel-info-page.container').click(function(){this.remove()});\r\n            $('<img src=\"'+aisServices+'getphoto.ashx?id='+this.id+'\">').load(function() {\r\n                    if (this){\r\n                        var w = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,\r\n                        h = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\r\n                        div.append(this)\r\n                        .css('display', 'table')\r\n                        .offset({\r\n                            left:(w-this.offsetWidth)/2,\r\n                            top:(h-this.offsetHeight)/2})\r\n//console.log($(this))\r\n//console.log(window.screen.width+\"-\"+$(this)[0].offsetWidth)\r\n//console.log((window.screen.width-$(this)[0].offsetWidth)/2)\r\n                    }\r\n            });\r\n        },\r\n    drawGallery = function(gallery){\r\n        if (gallery.length>0)\r\n            $('.vessel-info-page .menu-item .counter').text(gallery.length).css('display', 'inline');   \r\n        var galcontent = $(\".vessel-info-page .galery .placeholder\")\r\n        for (var i=0; i<gallery.length; ++i)\r\n            galcontent.append(\"<div class='photo preview' id='\"+gallery[i]+\"' style='background-image: url(\"+aisServices+\"getphoto.ashx?id=\"+gallery[i]+\")'/>\" )             \r\n        $('.photo.preview').click(showPicture)\r\n        resize();     \r\n    },\r\n    drawAis = function(ledokol){\r\n    var aiscontent = document.querySelector(\".vessel-info-page .ais .placeholder\")\r\n    aiscontent.innerHTML = \"\" +                \r\n    \"<div class='caption'><div>\"+_gtxt(\"AISSearch2.vessel_info\")+\"</div></div>\" +\r\n    \"<table>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.vessel_name\")+\"</td><td><b>\"+ledokol.vessel_name+(ledokol.registry_name?\" (\"+ledokol.registry_name+\")\":\"\")+\"</b></td></tr>\" +\r\n        \"<tr><td>IMO</td><td>\"+ledokol.imo+\"</td></tr>\" +\r\n        \"<tr><td>MMSI</td><td>\"+ledokol.mmsi+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.vessel_type\")+\"</td><td>\"+ledokol.vessel_type+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.flag\")+\"</td><td>\"+ledokol.flag_country+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.callsign\")+\"</td><td>\"+ledokol.callsign+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.length\")+\"</td><td>\"+ledokol.length+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.width\")+\"</td><td>\"+ledokol.width+\"</td></tr>\" +\r\n    \"</table>\" +\r\n    \"<div class='caption'><div>\"+_gtxt(\"AISSearch2.vessel_voyage\")+\"</div></div>\" +\r\n    \"<table>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.nav_status\")+\"</td><td>\"+ledokol.nav_status+\"</td></tr>\" +\r\n        \"<tr><td>COG</td><td>\"+ledokol.cog+\"</td></tr>\" +\r\n        \"<tr><td>SOG</td><td>\"+ledokol.sog+\"</td></tr>\" +\r\n        \"<tr><td>HDG</td><td>\"+ledokol.heading+\"</td></tr>\" +\r\n        \"<tr><td>ROT</td><td>\"+ledokol.rot+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.draught\")+\"</td><td>\"+ledokol.draught+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.destination\")+\"</td><td>\"+ledokol.destination+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.eta\")+\"</td><td>\"+ledokol.ts_eta+\"</td></tr>\" +\r\n    \"</table>\";     \r\n        resize();        \r\n    },\r\n    drawRegister = function(ledokol){\r\n        let regcontent = _register.querySelector(\".placeholder\"),\r\n        drawTable = function(groups, article, display){\r\n            let s = \"<div class='panel \"+article+\" article' style='display:\"+display+\"'>\";\r\n            for(let i=0; i<groups.length; ++i){\r\n                if (!groups[i])\r\n                    continue;\r\n                s += \"<div class='group'>\"+groups[i].name+\"</div><table>\"\r\n                for(let j=0; j<groups[i].properties.length; ++j){\r\n                    let pn = groups[i].properties[j].name,\r\n                    desc = nsGmx.Translations.getLanguage()==\"rus\"?groups[i].properties[j].description:null, \r\n                    pv = groups[i].properties[j].value\r\n                    s+= \"<tr><td>\"+pn+\r\n                    (desc ? \"<div class='description'>\" + desc + \"</div>\" : \"\")+ \r\n                    \"</td><td>\"+(pn==\"Название судна\"||pn==\"Латинское название\"?\"<b>\"+pv+\"</b>\":pv)+\"</td></tr>\"\r\n                }\r\n                s += \"<tr><td>&nbsp;</td><td>&nbsp;</td></tr></table>\"\r\n            }\r\n            s += \"</div>\"\r\n            return s;\r\n        }\t\r\n\r\n        _regcap.innerHTML = \"<table class='register-title'>\"+\r\n        \"<tr><td><span class='switch active'>\"+_gtxt(\"AISSearch2.rmrs\")+\"</span> <span class='switch'>Lloyd's register</span></td></tr>\"+\r\n        \"<tr><td><span class='update'></span></td></tr>\"+\r\n        \"</table>\";\r\n\r\n        let drawRMR = function(){\r\n            if (ledokol) {\r\n                regcontent.innerHTML =\r\n                    drawTable([ledokol.data[0], ledokol.data[1], ledokol.data[9]], \"general\", \"block\") +\r\n                    drawTable([ledokol.data[2]], \"build\", \"none\") +\r\n                    drawTable([ledokol.data[3]], \"dimensions\", \"none\") +\r\n                    drawTable([ledokol.data[4], ledokol.data[5], ledokol.data[6], ledokol.data[7], ledokol.data[8]], \"gears\", \"none\");\r\n                _regcap.querySelector('.update').innerText = _gtxt(\"AISSearch2.last_update\") + \" \" + ledokol.version.replace(/ \\S+$/g, '');\r\n            }\r\n            else{\r\n                regcontent.innerHTML = \"\";\r\n                _regcap.querySelector('.update').innerHTML = \"&nbsp;\"; \r\n            }\r\n        },\r\n        drawLloyds = function(){\r\n            regcontent.innerHTML =\r\n                drawTable([_lloyds.data[15], _lloyds.data[14], _lloyds.data[13], _lloyds.data[11], _lloyds.data[0]], \"general\", \"block\") +\r\n                drawTable([_lloyds.data[10], _lloyds.data[12]], \"build\", \"none\") +\r\n                drawTable([_lloyds.data[9], _lloyds.data[8], _lloyds.data[7], _lloyds.data[6]], \"dimensions\", \"none\") +\r\n                drawTable([_lloyds.data[4], _lloyds.data[3], _lloyds.data[2], _lloyds.data[1], _lloyds.data[5]], \"gears\", \"none\");\r\n            _regcap.querySelector('.update').innerText = _gtxt(\"AISSearch2.last_update\") + \" \" + _lloyds.version.replace(/ \\S+$/g, '');   \r\n        },\r\n        regSwitches = _regcap.querySelectorAll(\".switch\");\r\n        regSwitches.forEach((item, i)=>item.addEventListener('click', e => {\r\n            let cl = e.currentTarget.classList;\r\n            if (!cl.contains('active')) {\r\n                _regcap.querySelector(\".switch.active\").classList.remove('active');\r\n                cl.add('active');\r\n                switch (i){\r\n                    case 0:\r\n                        drawRMR();\r\n                        break;\r\n                    case 1:\r\n                        if (_lloyds)\r\n                            drawLloyds();\r\n                        else\r\n                            regcontent.innerHTML = \"\";                        \r\n                        break;\r\n                }           \r\n                resize();   \r\n                mia[0] && mia[0].click();\r\n            }\r\n        }));\r\n        var mia = document.querySelectorAll('.column2 .menu-item');\r\n        for (var i=0; i<mia.length; ++i){\r\n            mia[i].addEventListener('click', menuAction)\r\n        }\r\n        drawRMR();             \r\n        resize(); \r\n        if (!ledokol)        \r\n            regSwitches[1].click();         \r\n    }\r\n\t\r\n\tlet open = function(vessel, vessel2){\r\n                    show(vessel2);\r\n                    var onFail = function(error){\r\n                        if (error!='register_no_data')\r\n                            console.log(error)\r\n                        _regcap.innerHTML = \"\";\r\n                    } \r\n                    new Promise(function(resolve, reject){\r\n                        (function wait(){\r\n                            if(!vessel2)\r\n                                setTimeout(wait, 100);\r\n                        })();\r\n                        resolve(vessel2)\r\n                    })\r\n                    .then(function(ship){\r\n//console.log(ship)\r\n                        drawAis(ship)\r\n                    }, \r\n                    onFail);\r\n                    var registerServerUrl = scheme + \"//kosmosnimki.ru/demo/register/api/v1/\",\r\n                        lloydsServerUrl = scheme + \"//kosmosnimki.ru/demo/lloyds/api/v1/\",\r\n                        rmr;\r\n                    if(vessel.imo && vessel.imo!=0 && vessel.imo!=-1){\r\n                        fetch(registerServerUrl+\"Ship/Search/\"+vessel.imo+(nsGmx.Translations.getLanguage()==\"rus\"?\"/ru\":\"/en\"))\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            if (ship.length>0)\r\n                                return fetch(registerServerUrl+\"Ship/Get/\"+ship[0].RS+(nsGmx.Translations.getLanguage()==\"rus\"?\"/ru\":\"/en\"))\r\n                            else\r\n                                return Promise.resolve({json:()=>null});\r\n                            //else\r\n                            //    return Promise.reject('register_no_data');\r\n                        })\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            //console.log(ship)\r\n                            rmr = ship;\r\n                            if (rmr)\r\n                                drawRegister(rmr);\r\n                            return fetch(lloydsServerUrl+\"Ship/Search/\"+vessel.imo+(nsGmx.Translations.getLanguage()==\"rus\"?\"/ru\":\"/en\"));\r\n                        })                        \r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            if (ship.length>0)\r\n                                return fetch(lloydsServerUrl+\"Ship/Get/\"+ship[0].RS+(nsGmx.Translations.getLanguage()==\"rus\"?\"/ru\":\"/en\"))\r\n                            else\r\n                                return Promise.reject('register_no_data');\r\n                        })\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            _lloyds = ship;\r\n                            if (nsGmx.Translations.getLanguage()!=\"rus\"){\r\n                                _lloyds.data[15].name = \"Vessel Data\";\r\n                                _lloyds.data[14].name = \"Type and Status\";\r\n                                _lloyds.data[13].name = \"Companies\";\r\n                                _lloyds.data[12].name = \"Companies\";\r\n                                _lloyds.data[11].name = \"Safety\";\r\n                                _lloyds.data[10].name = \"History\";\r\n                                _lloyds.data[9].name = \"Characteristics\";\r\n                                _lloyds.data[8].name = \"Dimensions\";\r\n                                _lloyds.data[7].name = \"Hull\";\r\n                                _lloyds.data[6].name = \"Capacity\";\r\n                                _lloyds.data[5].name = \"Cargo\";\r\n                                _lloyds.data[4].name = \"Machinery\";\r\n                                _lloyds.data[3].name = \"Fuel\";\r\n                                _lloyds.data[2].name = \"Energy Supply\";\r\n                                _lloyds.data[1].name = \"Propellers and Thrusters\";\r\n                                _lloyds.data[0].name = \"Codes\";\r\n                            }\r\n                            if (!rmr)\r\n                                drawRegister(rmr);\r\n                        })\r\n                        .catch( onFail );\r\n                    }\r\n                    else                    \r\n                        _regcap.innerHTML = \"\";\r\n\r\n                    new Promise(function(resolve, reject){\r\n                        sendCrossDomainJSONRequest(aisServices + \r\n                            \"gallery.ashx?mmsi=\"+vessel.mmsi+\"&imo=\"+vessel.imo, function(response){\r\n                            if (response.Status==\"ok\") \r\n                                resolve(response.Result);\r\n                            else\r\n                                reject(response)\r\n                        });\r\n                    })\r\n                    .then(function(gallery){\r\n                        drawGallery(gallery)\r\n                    }, \r\n                    onFail);\r\n                }\r\n        \r\n    return {\r\n\t\topen:open,\r\n            show: show,\r\n            drawRegister: drawRegister,\r\n            drawAis: drawAis,\r\n            drawGallery:drawGallery\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Views/VesselInfoScreen.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/VesselInfoScreen.css\n// module id = 14\n// module chunks = 0","module.exports = function (options) {\r\n    const _baseUrl = document.location.href.replace(/^(https?:).+/, \"$1\") +\r\n        (window.serverBase.replace(/^https?:/, \"\") || '//maps.kosmosnimki.ru/'),\r\n        _aisServices = _baseUrl + \"Plugins/AIS/\",\r\n        _serverScript = _baseUrl + 'VectorLayer/Search.ashx',\r\n        { aisLastPoint: _aisLastPoint,\r\n            screenSearchLayer: _screenSearchLayer,\r\n            aisLayerID: _aisLayerID,\r\n            historyLayer: _historyLayer,\r\n            lastPointLayerAlt: _lastPointLayerAlt,\r\n            vesselLegend: _vesselLegend\r\n        } = options;\r\n\r\n    return {\r\n        baseUrl: _baseUrl,\r\n        get screenSearchLayer(){return _screenSearchLayer},\r\n        aisServices: _aisServices,\r\n        getBorder: function () {\r\n            var lmap = nsGmx.leafletMap;\r\n            var dFeatures = lmap.gmxDrawing.getFeatures();\r\n            if (dFeatures.length) { return dFeatures[dFeatures.length - 1].toGeoJSON(); }\r\n            var latLngBounds = lmap.getBounds(),\r\n                sw = latLngBounds.getSouthWest(),\r\n                ne = latLngBounds.getNorthEast(),\r\n                min = { x: sw.lng, y: sw.lat },\r\n                max = { x: ne.lng, y: ne.lat },\r\n                minX = min.x,\r\n                maxX = max.x,\r\n                geo = { type: 'Polygon', coordinates: [[[minX, min.y], [minX, max.y], [maxX, max.y], [maxX, min.y], [minX, min.y]]] },\r\n                w = (maxX - minX) / 2;\r\n\r\n            if (w >= 180) {\r\n                geo = { type: 'Polygon', coordinates: [[[-180, min.y], [-180, max.y], [180, max.y], [180, min.y], [-180, min.y]]] };\r\n            }\r\n            else if (maxX > 180 || minX < -180) {\r\n                var center = ((maxX + minX) / 2) % 360;\r\n                if (center > 180) { center -= 360; }\r\n                else if (center < -180) { center += 360; }\r\n                minX = center - w; maxX = center + w;\r\n                if (minX < -180) {\r\n                    geo = {\r\n                        type: 'MultiPolygon', coordinates: [\r\n                            [[[-180, min.y], [-180, max.y], [maxX, max.y], [maxX, min.y], [-180, min.y]]],\r\n                            [[[minX + 360, min.y], [minX + 360, max.y], [180, max.y], [180, min.y], [minX + 360, min.y]]]\r\n                        ]\r\n                    };\r\n                } else if (maxX > 180) {\r\n                    geo = {\r\n                        type: 'MultiPolygon', coordinates: [\r\n                            [[[minX, min.y], [minX, max.y], [180, max.y], [180, min.y], [minX, min.y]]],\r\n                            [[[-180, min.y], [-180, max.y], [maxX - 360, max.y], [maxX - 360, min.y], [-180, min.y]]]\r\n                        ]\r\n                    };\r\n                }\r\n            }\r\n            return geo;\r\n        },\r\n\r\n        formatTime: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleTimeString();\r\n        },\r\n        formatDate: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleDateString();\r\n        },\r\n        formatDateTime: function (d, local) {\r\n            if (d.isNaN)\r\n                return \"\";\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleString().replace(/,/, \"\");\r\n        },\r\n\r\n        formatDate2: function (d, local) {\r\n            var dd, m, y, h, mm;\r\n            if (local) {\r\n                dd = (\"0\" + d.getDate()).slice(-2);\r\n                m = (\"0\" + (d.getMonth() + 1)).slice(-2);\r\n                y = d.getFullYear();\r\n                h = (\"0\" + d.getHours()).slice(-2);\r\n                mm = (\"0\" + d.getMinutes()).slice(-2);\r\n                return dd + \".\" + m + \".\" + y + \" \" + h + \":\" + mm +\r\n                    \" (\" + (\"0\" + d.getUTCHours()).slice(-2) + \":\" + (\"0\" + d.getUTCMinutes()).slice(-2) + \" UTC)\";\r\n            }\r\n            else {\r\n                dd = (\"0\" + d.getUTCDate()).slice(-2);\r\n                m = (\"0\" + (d.getUTCMonth() + 1)).slice(-2);\r\n                y = d.getUTCFullYear();\r\n                h = (\"0\" + d.getUTCHours()).slice(-2);\r\n                mm = (\"0\" + d.getUTCMinutes()).slice(-2);\r\n                var\r\n                    ldd = (\"0\" + d.getDate()).slice(-2),\r\n                    lm = (\"0\" + (d.getMonth() + 1)).slice(-2),\r\n                    ly = d.getFullYear(),\r\n                    lh = (\"0\" + d.getHours()).slice(-2),\r\n                    lmm = (\"0\" + d.getMinutes()).slice(-2),\r\n                    offset = -d.getTimezoneOffset() / 60;\r\n                return dd + \".\" + m + \".\" + y + \" <span class='utc'>\" + h + \":\" + mm + \" UTC</span> (\" + lh + \":\" + lmm + \")\"\r\n                //return dd+\".\"+m+\".\"+y+\" \"+h+\":\"+mm+\" UTC <br>\"+\r\n                //\"<span class='small'>(\"+ldd+\".\"+lm+\".\"+ly+\" \"+lh+\":\"+lmm+\" UTC\"+(offset>0?\"+\":\"\")+offset+\")</span>\";\r\n            }\r\n        },\r\n        placeVesselTypeIcon: function(vessel){\r\n            let protocol = document.location.protocol,\r\n            icon;            \r\n            // speed icon\r\n            icon = _vesselLegend.getIconAlt(\"vessel.vessel_name\", vessel.sog);\r\n            if (icon){\r\n                vessel.iconAlt = protocol + icon.url; \r\n                vessel.imgAlt =  icon.img;\r\n                vessel.colorAlt = icon.color;\r\n            }         \r\n            // type icon\r\n            icon = _vesselLegend.getIcon(vessel.vessel_type, vessel.sog);\r\n            if (icon){\r\n                vessel.icon = protocol + icon.url;\r\n                vessel.img =  icon.img;\r\n                vessel.color = icon.color;\r\n            }\r\n        },\r\n        searchPositionsAgg2: function (mmsi, dateInterval, callback) {\r\n            fetch(`${_baseUrl}plugins/AIS/SearchPositionsAsync.ashx?layer=${_historyLayer}&mmsi=${mmsi}&s=${dateInterval.dateBegin.toISOString()}&e=${dateInterval.dateEnd.toISOString()}`, {\r\n                method: 'POST', // *GET, POST, PUT, DELETE, etc.\r\n                mode: 'cors', // no-cors, cors, *same-origin\r\n                cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\r\n                credentials: 'include' // include, *same-origin, omit\r\n            })\r\n            .then(response => response.json())\r\n            .then(callback);\r\n        },\r\n        searchPositionsAgg2Mf: function (mmsi, dateInterval, callback) {\r\n            fetch(`${_baseUrl}plugins/AIS/SearchMfPositionsAsync.ashx?layer=${_historyLayer}&mmsi=${mmsi}&s=${dateInterval.dateBegin.toISOString()}&e=${dateInterval.dateEnd.toISOString()}`, {\r\n                method: 'POST', // *GET, POST, PUT, DELETE, etc.\r\n                mode: 'cors', // no-cors, cors, *same-origin\r\n                cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\r\n                credentials: 'include' // include, *same-origin, omit\r\n            })\r\n            .then(response => response.json())\r\n            .then(callback);\r\n        },\r\n        searchPositionsAgg: function (vessels, dateInterval, callback) {\r\n            //console.log(dateInterval);\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _historyLayer, //'8EE2C7996800458AAF70BABB43321FA4',//\r\n                orderdirection: 'desc',\r\n                orderby: 'ts_pos_utc',\r\n                columns:'[{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"flag_country\"},{\"Value\":\"callsign\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"cog\"},{\"Value\":\"sog\"},{\"Value\":\"draught\"},{\"Value\":\"vessel_type\"},'+\r\n                '{\"Value\":\"destination\"},{\"Value\":\"ts_eta\"},{\"Value\":\"nav_status\"},{\"Value\":\"heading\"},{\"Value\":\"rot\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"},{\"Value\":\"source\"}]',\r\n                \r\n                query: \"([mmsi] IN (\" + vessels.join(',') + \")) and '\" + dateInterval.dateBegin.toISOString() + \"'<=[ts_pos_utc] and [ts_pos_utc]<'\" + dateInterval.dateEnd.toISOString() + \"'\"\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchPositions: function (vessels, dateInterval, callback) {\r\n            //console.log(\"searchById\");\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _historyLayer, //'8EE2C7996800458AAF70BABB43321FA4',//\r\n                //orderdirection: 'desc',\r\n                //orderby: 'ts_pos_utc',\r\n                query: \"([mmsi] IN (\" + vessels.join(',') + \")) and '\" + dateInterval.dateBegin.toISOString() + \"'<=[ts_pos_utc] and [ts_pos_utc]<'\" + dateInterval.dateEnd.toISOString() + \"'\"\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchById: function (aid, callback) {\r\n            //console.log(\"searchById\");\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _aisLayerID, //'8EE2C7996800458AAF70BABB43321FA4'\r\n                columns: `[{\"Value\":\"id\"},\r\n                        {\"Value\":\"vessel_name\"},\r\n                        {\"Value\":\"mmsi\"},\r\n                        {\"Value\":\"imo\"},\r\n                        {\"Value\":\"flag_country\"},\r\n                        {\"Value\":\"callsign\"},\r\n                        {\"Value\":\"ts_pos_utc\"},\r\n                        {\"Value\":\"cog\"},\r\n                        {\"Value\":\"sog\"},\r\n                        {\"Value\":\"draught\"},\r\n                        {\"Value\":\"vessel_type\"},\r\n                        {\"Value\":\"destination\"},\r\n                        {\"Value\":\"ts_eta\"},\r\n                        {\"Value\":\"nav_status\"},\r\n                        {\"Value\":\"heading\"},\r\n                        {\"Value\":\"rot\"},\r\n                        {\"Value\":\"longitude\"},\r\n                        {\"Value\":\"latitude\"},\r\n                        {\"Value\":\"source\"}]`,                \r\n                query: \"([id] IN (\" + aid.join(',') + \"))\"\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        \r\n        searchString2: function (query, isfuzzy, callback) {\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _aisLastPoint,\r\n                columns: '[{\"Value\":\"vessel_name\"},{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"vessel_type\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"},{\"Value\":\"source\"}]',\r\n                //orderdirection: 'desc',\r\n                //orderby: 'vessel_name',\r\n                query: query\r\n            };\r\n            if (isfuzzy)\r\n                request.pagesize = 1000;\r\n            L.gmxUtil.sendCrossDomainPostRequest(_aisServices + \"searchship.ashx\", request, callback);\r\n        },\r\n        searchString: function (searchString, isfuzzy, callback) {\r\n            //console.log(_aisLastPoint+\", \"+_aisLayerID)\r\n            var query = \"\";\r\n            if (searchString) {\r\n                searchString = searchString.toUpperCase();\r\n                if (searchString.search(/[^\\d, ]/) === -1) {\r\n                    var arr = searchString.replace(/ /g, '').split(/,/);\r\n                    query = \"([mmsi] IN (\" + arr.join(',') + \"))\" +\r\n                        \"OR ([imo] IN (\" + arr.join(',') + \"))\"\r\n                } else {\r\n                    if (isfuzzy)\r\n                        query = '([vessel_name] startswith \\'' + searchString + '\\') OR ([vessel_name] contains \\' ' + searchString + '\\')';\r\n                    else\r\n                        query = '([vessel_name] startswith \\'' + searchString + '\\') OR ([vessel_name] contains \\' ' + searchString + '\\')';\r\n                }\r\n            }\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _aisLastPoint,\r\n                columns: '[{\"Value\":\"vessel_name\"},{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"vessel_type\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"},{\"Value\":\"source\"}]',\r\n                //orderdirection: 'desc',\r\n                //orderby: 'vessel_name',\r\n                query: query\r\n            };\r\n            if (isfuzzy)\r\n                request.pagesize = 1000;\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchNames: function (avessels, callback) {\r\n            var a = avessels.reduce((p,c)=>{\r\n                if((c.mmsi && c.mmsi!=\"\") || (c.imo && c.imo!=\"\" && c.imo!=-1)) \r\n                    p.push(c); \r\n                return p;\r\n            },[]),\r\n            request = {\r\n                WrapStyle: 'window',\r\n                layer: _aisLastPoint,\r\n                orderdirection: 'desc',\r\n                orderby: 'ts_pos_utc',\r\n                query: a.map(function (v) { return \"([mmsi]=\" + v.mmsi + (v.imo && v.imo != \"\" ? (\" and [imo]=\" + v.imo) : \"\") + \")\" }).join(\" or \")\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchScreen: function (options, callback) {\r\n            var lmap = nsGmx.leafletMap;\r\n            var latLngBounds = lmap.getBounds(),\r\n                sw = latLngBounds.getSouthWest(),\r\n                ne = latLngBounds.getNorthEast(),\r\n                min = { x: sw.lng, y: sw.lat },\r\n                max = { x: ne.lng, y: ne.lat };\r\n            // let queryParams = { WrapStyle: 'window', minx: min.x, miny: min.y, maxx: max.x, maxy: max.y, layer: _screenSearchLayer },\r\n            // dateInterval = nsGmx.widgets.commonCalendar.getDateInterval();\r\n            // queryParams.s = options.dateInterval.get('dateBegin').toJSON(),\r\n            // queryParams.e = options.dateInterval.get('dateEnd').toJSON();\r\n//console.log(queryParams);\r\n            //L.gmxUtil.sendCrossDomainPostRequest(_aisServices + \"SearchScreenAsync.ashx\",\r\n            // L.gmxUtil.sendCrossDomainPostRequest(_aisServices + \"SearchScreen.ashx\",\r\n            //     queryParams,\r\n            //     callback);\r\n            fetch(_aisServices + `SearchScreenAsync.ashx?${options.filter ? 'f=' + options.filter + '&' : ''}minx=${min.x}&miny=${min.y}&maxx=${max.x}&maxy=${max.y}&layer=${_screenSearchLayer}\r\n&s=${options.dateInterval.get('dateBegin').toJSON()}&e=${options.dateInterval.get('dateEnd').toJSON()}`, {\r\n                method: 'GET', \r\n                mode: 'cors', \r\n                cache: 'no-cache', \r\n                credentials: 'include', \r\n            })\r\n            .then(function(response) {\r\n                return response.json();\r\n            })\r\n            .then(callback);\r\n        }\r\n    };\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/Search/Searcher.js","const Polyfill = require('./Polyfill');\r\n\r\nmodule.exports = function (options) {\r\n    const _lmap = nsGmx.leafletMap,\r\n        _layersByID = nsGmx.gmxMap.layersByID,\r\n        _aisLayer = _layersByID[options.aisLayerID],\r\n        _screenSearchLayer = _layersByID[options.searchLayer],\r\n        //_lastPointLayerAltFact = _layersByID[options.lastPointLayerAlt],\r\n        _lastPointLayerAlt = _layersByID[options.lastPointLayerAlt];\r\n\r\n    let _curLegendLayer = _screenSearchLayer, _prevLegendLayer = _lastPointLayerAlt;\r\n\r\n    let _almmsi, _tlmmsi, _aldt, _tldt;\r\n    let _needAltLegend = false;\r\n    try{\r\n          _almmsi = _aisLayer.getGmxProperties().attributes.indexOf(\"mmsi\") + 1, \r\n          _aldt = _aisLayer.getGmxProperties().attributes.indexOf(\"ts_pos_utc\") + 1;\r\n// console.log(_almmsi+\" \"+_aldt)\r\n// console.log(_tlmmsi+\" \"+_tldt)\r\n    }\r\n    catch(ex){}\r\n\r\n    let _displayedVessels = \"all\",  \r\n    _notDisplayedVessels = [],\r\n    _filterFunc = function (args) {\r\n        let mmsiArr = [];\r\n        let mmsi = args.properties[args.properties.length > 20 ? _almmsi : _tlmmsi].toString(),\r\n            dt = new Date(new Date(args.properties[args.properties.length>20 ? _aldt : _tldt]*1000).setUTCHours(0,0,0,0)),\r\n            i, j;\r\n        for (i = 0; i < mmsiArr.length; i++) {\r\n            if (mmsi == mmsiArr[i]) { \r\n                if (dates)\r\n                    for (j=0; j<dates.length; ++j){\r\n                        if (dates[j].getTime()==dt.getTime()){\r\n                            return true;\r\n                        }\r\n                    }\r\n                else{\r\n                    return true; \r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }, \r\n    _specialVesselFilters,\r\n    // _setVesselFilter = function(){\r\n    //     if (_screenSearchLayer) {\r\n    //         _screenSearchLayer.removeFilter();  \r\n\r\n    //         if (_displayedVessels!=\"all\" || _notDisplayedVessels.length || _specialVesselFilters) {            \r\n    //             let ai = _screenSearchLayer._gmx.tileAttributeIndexes, fields = [];\r\n    //             for (var k in ai)\r\n    //                 fields[ai[k]] = k;\r\n    //             _screenSearchLayer.setFilter((args) => {\r\n\r\n    //                 for(var f in _specialVesselFilters)\r\n    //                         _specialVesselFilters[f](args, ai, _displayedVessels);\r\n\r\n    //                 let mmsi = args.properties[ai.mmsi].toString();\r\n    //                 if ((_displayedVessels==\"all\" || _displayedVessels.indexOf(mmsi) >= 0) && \r\n    //                     _notDisplayedVessels.indexOf(mmsi) < 0)\r\n    //                     return true;\r\n    //                 else\r\n    //                     return false;\r\n    //             });\r\n    //         } \r\n    //     }\r\n\r\n    // },\r\n    _setVesselFilter = function(){\r\n        if (_curLegendLayer) {\r\n            _curLegendLayer.removeFilter();  \r\n\r\n            if (_displayedVessels!=\"all\" || _notDisplayedVessels.length || _specialVesselFilters) {            \r\n                let ai = _curLegendLayer._gmx.tileAttributeIndexes, fields = [];\r\n                for (var k in ai)\r\n                    fields[ai[k]] = k;\r\n                    _curLegendLayer.setFilter((args) => {\r\n\r\n                    for(var f in _specialVesselFilters)\r\n                            _specialVesselFilters[f](args, ai, _displayedVessels);\r\n\r\n                    let mmsi = args.properties[ai.mmsi].toString();\r\n                    if ((_displayedVessels==\"all\" || _displayedVessels.indexOf(mmsi) >= 0) && \r\n                        _notDisplayedVessels.indexOf(mmsi) < 0)\r\n                        return true;\r\n                    else\r\n                        return false;\r\n                });\r\n            } \r\n        }\r\n\r\n    },\r\n    _markers,\r\n    _visibleMarkers = [],\r\n    _icons = {},\r\n    _getSvg = function(url){\r\n        let svg = _icons[url]\r\n        if (!svg){\r\n            return new Promise(resolve=>{\r\n                let httpRequest = new XMLHttpRequest();\r\n                httpRequest.onreadystatechange = function () {\r\n                    if (httpRequest.readyState === 4) {\r\n                        _icons[url] = httpRequest.responseText\r\n                        resolve(_icons[url]);\r\n                    }\r\n                }\r\n                httpRequest.open(\"GET\", document.location.protocol + url.replace(/^https?:/, \"\"));\r\n                httpRequest.send();\r\n            })\r\n        }\r\n        return Promise.resolve(svg);\r\n    },\r\n    _markerIcon = function(icon, cog, sog, vtype, group_style){ \r\n        return _getSvg(icon).then(\r\n            svg=>{\r\n                let type_color = '#00f',\r\n                    a = /\\.cls-1{fill:(#[^};]+)/.exec(svg)\r\n                if (a && a.length)\r\n                    type_color = a[1];\r\n//console.log(type_color)\r\n                if (sog)\r\n                    return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"21\" height=\"21\" viewBox=\"0 0 21 21\" style=\"transform:rotate(' + (!cog ? 0 : cog) + 'deg)\"><title>1</title><path style=\"fill:' + type_color + ';\" d=\"M13.8,20.07a1,1,0,0,1-.69-0.28l-1.79-1.72a0.72,0.72,0,0,0-1,0L8.52,19.79a1,1,0,0,1-.69.28,1,1,0,0,1-1-1V8.65c0-1.52,1.55-7.59,4-7.59s4,6.07,4,7.59V19a1,1,0,0,1-1,1h0Z\"/><path style=\"fill:' + group_style + ';\" d=\"M10.82,1.57c1.93,0,3.5,5.57,3.5,7.09V19a0.52,0.52,0,0,1-.51.53,0.49,0.49,0,0,1-.34-0.14l-1.79-1.72a1.22,1.22,0,0,0-1.71,0L8.17,19.42a0.49,0.49,0,0,1-.34.14A0.52,0.52,0,0,1,7.32,19V8.65c0-1.51,1.57-7.09,3.5-7.09h0m0-1c-3,0-4.5,6.72-4.5,8.09V19a1.52,1.52,0,0,0,1.51,1.53,1.49,1.49,0,0,0,1-.42l1.79-1.72a0.22,0.22,0,0,1,.32,0l1.79,1.72a1.49,1.49,0,0,0,1,.42A1.52,1.52,0,0,0,15.32,19V8.65c0-1.37-1.51-8.09-4.5-8.09h0Z\"/><ellipse style=\"fill:#fff;\" cx=\"10.82\" cy=\"10.54\" rx=\"1.31\" ry=\"1.35\"/><path style=\"fill:#fff;\" d=\"M10.73,3.34h0.12a0.35,0.35,0,0,1,.35.35v6.85a0,0,0,0,1,0,0H10.38a0,0,0,0,1,0,0V3.69A0.35,0.35,0,0,1,10.73,3.34Z\"/></svg>';\r\n                else\r\n                    return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"21\" height=\"21\" viewBox=\"0 0 21 21\" style=\"transform:rotate(' + (!cog ? 0 : cog) + 'deg)\"><title>1</title><rect style=\"fill:' + type_color + ';stroke:' + group_style + ';stroke-miterlimit:10;\" x=\"5.9\" y=\"5.6\" width=\"9.19\" height=\"9.19\" rx=\"2\" ry=\"2\" transform=\"translate(-4.13 10.41) rotate(-45)\"/><circle style=\"fill:#fff;\" cx=\"10.5\" cy=\"10.19\" r=\"1.5\"/></svg>';\r\n            }\r\n        );\r\n    },\r\n    _eraseMyFleetMarker = function(mmsi){\r\n        if (!_markers)\r\n            _markers = L.layerGroup().addTo(_lmap);\r\n        else{\r\n            let layers = _markers.getLayers(), layer;\r\n            for (var i in layers)\r\n                if (layers[i].id==mmsi){\r\n                    layer = layers[i];\r\n                    break;\r\n                }\r\n            layer && _markers.removeLayer(layer);\r\n        }\r\n    },\r\n    _drawMyFleetMarker = function(args, markerTemplate, group, ai, isVisible){ \r\n        let data = args.properties;\r\n        let di = nsGmx.widgets.commonCalendar.getDateInterval();\r\n        let icon = args.parsedStyleKeys.iconUrl;//args.parsedStyleKeys.iconUrl.replace(/.+(\\/|%5C)(?=[^\\/]+$)/, '')\r\n        _eraseMyFleetMarker(data[ai.mmsi]);\r\n\r\n        if (!isVisible)\r\n            return;\r\n\r\n        let label_line = function(label, label_color, label_shadow){\r\n            if (label!=\"\")\r\n            return '<div style=\"height:14px;\">'+\r\n            '<div class=\"label_shadow\" style=\"height:14px;color' + label_shadow.color + \";text-shadow:\" + label_shadow.text_shadow + '\">' + label + '</div>'+\r\n            '<div class=\"label_color\" style=\"position:relative;top:-14px;color:' + label_color + '\">' + label + '</div></div>';\r\n            else\r\n            return \"\";\r\n        }\r\n        if (di.get(\"dateBegin\").getTime()<=data[ai.ts_pos_utc]*1000 && data[ai.ts_pos_utc]*1000<di.get(\"dateEnd\").getTime()){ \r\n            _markerIcon(icon, data[ai.cog], data[ai.sog], data[ai.vessel_type], group.marker_style).then(marker=>{\r\n\r\n                _eraseMyFleetMarker(data[ai.mmsi]);\r\n\r\n                let temp = {};\r\n                temp.group_name = label_line(group.default?\"\":(group.title), group.label_color, group.label_shadow)\r\n                temp.vessel_name = label_line(data[ai.vessel_name], group.label_color, group.label_shadow);    \r\n                temp.sog = label_line(data[ai.sog] + _gtxt(\"AISSearch2.KnotShort\"), group.label_color, group.label_shadow);  \r\n                temp.cog = label_line(isNaN(data[ai.cog])?\"\":data[ai.cog].toFixed(1) + \"&deg;\", group.label_color, group.label_shadow);                 \r\n                temp.marker = marker;\r\n                let m = L.marker([data[ai.latitude], data[ai.longitude]>0?data[ai.longitude]:360+data[ai.longitude]],\r\n                    {\r\n                        id:data[ai.mmsi],\r\n                        icon: L.divIcon({\r\n                            className: 'mf_label gr' + group.id,\r\n                            html: Handlebars.compile(markerTemplate)(temp)\r\n                        }),\r\n                        zIndexOffset:1000\r\n                    });\r\n                m.id = data[ai.mmsi];\r\n                _markers.addLayer(m);\r\n            });\r\n        }\r\n\r\n    },\r\n    _switchLayers = function(l1, l2){\r\n        //l1 && console.log(l1.getGmxProperties().name +\" \"+ !!(l1._map))\r\n        if (!l2 || l2._map)\r\n            return;\r\n        if (l1 && l2){\r\n            _lmap.removeLayer(l1);\r\n            _lmap.addLayer(l2);\r\n        }\r\n    },\r\n    _legendSwitchedHandlers = [],\r\n    _legendSwitched = function(showAlternative){\r\n        _legendSwitchedHandlers.forEach(h=>h(showAlternative));\r\n    },\r\n\r\n    _round = function (d, p) {\r\n        let isNeg = d < 0,\r\n            power = Math.pow(10, p)\r\n        return d ? ((isNeg ? -1 : 1) * (Math.round((isNeg ? d = -d : d) * power) / power)) : d\r\n    },\r\n    _addUnit = function (v, u) {\r\n        return v != null && v != \"\" ? v + u : \"\";\r\n    },        \r\n    _toDd = function (D, lng) {\r\n        let dir = D < 0 ? lng ? 'W' : 'S' : lng ? 'E' : 'N',\r\n            deg = Math.round((D < 0 ? D = -D : D) * 1000000) / 1000000\r\n        return deg.toFixed(2) + \" \"//\"°\"\r\n            + dir\r\n    };\r\n\r\n    return {\r\n        set specialVesselFilters({key, value}) {\r\n            if (!_specialVesselFilters)\r\n                _specialVesselFilters = {};\r\n            _specialVesselFilters[key] = value;\r\n            //_setVesselFilter();\r\n        },\r\n        get hasAlternativeLayers(){ return _lastPointLayerAlt; },\r\n        get needAltLegend(){\r\n            //return !!(_lastPointLayerAltFact && _lastPointLayerAltFact._map); \r\n            return _needAltLegend;\r\n        },\r\n\r\n        ///////////////////////\r\n        removeMyFleetTrack: function (mmsi){\r\n        }, \r\n\r\n        showMyFleetTrack: function (vessels, onclick, aisLayerSearcher, viewState) {\r\n        },\r\n     \r\n        showHistoryTrack: function (vessels, onclick) {\r\n        },\r\n\r\n        restoreDefault: function(){    \r\n            if (!_curLegendLayer)\r\n                return;\r\n            _lmap.addLayer(_curLegendLayer);\r\n            _prevLegendLayer && _lmap.removeLayer(_prevLegendLayer); \r\n        },\r\n\r\n        cleanMap: function(viewState){\r\n        },\r\n\r\n        hideVesselsOnMap: function (viewState, comment) {      \r\n        },\r\n\r\n        showVesselsOnMap: function (viewState) { \r\n        },\r\n\r\n        redrawMarkers: function () {\r\n            _setVesselFilter();\r\n        },\r\n\r\n        clearMyFleetMarkers: function(){\r\n//console.log(\"clearMyFleetMarkers\")\r\n            _markers && _markers.clearLayers();\r\n        },\r\n\r\n        eraseMyFleetMarker: _eraseMyFleetMarker,\r\n\r\n        drawMyFleetMarker: _drawMyFleetMarker,\r\n\r\n        highlightMarker: function(i, group){\r\n            $('.mf_label.gr'+group.id+' svg').each((i,e)=>{\r\n                let paths = e.querySelectorAll('path');\r\n                if(paths[1])\r\n                    paths[1].style.fill = group.marker_style;\r\n            })\r\n            $('.mf_label.gr'+group.id+' svg rect').css({\"stroke\":group.marker_style});\r\n\r\n            $('.mf_label.gr'+group.id+' .label_color').css({\"color\":group.label_color});\r\n            $('.mf_label.gr'+group.id+' .label_shadow').css({\"color\":group.label_shadow.color, \"text-shadow\":group.label_shadow.text_shadow});\r\n        },\r\n\r\n        switchLegend: function(showAlternative){            \r\n        },\r\n\r\n        onLegendSwitched: function(handler){    \r\n            _legendSwitchedHandlers.push(handler);\r\n        },\r\n\r\n        formatPosition: function (vessel, aisLayerSearcher) {\r\n            vessel.cog_sog = vessel.cog && vessel.sog\r\n            vessel.heading_rot = vessel.heading && vessel.rot\r\n            vessel.x_y = vessel.longitude && vessel.latitude\r\n            let d = new Date(vessel.ts_pos_utc * 1000)\r\n            let eta = new Date(vessel.ts_eta * 1000)\r\n            vessel.tm_pos_utc = this.formatTime(d);\r\n            vessel.tm_pos_loc = this.formatTime(d, true);\r\n            vessel.dt_pos_utc = this.formatDate(d);\r\n            vessel.dt_pos_loc = this.formatDate(d, true);\r\n            vessel.eta_utc = aisLayerSearcher.formatDateTime(eta);\r\n            vessel.eta_loc = aisLayerSearcher.formatDateTime(eta, true);\r\n            vessel.icon_rot = Math.round(vessel.cog/15)*15;\r\n            vessel.cog = _addUnit(_round(vessel.cog, 5), \"°\");\r\n            vessel.rot = _addUnit(_round(vessel.rot, 5), \"°/мин\");\r\n            vessel.heading = _addUnit(_round(vessel.heading, 5), \"°\");\r\n            vessel.draught = _addUnit(_round(vessel.draught, 5), \" м\");\r\n            //vessel.length = _addUnit(vessel.length, \" м\");\r\n            //vessel.width = _addUnit(vessel.width, \" м\");\r\n            //vessel.source = 'plugins/AIS/AISSearch/svg/satellite-ais.svg'//vessel.source=='T-AIS'?_gtxt('AISSearch2.tais'):_gtxt('AISSearch2.sais');\r\n            vessel.source_orig = vessel.source;\r\n            vessel.source = vessel.source=='T-AIS'?'plugins/AIS/AISSearch/svg/waterside-radar.svg':'plugins/AIS/AISSearch/svg/satellite-ais.svg';\r\n                \r\n            vessel.xmin = vessel.longitude;\r\n            vessel.xmax = vessel.longitude;           \r\n            vessel.ymin = vessel.latitude;\r\n            vessel.ymax = vessel.latitude; \r\n        \r\n            vessel.longitude = _toDd(vessel.longitude, true);\r\n            vessel.latitude = _toDd(vessel.latitude);\r\n            aisLayerSearcher.placeVesselTypeIcon(vessel);\r\n            vessel.sog = _addUnit(_round(vessel.sog, 5), \" уз\");\r\n        \r\n            return vessel;\r\n        },\r\n        formatTime: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleTimeString();\r\n        },\r\n        formatDate: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleDateString();\r\n        },\r\n\r\n        hideAisData: function(isNeeded){\r\n            if (isNeeded){\r\n                _lmap.removeLayer(_screenSearchLayer);\r\n                _lmap.removeLayer(_lastPointLayerAlt);\r\n                _markers && _lmap.removeLayer(_markers);\r\n            }\r\n            else{\r\n                if (_curLegendLayer){\r\n                    _lmap.addLayer(_curLegendLayer);\r\n                    _markers && _lmap.addLayer(_markers);\r\n                }\r\n            }\r\n        }\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Toolbox.js"],"sourceRoot":""}