<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script src="http://maps.kosmosnimki.ru/api/api.js" charset="windows-1251"></script>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>GeoMixer API - начало использования - Загрузка Карты</title>
<link rel="stylesheet" href="style_geo_help.css" type="text/css" />
<link rel="stylesheet" href="default.css">
</head>

<body>
<div class="logo" style="margin:7px 0 0 12px ; padding:8px;"><span class="logo"><a href="geomixer_help.html"><img src="geo_help_img/logo_mini.jpg" width="203" height="50" /></a></span></div>
<div style="margin-left:30%; margin-top:15px; margin-bottom:15px;" class="heading">Scanex Web GeoMixer</div>
<table width="98%">
<tr><td colspan="3">
  <table width="100%">
   <tr><td>
        <div class="in_left"><a href="admin_help.html">GeoMixer Admin<br/>(Администрирование карты и БД)</a></div>
        </td><td>
        <div class="in_left" ><a href="mapviewer_help.html">MapViewer Template<br/>(Шаблон просмотра карты)</a></div>
        </td><td>                
        <div class="in_left_current"><a href="api_start.html">&gt;&gt; MapViewer API<br/>(Программный Интерфейс управления картой)</a></div>
        </td>
       </tr>
     </table>
</td></tr>
<tr><td valign="top" style="width: 250px;  padding-top:5px; padding-right:10px; padding-left:3px;" class="menutext">
<div class="in_left" style="background-color:#FFF">
<h3><a href="api_start.html">Начало использования <strong>API</strong> - загрузка Карты</a></h3><br/>
<h3><a href="api_start2.html">Элементы пользовательского интерфейса  Карты</a></h3>
<br/>
<h3><a href="api_start3.html">Добавление объектов на карту</a></h3>
<br/>
<h3><a href="api_geocoding.html">Геокодинг</a></h3>
<br/>
<h3>&gt;&gt; Дополнительные примеры</h3>
<ul>
<li><a href="#baloon_text">Редактирование содержания балуна</a></li>
<br/><br/>
<li><a href="#baloon_field">Выборочное отображение атрибутивной информации объекта</a></li>
<br/><br/>
<li><a href="#baloon_html">Использование HTML-разметки внутри балуна</a></li>
<br/><br/>
<li><a href="#events">Навешивание обработчиков пользовательских событий</a></li>


</ul>

</div>
<h3 style="margin-left:8px;">Руководство пользователя Scanex Web GeoMixer:</h3>
<div class="in_left"><a href="mapviewer_help.html"><b> MapViewer Template  (Шаблон просмотра карты)</b>  - Руководство пользователя</a></div>

<div class="in_left"><a href="admin_help.html"><b> GeoMixer Admin (Администрирование карты и БД)</b>  - Руководство пользователя</a></div>

</td>

<td style="padding-right:4px;">
<table id="content" border="0" style="background-color:#fff; margin-top:6px;" cellpadding="20" cellspacing="0"> 

  <tr>
    <td colspan="3" class="style1"><a name="baloon_text"></a>Редактирование содержания балуна</td>
  </tr>

  <tr>
    <td colspan="3" ><span class="bodytext">Содержание балуна может отображать информацию о слое, взятую из атрибутивной таблицы. А может быть задано произвольным образом.<br/>
    
    В данном примере задан определенный текст внутри балуна и навешен обработчик события <strong>onClick</strong>, которое выводит свойства слоя.
<pre><code class="javascript">map.vectors.enableHoverBalloon(<span class="function"><span class="keyword">function</span><span class="params">(o)</span> {</span> <span class="keyword">return</span> <span class="string">"Кликните для отображения информации!"</span>;
map.vectors.setHandler(<span class="string">"onClick"</span>, <span class="function"><span class="keyword">function</span><span class="params">(o)</span> {</span> alert(JSON.stringify(o.properties)); });</code></pre>
Как это выглядит:
	</span></td>
  </tr>
  <tr>
    <td align="center" class="td_text">
    <div id="map" style="width:500px; height:250px;"></div>
    </td>
  </tr>
  
    <tr>
    <td colspan="3" class="style1"><a name="baloon_field"></a>Выборочное отображение атрибутивной информации объекта</td>
  </tr>

  <tr>
    <td colspan="3" class="td_text"><p>Разработчик может задать выборочное отображение значений атрибутивных полей в балуне при наведении или клике на объект на карте.
    </p>
      <p>Например: 
      <pre><code class="javascript">map.vectors.enableHoverBalloon(<span class="function"><span class="keyword">function</span><span class="params">(o)</span> {</span> <span class="keyword">return</span> o.properties.NAME + <span class="string">" "</span> + o.properties.TEXT });</code></pre></p>
      В данном случае будут показываться только значения полей "NAME" и "TEXT"</td>
  </tr>
      
   <tr>
    <td colspan="3" class="style1"><a name="baloon_html"></a>Использование HTML-разметки внутри балуна</td>
  </tr>

  <tr>
    <td colspan="3" class="td_text"><span class="bodytext">Содержание балуна можно редактировать, используя синтаксис html-разметки. Например, можно вставить тег ссылки, использовать теги <strong>&lt;b&gt;</strong> или <strong>&lt;i&gt;</strong>
    <pre><code class="javascript">map.drawing.addObject({ type: <span class="string">"POINT"</span>, coordinates: [<span class="number">14754669</span>, <span class="number">5487309</span>]}, 
 {text: <span class="string">"&lt;a href='http://kosmosnimki.ru' target='a_blank'&gt;&lt;i&gt;Сайт Космоснимки&lt;/i&gt;&lt;/a&gt;"</span>});</code></pre>
   
Как это выглядит - см. в <a href="#ex2">следующем примере</a> ↓</span></td>
  </tr>
  <tr>
    <td colspan="3" class="style1"><a name="events"></a>Навешивание обработчиков пользовательских событий</td>
  </tr>
  <tr>
    <td colspan="3" class="bodytext">
    В предыдущем примере управляетcя событие карты <strong>onClick</strong>. <br/><br/>
    В случае управления событиями рисования, внутри метода map.drawing задаются события: <strong>onAdd, onEdit, onRemove</strong> В данном примере обрабатывается событие <strong>onAdd</strong>: при добавлении нового объекта все предыдущие удаляются.
    <pre><code class="javascript"><span class="comment">// "onAdd", "onEdit", "onRemove"</span>
map.drawing.setHandler(<span class="string">"onAdd"</span>, <span class="function"><span class="keyword">function</span><span class="params">(o)</span>
{</span>
 <span class="comment">// например, удалим все остальные объекты</span>
 map.drawing.forEachObject(<span class="function"><span class="keyword">function</span><span class="params">(o2)</span>
 {</span>
   <span class="keyword">if</span> (o2 != o)
     o2.remove();
 });
});</code></pre>
<br/>
   Как это выглядит:
	</span></td>
  </tr>
  <tr>
    <td align="center" class="td_text">
    <a name="ex2"></a><div id="map2" style="width:500px; height:250px;"></div>
    </td>
  </tr>    
</table>

</td>
</tr>
</table>
<script>
	createKosmosnimkiMap(document.getElementById("map"), "maps.kosmosnimki.ru", "44CB65F7CE8D4989B1D35121BD721C9F", function(map)      {	    
	  map.vectors.enableHoverBalloon(function(o) { return "Кликните для отображения информации!"; });
	  map.vectors.setHandler("onClick", function(o) { alert(JSON.stringify(o.properties)); });
	  map.drawing.tools["POLYGON"].setVisible(false);
	  map.drawing.tools["LINESTRING"].setVisible(false);
	  map.coordinates.setVisible(false);
      map.scaleBar.setVisible(false);
	  map.moveTo(4935996, 6990624, 13)
      });
</script>
<script>
      makeFlashMap(document.getElementById("map2"), "0CD53CD459F249F2B621D204B0E0F27B", function(map)
																								 
       {	
	   		   map.moveTo(14759835, 5489396, 6);
			   map.drawing.addObject({ type: "POINT", coordinates: [14754669, 5487309]}, 
 {text: "<a href='http://kosmosnimki.ru' target='a_blank'><i>Сайт Космоснимки</i></a>"});

		map.drawing.addObject({	type: "POLYGON", coordinates: 
			[[[14750982, 5481599],[14749477, 5488268],
			[14757923, 5493118],[14764488, 5485905], 
			[14751024, 5481578], [14750982, 5481599]]]}
		);
			  
				map.drawing.setHandler("onAdd", function(o)
				{
				
				 map.drawing.forEachObject(function(o2)
				 {
				   if (o2 != o)
					 o2.remove();
				 });
				});
       });
</script>
</body>
</html>
