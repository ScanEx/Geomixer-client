{"version":3,"sources":["webpack:///webpack/bootstrap 3cf2ef09065e27d6f3b3","webpack:///./src/entry.js","webpack:///./src/all.css","webpack:///./src/locale.js","webpack:///./src/polyfill.js","webpack:///./src/infodialog.js","webpack:///./src/infodialog.css","webpack:///./src/Views/BaseView.js","webpack:///./src/Search/Searcher.js","webpack:///./src/Models/MyFleetModel.js","webpack:///./src/Models/ScreenSearchModel.js","webpack:///./src/Models/DbSearchModel.js","webpack:///./src/Views/SearchView.js","webpack:///./src/Views/MyFleetView.js","webpack:///./src/Views/VesselInfoView.js"],"names":["require","polyFind","polyFindIndex","createDialog","Handlebars","registerHelper","context","mmsi","imo","JSON","stringify","pluginName","toolbarIconId","modulePath","gmxCore","getModulePath","scheme","document","location","href","replace","baseUrl","window","serverBase","aisServiceUrl","infoDialogCascade","allIinfoDialogs","myFleetLayers","layersWithBaloons","tracksLayerID","aisLayer","tracksLayer","displaingTrack","defaultSearch","highlight","L","marker","icon","className","iconAnchor","iconSize","iconUrl","zIndexOffset","publicInterface","afterViewer","params","map","_params","extend","path","layersByID","nsGmx","gmxMap","lmap","aisLayerSearcher","aisLayerID","aisLastPoint","screenSearchLayer","searchLayer","setLocaleDate","layer","bindPopup","on","e","result","re","lastIndex","template","str","gmx","templateBalloon","props","properties","exec","substring","index","hasOwnProperty","search","formatDate","Date","popup","setContent","setLayerClickHandler","removeEventListener","addEventListener","showInfo","forLayers","key","split","id","i","length","myFleetMembersModel","mapLayers","target","vessel","iconOpt_mf","togglable","title","_gtxt","text","options","svgSprite","iconOpt","regularImageUrl","regularImage","activeImageUrl","activeImage","icon_mf","control","gmxIcon","ev","isActive","aisPluginPanel","show","hide","addControl","a","toLowerCase","substr","x","filter","c","indexOf","y","setLatLng","addTo","leafletMap","getmore","ind","d","$","dialog","parent","insertAfter","eq","closeFunc","event","splice","aisView","myFleetMembersView","gifLoader","openVesselInfoView","vesselInfoView","open","showTrack","mmsiArr","bbox","filterFunc","args","len","fitBounds","maxZoom","setFilter","_map","addLayer","removeFilter","removeLayer","pos","position","left","top","push","ui","svgLoader","BaseView","Searcher","MyFleetModel","ScreenSearchModel","aisScreenSearchModel","DbSearchModel","aisDbSearchModel","SearchView","aisSearchView","MyFleetView","VesselInfoView","_canvas","_div","_leftMenuBlock","_activeView","getActiveView","leftMenu","createWorkCanvas","_iconClick","tabsTemplate","append","compile","workCanvas","tabs","views","_this","is","each","tab","addClass","removeClass","create","_frame","_container","_refresh","_search","_count","setModel","needUpdate","setDirty","bind","widgets","commonCalendar","getDateInterval","parentWorkCanvas","attr","blockItem","leftPanelItem","blockTitle","panelCanvas","toggleTitle","isCollapsed","click","drawBackground","addModule","css","_translationsHash","addtext","module","exports","predicate","list","Object","thisArg","arguments","value","call","undefined","addUnit","v","u","formatVessel","ts_pos_utc","ts_eta","cog","sog","rot","heading","draught","width","source","ddToDms","D","lng","dms","dir","deg","min","sec","commands","canvas","menu","appendTo","photo","moreinfo","content","buttons","showDialog","vessel_name","height","vessel2","moreInfo","smallShipIcon","vesselPropTempl","registry_name","latitude","longitude","swap","mi","t","html","searchNames","response","parseResponse","Result","fields","values","console","log","load","replaceWith","menubuttons","openpage","showpos","showVessel","xmin","xmax","ymin","ymax","isNaN","positionMap","templ","showtrack","model","addremoveIcon","add","data","vessels","findIndex","addremove","filterUpdating","progress","changeFilter","then","info","titlebar","find","currentTarget","_model","_calcHeight","getBoundingClientRect","_clean","off","empty","_doClean","controls","_bindControlEvents","_waitTime","_start","getTime","clearTimeout","_wait","rest","_lastUpdate","update","setTimeout","interval","DateInterval","getUTCDayBoundary","setDateInterval","dateBegin","dateEnd","animate","showPosition","item","parse","maxid","searchById","Status","repaint","scrollCont","_tableTemplate","mCustomScrollbar","_repaintControls","_serverScript","getBorder","dFeatures","gmxDrawing","getFeatures","toGeoJSON","latLngBounds","getBounds","sw","getSouthWest","ne","getNorthEast","lat","max","minX","maxX","geo","type","coordinates","w","center","local","dd","m","h","mm","getDate","slice","getMonth","getFullYear","getHours","getMinutes","getUTCHours","getUTCMinutes","getUTCDate","getUTCMonth","getUTCFullYear","ldd","lm","ly","lh","lmm","offset","getTimezoneOffset","aid","callback","request","WrapStyle","columns","query","join","gmxUtil","sendCrossDomainPostRequest","searchString","isfuzzy","toUpperCase","arr","orderdirection","orderby","pagesize","avessels","searchScreen","dt1","dateInterval","get","dt2","s","toJSON","minx","miny","maxx","maxy","searchByCoords","toString","parseInt","view","_isDirty","getDirty","_parseFilter","attributes","myRe","myArray","getCount","layers","msg","txt","Promise","resolve","errors","promises","lid","reject","sendCrossDomainJSONRequest","layerId","parentLayerId","ParentLayer","Filter","all","l","ErrorInfo","reduce","p","lon","some","sort","b","_actualUpdate","actualUpdate","r","markMembers","forEach","member","vv","mf_member","temp","today","run","TaskID","Completed","ErorInfo","layersVersion","chkVersion","border","group","json","dataSrc","filterString","RegExp","_searchString","ErrorMessage","instance","change","models","selectedIndex","val","siblings","keyup","input","keyCode","searchType","_ais","_galery","_register","_regcap","_leftPanel","_minh","resize","menuAction","counter","count","preview","showPicture","remove","errmsg","submit","$img","jQuery","imgURL","prop","$svg","removeAttr","name","querySelector","Math","floor","innerHeight","style","offsetHeight","parentElement","mia","querySelectorAll","j","panel","classList","display","theme","div","innerWidth","documentElement","clientWidth","body","clientHeight","offsetWidth","drawGallery","gallery","galcontent","drawAis","ledokol","aiscontent","innerHTML","vessel_type","flag_country","callsign","nav_status","destination","drawRegister","regcontent","drawTable","groups","article","pn","pv","version","onFail","error","wait","ship","registerServerUrl","fetch","RS","catch"],"mappings":"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","file":"AISSearch2.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3cf2ef09065e27d6f3b3","require(\"./all.css\")\r\nrequire(\"./locale.js\")\r\nconst {polyFind, polyFindIndex} = require(\"./polyfill.js\")\r\nconst createDialog = require('./infodialog.js')\r\n\t\r\n    Handlebars.registerHelper('aisinfoid', function(context) {\r\n        return context.mmsi+\" \"+context.imo;\r\n    });\r\n\r\n    Handlebars.registerHelper('aisjson', function(context) {\r\n        return JSON.stringify(context);\r\n    });\r\n\r\n    var pluginName = 'AISSearch2',\r\n        toolbarIconId = 'AISSearch2',\r\n        modulePath = gmxCore.getModulePath(pluginName),\r\n        scheme = document.location.href.replace(/^(https?:).+/, \"$1\"),\r\n        baseUrl = window.serverBase || scheme + '//maps.kosmosnimki.ru/',\r\n        //aisServiceUrl = scheme + \"//localhost/GM/Plugins/AIS/\",\r\n        aisServiceUrl = baseUrl + \"Plugins/AIS/\",\r\n        infoDialogCascade = [],  \r\n        allIinfoDialogs = [],\r\n        myFleetLayers = [],\r\n        layersWithBaloons = [],\r\n        //aisLayerID,\r\n        //aisLastPoint,\r\n        tracksLayerID,\r\n        aisLayer,\r\n\t\t//screenSearchLayer,\r\n        tracksLayer,\r\n        displaingTrack,\r\n\t\tdefaultSearch,\r\n\t\thighlight = L.marker([0, 0], {icon:L.icon({className:\"ais_highlight-icon\", iconAnchor:[12, 12], iconSize:[25,25], iconUrl:'plugins/ais/aissearch/highlight.png'}), zIndexOffset:1000}),\r\n        publicInterface = {\r\n            pluginName: pluginName,\r\n            afterViewer: function (params, map) {\r\n                var _params = L.extend({\r\n                        // regularImage: 'ship.png',\r\n                        // activeImage: 'active.png'\r\n                    }, params),\r\n                path = gmxCore.getModulePath(pluginName),\r\n                layersByID = nsGmx.gmxMap.layersByID,\r\n                lmap = map;  \r\n                layersWithBaloons = params.layersWithBaloons;\t\t\t\t\r\n                aisLayerSearcher.aisLayerID = params.aisLayer || '8EE2C7996800458AAF70BABB43321FA4';\t\t\t\t\r\n                aisLayerSearcher.aisLastPoint = params.aisLastPoint || '303F8834DEE2449DAF1DA9CD64B748FE';\r\n                aisLayer = layersByID[aisLayerSearcher.aisLayerID];\r\n\t\t\t\taisLayerSearcher.screenSearchLayer = params.searchLayer || '8EE2C7996800458AAF70BABB43321FA4';\r\n                tracksLayerID = params.tracksLayerID || '13E2051DFEE04EEF997DC5733BD69A15';\r\n                tracksLayer = layersByID[tracksLayerID];\r\n\t\t\t\tdefaultSearch = params.defaultSearch || 'screen';\r\n\t\t\t\ttoolbarIconId = params.toolbarIconId;\r\n                var setLocaleDate = function(layer){\r\n                    if (layer)\r\n                    layer.bindPopup('').on('popupopen',function(e){\r\n                        //console.log(e.gmx.properties);\r\n                        var result, re = /\\[([^\\[\\]]+)\\]/g, lastIndex = 0, template = \"\", \r\n                        str = e.gmx.templateBalloon, props = e.gmx.properties;\r\n                        while ((result = re.exec(str)) !== null) {\r\n                            template += str.substring(lastIndex, result.index);\r\n                            if (props.hasOwnProperty(result[1]))\r\n                                if (result[1].search(/^ts_/)!=-1)\r\n                                    template += aisLayerSearcher.formatDate(new Date(props[result[1]]*1000))\r\n                                else\r\n                                    template += props[result[1]]\r\n//console.log(lastIndex+\", \"+result.index+\" \"+str.substring(lastIndex, result.index)+\" \"+props[result[1]]+\" \"+result[1])\r\n                            lastIndex = re.lastIndex;\r\n                        }  \r\n                        template += str.substring(lastIndex);                      \r\n//console.log(lastIndex+\", \"+re.lastIndex+\" \"+str.substring(lastIndex))\r\n                        e.popup.setContent(template);\r\n                    })\r\n                },\r\n                setLayerClickHandler = function(layer){\r\n                        layer.removeEventListener('click')\r\n                        layer.addEventListener('click', function(e){\r\n//console.log(e)\r\n                        if (e.gmx && e.gmx.properties.hasOwnProperty(\"imo\"))\r\n                        publicInterface.showInfo(e.gmx.properties)\r\n                        })           \r\n                },\r\n                forLayers = function(layer){\r\n                    if (layer){\r\n                            setLocaleDate(layer)                 \r\n                            setLayerClickHandler(layer)\r\n                    }        \r\n                }\r\n                for (var key in params) {\r\n                    if (key==\"myfleet\"){\r\n                        myFleetLayers = params[key].split(\",\").map(function(id){\r\n                           return  id.replace(/\\s/, \"\");\r\n                        });\r\n                        for (var i=0; i<myFleetLayers.length; ++i) { \r\n                            forLayers(layersByID[myFleetLayers[i]])\r\n                        }\r\n                    }\r\n                    else{ \r\n                        forLayers(layersByID[params[key]] )\r\n                    }\r\n                }\r\n\t\t\t\tmyFleetMembersModel.mapLayers = myFleetLayers\r\n\t\t\t\thighlight.addEventListener('click', function(e){e.target.vessel && publicInterface.showInfo(e.target.vessel, true)});\r\n\t\t\t\tvar iconOpt_mf = {\r\n                    //id: toolbarIconId,\r\n\t\t\t\t\tclassName: \"VesselSearchTool\",\r\n                    togglable: true,\r\n                    title: _gtxt('AISSearch2.caption')\r\n                };\t\r\n\t\t\t\tif (toolbarIconId)\r\n\t\t\t\t\ticonOpt_mf.id = toolbarIconId;\r\n\t\t\t\telse\r\n\t\t\t\t\ticonOpt_mf.text = _gtxt('AISSearch2.capShort');\r\n\t\t\t\r\n                if (!lmap.options.svgSprite) {\r\n                    L.extend(iconOpt, {\r\n\t\t\t\t\t\tregularImageUrl: _params.regularImage.search(/^https?:\\/\\//) !== -1 ? _params.regularImage : path + _params.regularImage,\r\n\t\t\t\t\t\tactiveImageUrl: _params.activeImage.search(/^https?:\\/\\//) !== -1 ? _params.activeImage : path + _params.activeImage\r\n                    });\r\n\t\t\t\t}\r\n\t\t\t\tvar icon_mf = L.control.gmxIcon(iconOpt_mf).on('statechange', function (ev) {\r\n                    if (ev.target.options.isActive) {\r\n                        //console.log(icon_mf);\r\n\t\t\t\t\t    aisPluginPanel.show(icon_mf);\r\n                    }\r\n                    else {\r\n                        aisPluginPanel.hide();\r\n                    }\r\n\t\t\t\t});\r\n                lmap.addControl(icon_mf);\r\n\t\t\t\tif (location.search.search(/x=[^y=]+y=/i)!=-1){\r\n\t\t\t\t\tvar a = location.search.toLowerCase().substr(1).split('&'),\r\n\t\t\t\t\tx = a.filter(function(c){return !c.indexOf(\"x=\")})[0].substr(2),\r\n\t\t\t\t\ty = a.filter(function(c){return !c.indexOf(\"y=\")})[0].substr(2)\r\n\t\t\t\t\thighlight.vessel = null;\r\n\t\t\t\t\thighlight.setLatLng([y, x]).addTo(nsGmx.leafletMap);\r\n\t\t\t\t}\r\n            },\r\n            showInfo: function(vessel, getmore){\r\n                var ind = polyFindIndex(allIinfoDialogs, function(d){return d.vessel.imo==vessel.imo && d.vessel.mmsi==vessel.mmsi});\r\n                if (ind>=0){\r\n                    $(allIinfoDialogs[ind].dialog).parent().insertAfter($('.ui-dialog').eq($('.ui-dialog').length-1));\r\n                    return;\r\n                }\r\n\r\n                var dialog = createDialog({\r\n\t\t\t\t\tvessel:vessel, \r\n\t\t\t\t\tgetmore:getmore, displaingTrack:displaingTrack,\r\n\t\t\t\t\tcloseFunc:function(event){\r\n                            var ind = polyFindIndex(infoDialogCascade, function(d){return d.id==dialog.id});\r\n                            if (ind>=0)\r\n                                infoDialogCascade.splice(ind, 1);\r\n                            ind = polyFindIndex(allIinfoDialogs, function(d){return d.dialog.id==dialog.id});\r\n                            if (ind>=0)\r\n                                allIinfoDialogs.splice(ind, 1);\r\n                        },\r\n\t\t\t\t\taisLayerSearcher:aisLayerSearcher, publicInterface:publicInterface,\r\n\t\t\t\t\tscheme:scheme, aisServiceUrl:aisServiceUrl, \r\n\t\t\t\t\taisView:aisView, myFleetMembersView:myFleetMembersView,\r\n\t\t\t\t\tmodulePath:modulePath,\r\n\t\t\t\t\tgifLoader:gifLoader,\r\n\t\t\t\t\taisPluginPanel:aisPluginPanel\r\n\t\t\t\t},\r\n\t\t\t\t{ \t// COMMANDS\r\n\t\t\t\t\topenVesselInfoView: vesselInfoView.open,\r\n\t\t\t\t\tshowTrack: function (mmsiArr, bbox) { \r\n\t\t\t\t\t\tlet lmap = nsGmx.leafletMap,                 \r\n\t\t\t\t\t\t\tfilterFunc = function (args) {\r\n\t\t\t\t\t\t\t\tvar mmsi = args.properties[1],\r\n\t\t\t\t\t\t\t\t\ti, len;\r\n\t\t\t\t\t\t\t\tfor (i = 0, len = mmsiArr.length; i < len; i++) {\r\n\t\t\t\t\t\t\t\t\tif (mmsi === mmsiArr[i]) { return true; }\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif (bbox) { lmap.fitBounds(bbox, { maxZoom: 11 }); }\r\n\t\t\t\t\t\tif (aisLayer) {\r\n\t\t\t\t\t\t\t\tif (mmsiArr.length) {\r\n\t\t\t\t\t\t\t\t\tdisplaingTrack = mmsiArr[0];\r\n\t\t\t\t\t\t\t\t\taisLayer.setFilter(filterFunc);\r\n\t\t\t\t\t\t\t\t\tif (!aisLayer._map) {\r\n\t\t\t\t\t\t\t\t\t\tlmap.addLayer(aisLayer);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tdisplaingTrack = false;\r\n\t\t\t\t\t\t\t\t\taisLayer.removeFilter();\r\n\t\t\t\t\t\t\t\t\tlmap.removeLayer(aisLayer);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (tracksLayer) {\r\n\t\t\t\t\t\t\t\tif (mmsiArr.length) {\r\n\t\t\t\t\t\t\t\t\ttracksLayer.setFilter(filterFunc);\r\n\t\t\t\t\t\t\t\t\tif (!tracksLayer._map) {\r\n\t\t\t\t\t\t\t\t\t\tlmap.addLayer(tracksLayer);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttracksLayer.removeFilter();\r\n\t\t\t\t\t\t\t\t\tlmap.removeLayer(tracksLayer);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t})\t\t\t\t\r\n            \r\n                if (infoDialogCascade.length>0){\r\n                    var pos  = $(infoDialogCascade[infoDialogCascade.length-1]).parent().position();\r\n                    $(dialog).dialog(\"option\", \"position\", [pos.left+10, pos.top+10]);   \r\n                }\r\n\r\n                infoDialogCascade.push(dialog);\r\n                allIinfoDialogs.push({vessel:vessel, dialog:dialog});\r\n                $(dialog).on( \"dialogdragstop\", function( event, ui ) {\r\n                    var ind = polyFindIndex(infoDialogCascade, function(d){return d.id==dialog.id});\r\n                    if (ind>=0)\r\n                        infoDialogCascade.splice(ind, 1);\r\n                });\r\n             \r\n            }\r\n        };\r\n\r\n\r\n    var svgLoader = '<div class=\"loader\">'+\r\n  '<svg version=\"1.1\" id=\"loader-1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"22px\" height=\"22px\" viewBox=\"0 0 50 50\" style=\"enable-background:new 0 0 50 50;\" xml:space=\"preserve\">'+\r\n  '<path opacity=\"0.2\" fill=\"#000\" d=\"M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z\"/>'+\r\n    '<g transform=\"rotate(180 25 25)\">'+\r\n  '<path opacity=\"0.2\" fill=\"#000\" d=\"M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z\"/>'+\r\n    '</g>'+    \r\n  '<path fill=\"#000\" d=\"M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z\">'+\r\n    '<animateTransform attributeType=\"xml\" attributeName=\"transform\" type=\"rotate\" from=\"0 25 25\" to=\"360 25 25\" dur=\"0.6s\" repeatCount=\"indefinite\"/>'+\r\n    '</path>'+\r\n  '</svg>'+\r\n'</div>',\r\n    gifLoader = '<img src=\"img/progress.gif\">'\r\n\t\r\n\r\n\tconst BaseView = require('./Views/BaseView.js') \r\n\tconst aisView = new BaseView({publicInterface:publicInterface, highlight:highlight})    \r\n\r\n\tconst Searcher = require('./Search/Searcher.js') \r\n\tconst aisLayerSearcher = new Searcher({baseUrl:baseUrl, aisServiceUrl: aisServiceUrl})\r\n\r\n    const MyFleetModel = require('./Models/MyFleetModel.js')\r\n    const myFleetMembersModel = new MyFleetModel({baseUrl:baseUrl, aisLayerSearcher:aisLayerSearcher, polyFind:polyFind, polyFindIndex:polyFindIndex})\t\r\n\t\r\n    const ScreenSearchModel = require('./Models/ScreenSearchModel.js')\t\r\n    const aisScreenSearchModel = new ScreenSearchModel({myFleetMembersModel:myFleetMembersModel, aisLayerSearcher:aisLayerSearcher})\r\n\r\n    const DbSearchModel = require('./Models/DbSearchModel.js')\r\n    const aisDbSearchModel = new DbSearchModel({myFleetMembersModel:myFleetMembersModel, aisLayerSearcher:aisLayerSearcher})\r\n\r\n\tconst SearchView = require('./Views/SearchView.js')\r\n\tconst aisSearchView = new SearchView({aisView:aisView, aisScreenSearchModel:aisScreenSearchModel, aisDbSearchModel:aisDbSearchModel, highlight:highlight})\r\n\t\r\n\tconst MyFleetView = require('./Views/MyFleetView.js')\r\n    const myFleetMembersView = new MyFleetView({aisView:aisView, myFleetMembersModel:myFleetMembersModel})\r\n\t\r\n    const VesselInfoView  = require('./Views/VesselInfoView.js')\r\n\tconst vesselInfoView  = new VesselInfoView({modulePath:modulePath, aisServiceUrl:aisServiceUrl, scheme:scheme})\r\n\t\r\n\r\n    //************************************\r\n    //  AIS PANEL\r\n    //************************************\r\n    var aisPluginPanel = {\r\n        _canvas: _div(null),\r\n        _leftMenuBlock: null,\r\n        _activeView: aisSearchView,\r\n        getActiveView: function(){\r\n            return this._activeView;\r\n        },\r\n        show: function(icon){\r\n            if (!this._leftMenuBlock)\r\n                this._leftMenuBlock = new leftMenu();\r\n            if (!this._leftMenuBlock.createWorkCanvas(\"aispanel\", function(){ icon._iconClick() },\r\n            { path:[_gtxt('AISSearch2.caption')] })) {\r\n\r\n                var tabsTemplate = '<table class=\"ais_tabs\" border=0><tr>' +\r\n                    '<td class=\"ais_tab search_tab\">' +\r\n                        '{{i \"AISSearch2.title\"}}' +\r\n                    '</td><td class=\"ais_tab myfleet_tab active\">' + // ACTIVE\r\n                        '{{i \"AISSearch2.myFleetDialog\"}}' +\r\n                    '</td>' +\r\n                '</tr></table>'+\r\n                '<div class=\"ais_view search_view\">'+\r\n                    '<table border=0 class=\"instruments\"><tr>'+\r\n                    '<td><div><i class=\"icon-down-dir\"><select>'+\r\n\t\t\t\t\t(defaultSearch=='screen'?\r\n\t\t\t\t\t'<option value=\"0\">{{i \"AISSearch2.screen\"}}</option>'+'<option value=\"1\">{{i \"AISSearch2.database\"}}</option>' :\r\n\t\t\t\t\t'<option value=\"1\">{{i \"AISSearch2.database\"}}</option>'+'<option value=\"0\">{{i \"AISSearch2.screen\"}}</option>')+\r\n\t\t\t\t\t'</select></i></div></td>'+\r\n                    '<td><div class=\"refresh clicable\" title=\"{{i \"AISSearch2.refresh\"}}\"><div>'+gifLoader+'</div></div></td>'+\r\n                    '<td><span class=\"count\"></span></td></tr>'+\r\n                    '<tr><td colspan=\"3\"><div class=\"filter\"><input type=\"text\" placeholder=\"{{i \"AISSearch2.filter\"}}\"/><i class=\"icon-search clicable\"></div></td></tr></table>'+\r\n                    \r\n                    '<div class=\"ais_vessels\"><div class=\"ais_vessel\">'+\r\n                    '<table><tr><td>NO VESSELS FOUND</td>'+\r\n                    '<td><div class=\"info\">'+\r\n                    '<i class=\"clicable icon-info\"></i>'+\r\n                    '</div></td></tr></table>'+\r\n                    '</div></div>'+\r\n                '</div>'+\r\n                '<div class=\"ais_view myfleet_view\">'+                    \r\n                    '<table border=0 class=\"instruments\"><tr>'+\r\n                    '<td><div class=\"refresh\"><div>'+gifLoader+'</div></div></td><td></td><td></td>'+\r\n                    '</tr></table>'+\r\n                    \r\n                    '<div class=\"ais_vessels\"><div class=\"ais_vessel\">NO VESSELS SELECTED</div></div>'+\r\n                '</div>';\r\n                $(this._canvas).append(Handlebars.compile(tabsTemplate));\r\n                $(this._leftMenuBlock.workCanvas).append(this._canvas);\r\n\r\n                var tabs = $('.ais_tab', this._canvas),\r\n                    views = [aisSearchView, myFleetMembersView];\r\n                var _this = this;\r\n                tabs.on('click', function(){\r\n                    if (!$(this).is('.active')){\r\n                        var target = this;\r\n                        tabs.each(function(i, tab){ \r\n                            if(!$(tab).is('.active') && target==tab){\r\n                                $(tab).addClass('active');                                \r\n                                views[i].show();\r\n                                _this._activeView = views[i];\r\n                            }\r\n                            else{\r\n                                $(tab).removeClass('active');                                \r\n                                views[i].hide();\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n                \r\n                aisSearchView.create({\r\n                    _frame: $('.search_view', this._canvas),\r\n                    _container: $('.search_view .ais_vessels', this._canvas),\r\n                    _refresh: $('.search_view .refresh div', this._canvas),\r\n                    _search: $('.filter', this._canvas),\r\n                    _count: $('.count', this._canvas)\r\n                });\r\n\t\t\t\taisSearchView.setModel(defaultSearch);\r\n\r\n                myFleetMembersView.create({\r\n                    _frame: $('.myfleet_view', this._canvas),\r\n                    _container: $('.myfleet_view .ais_vessels', this._canvas),\r\n                    _refresh: $('.myfleet_view .refresh div', this._canvas)\r\n                });\r\n\r\n                var needUpdate = function(){\r\n                    aisScreenSearchModel.setDirty();\r\n                    if (this._activeView===aisSearchView){\r\n                        aisSearchView.show();\r\n                    }\r\n                }; \r\n                nsGmx.leafletMap.on('moveend', needUpdate.bind(this));\r\n                nsGmx.widgets.commonCalendar.getDateInterval().on('change', needUpdate.bind(this));\r\n\r\n            }\r\n            $(this._leftMenuBlock.parentWorkCanvas)\r\n            .attr('class', 'left_aispanel')\r\n            .insertAfter('.layers-before');\r\n            var blockItem = this._leftMenuBlock.leftPanelItem,\r\n                blockTitle = $('.leftmenu-path', blockItem.panelCanvas);\r\n            var toggleTitle = function(){\r\n                if(blockItem.isCollapsed())\r\n                    blockTitle.show();\r\n                else\r\n                    blockTitle.hide();\r\n            }\r\n            $(blockItem).on('changeVisibility', toggleTitle);\r\n            toggleTitle();\r\n\r\n            // Show the first tab\r\n            $('.ais_tab', this._canvas).eq(0).removeClass('active').click();\r\n            aisSearchView.drawBackground();\r\n            myFleetMembersView.drawBackground();\r\n        },\r\n        hide: function(){\r\n            $(this._leftMenuBlock.parentWorkCanvas).hide()\r\n\t\t\tnsGmx.leafletMap.removeLayer(highlight)\r\n        }\r\n    };\r\n\r\n\r\n    gmxCore.addModule(pluginName, publicInterface, {\r\n        css: pluginName + '.css'\r\n    });\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/entry.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/all.css\n// module id = 1\n// module chunks = 0","\r\n    _translationsHash.addtext('rus', {\r\n        'AISSearch2.title': 'Поиск судов',\r\n        'AISSearch2.title1': 'Найдено судов',\r\n        'AISSearch2.title2': '<b>Данных не найдено!</b>',\r\n        'AISSearch2.error': '<b>Ошибка при получении данных!</b>',\r\n        'AISSearch2.iconTitle': 'Поиск судов по экрану',\r\n        'AISSearch2.placeholder_0': 'Поиск по адресам, координатам',\r\n        'AISSearch2.placeholder_1': 'Поиск судна по названию / MMSI',\r\n        // 'AISSearch2.placeholder_1': 'Поиск судна по названию / MMSI. Поиск по адресам, координатам, кадастровым номерам'\r\n        'AISSearch2.myFleetDialog': 'Мой флот',\r\n        'AISSearch2.vesselName': 'название',\r\n        'AISSearch2.vesselAdd': 'добавить',\r\n        'AISSearch2.vesselRemove': 'удалить',\r\n        'AISSearch2.myFleetMembers': 'Состав',\r\n        'AISSearch2.myFleetMember': 'мой флот',\r\n        'AISSearch2.info': 'информация',\r\n        'AISSearch2.found':'Найдено: ',\r\n        'AISSearch2.filter':'Введите название или mmsi или imo судна',\r\n        'AISSearch2.screen':'По экрану',\r\n        'AISSearch2.database':'По базе данных',\r\n        'AISSearch2.capShort': 'Поиск судов',\r\n        'AISSearch2.caption': 'Поиск судов и \"Мой флот\"',\r\n        'AISSearch2.refresh': 'обновить',\r\n        'AISSearch2.refreshing': 'обновляется',\r\n        'AISSearch2.nomyfleet': 'Сервис не доступен',\r\n        'AISSearch2.auth': 'Требуется авторизация',\r\n        'AISSearch2.vessel_name': 'Название',\r\n        'AISSearch2.mmsi': 'MMSI',\r\n        'AISSearch2.imo': 'IMO',\r\n        'AISSearch2.flag_country': 'Страна',\r\n        'AISSearch2.vessel_type': 'Тип судна',\r\n        'AISSearch2.draught': 'Осадка',\r\n        'AISSearch2.destination': 'Назначение',\r\n        'AISSearch2.nav_status': 'Статус',\r\n        'AISSearch2.last_sig': 'Последний сигнал',\r\n        'AISSearch2.show_track': 'трек за сутки',\r\n        'AISSearch2.hide_track': 'скрыть трек',\r\n\t\t'AISSearch2.source': 'Источник данных',\r\n\t\t'AISSearch2.sais': 'спутниковый AIS',\r\n\t\t'AISSearch2.tais': 'береговой AIS',\r\n\t\t'AISSearch2.lon': 'Долгота',\r\n\t\t'AISSearch2.lat': 'Широта'\r\n    });\r\n    _translationsHash.addtext('eng', {\r\n        'AISSearch2.title': 'Searching vessels',\r\n        'AISSearch2.title1': 'Vessels found',\r\n        'AISSearch2.title2': '<b>Vessels not found!</b>',\r\n        'AISSearch2.error': '<b>Vessels not found!</b>',\r\n        'AISSearch2.iconTitle': 'Search vessels within the view area',\r\n        'AISSearch2.placeholder_0': 'Search for addresses, coordinates',\r\n        'AISSearch2.placeholder_1': 'Search by vessel name / MMSI',\r\n        // 'AISSearch2.placeholder_1' : 'Search by vessel name / MMSI. Search by addresses, coordinates, cadastre number'\r\n        'AISSearch2.myFleetDialog': 'My fleet',\r\n        'AISSearch2.vesselName': 'name',\r\n        'AISSearch2.vesselAdd': 'add',\r\n        'AISSearch2.vesselRemove': 'remove',\r\n        'AISSearch2.myFleetMembers': 'Members',\r\n        'AISSearch2.myFleetMember': 'my fleet',\r\n        'AISSearch2.info': 'info',\r\n        'AISSearch2.found':'Found ',\r\n        'AISSearch2.filter':'Insert vessel name or mmsi or imo',\r\n        'AISSearch2.screen':'On screen',\r\n        'AISSearch2.database':'In database',\r\n        'AISSearch2.capShort': 'Vessel Search',\r\n        'AISSearch2.caption': 'Vessel Search & My Fleet',\r\n        'AISSearch2.refresh': 'refresh',\r\n        'AISSearch2.refreshing': 'refreshing',\r\n        'AISSearch2.nomyfleet': 'Service is unavailable',\r\n        'AISSearch2.auth': 'Authorization required',\r\n        'AISSearch2.vessel_name': 'Name',\r\n        'AISSearch2.mmsi': 'MMSI',\r\n        'AISSearch2.imo': 'IMO',\r\n        'AISSearch2.flag_country': 'Flag',\r\n        'AISSearch2.vessel_type': 'Vessel type',\r\n        'AISSearch2.draught': 'Draught',\r\n        'AISSearch2.destination': 'Destination',\r\n        'AISSearch2.nav_status': 'Navigation status',\r\n        'AISSearch2.last_sig': 'Last signal',\r\n        'AISSearch2.show_track': 'show track',\r\n        'AISSearch2.hide_track': 'hide track',\r\n\t\t'AISSearch2.source': 'Source',\r\n\t\t'AISSearch2.sais': 'S-AIS',\r\n\t\t'AISSearch2.tais': 'T-AIS',\r\n\t\t'AISSearch2.lon': 'Longitude',\r\n\t\t'AISSearch2.lat': 'Latitude'\r\n    });\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/locale.js","module.exports = { \r\n\tpolyFind: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn value;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn undefined;\r\n\t},\r\n\tpolyFindIndex: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn i;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/polyfill.js","require(\"./infodialog.css\")\r\n\r\nlet addUnit = function(v, u){\r\n        return v!=null && v!=\"\" ? v+u : \"\"; \r\n    },\r\n\tformatDate,\r\n    formatVessel = function(vessel){\r\n                    vessel.ts_pos_utc = formatDate(new Date(vessel.ts_pos_utc*1000));\r\n                    vessel.ts_eta = formatDate(new Date(vessel.ts_eta*1000));\r\n                    vessel.cog = addUnit(vessel.cog, \"°\");\r\n                    vessel.sog = addUnit(vessel.sog, \" уз\");\r\n                    vessel.rot = addUnit(vessel.rot, \"°/мин\");\r\n                    vessel.heading = addUnit(vessel.heading, \"°\");\r\n                    vessel.draught = addUnit(vessel.draught, \" м\");\r\n                    vessel.length = addUnit(vessel.length, \" м\");\r\n                    vessel.width = addUnit(vessel.width, \" м\");\r\n\t\t\t\t\tvessel.source = vessel.source=='T-AIS'?_gtxt('AISSearch2.tais'):_gtxt('AISSearch2.sais');\r\n                    return vessel;\r\n    },\r\n\tddToDms = function(D, lng){\r\n\t\tlet dms = {\r\n\t\t\tdir : D<0?lng?'W':'S':lng?'E':'N',\r\n\t\t\tdeg : 0|(D<0?D=-D:D),\r\n\t\t\tmin : 0|D%1*60,\r\n\t\t\tsec :(0|D*60%1*6000)/100\r\n\t\t};\r\n\t\treturn dms.deg+\"°\"+dms.min+\"'\"+dms.sec+\"\\\" \"+dms.dir\r\n\t}\r\n\r\nmodule.exports = function({vessel, closeFunc, aisLayerSearcher, getmore, scheme, modulePath, gifLoader,\r\naisView, displaingTrack, myFleetMembersView, aisPluginPanel }, commands){\r\n\r\n\tformatDate = aisLayerSearcher.formatDate\r\n\t\r\n    let canvas = $('<div class=\"ais_myfleet_dialog\"/>'),\r\n        menu = $('<div class=\"column1 menu\"></div>').appendTo(canvas),\r\n        photo = $('<div class=\"photo\"><div></div></div>').appendTo(menu),\r\n        moreinfo = $('<div class=\"moreinfo\"><div></div></div>').appendTo(menu),\r\n        content = Handlebars.compile(\r\n                    '<div class=\"column2 content\">'+\r\n                    '</div>') (vessel),\r\n\t\tbuttons = $('<div class=\"column3 buttons\"></div>')\r\n                    //console.log(content);\r\n\t\r\n    canvas.append(content).append(buttons)\r\n\t\t\t\t\r\n\tlet dialog = showDialog(vessel.vessel_name, canvas[0], {width: 610, height: 230, closeFunc: closeFunc }),     \r\n\tvessel2,\r\n    moreInfo = function(v){\r\n\t\t\t\t\t\tlet smallShipIcon = '<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"14px\" height=\"14px\" viewBox=\"0 0 14 14\" style=\"margin-left: 10px\" xml:space=\"preserve\">'+\r\n\t\t\t\t\t\t\t'<g style=\"fill: #48aff1;\">'+\r\n\t\t\t\t\t\t\t\t'<path class=\"st0\" d=\"M13.4,11H0.6c-0.2,0-0.4,0.1-0.5,0.3c-0.1,0.2-0.1,0.4,0,0.6l1.2,1.8C1.4,13.9,1.6,14,1.8,14h9.9   c0.2,0,0.3-0.1,0.4-0.2l1.7-1.8c0.2-0.2,0.2-0.4,0.1-0.7C13.9,11.1,13.7,11,13.4,11z\"/>'+\r\n\t\t\t\t\t\t\t\t'<path class=\"st0\" d=\"M9.3,9.7h2.9c0.2,0,0.4-0.1,0.5-0.3c0.1-0.2,0.1-0.4,0-0.6L9.8,4.5C9.7,4.3,9.4,4.2,9.2,4.3   C8.9,4.4,8.7,4.6,8.7,4.9v4.3C8.7,9.5,9,9.7,9.3,9.7z\"/>'+\r\n\t\t\t\t\t\t\t\t'<path class=\"st0\" d=\"M1.2,9.7H7c0.3,0,0.6-0.3,0.6-0.6V0.6c0-0.3-0.2-0.5-0.4-0.6C6.9-0.1,6.7,0,6.5,0.3L0.7,8.8   C0.6,9,0.5,9.2,0.6,9.4C0.7,9.6,0.9,9.7,1.2,9.7z\"/>'+\r\n\t\t\t\t\t\t\t'</g>'+\r\n\t\t\t\t\t\t'</svg>',\r\n\t\t\t\t\t\tvesselPropTempl = '<div class=\"vessel_prop vname\"><b>{{vessel_name}}</b>'+smallShipIcon+'</div>'+\r\n\t\t\t\t\t\t'<div class=\"vessel_prop\"><b>&nbsp;'+(vessel2.registry_name ? vessel2.registry_name:'')+'</b></div>'\r\n\t\t\t\t\t\t\r\n                        $('.content', canvas).append(Handlebars.compile(\r\n\t\t\t\t\t\t'<div class=\"vessel_props1\">'+vesselPropTempl+\r\n                        '<div class=\"vessel_prop\">Тип судна: <b>{{vessel_type}}</b></div>'+\r\n                        '<div class=\"vessel_prop\">Флаг: <b>{{flag_country}}</b></div>'+\r\n                        '<div class=\"vessel_prop\">IMO: <b>{{imo}}</b></div>'+\r\n                        '<div class=\"vessel_prop\">MMSI: <b>{{mmsi}}</b></div>'+\r\n                        '<div class=\"vessel_prop\">{{i \"AISSearch2.source\"}}: <b>{{source}}</b></div>'+\r\n\t\t\t\t\t\t'</div>'\r\n                        )(v));\r\n\t\t\t\t\t\t\r\n                        $('.content', canvas).append(Handlebars.compile(\t\r\n\t\t\t\t\t\t'<div class=\"vessel_props2\">'+vesselPropTempl+\t\t\t\t\t\r\n                        '<div class=\"vessel_prop\">COG / SOG: <b>{{cog}} / {{sog}}</b></div>'+\r\n                        '<div class=\"vessel_prop\">HDG / ROT: <b>{{heading}} / {{rot}}</b></div>'+\r\n                        '<div class=\"vessel_prop\">{{i \"AISSearch2.draught\"}}: <b>{{draught}}</b></div>'+\r\n                        '<div class=\"vessel_prop\">{{i \"AISSearch2.destination\"}}: <b>{{destination}}</b></div>'+\r\n                        '<div class=\"vessel_prop\">{{i \"AISSearch2.nav_status\"}}: <b>{{nav_status}}</b></div>'+\r\n\t\t\t\t\t\t'</div>'\r\n                        )(v));\r\n\t\t\t\t\t\t\r\n                        $(moreinfo).append('<table><tr>'+\r\n'<td class=\"ais_refresh\"><svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" height=\"16\" width=\"16\"><g class=\"nc-icon-wrapper\" fill=\"#444444\"><polyline data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 15,16 7,16 7,13 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 15,18 17,16 15,14 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" data-stroke=\"none\" fill=\"#444444\" points=\"15,18 17,16 15,14 \" stroke-linejoin=\"miter\" stroke-linecap=\"square\" style=\"stroke: currentColor;fill: currentColor;\"/> <polyline data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 9,8 17,8 17,11 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\"9,6 7,8 9,10 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" data-stroke=\"none\" fill=\"#444444\" points=\"9,6 7,8 9,10 \" stroke-linejoin=\"miter\" stroke-linecap=\"square\" style=\"stroke: currentColor;fill: currentColor;\"/> <rect x=\"2\" y=\"1\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" width=\"20\" height=\"22\" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/></g></svg></td>'+\r\n\t\t\t\t\t\t'<td><div class=\"vessel_prop coordinates\"><span class=\"small\">'+\r\n\t\t\t\t\t\tv.latitude+'° '+(v.latitude<0?'S':'N')+' '+v.longitude+'° '+(v.longitude<0?'W':'E')+\r\n\t\t\t\t\t\t'</small></div></td>'+\r\n\t\t\t\t\t\t'</tr></table>'\r\n                        );\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet swap = \"<span class='small'>\"+ddToDms(v.latitude, false)+\" \"+ddToDms(v.longitude, true)+\"</span>\"\t\t\t\t\t\t\r\n\t\t\t\t\t\t$('.ais_refresh', moreinfo).click((e)=>{\r\n\t\t\t\t\t\t\tlet mi = $('.coordinates', moreinfo),\r\n\t\t\t\t\t\t\tt = mi.html()\r\n\t\t\t\t\t\t\tmi.html(swap)\r\n\t\t\t\t\t\t\tswap = t\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$('.vessel_props2', canvas).hide()\r\n    }              \r\n    \r\n\tif (!getmore){\r\n        vessel2 = $.extend({}, vessel);\r\n        moreInfo(formatVessel(vessel2));\r\n    }\r\n    else\r\n        aisLayerSearcher.searchNames([{mmsi:vessel.mmsi,imo:vessel.imo}], function(response){\r\n                        if (parseResponse(response)){                    \r\n                            vessel2 = {};\r\n\t\t\t\t\t\t\tfor (var i=0; i<response.Result.fields.length; ++i)\r\n\t\t\t\t\t\t\t\tvessel2[response.Result.fields[i]] = response.Result.values[0][i];\r\n//console.log(vessel2.registry_name)\r\n                            moreInfo(formatVessel(vessel2));\r\n                        }\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tconsole.log(response)\r\n        })\r\n\t\r\n\t// IMAGE\r\n    $('<img src=\"'+scheme+'//photos.marinetraffic.com/ais/showphoto.aspx?size=thumb&mmsi='+vessel.mmsi+'\">').load(function() {\r\n        if (this)\r\n            $('div', photo).replaceWith(this);\r\n    });\r\n\t\r\n\t// BUTTONS\r\n    let menubuttons = $('<div class=\"menubuttons\"></div>').appendTo(buttons)\r\n\t\r\n\tlet openpage = $('<div class=\"button openpage\" title=\"информация о судне\">'+\r\n\t\t\t\t'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">'+\r\n\t\t\t\t\t'<g class=\"nc-icon-wrapper\" style=\"fill:currentColor\">'+\r\n\t\t\t\t\t\t'<path d=\"M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 9h2V7h-2v2z\"/>'+\r\n\t\t\t\t\t'</g>'+\t\t\t\t\r\n\t\t\t\t'</svg>'\r\n\t\t\t\t+'</div>')\r\n                .appendTo(menubuttons)                   \r\n                .on('click', ()=>commands.openVesselInfoView.call(null, vessel, vessel2)); \r\n\r\n    let showpos = $('<div class=\"button showpos\" title=\"показать положение\">'+\r\n'<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" width=\"20\" height=\"20\"><g class=\"nc-icon-wrapper\" fill=\"#444444\"><polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 1,7 1,1 7,1 \" stroke-linejoin=\"miter\"/> <polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 17,1 23,1 23,7 \" stroke-linejoin=\"miter\"/> <polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 23,17 23,23 17,23 \" stroke-linejoin=\"miter\"/> <polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 7,23 1,23 1,17 \" stroke-linejoin=\"miter\"/> <rect style=\"stroke:currentColor\" x=\"8\" y=\"8\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" width=\"8\" height=\"8\" stroke-linejoin=\"miter\"/></g></svg>'+\r\n\t\t\t\t'</div>')\r\n                .appendTo(menubuttons)                   \r\n                .on('click', function(){\r\n                    var showVessel = {\r\n                        xmin:vessel.xmin?vessel.xmin:vessel.longitude, \r\n                        xmax:vessel.xmax?vessel.xmax:vessel.longitude, \r\n                        ymin:vessel.ymin?vessel.ymin:vessel.latitude, \r\n                        ymax:vessel.ymax?vessel.ymax:vessel.latitude, \r\n                        ts_pos_utc:vessel.ts_pos_utc && !isNaN(vessel.ts_pos_utc)?aisLayerSearcher.formatDate(new Date(vessel.ts_pos_utc*1000)):vessel.ts_pos_utc\r\n                    }\t\t\t\r\n\t\t\t\t\t//nsGmx.leafletMap.removeLayer(highlight);\r\n\t\t\t\t\t//highlight.setLatLng([showVessel.ymax, showVessel.xmax]).addTo(nsGmx.leafletMap);\r\n                    aisView.positionMap(showVessel);\r\n                });\r\n\t//if (tracksLayer){\r\n\tlet templ = '<div class=\"button showtrack\" title=\"'+_gtxt('AISSearch2.show_track')+'\">'+\r\n'<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" width=\"20\" height=\"20\"><g class=\"nc-icon-wrapper\" fill=\"#444444\"><path style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" d=\"M4,13V5 c0-2.209,1.791-4,4-4h0c2.209,0,4,1.791,4,4v14c0,2.209,1.791,4,4,4h0c2.209,0,4-1.791,4-4v-8\" stroke-linejoin=\"miter\"/> <circle style=\"stroke:currentColor\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" cx=\"20\" cy=\"4\" r=\"3\" stroke-linejoin=\"miter\"/> <circle style=\"stroke:currentColor\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" cx=\"4\" cy=\"20\" r=\"3\" stroke-linejoin=\"miter\"/></g></svg>'+\t\t\t\t\t\r\n\t\t\t\t\t'</div>',\r\n\t\t\t\t\t\r\n\t\tshowtrack = $(templ)\r\n\t\t\t\t\t.appendTo(menubuttons) \r\n\t\t\t\t\t.on('click', function(){\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (showtrack.attr('title')!=_gtxt('AISSearch2.hide_track')){\r\n\t\t\t\t\t\t\t$('.showtrack').attr('title', _gtxt('AISSearch2.show_track'))\r\n\t\t\t\t\t\t\t.removeClass('active');\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tcommands.showTrack.call(null, [vessel.mmsi])\r\n\t\t\t\t\t\t\tshowtrack.attr('title', _gtxt('AISSearch2.hide_track'))\r\n\t\t\t\t\t\t\t.addClass('ais active');      \r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t$('.showtrack').attr('title',_gtxt('AISSearch2.show_track'))\r\n\t\t\t\t\t\t\t.removeClass('ais active');\r\n\t\t\t\t\t\t\tcommands.showTrack.call(null, [])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!displaingTrack || displaingTrack!=vessel.mmsi){\r\n\t\t\t\t\t\tshowtrack.attr('title', _gtxt('AISSearch2.show_track'))\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tshowtrack.attr('title', _gtxt('AISSearch2.hide_track'))\r\n\t\t\t\t\t\t.addClass('ais active');      \r\n\t\t\t\t\t}\r\n\t//}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\tlet myFleetMembersModel = myFleetMembersView.model,\r\n\t\taddremoveIcon = function(add){\r\n\t\t\t\t\treturn ( add ? '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><g class=\"nc-icon-wrapper\" fill=\"#444444\" style=\"fill: currentColor;\"><path d=\"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z\"/></g></svg>'\t\t\t\t\t\r\n:'<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"24px\" height=\"24px\" viewBox=\"0 0 24 24\" style=\"enable-background:new 0 0 24 24;fill: currentColor;\" xml:space=\"preserve\"><g><path class=\"st0\" d=\"M4,6H2v14c0,1.1,0.9,2,2,2h14v-2H4V6z M20,2H8C6.9,2,6,2.9,6,4v12c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2V4    C22,2.9,21.1,2,20,2z M19,11h-4v4h-2v-4H9V9h4V5h2v4h4V11z\"/></g><rect x=\"9\" y=\"5\" class=\"st0\" width=\"10\" height=\"4\"/><rect x=\"9\" y=\"11\" class=\"st0\" width=\"10\" height=\"4\"/></g></svg>' )\r\n\t\t}\r\n        if (myFleetMembersModel && myFleetMembersModel.data && myFleetMembersModel.data.vessels){\r\n                    let add = myFleetMembersModel.findIndex(vessel)<0,\r\n                    addremove = $('<div class=\"button addremove\">'+\r\n\t\t\t\t\taddremoveIcon(add) +\r\n\t\t\t\t\t'</div>')\r\n\t\t\t\t\t\t//.css('background-image','url('+modulePath+'svg/'+(add?'add':'rem')+'-my-fleet.svg)')\r\n\t\t\t\t\t\t.attr('title', add?'добавить в мой флот':'удалить из моего флота')\r\n\t\t\t\t\t\t.appendTo(menubuttons);\r\n                    if (myFleetMembersModel.filterUpdating)\r\n                        addremove.addClass('disabled');\r\n                    addremove.on('click', function(){\r\n                        if (addremove.is('.disabled'))\r\n                            return;\r\n                        \r\n                        $('.addremove').addClass('disabled')\r\n\t\t\t\t\t\taddremove.hide()\r\n                        progress.append(gifLoader)\r\n\t\t\t\t\t\t\r\n                        myFleetMembersModel.changeFilter(vessel).then(function(){  \r\n                            add = myFleetMembersModel.findIndex(vessel)<0;\r\n                            var info = $('.icon-ship[vessel=\"' + vessel.mmsi + ' ' + vessel.imo + '\"]');\r\n                            info.css('display', !add?'inline':'none'); \r\n                            \r\n                            addremove.attr('title', add?'добавить в мой флот':'удалить из моего флота')\r\n\t\t\t\t\t\t\t.html(addremoveIcon(add))\r\n                            //.css('background-image','url('+modulePath+'svg/'+(add?'add':'rem')+'-my-fleet.svg)')\r\n \r\n                            progress.text('');               \r\n                            $('.addremove').removeClass('disabled').show()\r\n\t\t\t\t\t\t\t\r\n                            if (aisPluginPanel.getActiveView()==myFleetMembersView)\r\n                                myFleetMembersView.show();\r\n                        });\r\n                    }); \r\n        }\r\n\t\t\t\t\r\n    let progress = $('<div class=\"progress\"></div>')\r\n    .appendTo(menubuttons); \r\n\t\r\n\t// TITLEBAR\t\r\n\tcanvas.parent('div').css({'margin':'0', 'overflow':'hidden'})\t\r\n\tlet titlebar = $(dialog).parent().find('.ui-dialog-titlebar').css('padding','0')\r\n\t\t.html('<table class=\"ais_info_dialog_titlebar\">'+\r\n\t\t'<tr><td><div class=\"date\"><span>Последний сигнал:</span>'+\r\n\t\tHandlebars.compile('<br>{{{ts_pos_utc}}}')(vessel2)\r\n\t\t+'</div></td>'+\r\n\t\t'<td><div class=\"switch on\">Общие сведения</div></td>'+\r\n\t\t'<td><div class=\"switch\">Параметры судна</div></td>'+\r\n\t\t'<td id=\"closebut\"><div class=\"ais_info_dialog_close-button\" title=\"закрыть\"></div></td></tr>'+\r\n\t\t'</table>')\r\n\t\t\r\n\t$('.ais_info_dialog_close-button', titlebar).on('click', ()=>$( dialog ).dialog( \"close\" ))\t\r\n\t$('.switch', titlebar).eq(0).on('click', (e)=>{$('.switch', titlebar).removeClass('on'); $(e.currentTarget).addClass('on'); $('.vessel_props1', canvas).show(); $('.vessel_props2', canvas).hide()})\r\n\t$('.switch', titlebar).eq(1).on('click', (e)=>{$('.switch', titlebar).removeClass('on'); $(e.currentTarget).addClass('on'); $('.vessel_props2', canvas).show(); $('.vessel_props1', canvas).hide()})\r\n\t\t\r\n\treturn dialog\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/infodialog.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/infodialog.css\n// module id = 6\n// module chunks = 0","//************************************\r\n//  BASE AIS VIEW\r\n//************************************\r\n\r\nmodule.exports = function({publicInterface, highlight}){\r\n\treturn {\r\n\t\tget model() { return this._model },\r\n        _calcHeight: function(){return ($('.ais_vessel')[0].getBoundingClientRect().height+5)*5-5},\r\n        drawBackground: function(){\r\n            this._clean();\r\n        },\r\n        _clean: function(){\r\n            $('.info', this._container).off('click');\r\n            $('.position', this._container).off('click');\r\n            if ($('.mCSB_container', this._container)[0])\r\n                $('.mCSB_container', this._container).empty();\r\n            else\r\n                $(this._container).empty();\r\n            if (this._doClean)\r\n                this._doClean();\r\n        },\r\n        create: function(controls){\r\n            $.extend(this, controls);\r\n            $(this._container).height(this._calcHeight())\r\n            if (this._bindControlEvents)\r\n                this._bindControlEvents();\r\n\r\n            if ($('.icon-down-dir', this._frame)[0] && $('.icon-down-dir', this._frame).height()==34)\r\n                $('.icon-down-dir', this._frame).css({position:'relative', top:'2px'})\r\n        },\r\n        _waitTime: 1000,\r\n        show: function(){\r\n            this._start = new Date().getTime();\r\n            \r\n            //if(clean) this._clean();\r\n            $(this._frame).show();\r\n\r\n                var _this = this;\r\n                clearTimeout(this._wait);\r\n                var rest = new Date().getTime()-this._lastUpdate;\r\n//console.log(rest) \r\n            //this._refresh.parent().removeClass('clicable');\r\n            //this._refresh.parent().attr('title', ''); \r\n\r\n            //this._refresh.addClass('animate-spin');\r\n            this._refresh.show();\r\n\r\n                if (!this._lastUpdate || rest>=this._waitTime){\r\n                    this._lastUpdate = new Date().getTime();  \r\n                    this._model.update();\r\n                }\r\n                else{\r\n                    this._wait = setTimeout(function(){  \r\n                        _this._lastUpdate = new Date().getTime();  \r\n                        _this._model.update();\r\n                    }, this._waitTime-rest);\r\n                }\r\n        },\r\n        hide: function(){            \r\n            $(this._frame).hide();\r\n        },\r\n        positionMap: function(vessel){\r\n//console.log(vessel);\r\n            if (vessel.ts_pos_utc){\r\n                var d = new Date(vessel.ts_pos_utc.replace(/(\\d\\d).(\\d\\d).(\\d\\d\\d\\d).+/, \"$3-$2-$1\")),\r\n                interval = nsGmx.DateInterval.getUTCDayBoundary(d);\r\n                nsGmx.widgets.commonCalendar.setDateInterval(interval.dateBegin, interval.dateEnd);\r\n            }\r\n\r\n \t\t\t\tnsGmx.leafletMap.fitBounds([\r\n    \t\t\t\t\t[vessel.ymin, vessel.xmin],\r\n    \t\t\t\t\t[vessel.ymax, vessel.xmax]\r\n    \t\t\t\t], {\r\n    \t\t\t\t\tmaxZoom: 9,//config.user.searchZoom,\r\n    \t\t\t\t\tanimate: false\r\n    \t\t\t})\r\n\t\t\t\r\n\t\t\tnsGmx.leafletMap.removeLayer(highlight);\r\n\t\t\thighlight.vessel = vessel;\r\n\t\t\thighlight.setLatLng([vessel.ymax, vessel.xmax]).addTo(nsGmx.leafletMap);\t\t\t\t\r\n        },        \r\n        showPosition: function(item){\r\n            var vessel = JSON.parse(item.parent().parent().find('.info').attr('vessel'));\r\n            if (vessel.maxid && vessel.xmax!=vessel.xmin && vessel.ymax!=vessel.ymin){\r\n                var _this = this;\r\n                // search latest position in group \r\n                aisLayerSearcher.searchById([vessel.maxid], function(response){\r\n                    if (response.Status.toLowerCase()==\"ok\"){\r\n                        vessel.ymin = response.Result.values[0][5]; vessel.xmin = response.Result.values[0][4];\r\n    \t\t\t\t\tvessel.ymax = response.Result.values[0][5]; vessel.xmax = response.Result.values[0][4];\r\n                        item.parent().parent().find('.info').attr('vessel', JSON.stringify(vessel));\r\n                        _this.positionMap(vessel);\r\n                    }\r\n                    else{\r\n                        console.log(response);\r\n                    }\r\n                });\r\n            }\r\n            else\r\n\t\t\t\tthis.positionMap(vessel);\t\r\n\r\n        },  \r\n        repaint: function(){\r\n\r\n            if (!$(this._container).is(':visible'))\r\n                return;\r\n\r\n//console.log(\"REPAINT \"+(new Date().getTime()-this._start)+\"ms\")\r\n\r\n            //this._refresh.removeClass('animate-spin');\r\n            this._refresh.hide();\r\n            //this._refresh.parent().addClass('clicable');\r\n            //this._refresh.parent().attr('title', _gtxt('AISSearch2.refresh'));\r\n\r\n            this._clean();\r\n\r\n//console.log(this._model.data);\r\n            var scrollCont = $(this._container).find('.mCSB_container');\r\n            var content = $(Handlebars.compile(this._tableTemplate)(this._model.data));\r\n//console.log(content);\r\n            if (!scrollCont[0]){\r\n                $(this._container).append(content).mCustomScrollbar(); \r\n            }\r\n            else{\r\n                $(scrollCont).append(content);\r\n            } \r\n            var _this = this;           \r\n            $('.info', this._container).on('click', function(){\r\n                publicInterface.showInfo(JSON.parse($(this).attr('vessel')), true);\r\n            });          \r\n            $('.position', this._container).on('click', function(){\r\n                _this.showPosition($(this))\r\n            });\r\n            if (this._repaintControls)\r\n                this._repaintControls();         \r\n        }\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Views/BaseView.js","//************************************\r\n// AIS LAYERS SEARCHER\r\n//************************************\r\n\r\nmodule.exports = function({baseUrl,  aisServiceUrl, aisLastPoint, screenSearchLayer, aisLayerID}){\r\n\treturn {\r\n        _serverScript: baseUrl + 'VectorLayer/Search.ashx',\r\n\t\t\r\n\t\tset aisLastPoint(value){\r\n\t\t\taisLastPoint = value\r\n\t\t},\r\n\t\tset aisLayerID(value){\r\n\t\t\taisLayerID = value\r\n\t\t},\r\n\t\tset screenSearchLayer(value){\r\n\t\t\tscreenSearchLayer = value\r\n\t\t},\r\n\t\tget aisLayerID(){\r\n\t\t\treturn aisLayerID\r\n\t\t},\t\t\t\r\n\t\t\r\n        getBorder :function () {\r\n            var lmap = nsGmx.leafletMap;\r\n            var dFeatures = lmap.gmxDrawing.getFeatures();\r\n            if (dFeatures.length) { return dFeatures[dFeatures.length - 1].toGeoJSON(); }\r\n            var latLngBounds = lmap.getBounds(),\r\n                sw = latLngBounds.getSouthWest(),\r\n                ne = latLngBounds.getNorthEast(),\r\n                min = { x: sw.lng, y: sw.lat },\r\n                max = { x: ne.lng, y: ne.lat },\r\n                minX = min.x,\r\n                maxX = max.x,\r\n                geo = { type: 'Polygon', coordinates: [[[minX, min.y], [minX, max.y], [maxX, max.y], [maxX, min.y], [minX, min.y]]] },\r\n                w = (maxX - minX) / 2;\r\n\r\n            if (w >= 180) {\r\n                    geo = { type: 'Polygon', coordinates: [[[-180, min.y], [-180, max.y], [180, max.y], [180, min.y], [-180, min.y]]] };\r\n            } \r\n            else if (maxX > 180 || minX < -180) {\r\n                var center = ((maxX + minX) / 2) % 360;\r\n                if (center > 180) { center -= 360; }\r\n                else if (center < -180) { center += 360; }\r\n                minX = center - w; maxX = center + w;\r\n                if (minX < -180) {\r\n                    geo = { type: 'MultiPolygon', coordinates: [\r\n                                    [[[-180, min.y], [-180, max.y], [maxX, max.y], [maxX, min.y], [-180, min.y]]],\r\n                                    [[[minX + 360, min.y], [minX + 360, max.y], [180, max.y], [180, min.y], [minX + 360, min.y]]]\r\n                                ]\r\n                    };\r\n                } else if (maxX > 180) {\r\n                    geo = { type: 'MultiPolygon', coordinates: [\r\n                                    [[[minX, min.y], [minX, max.y], [180, max.y], [180, min.y], [minX, min.y]]],\r\n                                    [[[-180, min.y], [-180, max.y], [maxX - 360, max.y], [maxX - 360, min.y], [-180, min.y]]]\r\n                                ]\r\n                    };\r\n                }\r\n            }\r\n            return geo;\r\n        },   \r\n        formatDate: function(d, local){\r\n            var dd,m,y,h,mm;\r\n            if (local){\r\n                dd = (\"0\"+d.getDate()).slice(-2);\r\n                m = (\"0\"+(d.getMonth()+1)).slice(-2);\r\n                y = d.getFullYear();\r\n                h = (\"0\"+d.getHours()).slice(-2);\r\n                mm = (\"0\"+d.getMinutes()).slice(-2);\r\n\t\t\t\treturn dd+\".\"+m+\".\"+y+\" \"+h+\":\"+mm+\r\n\t\t\t\t\" (\"+(\"0\"+d.getUTCHours()).slice(-2)+\":\"+(\"0\"+d.getUTCMinutes()).slice(-2)+\" UTC)\";\r\n            }\r\n            else{\r\n                dd = (\"0\"+d.getUTCDate()).slice(-2);\r\n                m = (\"0\"+(d.getUTCMonth()+1)).slice(-2);\r\n                y = d.getUTCFullYear();\r\n                h = (\"0\"+d.getUTCHours()).slice(-2);\r\n                mm = (\"0\"+d.getUTCMinutes()).slice(-2);\r\n\t\t\t\tvar\r\n                ldd = (\"0\"+d.getDate()).slice(-2),\r\n                lm = (\"0\"+(d.getMonth()+1)).slice(-2),\r\n                ly = d.getFullYear(),\r\n                lh = (\"0\"+d.getHours()).slice(-2),\r\n                lmm = (\"0\"+d.getMinutes()).slice(-2),\r\n\t\t\t\toffset = -d.getTimezoneOffset()/60;\t\t\t\t\r\n\t\t\t\treturn dd+\".\"+m+\".\"+y+\" <span class='utc'>\"+h+\":\"+mm+\" UTC</span> (\"+lh+\":\"+lmm+\")\"\r\n\t\t\t\t//return dd+\".\"+m+\".\"+y+\" \"+h+\":\"+mm+\" UTC <br>\"+\r\n\t\t\t\t//\"<span class='small'>(\"+ldd+\".\"+lm+\".\"+ly+\" \"+lh+\":\"+lmm+\" UTC\"+(offset>0?\"+\":\"\")+offset+\")</span>\";\r\n            }\r\n        }, \r\n        searchById: function(aid, callback){\r\n//console.log(\"searchById\");\r\n            var request =  {\r\n                            WrapStyle: 'window',\r\n                            layer: aisLayerID, //'8EE2C7996800458AAF70BABB43321FA4'\r\n                            columns: '[{\"Value\":\"vessel_name\"},{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"}]',\r\n                            query: \"([id] IN (\" + aid.join(',') + \"))\"\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(this._serverScript, request, callback);\r\n        },\r\n        searchString: function(searchString, isfuzzy, callback){\r\n//console.log(aisLastPoint+\", \"+aisLayerID)\r\n            var query = \"\"; \r\n            if (searchString) {\r\n                searchString = searchString.toUpperCase();\r\n                    if (searchString.search(/[^\\d, ]/) === -1) {\r\n                            var arr = searchString.replace(/ /g, '').split(/,/);\r\n                            query = \"([mmsi] IN (\" + arr.join(',') + \"))\"+\r\n                            \"OR ([imo] IN (\" + arr.join(',') + \"))\"\r\n                    } else {\r\n                        if (isfuzzy)\r\n                            query = '([vessel_name] startswith \\'' + searchString + '\\') OR ([vessel_name] contains \\' ' + searchString + '\\')';\r\n                        else\r\n                            query = '([vessel_name] startswith \\'' + searchString + '\\') OR ([vessel_name] contains \\' ' + searchString + '\\')';\r\n                    }\r\n            }\r\n            var request =  {\r\n                            WrapStyle: 'window',\r\n                            layer: aisLastPoint, \r\n                            columns: '[{\"Value\":\"vessel_name\"},{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"}]',\r\n                            orderdirection: 'desc',\r\n                            orderby: 'ts_pos_utc',\r\n                            query: query\r\n            };\r\n            if (isfuzzy)\r\n                request.pagesize = 1000;\r\n            L.gmxUtil.sendCrossDomainPostRequest(this._serverScript, request, callback);\r\n        },      \r\n        searchNames: function(avessels, callback){\r\n            var request =  {\r\n                            WrapStyle: 'window',\r\n                            layer: aisLastPoint, \r\n                            orderdirection: 'desc',\r\n                            orderby: 'ts_pos_utc',\r\n                            query: avessels.map(function(v){return \"([mmsi]=\"+v.mmsi+(v.imo && v.imo!=\"\"?(\" and [imo]=\"+v.imo):\"\")+\")\"}).join(\" or \")\r\n                            //([mmsi] IN (\" + ammsi.join(',') + \"))\"+\r\n                            //\"and ([imo] IN (\" + aimo.join(',') + \"))\"\r\n            };\r\n//console.log(request)\r\n            L.gmxUtil.sendCrossDomainPostRequest(this._serverScript, request, callback);\r\n        },\r\n        searchScreen:  function(options, callback) {\r\n            var lmap = nsGmx.leafletMap;\r\n            var dt1 = options.dateInterval.get('dateBegin'),\r\n                dt2 = options.dateInterval.get('dateEnd');\r\n                //query += '([' + TemporalColumnName + '] >= \\'' + dt1.toJSON() + '\\')';\r\n                //query += ' and ([' + TemporalColumnName + '] < \\'' + dt2.toJSON() + '\\')';\r\n            var latLngBounds = lmap.getBounds(),\r\n                sw = latLngBounds.getSouthWest(),\r\n                ne = latLngBounds.getNorthEast(),\r\n                min = { x: sw.lng, y: sw.lat },\r\n                max = { x: ne.lng, y: ne.lat };\r\n//console.log(min);\r\n//console.log(max);\r\n            L.gmxUtil.sendCrossDomainPostRequest(aisServiceUrl + \"SearchScreen.ashx\", \r\n            {WrapStyle: 'window',s:dt1.toJSON(),e:dt2.toJSON(),minx:min.x,miny:min.y,maxx:max.x,maxy:max.y, layer:screenSearchLayer}, \r\n            callback);\r\n        },\r\n\t\tsearchByCoords(x, y){\r\n\t\t\t//VectorLayer/Search.ashx?layer=2AA3504D346343A1A5505BDC75D96EC2&pagesize=1&query=longitude>=129.052004 and  longitude<=129.052006 and latitude>=35.01017333332 and latitude<=35.01017333334\r\n            var x = x.toString(),\r\n\t\t\ty = y.toString()\r\n\t\t\tvar request =  {\r\n                            WrapStyle: 'window',\r\n                            layer: aisLayer,\r\n                            query: \"longitude>=\"+x.replace(/(\\d)$/, parseInt(x.slice(-1))-1)+\" and  longitude<=\"+x.replace(/(\\d)$/, parseInt(x.slice(-1))+1)+\r\n\t\t\t\t\t\t\t\" and latitude>=\"+y.replace(/(\\d)$/, parseInt(y.slice(-1))-1)+\" and latitude<=\"+y.replace(/(\\d)$/, parseInt(y.slice(-1))+1)\r\n            };\r\nconsole.log(request)\r\n            //L.gmxUtil.sendCrossDomainPostRequest(this._serverScript, request, callback);\t\t\t\r\n\t\t}\r\n    };  \r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Search/Searcher.js","//************************************\r\n// MY FLEET MODEL\r\n//************************************\r\n\t\r\nmodule.exports = function({baseUrl, myFleetLayers, aisLayerSearcher, myFleetMembersView, polyFind, polyFindIndex}){\r\n\treturn {\t\t\r\n\t\tset view(value){ myFleetMembersView = value },\t\r\n\t\tset mapLayers(value){ myFleetLayers = value },\r\n\t\tget mapLayers(){ return myFleetLayers },\r\n\t\t\r\n\t\tfindIndex: function(vessel){\r\n\t\t\treturn polyFindIndex(this.data.vessels, function(v){\r\n                return v.mmsi==vessel.mmsi && v.imo==vessel.imo;\r\n            })\r\n\t\t},\r\n\t\t\r\n        _isDirty: true,\r\n        getDirty: function(){return this._isDirty},\r\n        setDirty: function(){this._isDirty = true},\r\n        _parseFilter: function(filter){\r\n            var vessels = [];\r\n            var attributes = filter.toLowerCase().replace(/and \\[ts_pos_utc\\].+$/, \"\").split(\"or\");\r\n//console.log(attributes);\r\n            var myRe = /\\[*([^\\[\\]=]+)\\]*=([^ \\)]+)\\)? *\\)?( |$)/ig;\r\n            var myArray;\r\n            for (var i=0; i<attributes.length; ++i){\r\n                var vessel = null;\r\n                while ((myArray = myRe.exec(attributes[i])) !== null) {\r\n                    if (!vessel) vessel = {};\r\n                    vessel[myArray[1]] = myArray[2];\r\n                }\r\n                if (vessel)\r\n                    vessels.push(vessel);\r\n            }  \r\n//console.log(vessels);   \r\n            return vessels;  \r\n        },\r\n        getCount: function(){\r\n            return this.data ? this.data.vessels.length : 0;\r\n        },\r\n        layers: [],\r\n        load: function(){\r\n            var _this = this;\r\n            //var layerId = myFleetLayers\r\n\r\n            if (myFleetLayers.length==0)\r\n                this.data = {msg:[{txt:_gtxt(\"AISSearch2.nomyfleet\")}]};\r\n\r\n            if (myFleetLayers.length==0 || !this._isDirty)\r\n                return Promise.resolve();\r\n\r\n            this.layers = [];\r\n            var errors = [],\r\n                promises = myFleetLayers.map(function(lid){return new Promise(function(resolve, reject) {\r\n                        sendCrossDomainJSONRequest(baseUrl + \"Layer/GetLayerInfo.ashx?NeedAttrValues=false&LayerName=\" +\r\n                        lid, function(response){   \r\n//console.log(response);                         \r\n                            if (response.Status.toLowerCase()==\"ok\")\r\n                                _this.layers.push({layerId:lid, parentLayerId:response.Result.ParentLayer, filter:response.Result.Filter});\r\n                            else\r\n                                errors.push(response);\r\n                            resolve(response); \r\n                        }); \r\n                    })})\r\n                \r\n            return Promise.all(promises)\r\n            .then(function() { \r\n//console.log(_this.layers)                                    \r\n                            if (_this.layers.length>0){\r\n                                var layer = polyFind(_this.layers, function(l){return l.parentLayerId!='13E2051DFEE04EEF997DC5733BD69A15' && l.filter!=\"(1=0)\";})// NOT TRACKS\r\n//console.log(layer)      \r\n                                if (!layer)\r\n                                    return Promise.resolve({Status:\"ok\", Result:{values:[]}});\r\n//console.log(layer.filter)                                    \r\n                                var vessels = _this._parseFilter(layer.filter);\r\n                                return new Promise(function(resolve, reject) {\r\n                                    aisLayerSearcher.searchNames(\r\n                                        vessels,\r\n                                        //vessels.map(function(v){return v.mmsi}), \r\n                                        //vessels.map(function(v){return v.imo}),\r\n                                        function(response){ \r\n                                            resolve(response);\r\n                                        });\r\n                                });\r\n                            }\r\n                            else{\r\n                                return Promise.resolve({Status:\"error\", ErrorInfo:errors});\r\n                            }\r\n                        }\r\n            )\r\n            .then(function(response) {  \r\n//console.log(response)  \r\n//console.log(\"LOAD MY FLEET FINISH\")               \r\n                        if (response.Status.toLowerCase()==\"ok\"){                          \r\n                            _this.data = {vessels:response.Result.values.reduce(function(p,c){\r\n\t\t\t\t\t\t\t\tvar mmsi = response.Result.fields.indexOf(\"mmsi\"), \r\n\t\t\t\t\t\t\t\tvessel_name = response.Result.fields.indexOf(\"vessel_name\"), \r\n\t\t\t\t\t\t\t\tts_pos_utc = response.Result.fields.indexOf(\"ts_pos_utc\"),\r\n\t\t\t\t\t\t\t\timo = response.Result.fields.indexOf(\"imo\"),\r\n\t\t\t\t\t\t\t\tlat = response.Result.fields.indexOf(\"longitude\"),\r\n\t\t\t\t\t\t\t\tlon = response.Result.fields.indexOf(\"latitude\");\r\n                                if (!p.some(function(v){return v.mmsi==c[mmsi]})) {\r\n                                    var d = new Date(c[ts_pos_utc]*1000);\r\n                                    p.push({vessel_name:c[vessel_name], mmsi:c[mmsi], imo:c[imo], ts_pos_utc: aisLayerSearcher.formatDate(d),\r\n                                    xmin:c[lat], xmax:c[lat], ymin:c[lon], ymax:c[lon]}); \r\n                                }\r\n                                return p;\r\n                            }, [])}; \r\n\t\t\t\t\t\t\t_this.data.vessels.sort(function(a,b){return +(a.vessel_name > b.vessel_name) || +(a.vessel_name === b.vessel_name) - 1;})\r\n                            _this._isDirty = false;                         \r\n                            return Promise.resolve(); \r\n                        }\r\n                        else{                                           \r\n                            return Promise.reject(response); \r\n                        }\r\n                    });\r\n        },\r\n        update: function(){\r\n            var _this = this;\r\n            this._actualUpdate = new Date();\r\n            var actualUpdate = this._actualUpdate;\r\n            this.load().then(function(){\r\n//console.log(_this.layers)\r\n                if (_this._actualUpdate==actualUpdate)\r\n                    myFleetMembersView.repaint();\r\n            }, function(response){\r\n                _this.data = null;\r\n                if (response.Status.toLowerCase()==\"auth\" || \r\n                    (response.ErrorInfo && response.ErrorInfo.some && response.ErrorInfo.some(function(r){return r.Status.toLowerCase()==\"auth\"})))\r\n                    _this.data = {msg:[{txt:_gtxt(\"AISSearch2.auth\")}], vessels:[]};\r\n                else{\r\n                    console.log(response);\r\n                }\r\n                myFleetMembersView.repaint();              \r\n            });\r\n        },\r\n        markMembers:function(vessels){\r\n            if (this.data && this.data.vessels)\r\n            this.data.vessels.forEach(function(v){\r\n                var member = polyFind(vessels, function(vv){return v.mmsi==vv.mmsi && v.imo==v.imo});\r\n                if (member)\r\n                    member.mf_member = \"display:inline\";\r\n            });\r\n        },\r\n        // Layer filter example \"(([mmsi]=273452320 and [imo]=8971059) or ([mmsi]=273349220 and [imo]=8811015)) and [ts_pos_utc]>=2017-07-08\"\r\n        changeFilter: function(vessel){\r\n//console.log(this.data);\r\n            var add = true, temp = {vessels:[]}, vessels = this.data.vessels;\r\n            for (var i=0; i< this.data.vessels.length; ++i){\r\n                if ( this.data.vessels[i].imo==vessel.imo &&  this.data.vessels[i].mmsi==vessel.mmsi)\r\n                    add = false;\r\n                else\r\n                    temp.vessels.push(this.data.vessels[i]);\r\n            }\r\n            if (add)\r\n                    temp.vessels.push(vessel);\r\n            this.data = temp;\r\n            var _this = this;\r\n            this.layers.forEach(function(layer){\r\n                layer.filter = _this.data.vessels.length==0?\r\n                \"(1=0)\":\r\n                _this.data.vessels.map(function(v){\r\n                    return layer.parentLayerId!='13E2051DFEE04EEF997DC5733BD69A15'? // IS TRACKS\r\n                    \"([mmsi]=\"+v.mmsi+\" and [imo]=\"+v.imo+\")\":\r\n                    \"([mmsi]=\"+v.mmsi+\")\";\r\n                }).join(\" or \");\r\n\r\n                /*\r\n                        var editFilter = layer.parentLayerId!='13E2051DFEE04EEF997DC5733BD69A15'? // IS TRACKS\r\n                        \"([mmsi]=\"+vessel.mmsi+\" and [imo]=\"+vessel.imo+\")\":\r\n                        \"([mmsi]=\"+vessel.mmsi+\")\";\r\n                        if(layer.filter.search(/(mmsi|imo)/i)!=-1){\r\n\r\n                            var conditions = layer.filter.replace(/\\( *(\\(.+\\)) *\\).*$/, \"$1\").split(\" or \"),\r\n                            pos = conditions.indexOf(editFilter);\r\n//console.log(conditions)\r\n                            if (pos!=-1)\r\n                                conditions.splice(pos, 1);\r\n                            else\r\n                                conditions.push(editFilter);\r\n                            if (conditions.length>0)\r\n                                layer.filter = conditions.join(\" or \");\r\n                            else\r\n                                layer.filter = \"(1=0)\";\r\n                        }\r\n                        else{\r\n                            layer.filter = editFilter;\r\n                        }\r\n                */\r\n                var today = new Date(new Date()-3600*24*7*1000);\r\n                today = today.getFullYear()+\"-\"+(\"0\"+(today.getMonth()+1)).slice(-2)+\"-\"+(\"0\"+today.getDate()).slice(-2);\r\n                if (layer.parentLayerId!='13E2051DFEE04EEF997DC5733BD69A15')\r\n                    layer.filter = \"(\"+layer.filter+\") and [ts_pos_utc]>='\"+ today +\"'\";\r\n                else\r\n                    layer.filter = \"(\"+layer.filter+\") and [Date]>='\"+ today +\"'\";\r\n//console.log(layer.filter)\r\n            });\r\n            return Promise.all(this.layers.map(function(l){\r\n                /* return new Promise(function(resolve){\r\n                    var t = setTimeout(function(){\r\n                        resolve();\r\n                    }, 1000);\r\n                });\r\n               */\r\n                        return new Promise(function(resolve, reject) {\r\n                        sendCrossDomainJSONRequest(baseUrl + \r\n                        \"VectorLayer/Update.ashx?VectorLayerID=\"+l.layerId+\"&filter=\" +\r\n                        l.filter, function(response){\r\n                            if (response.Status.toLowerCase() == \"ok\") \r\n                                setTimeout(function run() {\r\n\r\n                                    sendCrossDomainJSONRequest(baseUrl + \r\n                                    \"AsyncTask.ashx?TaskID=\"+response.Result.TaskID, function(response){\r\n                                        if (response.Status.toLowerCase() == \"ok\") \r\n                                            if (!response.Result.Completed)\r\n                                                setTimeout(run, 1000);\r\n                                            else{\r\n                                                if(response.Result.ErorInfo){\r\n                                                    console.log(response)\r\n                                                    reject();\r\n                                                }\r\n                                                else\r\n                                                    resolve();\r\n                                        }\r\n                                        else{\r\n                                            console.log(response)\r\n                                            reject();\r\n                                        }\r\n\r\n                                    });\r\n                                }, 1000);\r\n                            else{\r\n                                console.log(response);\r\n                                reject();\r\n                            }\r\n                        }); \r\n                        });\r\n                \r\n                    })\r\n            ).then(\r\n            //return Promise.resolve().then(\r\n            function(){\r\n                this._isDirty = true;\r\n//console.log(this.data);\r\n                L.gmx.layersVersion.chkVersion();\r\n                return Promise.resolve();\r\n            }.bind(this),\r\n            function(){\r\n                return Promise.reject();\r\n            });\r\n        }\r\n    }; \r\n}\t\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Models/MyFleetModel.js","//************************************\r\n// AIS SCREEN SEARCH MODEL\r\n//************************************\r\n\r\nmodule.exports = function({myFleetMembersModel, aisLayerSearcher, aisSearchView}){\r\n\treturn {\r\n\t\t\r\n\t\tset view(value){ aisSearchView = value },\r\n\t\t\r\n        _isDirty: true,\r\n        getDirty: function(){return this._isDirty},\r\n        setDirty: function(){this._isDirty = true},\r\n        getCount: function(){\r\n            return this.data ? this.data.vessels.length : 0;\r\n        },\r\n        load: function(actualUpdate){\r\n            var _this = this;\r\n            if (!this._isDirty){\r\n                return Promise.resolve();\r\n            }\r\n            return Promise.all([new Promise(function(resolve, reject){\r\n                aisLayerSearcher.searchScreen({\r\n                    dateInterval: nsGmx.widgets.commonCalendar.getDateInterval(),\r\n                    border: true,\r\n                    group:true\r\n                }, function (json) {\r\n//console.log(json)\r\n                    if (json.Status.toLowerCase()==\"ok\")\r\n                    {\r\n                        _this.dataSrc = {vessels: json.Result.values.map(function(v){\r\n                            return {vessel_name:v[0], mmsi:v[1], imo:v[2], mf_member:'display:none', \r\n                        xmin:v[4], xmax:v[5], ymin:v[6], ymax:v[7], maxid:v[3]}\r\n                        })};\r\n                        if (_this._actualUpdate==actualUpdate){\r\n//console.log(\"ALL CLEAN\")\r\n//console.log(\"1>\"+new Date(_this._actualUpdate))\r\n//console.log(\"2>\"+new Date(actualUpdate))\r\n                            _this._isDirty = false;\r\n                        }\r\n                        resolve();\r\n                    }\r\n                    else{\r\n                        reject(json);\r\n                    }\r\n//console.log(\"LOAD SCREEN SEARCH DONE\")\r\n                    //return resolve();\r\n                });\r\n            })\r\n            ,myFleetMembersModel.load()\r\n            ]);\r\n        },\r\n        _actualUpdate: new Date().getTime(),\r\n        filterString: \"\",\r\n        update: function(){\r\n            var _this = this;\r\n            this._actualUpdate = new Date().getTime();\r\n            var actualUpdate = this._actualUpdate;  \r\n//this.filterString&&console.log(this.filterString+\" \"+this.filterString.search(/\\r$/))\r\n//this.filterString&&console.log(this.filterString.replace(/^\\s+/, \"\").replace(/\\s+\\r*$/, \"\")!=\"\")\r\n\r\n            this.load(actualUpdate).then(function(){\r\n//console.log(\"LOADED \"+(new Date().getTime()-_this._actualUpdate)+\"ms\")\r\n//console.log(\"3>\"+new Date(_this._actualUpdate))\r\n//console.log(\"4>\"+new Date(actualUpdate))\r\n                if (_this._actualUpdate==actualUpdate){\r\n                    _this.filterString = _this.filterString.replace(/\\r+$/, \"\");\r\n                    if (_this.dataSrc)\r\n                        if(_this.filterString!=\"\"){\r\n                            _this.data = {vessels:_this.dataSrc.vessels.filter(function(v){\r\n                                return v.vessel_name.search(new RegExp(\"\\\\b\"+_this.filterString, \"ig\"))!=-1;\r\n                            })}; \r\n                        }\r\n                        else{\r\n                            _this.data = {vessels:_this.dataSrc.vessels.map(function(v){return v;})};\r\n                        }\r\n                    \r\n                    if (_this.data)\r\n                        myFleetMembersModel.markMembers(_this.data.vessels);\r\n                    aisSearchView.repaint();\r\n                }\r\n            }, function(json){\r\n                _this.dataSrc = null;\r\nconsole.log(json)\r\n                if (json.Status.toLowerCase()==\"auth\" || \r\n                    (json.ErrorInfo && json.ErrorInfo.some && json.ErrorInfo.some(function(r){return r.Status.toLowerCase()==\"auth\"})))\r\n                    _this.data = {msg:[{txt:_gtxt(\"AISSearch2.auth\")}], vessels:[]};\r\n                else{\r\n                    //_this.data = {msg:[{txt:\"!!!\"}], vessels:[]};\r\n                    console.log(json);\r\n                }\r\n                aisSearchView.repaint();\r\n            });\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Models/ScreenSearchModel.js","//************************************\r\n// DB SEARCH MODEL\r\n//************************************\r\n\r\nmodule.exports = function({aisSearchView, myFleetMembersModel, aisLayerSearcher}){\r\n\treturn {\r\n\t\tset view(value) {\r\n\t\t\taisSearchView = value\r\n\t\t},\r\n        getCount: function(){\r\n            return this.data ? this.data.vessels.length : 0;\r\n        },\r\n        filterString: \"\",\r\n        _searchString: \"\",\r\n        update: function(){\r\n            var _this = this;\r\n            this._actualUpdate = new Date().getTime();\r\n            var actualUpdate = this._actualUpdate; \r\n            \r\n//this.filterString&&console.log(this.filterString+\" \"+this.filterString.search(/\\r$/))\r\n//this.filterString&&console.log(this._searchString+\" \"+this._searchString.search(/\\r$/))\r\n            this.filterString = this.filterString.replace(/\\r+$/, \"\");\r\n \r\n            new Promise(function(resolve, reject){\r\n                if (_this.filterString.length>0 && _this.filterString!=_this._searchString)\r\n                {\r\n                    _this._searchString = _this.filterString;\r\n                    aisLayerSearcher.searchString(_this._searchString, true, function(response){\r\n                        if (response.Status.toLowerCase()==\"ok\")\r\n                        {\r\n                            _this.data = {vessels: response.Result.values.map(function(v){\r\n                                return {vessel_name:v[0], mmsi:v[1], imo:v[2], mf_member:'display:none', ts_pos_utc: aisLayerSearcher.formatDate(new Date(v[3]*1000)),\r\n                            xmin:v[4], xmax:v[4], ymin:v[5], ymax:v[5]}\r\n                            })};\r\n                            resolve();\r\n                        }\r\n                        else{\r\n                            reject(response);\r\n                        }\r\n                    })\r\n                }\r\n                else if(_this.filterString.length==0){\r\n                    _this.data = null;\r\n                    resolve();\r\n                }\r\n                else\r\n                    resolve();\r\n            })\r\n            .then(function(){\r\n//console.log(\"LOADED \"+(new Date().getTime()-_this._actualUpdate)+\"ms\")\r\n                if (_this._actualUpdate==actualUpdate){\r\n                    if (_this.data)\r\n                        myFleetMembersModel.markMembers(_this.data.vessels);\r\n                    aisSearchView.repaint();\r\n                }\r\n            },\r\n            function(response){\r\nconsole.log(response);                \r\n                if (response.Status.toLowerCase()==\"auth\" || \r\n                (response.ErrorInfo && response.ErrorInfo.ErrorMessage.search(/can not access/i)!=-1))\r\n                    _this.data = {msg:[{txt:_gtxt(\"AISSearch2.auth\")}], vessels:[]};\r\n                else\r\n                    console.log(response);\r\n                _this.dataSrc = null;\r\n                aisSearchView.repaint();\r\n            });\r\n        }\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Models/DbSearchModel.js","//************************************\r\n// AIS SEARCH VIEW\r\n//************************************\r\n\r\nmodule.exports = function({aisView, aisScreenSearchModel, aisDbSearchModel, highlight}){\r\n\tvar instance = $.extend({\r\n        _tableTemplate: '{{#each vessels}}' +\r\n        '<div class=\"ais_vessel\">' +\r\n        '<table border=0><tr><td><span class=\"position\">{{vessel_name}}</span>'+\r\n        '{{#if ts_pos_utc}} <span class=\"date\">({{{ts_pos_utc}}})</span>{{/if}}'+\r\n        '</td><td><i class=\"icon-ship\" vessel=\"{{aisinfoid this}}\" style=\"{{mf_member}}\" title=\"{{i \"AISSearch2.myFleetMember\"}}\"></i></td>'+\r\n        '<td><div class=\"info\" vessel=\"{{aisjson this}}\" title=\"{{i \"AISSearch2.info\"}}\">'+\r\n        //'<i class=\"clicable icon-info\" vessel=\"{{aisjson this}}\" title=\"{{i \"AISSearch2.info\"}}\"></i>'+\r\n        '<div></td></tr></table>' +\r\n        '</div>' +\r\n        '{{/each}}'+\r\n        '{{#each msg}}<div class=\"msg\">{{txt}}</div>{{/each}}',\r\n        _model: aisScreenSearchModel,\r\n        _repaintControls: function(){\r\n            $(this._count).text(_gtxt('AISSearch2.found')+this._model.getCount());\r\n        },\r\n        _doClean: function(){\r\n            $(this._count).text(_gtxt('AISSearch2.found')+0);\r\n        },\r\n        _bindControlEvents: function(){\r\n                var _this = this;\r\n                $('select', this._canvas).change(function(e){\r\n                    var models = [aisScreenSearchModel, aisDbSearchModel];\r\n                    _this._model = models[e.target.options[e.target.selectedIndex].value]; \r\n                    //_this._model = models[(e.target.selectedOptions[0].value)];\r\n                    $('input', _this._search).val(_this._model.filterString);\r\n                    _this.show();\r\n\t\t\t\t\tnsGmx.leafletMap.removeLayer(highlight);\r\n                });\r\n                this._refresh.parent().click(function(){\r\n                    //console.log(_this._refresh)\r\n                    _this.show();\r\n\t\t\t\t\tnsGmx.leafletMap.removeLayer(highlight);\r\n                })\r\n                $('i', this._search).click(function(e){\r\n                    _this._model.filterString = $(this).siblings('input').val()+'\\r';\r\n                    _this.show();\r\n\t\t\t\t\tnsGmx.leafletMap.removeLayer(highlight);\r\n                })\r\n                this._search.keyup(function(e){\r\n                    var input = $('input', this).val() || \"\";\r\n                    input = input.replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n                    if (input==_this._model.filterString && e.keyCode!=13)\r\n                        return;\r\n                    _this._model.filterString = input; \r\n                    if (e.keyCode==13)\r\n                        _this._model.filterString += '\\r' \r\n                    _this.show();\r\n\t\t\t\t\tnsGmx.leafletMap.removeLayer(highlight);\r\n                })\r\n        },\r\n\t\tsetModel: function(searchType){this._model = searchType=='screen' ? aisScreenSearchModel : aisDbSearchModel}\r\n    }, aisView);\r\n\taisDbSearchModel.view = instance;\r\n\taisScreenSearchModel.view = instance;\r\n\treturn instance;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Views/SearchView.js","//************************************\r\n// MY FLEET VIEW\r\n//************************************\r\nmodule.exports = function({aisView, myFleetMembersModel}){\r\n\tconst instance = $.extend({\r\n\t\tget model(){ return this._model },\r\n        _tableTemplate: '{{#each vessels}}' +\r\n        '<div class=\"ais_vessel\">' +\r\n        '<table border=0><tr><td><span class=\"position\">{{vessel_name}}</span> <span class=\"date\">({{{ts_pos_utc}}})</span></td>'+\r\n        '<td><div class=\"info\" vessel=\"{{aisjson this}}\" title=\"{{i \"AISSearch2.info\"}}\">'+\r\n        //'<i class=\"clicable icon-info\" vessel=\"{{aisjson this}}\" title=\"{{i \"AISSearch2.info\"}}\"></i>'+\r\n        '</div></td></tr></table>' +\r\n        '</div>' +\r\n        '{{/each}}'+\r\n        '{{#each msg}}<div class=\"msg\">{{txt}}</div>{{/each}}',\r\n        _model: myFleetMembersModel\r\n    }, aisView);\r\n\tmyFleetMembersModel.view = instance\r\n\treturn instance\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Views/MyFleetView.js","//************************************\r\n// VESSEL INFO VIEW\r\n//************************************  \r\n\r\nmodule.exports = function ({scheme, modulePath, aisServiceUrl}){\r\n        var _ais,  \r\n        _galery, \r\n        _register, \r\n        _regcap,    \r\n        _leftPanel,  \r\n        _minh,\r\n        resize,\r\n        menuAction,\r\n        show = function(vessel){\r\n//console.log(vessel) \r\n            $(\"body\").append(''+  \r\n'<table class=\"vessel-info-page overlay\">' +\r\n        '<tr>' +\r\n            '<td>' +\r\n'<table class=\"vessel-info-page container\">' +\r\n    '<tr>' +\r\n        '<td class=\"column1\">' +\r\n                '<table>' +\r\n                    '<tr>' +\r\n                        '<td>' +\r\n                            '<div>' +\r\n                                '<div class=\"title\">' +\r\n                                   '<div class=\"cell\">'+vessel.vessel_name+'<div class=\"timestamp\">'+vessel.ts_pos_utc+'</div></div>  ' +                  \r\n                                '</div>' +\r\n                                '<div class=\"menu\">' +\r\n                                '<div class=\"ais cell menu-item active\"><img src=\"'+modulePath+'svg/info_gen.svg\" class=\"icon\">Основные сведения</div>' +\r\n                                '<div class=\"register cell menu-item\"><img src=\"'+modulePath+'svg/info.svg\" class=\"icon\">Регистр</div>' +\r\n                                '<div class=\"galery cell menu-item\"><img src=\"'+modulePath+'svg/photogallery.svg\" class=\"icon\">Фотогалерея <div class=\"counter\">0</div></div>' +\r\n                               '</div>' +\r\n                            '</div>  ' +\r\n                        '</td>' +\r\n                    '</tr>' +\r\n                    '<tr>' +\r\n                        '<td class=\"frame\">' +\r\n                                '<div class=\"photo\">' +\r\n                                    '<img src=\"'+modulePath+'svg/no-image.svg\" class=\"no-image\">' +\r\n                                '</div>  ' +  \r\n                        '</td>' +\r\n                    '</tr>' +\r\n                '</table>' +\r\n    '</td>' +\r\n    '<td class=\"column2\">' +\r\n        '<div class=\"close-button-holder\">' +\r\n            '<div class=\"close-button\" title=\"закрыть\"></div>' +\r\n        '</div>' +\r\n        '<div class=\"register panel\">' +\r\n            '<div class=\"caption\">123</div>' +\r\n            '<div class=\"menu\">' +\r\n                '<div>' +\r\n                    '<table>' +\r\n                        '<tr>' +\r\n                            '<td><div class=\"general menu-item active\">Общие сведения</div></td>' +\r\n                            '<td><div class=\"build menu-item\">Сведения о постройке</div></td>' +\r\n                            '<td><div class=\"dimensions menu-item\">Размеры и скорость</div></td>' +\r\n                            '<td><div class=\"gears menu-item\">Оборудование</div></td>' +\r\n                        '</tr>' +\r\n                    '</table>' +\r\n                '</div>' +\r\n            '</div>' +\r\n            '<div class=\"content\">' +\r\n                '<div class=\"placeholder\"></div>' +\r\n            '</div>' +\r\n        '</div>' +\r\n\r\n        '<div class=\"galery panel\">' +   \r\n'<form action=\"' + aisServiceUrl + 'Upload.ashx\" class=\"uploadFile\" method=\"post\" enctype=\"multipart/form-data\" target=\"upload_target\" style=\"display:none\" >' +\r\n    '<input name=\"Filedata\" class=\"chooseFile\" type=\"file\">' +    \r\n    '<input name=\"imo\" type=\"hidden\" value=\"'+vessel.imo+'\">' +    \r\n    '<input name=\"mmsi\" type=\"hidden\" value=\"'+vessel.mmsi+'\">' +\r\n          //'<input type=\"submit\" name=\"submitBtn\" value=\"Upload\" />' +\r\n'</form>' + \r\n'<iframe id=\"upload_target\" name=\"upload_target\" src=\"#\" style=\"width:0;height:0;border:0px solid #fff;\"></iframe>' + \r\n            '<div class=\"placeholder\">' +\r\n                '<div class=\"photo\" onclick=\"document.querySelector(\\'.vessel-info-page .chooseFile\\').click();\"'+\r\n                ' style=\"background-image: url('+modulePath+'svg/add-image.svg);background-size: 50px;\"></div>' +                \r\n            '</div>' +\r\n        '</div>' +\r\n\r\n        '<div class=\"ais panel\">' +\r\n            '<div class=\"placeholder\"></div>' +\r\n        '</div>' +\r\n    '</td>' +\r\n    '</tr>' +\r\n'</table>' +\r\n            '</td>' +\r\n        '</tr>' +\r\n    '</table>'           \r\n            );\r\n        window.addEventListener(\"message\", function(e){\r\n            if (e.data.search(/\"uploaded\"\\:/)<0)\r\n                return;\r\n            var data = JSON.parse(e.data);    \r\n            if (data.id && parseInt(data.id)) { //uploaded:\r\n//console.log('UPLOADED '+id)\r\n                var counter = $('.vessel-info-page .menu-item .counter'), \r\n                count = parseInt(counter.text())+1;\r\n                counter.text(count).css('display', 'inline');\r\n                var preview = $(\"<div class='photo preview' id='\"+data.id+\"' style='background-image: url(\"+aisServiceUrl+\"getphoto.ashx?id=\"+data.id+\")'/>\");\r\n                $('.vessel-info-page .uploader').replaceWith(preview);\r\n                preview.click(showPicture);\r\n//console.log(preview)\r\n            }\r\n            else {//uploadError:            \r\n                $('.vessel-info-page .uploader').remove();\r\n                console.log(data.errmsg)\r\n            }  \r\n        }, false);\r\n\r\n        $('<img src=\"'+scheme+'//photos.marinetraffic.com/ais/showphoto.aspx?mmsi='+vessel.mmsi+'\">').load(function() {\r\n            if (this){\r\n                $('.column1 .photo img.no-image').replaceWith(this);\r\n            }\r\n        });\r\n        $('.vessel-info-page .chooseFile').change(function(){            \r\n            $('<div class=\"photo uploader\" style=\"background-image:url(img/progress.gif);background-size:20px;\"></div>')\r\n            .insertAfter($('.vessel-info-page .galery .placeholder .photo').eq(0));\r\n            $('.vessel-info-page .uploadFile')[0].submit();\r\n        })\r\n        $('.vessel-info-page .close-button').click(function(){\r\n            $('.vessel-info-page.overlay').remove();\r\n        });\r\n/**/\r\n        $('.vessel-info-page .menu img[src$=\".svg\"]').each(function() {\r\n            var $img = jQuery(this);\r\n            var imgURL = $img.attr('src');\r\n            var attributes = $img.prop(\"attributes\");\r\n\r\n            $.get(imgURL, function(data) {\r\n                // Get the SVG tag, ignore the rest\r\n                var $svg = jQuery(data).find('svg');\r\n\r\n                // Remove any invalid XML tags\r\n                $svg = $svg.removeAttr('xmlns:a');\r\n\r\n                // Loop through IMG attributes and apply on SVG\r\n                $.each(attributes, function() {\r\n                    $svg.attr(this.name, this.value);\r\n                });\r\n\r\n                // Replace IMG with SVG\r\n                $img.replaceWith($svg);\r\n            }, 'xml');\r\n        });\r\n\r\n        _ais = document.querySelector('.vessel-info-page .column2 .ais') \r\n        _galery = document.querySelector('.vessel-info-page .column2 .galery')\r\n        _register = document.querySelector('.vessel-info-page .column2 .register .content')\r\n        _regcap = document.querySelector('.vessel-info-page .column2 .register .caption')    \r\n        _leftPanel = document.querySelector('.vessel-info-page .column1 table')      \r\n        _minh = 420\r\n        resize = function(){\r\n            var h = Math.floor(window.innerHeight*0.8);\r\n            if (h>_minh){\r\n                _leftPanel.style.height = _ais.style.height = _galery.style.height = h + \"px\";\r\n                _register.style.height = h - _regcap.offsetHeight + \"px\";\r\n            }\r\n            else{\r\n                _leftPanel.style.height = _ais.style.height = _galery.style.height = _minh + \"px\";\r\n                _register.style.height = _minh - _regcap.offsetHeight + \"px\";\r\n            }      \r\n        }\r\n        menuAction = function(e){\r\n            var target = e.currentTarget, p = target.parentElement, mia;\r\n            while(!(mia = p.querySelectorAll('.menu-item')) || mia.length<2){\r\n                p = p.parentElement;\r\n            }\r\n            for (var j=0; j<mia.length; ++j){\r\n                    //console.log( mia[j])\r\n                mia[j].className = mia[j].className.replace(/ active/, \"\");\r\n                var panel = document.querySelector('.panel.' + mia[j].classList[0]);\r\n                if (panel){\r\n                    if (mia[j]!=target)\r\n                    panel.style.display = \"none\";\r\n                    else{\r\n                    panel.style.display = \"block\";\r\n                    }\r\n                }\r\n            }\r\n            target.className += \" active\"\r\n            resize(); \r\n        }\r\n\r\n        window.addEventListener(\"resize\", resize, false); \r\n    \r\n        var mia = document.querySelectorAll('.column1 .menu-item');\r\n        for (var i=0; i<mia.length; ++i){\r\n            mia[i].addEventListener('click', menuAction)\r\n        }\r\n    \r\n        resize();    \r\n        $(_ais).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        $(_galery).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        $(_register).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        document.querySelector('.vessel-info-page .container').style.display = \"table\";  \r\n    },\r\n    showPicture = function(){\r\n//console.log($(this))\r\n            $('.vessel-info-page .picture').remove();\r\n            var div = $('<div class=\"picture\" style=\"display:none;position:absolute;\"></div>')\r\n            .insertAfter('.vessel-info-page.container').click(function(){this.remove()});\r\n            $('<img src=\"'+aisServiceUrl+'getphoto.ashx?id='+this.id+'\">').load(function() {\r\n                    if (this){\r\n                        var w = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,\r\n                        h = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\r\n                        div.append(this)\r\n                        .css('display', 'table')\r\n                        .offset({\r\n                            left:(w-this.offsetWidth)/2,\r\n                            top:(h-this.offsetHeight)/2})\r\n//console.log($(this))\r\n//console.log(window.screen.width+\"-\"+$(this)[0].offsetWidth)\r\n//console.log((window.screen.width-$(this)[0].offsetWidth)/2)\r\n                    }\r\n            });\r\n        },\r\n    drawGallery = function(gallery){\r\n        if (gallery.length>0)\r\n            $('.vessel-info-page .menu-item .counter').text(gallery.length).css('display', 'inline');   \r\n        var galcontent = $(\".vessel-info-page .galery .placeholder\")\r\n        for (var i=0; i<gallery.length; ++i)\r\n            galcontent.append(\"<div class='photo preview' id='\"+gallery[i]+\"' style='background-image: url(\"+aisServiceUrl+\"getphoto.ashx?id=\"+gallery[i]+\")'/>\" )             \r\n        $('.photo.preview').click(showPicture)\r\n        resize();     \r\n    },\r\n    drawAis = function(ledokol){\r\n    var aiscontent = document.querySelector(\".vessel-info-page .ais .placeholder\")\r\n    aiscontent.innerHTML = \"\" +                \r\n    \"<div class='caption'><div>ИНФОРМАЦИЯ О СУДНЕ</div></div>\" +\r\n    \"<table>\" +\r\n        \"<tr><td>Название судна</td><td><b>\"+ledokol.vessel_name+(ledokol.registry_name?\" (\"+ledokol.registry_name+\")\":\"\")+\"</b></td></tr>\" +\r\n        \"<tr><td>IMO</td><td>\"+ledokol.imo+\"</td></tr>\" +\r\n        \"<tr><td>MMSI</td><td>\"+ledokol.mmsi+\"</td></tr>\" +\r\n        \"<tr><td>Тип</td><td>\"+ledokol.vessel_type+\"</td></tr>\" +\r\n        \"<tr><td>Флаг</td><td>\"+ledokol.flag_country+\"</td></tr>\" +\r\n        \"<tr><td>Позывной</td><td>\"+ledokol.callsign+\"</td></tr>\" +\r\n        \"<tr><td>Длина</td><td>\"+ledokol.length+\"</td></tr>\" +\r\n        \"<tr><td>Ширина</td><td>\"+ledokol.width+\"</td></tr>\" +\r\n    \"</table>\" +\r\n    \"<div class='caption'><div>СВЕДЕНИЯ О ДВИЖЕНИИ</div></div>\" +\r\n    \"<table>\" +\r\n        \"<tr><td>Навигационный статус</td><td>\"+ledokol.nav_status+\"</td></tr>\" +\r\n        \"<tr><td>COG</td><td>\"+ledokol.cog+\"</td></tr>\" +\r\n        \"<tr><td>SOG</td><td>\"+ledokol.sog+\"</td></tr>\" +\r\n        \"<tr><td>HDG</td><td>\"+ledokol.heading+\"</td></tr>\" +\r\n        \"<tr><td>ROT</td><td>\"+ledokol.rot+\"</td></tr>\" +\r\n        \"<tr><td>Осадка</td><td>\"+ledokol.draught+\"</td></tr>\" +\r\n        \"<tr><td>Назначение</td><td>\"+ledokol.destination+\"</td></tr>\" +\r\n        \"<tr><td>Расчетное время прибытия</td><td>\"+ledokol.ts_eta+\"</td></tr>\" +\r\n    \"</table>\";     \r\n        resize();        \r\n    },\r\n    drawRegister = function(ledokol){\r\n        var regcontent = _register.querySelector(\".placeholder\"),\r\n        drawTable = function(groups, article, display){\r\n            var s = \"<div class='panel \"+article+\" article' style='display:\"+display+\"'>\";\r\n            for(var i=0; i<groups.length; ++i){\r\n                s += \"<div class='group'>\"+groups[i].name+\"</div><table>\"\r\n                for(var j=0; j<groups[i].properties.length; ++j){\r\n                    var pn = groups[i].properties[j].name,\r\n                    pv = groups[i].properties[j].value\r\n                    s+= \"<tr><td>\"+pn+\"</td><td>\"+(pn==\"Название судна\"||pn==\"Латинское название\"?\"<b>\"+pv+\"</b>\":pv)+\"</td></tr>\"\r\n                }\r\n                s += \"</table>\"\r\n            }\r\n            s += \"</div>\"\r\n            return s;\r\n        }\r\n        regcontent.innerHTML = \r\n        drawTable([ledokol.data[0], ledokol.data[1], ledokol.data[9]], \"general\", \"block\") + \r\n        drawTable([ledokol.data[2]], \"build\", \"none\") + \r\n        drawTable([ledokol.data[3]], \"dimensions\", \"none\") + \r\n        drawTable([ledokol.data[4], ledokol.data[5], ledokol.data[6], ledokol.data[7], ledokol.data[8]], \"gears\", \"none\");\r\n\t\t\r\n        _regcap.innerHTML = \"<table><tr><td>Обновление базы данных \"+ledokol.version.replace(/ \\S+$/g, '')+\"</td></tr></table>\"\r\n\r\n        var mia = document.querySelectorAll('.column2 .menu-item');\r\n        for (var i=0; i<mia.length; ++i){\r\n            mia[i].addEventListener('click', menuAction)\r\n        }\r\n             \r\n        resize();        \r\n    }\r\n\t\r\n\tlet open = function(vessel, vessel2){\r\n                    show(vessel2);\r\n                    var onFail = function(error){\r\n                        if (error!='register_no_data')\r\n                        console.log(error)\r\n                    } \r\n                    new Promise(function(resolve, reject){\r\n                        (function wait(){\r\n                            if(!vessel2)\r\n                                setTimeout(wait, 100);\r\n                        })();\r\n                        resolve(vessel2)\r\n                    })\r\n                    .then(function(ship){\r\n//console.log(ship)\r\n                        drawAis(ship)\r\n                    }, \r\n                    onFail);\r\n                    var registerServerUrl = scheme + \"//kosmosnimki.ru/demo/register/api/v1/\";\r\n                    if(vessel.imo && vessel.imo!=0 && vessel.imo!=-1)\r\n                        fetch(registerServerUrl+\"Ship/Search/\"+vessel.imo+\"/ru\")\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            if (ship.length>0)\r\n                                return fetch(registerServerUrl+\"Ship/Get/\"+ship[0].RS+\"/ru\")\r\n                            else\r\n                                return Promise.reject('register_no_data');\r\n                        })\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            //console.log(ship)\r\n                            drawRegister(ship)\r\n                        })\r\n                        .catch( onFail );\r\n\r\n                    new Promise(function(resolve, reject){\r\n                        sendCrossDomainJSONRequest(aisServiceUrl + \r\n                            \"gallery.ashx?mmsi=\"+vessel.mmsi+\"&imo=\"+vessel.imo, function(response){\r\n                            if (response.Status==\"ok\") \r\n                                resolve(response.Result);\r\n                            else\r\n                                reject(response)\r\n                        });\r\n                    })\r\n                    .then(function(gallery){\r\n                        drawGallery(gallery)\r\n                    }, \r\n                    onFail);\r\n                }\r\n        \r\n    return {\r\n\t\topen:open,\r\n            show: show,\r\n            drawRegister: drawRegister,\r\n            drawAis: drawAis,\r\n            drawGallery:drawGallery\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Views/VesselInfoView.js"],"sourceRoot":""}