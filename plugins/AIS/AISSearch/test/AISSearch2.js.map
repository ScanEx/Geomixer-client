{"version":3,"sources":["webpack:///webpack/bootstrap 2ba9de299ed60bdd5bf2","webpack:///./src/entry.js","webpack:///./src/all.css","webpack:///./src/Views/AisView.css","webpack:///./src/locale.js","webpack:///./src/Polyfill2.js","webpack:///./src/aisPluginPanel.js","webpack:///./src/ViewsFactory.js","webpack:///./src/Views/ScreenSearchView.js","webpack:///./src/Views/BaseView.js","webpack:///./src/Models/ScreenSearchModel.js","webpack:///./src/Views/MyFleetView.js","webpack:///./src/Views/MyFleet.css","webpack:///./src/Controls/GroupList.js","webpack:///./src/Controls/GroupWidget.js","webpack:///./src/Models/MyFleetModel.js","webpack:///./src/Polyfill.js","webpack:///./src/Views/DbSearchView.js","webpack:///./src/Views/DbSearch.css","webpack:///./src/Controls/SearchControl.css","webpack:///./src/Controls/SearchControl.js","webpack:///./src/Models/DbSearchModel.js","webpack:///./src/Views/InfoDialogView.js","webpack:///./src/Views/infodialog.js","webpack:///./src/Views/infodialog.css","webpack:///./src/Views/SpecialFloatView.js","webpack:///./src/Views/SpecialFloatView.css","webpack:///./src/Views/BaseFloatView.js","webpack:///./src/Views/VesselInfoScreen.js","webpack:///./src/Views/VesselInfoScreen.css","webpack:///./src/Search/Searcher.js","webpack:///./src/Controls/LegendControl.js","webpack:///./src/Toolbox.js","webpack:///./src/Track.js","webpack:///./src/VesselMarker.js"],"names":["PRODUCTION","SIDEBAR2","BETA","require","AisPluginPanel","ViewsFactory","LegendControl","Toolbox","Handlebars","registerHelper","context","mmsi","imo","JSON","stringify","pluginName","menuId","toolbarIconId","cssTable","modulePath","gmxCore","getModulePath","highlight","L","marker","icon","className","iconAnchor","iconSize","iconUrl","zIndexOffset","ready","publicInterface","afterViewer","params","map","tools","legendControl","aisLastPoint","lastPointLayerAlt","options","aisLayerID","screenSearchLayer","searchLayer","historyLayer","tracksLayerID","historyLayerAlt","tracksLayerAlt","vesselLegend","key","toLowerCase","myFleetLayers","split","id","replace","viewFactory","layersByID","nsGmx","gmxMap","setLayerClickHandler","layer","removeEventListener","addEventListener","e","gmx","properties","hasOwnProperty","infoDialogView","show","forLayers","layersId","i","length","sidebar","window","iconSidebarWidget","sidebarControl","sidebarPane","setPane","position","showOnTop","createTab","createTabFunction","active","inactive","hint","_gtxt","withLegendSwitch","aisPluginPanel","createSwitch","_activeTabId","$","removeClass","_renderTabs","activeTabId","setTimeout","open","location","search","a","substr","x","filter","c","indexOf","y","vessel","setLatLng","addTo","leafletMap","fitBounds","maxZoom","animate","addModule","css","_translationsHash","addtext","proto","matches","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","closest","selector","parentElement","Element","prototype","arr","CharacterData","DocumentType","args","forEach","item","push","Object","defineProperty","configurable","enumerable","writable","value","remove","parentNode","removeChild","append","argArr","Array","slice","call","arguments","docFrag","document","createDocumentFragment","argItem","isNode","Node","appendChild","createTextNode","String","Document","DocumentFragment","NodeList","module","exports","withFooter","_isReady","_canvas","createElement","_activeView","_views","create","_createFooter","footer","_createTabs","tabsTemplate","compile","v","frame","tabs","on","is","target","each","tab","addClass","hide","_tabs","_footer","_returnInstance","element","eq","resize","click","ScreenSearchView","ScreenSearchModel","MyFleetView","MyFleetModel","DbSearchView","DbSearchModel","InfoDialogView","Searcher","_tools","calendar1","calendar2","daysLimit","mapDateInterval","widgets","commonCalendar","getDateInterval","dateInterval","DateInterval","set","get","console","log","toUTCString","d","Date","attributes","dateEnd","getTime","msd","_viewCalendar1","_dateInputs","datepicker","onChange","dateBegin","_viewCalendar2","bind","historyInterval","CalendarWidget","name","container","dateMin","getUTCDayBoundary","dateMax","dateFormat","minimized","showSwitcher","td","find","after","db","setDateInterval","_modulePath","_searcher","_mfm","aisLayerSearcher","toolbox","_ssm","myFleetModel","_dbsm","_dbsv","_ssv","_mfv","_idv","aisView","myFleetView","BaseView","_delayedRepaint","model","apply","onLegendSwitched","showAlternative","isActive","data","vessels","repaint","gifLoader","th","getBoundingClientRect","height","ih","rh","rv","tableTemplate","cleanFilter","filterReady","filterInput","delay","doFilter","setFilter","filterString","val","clearTimeout","keyup","input","keyCode","needUpdate","isDirty","update","_clean","text","_switchLegendIcon","ic","ica","inProgress","state","progress","_firstRowsPos","_firstRowsNum","_firstRowsShift","_setEventHandlers","thisInst","parse","attr","xmin","xmax","longitude","ymin","ymax","latitude","ts_pos_utc","ts_pos_org","dt_pos_utc","html","stopPropagation","lastPosition","showPosition","arrowHead","innerHTML","groups","needAltLegend","groupsAlt","off","scrollCont","empty","tempFirst","content","msg","mcsTopPctPrev","rowH","mCustomScrollbar","callbacks","onScroll","scroledPx","mcs","top","whileScrolling","startShow","topPct","start","end","scrollInertia","timeout","focus","_calcHeight","topOffset","view","clean","h","startScreen","bb","left","width","_this","restoreDefault","_actualUpdate","_myFleetModel","_aisLayerSearcher","_vesselLegend","thisInstance","onChanged","load","actualUpdate","Promise","resolve","s","all","reject","searchScreen","border","group","json","Status","dataSrc","Result","values","vessel_name","mf_member","formatDate","Math","floor","maxid","vessel_type","sog","cog","heading","icon_rot","round","placeVesselTypeIcon","k","getIcon","url","count","isNaN","getIconAlt","parseInt","sortData","sortGrups","b","sort","then","markMembers","ErrorInfo","some","r","txt","GroupList","style","display","visibility","_displayedOnly","_notDisplayed","_saveLabelSettingsPromise","_viewState","displayedOnly","notDisplayed","showTracks","trackBuilder","needAlt","showMyFleetTracks","hideTracks","hideMyFleetTracks","cleanTracks","cleanMyFleetTracks","viewCalendar","settings","calendar","el","reloadTrack","displayTracks","loadTracks","classList","toString","reset","showTracsCtrl","checked","newGroupNameValid","ngn","isValid","g","title","createGroup","groupList","appendGroup","error","markerTemplate","showVesselsOnMap","saveLabelSettings","currentTarget","showMyFleetTrack","hideVesselsOnMap","onRepaintItem","elm","querySelector","innerText","onDeleteGroup","deleteGroup","labelSettings","match","labelSettingCtrl","onCheckItem","uncheked","onChangeGroup","changeGroup","catch","err","onExcludeItem","ev","thisView","beforeExcludeMember","dlg","changeMembers","eraseMyFleetMarker","onGroupMenuShow","marker_style","label_color","label_shadow","color","onChangeGroupStyle","colors","changeGroupStyle","onSaveGroupStyle","saveGroupStyle","strMmsi","m","cleanMap","GroupWidget","_onRepaintItemHandler","_onCheckItem","_onExcludeItem","_onChangeGroup","_onDeleteGroup","_onGroupMenuShow","_onChangeGroupStyle","_rolledupGroups","_cp1","_cp2","_cp3","_getFiltered","filtered","selectAll","selectOne","j","_setCheckBoxes","check","querySelectorAll","_setGroupCommands","preventDefault","classes","ctxMenu","contextMenu","evnt","colorChangeHandler","cs","_groupStyleChanged","backgroundColor","c1","cp1","c2","cp2","c3","cp3","Utils","rgb2hex","Controls","createColorPicker","relatedTarget","_hideContextMenu","ColorPickerHide","div","offset","clientX","clientY","offsetHeight","innerHeight","bottom","arrow","cl","contains","add","_onSaveGroupStyle","_saveStylePromise","groupblock","template","previousSibling","callback","index","parent","Polyfill","emptyGroup","isDefault","updateTemplate","ms","lsc","ls","eg","label_shadow_color","default","lc","mt","_markerTemplate","VesselData","_trackLoaders","_isDirty","_myFleetLayers","_defaultGroup","_vessels","_mapID","_prepared","_data","_view","_onChangedHandlers","_fireChanged","_loadVoyageInfo","findIndex","_parseVoyageInfo","fields","searchNames","response","_compareGroups","l","lat","lon","vt","gmx_id","member","formatDateTime","gn","_persistGroupsLook","temp","action","FormData","sendCrossDomainJSONRequest","baseUrl","encodeURIComponent","form","fetch","credentials","method","body","_queryMapLayers","buildedTree","gmxProperties","MapID","addGroupField","lid","run","TaskID","Completed","ErorInfo","addDefaultGroup","f","fetchMyFleet","rs","rj","nickname","Nickname","layers","LayerID","rejectedResponse","specialVesselFilters","ai","displayed","drawMyFleetMarker","myfleet","reduce","p","thisModel","membCounter","vv","splice","objects","infoDialog","removeMyFleetTrack","loadTrack","found","highlightMarker","Worker","serverBase","di","interval","counter","myWorker","postMessage","toISOString","onmessage","pid","searchById","res","onerror","viewState","w","terminate","positions","predicate","list","thisArg","undefined","SearchControl","_searchLayer","_highlight","_displayed","showHistoryTracks","cleanHistoryTracks","trg","searchInput","searcher","searchPromise","request","protocol","headers","mode","encodeURI","parser","columns","_cleanMap","removeLayer","showTrack","reload","_vi_template","clearMyFleetMarkers","openPos","thisVessel","showInfoDialog","source","source_orig","ind","vi_cont","siblings","next","positionMap","allTracksInput","nv","ts","tracksInputs","setMapCalendar","calendarInterval","dv","lastPos","intervalEnd","lastDate","calendarlastDate","setUTCHours","searchString","positionDate","checkInterval","onclick","showHistoryTrack","isArray","zoom","getZoom","setView","local","formatPosition","obj","_searchString","_sparams","searchparams","suggestions","q","preferences","localStorage","getItem","asparams","sr","borderRight","paddingRight","searchBut","prefeBut","removeBut","suggestionsCount","suggestionsFrame","first","current","last","searchDone","doSearch","actualId","requests","status","concat","suggestion","cr","offsetWidth","ch","sparam","RegExp","setItem","onkeydown","nextSibling","prepareSearchInput","onkeyup","onpaste","originalEvent","clipboardData","getData","searchPositionsAgg2","parseResponse","previous","dt","t","total","ErrorMessage","displayInfoDialog","VesselInfoScreen","infoDialogCascade","allIinfoDialogs","vesselInfoScreen","aisServices","_showPosition","track","_updateView","getmore","dialog","isNew","dialogOffset","insertAfter","displayedTrack","closeFunc","event","openVesselInfoScreen","pos","ui","SpecialFloatView","addUnit","u","isNeg","power","pow","formatVessel","ts_pos_loc","ts_eta","Translations","getLanguage","rot","draught","toDd","D","lng","dir","deg","ddToDms","dms","min","sec","shipCams","commands","_gmx","props","meta","MetaProperties","ships","Value","urls","canvas","menu","appendTo","photo","underphoto","buttons","dialogW","dialogH","posX","posY","showDialog","vessel2","moreInfo","smallShipIcon","vesselPropTempl","registry_name","swap","mi","resizable","extend","titlebar","scheme","href","replaceWith","menubuttons","openpage","showpos","shipCam","setImages","moment","setMinutes","getMinutes","getTimezoneOffset","getFullYear","getMonth","getDate","getHours","getSeconds","images","special","showCamBut","visible","close","addremoveIcon","addremove","filterUpdating","info","redrawMarkers","ex","onDone","_cssClassName","BaseFloatView","cancelBubble","returnValue","closeCom","zinCom","zoutCom","img1Com","img2Com","twoimgCom","rc1","rc2","image1","image2","logos","showTwo","restoreSize","h1","h2","zoomIn","image","wiw","wih","setPlace1","setPlace2","zoomIn2","ceil","allowMove","src","closeCallback","srcElement","st","getComputedStyle","innerWidth","right","rc","imageUrl","timers","downloadingImage1","Image","onload","random","downloadingImage2","defaultView","getWindowWidth","intrerval","timer","disposeTimer","_getMaxZindex","dialogs","z","zMax","parseFloat","zIndex","dx","dy","rect","fx","fy","_ais","_galery","_register","_regcap","_leftPanel","_minh","_lloyds","menuAction","preview","showPicture","errmsg","change","submit","$img","jQuery","imgURL","prop","$svg","removeAttr","mia","panel","theme","documentElement","clientWidth","clientHeight","drawGallery","gallery","galcontent","drawAis","ledokol","aiscontent","flag_country","callsign","nav_status","destination","drawRegister","regcontent","drawTable","article","pn","desc","description","pv","drawRMR","version","drawLloyds","regSwitches","onFail","wait","ship","registerServerUrl","lloydsServerUrl","rmr","RS","_aisServices","_baseUrl","_serverScript","_aisLastPoint","_screenSearchLayer","_aisLayerID","_historyLayer","_lastPointLayerAlt","getBorder","lmap","dFeatures","gmxDrawing","getFeatures","toGeoJSON","latLngBounds","getBounds","sw","getSouthWest","ne","getNorthEast","max","minX","maxX","geo","type","coordinates","center","formatTime","toLocaleTimeString","toLocaleDateString","toLocaleString","formatDate2","dd","mm","getUTCHours","getUTCMinutes","getUTCDate","getUTCMonth","getUTCFullYear","ldd","lm","ly","lh","lmm","iconAlt","imgAlt","img","colorAlt","cache","searchPositionsAgg2Mf","searchPositionsAgg","WrapStyle","orderdirection","orderby","query","join","gmxUtil","sendCrossDomainPostRequest","searchPositions","aid","searchString2","isfuzzy","pagesize","toUpperCase","avessels","toJSON","aisLastPointLayer","_layersByID","_layers","_getIcons","gmxStyles","styles","Filter","RenderStyle","Name","_icons","_iconsDict","typeColor","_iconsAlt","_iconsAltDict","_getSvgPromise","httpRequest","XMLHttpRequest","onreadystatechange","readyState","svg","responseText","exec","svg64","btoa","unescape","b64Start","image64","imgSvg","ctx","getContext","clearRect","drawImage","toDataURL","send","_svgLoader","_svgAltLoader","_createSwitch","lswitchClick","switchLegend","legendDiv","loader","iconCollection","_getAtAnchorIcon","_getUnderWayIcon","getClientRects","type_color","group_style","getUnderWayIcon","getAtAnchorIcon","icons","iconsAlt","cond","eval","re1","re2","getIconAltUrl","getIconUrl","Track","_lmap","_aisLayer","_lastPointLayerAltFact","_almmsi","_tlmmsi","_aldt","_tldt","getGmxProperties","_displayedVessels","_notDisplayedVessels","_filterFunc","mmsiArr","dates","_specialVesselFilters","_setVesselFilter","removeFilter","tileAttributeIndexes","_historyInterval","_markers","_visibleMarkers","_getSvg","_markerIcon","vtype","_eraseMyFleetMarker","layerGroup","getLayers","_drawMyFleetMarker","isVisible","parsedStyleKeys","label_line","label","text_shadow","group_name","toFixed","divIcon","addLayer","_switchLayers","l1","l2","_map","_legendSwitchedHandlers","_legendSwitched","_round","_addUnit","_toDd","_trackBuilder","hasAlternativeLayers","comment","clearLayers","paths","fill","handler","cog_sog","heading_rot","x_y","eta","tm_pos_utc","tm_pos_loc","dt_pos_loc","eta_utc","eta_loc","vesselMarker","_tracks","_tracksAlt","_tracksMF","_tracksAltMF","_addMarker","ep","radius","fillColor","fillOpacity","weight","renderer","latLng","_addMarkers","_prevCursor","_historyMmsi","_container","_onMouseMove","cursor","_onClick","trackId","pointerEvents","keys","ra","notDisplayedVessels","Canvas","include","_updateVesselMarker","_drawing","_empty","_drawnLayers","_leaflet_id","_point","_ctx","_radius","np","latLngToLayerPoint","lineWidth","strokeStyle","beginPath","moveTo","lineTo","stroke","save","translate","rotate","PI","restore","VesselMarker","CircleMarker","_updatePath","_renderer"],"mappings":"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","file":"AISSearch2Test.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2ba9de299ed60bdd5bf2","let PRODUCTION = false,\r\n    SIDEBAR2 = false,\r\n    BETA = false;\r\nif (has('SIDEBAR2'))\r\n    SIDEBAR2 = true;\r\nif (has('PRODUCTION'))\r\n    PRODUCTION = true;\r\nif (has('BETA'))\r\n    BETA = true;\r\n\r\nrequire(\"./all.css\");\r\nrequire(\"./Views/AisView.css\");\r\nrequire(\"./locale.js\");\r\nrequire(\"./Polyfill2.js\");\r\n\r\nconst AisPluginPanel = require('./aisPluginPanel.js'),\r\n      ViewsFactory = require('./ViewsFactory'),\r\n      LegendControl = require(\"./Controls/LegendControl.js\"),\r\n      Toolbox = require('./Toolbox.js');\r\n\r\nHandlebars.registerHelper('aisinfoid', function (context) {\r\n    return context.mmsi + \" \" + context.imo;\r\n});\r\n\r\nHandlebars.registerHelper('aisjson', function (context) {\r\n    return JSON.stringify(context);\r\n});\r\n\r\nconst pluginName = PRODUCTION ? (BETA ? 'AISPluginBeta' : 'AISPlugin') : 'AISSearch2Test',\r\n    menuId = 'AISSearch',\r\n    toolbarIconId = null, \r\n    cssTable = PRODUCTION ? (BETA ? 'AISPluginBeta' : 'AISPlugin') : 'AISSearch2',\r\n    modulePath = gmxCore.getModulePath(pluginName);\r\n\r\nconst highlight = L.marker([0, 0], {icon:L.icon({\r\n    className:\"ais_highlight-icon\", \r\n    iconAnchor:[12, 12], \r\n    iconSize:[25,25], \r\n    iconUrl:'plugins/ais/aissearch/highlight.png'}), zIndexOffset:1000});\r\n\r\nlet ready = false;\r\nconst publicInterface = {\r\n    pluginName: pluginName,\r\n    afterViewer: function (params, map) {\r\n        if (ready)\r\n            return;\r\n        ready = true;\r\n//console.log(\"ready\");\r\n        const tools = new Toolbox(params),\r\n            legendControl = new LegendControl(tools, params.aisLastPoint, params.lastPointLayerAlt),\r\n            options = {\r\n                aisLayerID: params.aisLayerID,// || '8EE2C7996800458AAF70BABB43321FA4',\t// searchById\t\t\t\r\n                screenSearchLayer: params.searchLayer,// || '8EE2C7996800458AAF70BABB43321FA4', // screen search\r\n\r\n                aisLastPoint: params.aisLastPoint, // || '303F8834DEE2449DAF1DA9CD64B748FE', // db search\r\n                historyLayer: params.historyLayer,\r\n                tracksLayerID: params.tracksLayerID, // || '13E2051DFEE04EEF997DC5733BD69A15',\r\n\r\n                lastPointLayerAlt: params.lastPointLayerAlt,\r\n                historyLayerAlt: params.historyLayerAlt,\r\n                tracksLayerAlt: params.tracksLayerAlt,\r\n\r\n                modulePath: modulePath,\r\n                highlight: highlight,\r\n                menuId: menuId,\r\n                vesselLegend: legendControl,\r\n                tools: tools\r\n            };\r\n\r\n        for (var key in params) \r\n            if (key.toLowerCase() == \"myfleet\") {\r\n                options.myFleetLayers = params[key].split(\",\").map(function (id) {\r\n                    return id.replace(/\\s/, \"\");\r\n                });\r\n                break;\r\n            }\r\n        const viewFactory = new ViewsFactory(options),\r\n            layersByID = nsGmx.gmxMap.layersByID,\r\n            setLayerClickHandler = function (layer) {\r\n                layer.removeEventListener('click')\r\n                layer.addEventListener('click', function (e) {\r\n                    //console.log(e)\r\n                    if (e.gmx && e.gmx.properties.hasOwnProperty(\"imo\"))\r\n                        viewFactory.infoDialogView.show(e.gmx.properties)\r\n                })\r\n            },\r\n            forLayers = function (layer) {\r\n                try {\r\n                    if (layer) {\r\n                        //setLocaleDate(layer)\r\n                        setLayerClickHandler(layer)\r\n                    }\r\n                }\r\n                catch (e) { }\r\n            };\r\n\r\n        for (var key in params) {\r\n            let layersId = params[key].split(\",\").map(function (id) {\r\n                return id.replace(/\\s/, \"\");\r\n            });\r\n            for (var i = 0; i < layersId.length; ++i) {\r\n//console.log(layersId[i])\r\n                forLayers(layersByID[layersId[i]]);\r\n            }\r\n        }\r\n\r\n        const sidebar = SIDEBAR2 ? window.iconSidebarWidget : window.sidebarControl,\r\n            sidebarPane = sidebar.setPane(\r\n                menuId, {\r\n                    position: params.showOnTop ? -100 : 0,\r\n                    createTab: window.createTabFunction({\r\n                        icon: menuId,\r\n                        active: \"ais_sidebar-icon-active\",\r\n                        inactive: \"ais_sidebar-icon\",\r\n                        hint: _gtxt('AISSearch2.caption')\r\n                    })\r\n                }\r\n            ),\r\n            withLegendSwitch = params.lastPointLayerAlt && nsGmx.gmxMap.layersByID[params.lastPointLayerAlt],       \r\n            aisPluginPanel = new AisPluginPanel(sidebarPane, viewFactory, withLegendSwitch);\r\n        aisPluginPanel.menuId = menuId;\r\n\r\n        if (withLegendSwitch)\r\n            legendControl.createSwitch(aisPluginPanel); // LEGEND SWITCH IN FOOTER\r\n\r\n        sidebar.addEventListener('opened', function (e) {\r\n            if (sidebar._activeTabId == menuId)\r\n                aisPluginPanel.show();\r\n        });\r\n        if (params.showOnTop) { // hack\r\n            $('div[data-pane-id]').removeClass('iconSidebarControl-pane-active')\r\n            sidebar._renderTabs({ activeTabId: menuId });\r\n            setTimeout(() => sidebar.open(menuId), 50);\r\n        }\r\n\r\n        if (location.search.search(/x=[^y=]+y=/i) != -1) {\r\n            var a = location.search.toLowerCase().substr(1).split('&'),\r\n                x = a.filter(function (c) { return !c.indexOf(\"x=\") })[0].substr(2),\r\n                y = a.filter(function (c) { return !c.indexOf(\"y=\") })[0].substr(2)\r\n            highlight.vessel = null;\r\n            highlight.setLatLng([y, x]).addTo(nsGmx.leafletMap);    \r\n            nsGmx.leafletMap.fitBounds([\r\n                [y, x],\r\n                [y, x]\r\n            ], {\r\n                    maxZoom: 9,//config.user.searchZoom,\r\n                    animate: false\r\n            }) \r\n        }\r\n    }\r\n};\r\n\r\ngmxCore.addModule(pluginName, publicInterface, {\r\n    css: cssTable + '.css'\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/entry.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/all.css\n// module id = 1\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/AisView.css\n// module id = 3\n// module chunks = 0","\r\n    _translationsHash.addtext('rus', {\r\n        'AISSearch2.title': 'Поиск судов',\r\n        'AISSearch2.title1': 'Найдено судов',\r\n        'AISSearch2.title2': '<b>Данных не найдено!</b>',\r\n        'AISSearch2.error': '<b>Ошибка при получении данных!</b>',\r\n        'AISSearch2.iconTitle': 'Поиск судов по экрану',\r\n        'AISSearch2.placeholder_0': 'Поиск по адресам, координатам',\r\n        'AISSearch2.placeholder_1': 'Поиск судна по названию / MMSI',\r\n        // 'AISSearch2.placeholder_1': 'Поиск судна по названию / MMSI. Поиск по адресам, координатам, кадастровым номерам'\r\n        'AISSearch2.myFleetDialog': 'Мой флот',\r\n        'AISSearch2.vesselName': 'название',\r\n        'AISSearch2.vesselAdd': 'добавить',\r\n        'AISSearch2.vesselRemove': 'удалить',\r\n        'AISSearch2.vesselExclude': 'исключить',\r\n        'AISSearch2.myFleetMembers': 'Состав',\r\n        'AISSearch2.myFleetMember': 'мой флот',\r\n        'AISSearch2.info': 'информация',\r\n        'AISSearch2.position': 'положение',\r\n        'AISSearch2.found':'Найдено: ',\r\n        'AISSearch2.filter':'Введите название или mmsi или imo судна',\r\n        'AISSearch2.filterName':'Введите название судна',\r\n        'AISSearch2.screen':'По экрану',\r\n        'AISSearch2.database':'По базе данных',\r\n        'AISSearch2.capShort': 'Поиск судов',\r\n        'AISSearch2.caption': 'Поиск судов и \"Мой флот\"',\r\n        'AISSearch2.refresh': 'обновить',\r\n        'AISSearch2.refreshing': 'обновляется',\r\n        'AISSearch2.nomyfleet': 'Сервис не доступен',\r\n        'AISSearch2.auth': 'Требуется авторизация',\r\n        'AISSearch2.vessel_info':'ИНФОРМАЦИЯ О СУДНЕ',\r\n        'AISSearch2.vessel_voyage':'СВЕДЕНИЯ О ДВИЖЕНИИ',\r\n        'AISSearch2.vessel_name': 'Название',\r\n        'AISSearch2.mmsi': 'MMSI',\r\n        'AISSearch2.imo': 'IMO',\r\n        'AISSearch2.flag_country': 'Страна',\r\n        'AISSearch2.vessel_type': 'Тип судна',\r\n        'AISSearch2.flag': 'Флаг',\r\n        'AISSearch2.callsign': 'Позывной',\r\n        'AISSearch2.length': 'Длина',\r\n        'AISSearch2.width': 'Ширина',\r\n        'AISSearch2.draught': 'Осадка',\r\n        'AISSearch2.destination': 'Назначение',\r\n        'AISSearch2.eta': 'Расчетное время прибытия',\r\n        'AISSearch2.nav_status': 'Статус',\r\n        'AISSearch2.last_sig': 'Последний сигнал',\r\n        'AISSearch2.show_track': 'трек за сутки',\r\n        'AISSearch2.hide_track': 'скрыть трек',\r\n\t\t'AISSearch2.source': 'Источник данных',\r\n\t\t'AISSearch2.sais': 'спутниковый AIS',\r\n\t\t'AISSearch2.tais': 'береговой AIS',\r\n\t\t'AISSearch2.lon': 'Долгота',\r\n\t\t'AISSearch2.lat': 'Широта',\r\n\t\t'AISSearch2.historyTab': 'История',\r\n        'AISSearch2.voyageInfo': 'Параметры движения',\r\n        'AISSearch2.DbSearchTab':'БАЗА ДАННЫХ',\r\n        'AISSearch2.ScreenSearchTab':'СУДА НА ЭКРАНЕ',\r\n        'AISSearch2.MyFleetTab':'МОЙ ФЛОТ',\r\n        'AISSearch2.dailyTrack':'трек за сутки',\r\n        'AISSearch2.allDailyTracks':'все треки',\r\n        'AISSearch2.myFleetOnly':'только мой флот',\r\n        'AISSearch2.show_pos':'показать положение и историю',\r\n        'AISSearch2.show_info':'информация о судне',\r\n        'AISSearch2.time_switch':'Время',\r\n        'AISSearch2.time_local':'Местное',\r\n        'AISSearch2.legend_switch':'Раскраска судов',\r\n        'AISSearch2.legend_type':'По типу',\r\n        'AISSearch2.legend_speed':'По скорости',\r\n        'AISSearch2.calendar_today':'сегодня',\r\n        'AISSearh2.searchresults_view':'Здесь будут отображаться<br>результаты поиска по названию,<br>IMO илм MMSI судна',\r\n        'AISSearh2.myfleet_view':'Здесь будут отображаться<br>выбранные суда<br>',\r\n        'AISSearch2.dialog_tab_general':'Общие сведения',\r\n        'AISSearch2.dialog_tab_params':'Параметры движения',\r\n        'AISSearch2.close_but':'закрыть',\r\n        'AISSearch2.myfleet_add':'добавить в мой флот',\r\n        'AISSearch2.myfleet_remove':'удалить из моего флота',\r\n        'AISSearch2.infoscreen_gen':'Основные сведения',\r\n        'AISSearch2.infoscreen_reg':'Регистр',\r\n        'AISSearch2.infoscreen_gal':'Фотогалерея',\r\n        'AISSearch2.last_update':'Обновление базы данных',\r\n        'AISSearch2.reg_general_tab':'Общие сведения',\r\n        'AISSearch2.reg_build_tab':'Сведения о постройке',\r\n        'AISSearch2.reg_chars_tab':'Размеры и скорость',\r\n        'AISSearch2.reg_devs_tab':'Оборудование',\r\n        'AISSearch2.rmrs':'РМРС',\r\n        'AISSearch2.AddIntoGroup':'Добавить в группу:',\r\n        'AISSearch2.RemoveFromGroup':'Удалить из группы',        \r\n        'AISSearch2.AllGroup':'Все',        \r\n        'AISSearch2.NewGroup':'Новая группа',        \r\n        'AISSearch2.NewGroupName':'название',        \r\n        'AISSearch2.CreateGroup':'создать',        \r\n        'AISSearch2.DeleteGroup':'удалить группу',       \r\n        'AISSearch2.DeleteGroupCommand':'Удалить группу',      \r\n        'AISSearch2.DisplaySection':'Показать на карте:',    \r\n        'AISSearch2.DisplayVesselName':'название судна',    \r\n        'AISSearch2.DisplayGroupName':'название группы',    \r\n        'AISSearch2.DisplayCog':'курс',    \r\n        'AISSearch2.DisplaySog':'скорость',   \r\n        'AISSearch2.KnotShort':' уз',\r\n        'AISSearch2.thisVesselOnly':'Только это судно: ',\r\n        'AISSearch2.allTracks':'треки всех судов',\r\n        'AISSearch2.shipsTracks':'треки судов',\r\n        'AISSearch2.markerShadow':'Цвет обводки маркера',\r\n        'AISSearch2.labelColor':'Цвет подписи маркера',\r\n        'AISSearch2.labelShadow':'Цвет обводки подписи',\r\n        'AISSearch2.zoomin_com':'Увеличить',\r\n        'AISSearch2.zoomout_com':'Уменьшить',\r\n        'AISSearch2.image1_com':'Изображение 1',\r\n        'AISSearch2.image2_com':'Изображение 2',\r\n        'AISSearch2.twoimages_com':'Два изображения',\r\n        'AISSearch2.close_com':'Закрыть',\r\n        'AISSearch2.moving':'В движении',\r\n        'AISSearch2.standing':'Стоит\\\\дрейфует',\r\n        'AISSearch2.myFleetInclude': 'добавить в мой флот',\r\n        'AISSearch2.myFleetExclude': 'удалить из моего флота',\r\n    });\r\n    _translationsHash.addtext('eng', {\r\n        'AISSearch2.title': 'Searching vessels',\r\n        'AISSearch2.title1': 'Vessels found',\r\n        'AISSearch2.title2': '<b>Vessels not found!</b>',\r\n        'AISSearch2.error': '<b>Vessels not found!</b>',\r\n        'AISSearch2.iconTitle': 'Search vessels within the view area',\r\n        'AISSearch2.placeholder_0': 'Search for addresses, coordinates',\r\n        'AISSearch2.placeholder_1': 'Search by vessel name / MMSI',\r\n        // 'AISSearch2.placeholder_1' : 'Search by vessel name / MMSI. Search by addresses, coordinates, cadastre number'\r\n        'AISSearch2.myFleetDialog': 'My fleet',\r\n        'AISSearch2.vesselName': 'name',\r\n        'AISSearch2.vesselAdd': 'add',\r\n        'AISSearch2.vesselRemove': 'remove',\r\n        'AISSearch2.vesselExclude': 'exclude',\r\n        'AISSearch2.myFleetMembers': 'Members',\r\n        'AISSearch2.myFleetMember': 'my fleet',\r\n        'AISSearch2.info': 'info',\r\n        'AISSearch2.position': 'position',\r\n        'AISSearch2.found':'Found ',\r\n        'AISSearch2.filter':'Insert vessel name or mmsi or imo',\r\n        'AISSearch2.filterName':'Insert vessel name',\r\n        'AISSearch2.screen':'On screen',\r\n        'AISSearch2.database':'In database',\r\n        'AISSearch2.capShort': 'Vessel Search',\r\n        'AISSearch2.caption': 'Vessel Search & My Fleet',\r\n        'AISSearch2.refresh': 'refresh',\r\n        'AISSearch2.refreshing': 'refreshing',\r\n        'AISSearch2.nomyfleet': 'Service is unavailable',\r\n        'AISSearch2.auth': 'Authorization required',\r\n        'AISSearch2.vessel_info':'VESSEL INFORMATION',\r\n        'AISSearch2.vessel_voyage':'VOYAGE INFORMATION',\r\n        'AISSearch2.vessel_name': 'Name',\r\n        'AISSearch2.mmsi': 'MMSI',\r\n        'AISSearch2.imo': 'IMO',\r\n        'AISSearch2.flag_country': 'Flag',\r\n        'AISSearch2.vessel_type': 'Vessel type',\r\n        'AISSearch2.flag': 'Flag',\r\n        'AISSearch2.callsign': 'Callsign',\r\n        'AISSearch2.length': 'Length',\r\n        'AISSearch2.width': 'Width',\r\n        'AISSearch2.draught': 'Draught',\r\n        'AISSearch2.destination': 'Destination',\r\n        'AISSearch2.eta': 'ETA',\r\n        'AISSearch2.nav_status': 'Navigation status',\r\n        'AISSearch2.last_sig': 'Last signal',\r\n        'AISSearch2.show_track': 'show track',\r\n        'AISSearch2.hide_track': 'hide track',\r\n\t\t'AISSearch2.source': 'Source',\r\n\t\t'AISSearch2.sais': 'S-AIS',\r\n\t\t'AISSearch2.tais': 'T-AIS',\r\n\t\t'AISSearch2.lon': 'Longitude',\r\n\t\t'AISSearch2.lat': 'Latitude',\r\n\t\t'AISSearch2.historyTab': 'History',\r\n\t\t'AISSearch2.voyageInfo': 'Voyage Info',\r\n        'AISSearch2.DbSearchTab':'DATA BASE',\r\n        'AISSearch2.ScreenSearchTab':'VESSELS ON SCREEN',\r\n        'AISSearch2.MyFleetTab':'MY FLEET',\r\n        'AISSearch2.dailyTrack':'daily track',\r\n        'AISSearch2.allDailyTracks':'all tracks',\r\n        'AISSearch2.myFleetOnly':'my fleet only',\r\n        'AISSearch2.show_pos':'position and history',\r\n        'AISSearch2.show_info':'vessel data',\r\n        'AISSearch2.time_switch':'Time',\r\n        'AISSearch2.time_local':'Local',\r\n        'AISSearch2.legend_switch':'Vessel legend',\r\n        'AISSearch2.legend_type':'Type',\r\n        'AISSearch2.legend_speed':'Speed',\r\n        'AISSearch2.calendar_today':'today',\r\n        'AISSearh2.searchresults_view':'Results View of Vessel Search<br>by Name,IMO or MMSI',\r\n        'AISSearh2.myfleet_view':'List of Special Selected<br>Vessels<br>',       \r\n        'AISSearch2.dialog_tab_general':'General',\r\n        'AISSearch2.dialog_tab_params':'Parameters',\r\n        'AISSearch2.close_but':'close',\r\n        'AISSearch2.myfleet_add':'include in my fleet',\r\n        'AISSearch2.myfleet_remove':'exclude from my fleet' ,\r\n        'AISSearch2.infoscreen_gen':'General',\r\n        'AISSearch2.infoscreen_reg':'Register',\r\n        'AISSearch2.infoscreen_gal':'Gallery',\r\n        'AISSearch2.last_update':'Last update',   \r\n        'AISSearch2.reg_general_tab':'General',\r\n        'AISSearch2.reg_build_tab':'Building',\r\n        'AISSearch2.reg_chars_tab':'Specification',\r\n        'AISSearch2.reg_devs_tab':'Equipment',        \r\n        'AISSearch2.rmrs':'RMRS',\r\n        'AISSearch2.AddIntoGroup':'Add into group',\r\n        'AISSearch2.RemoveFromGroup':'Remove from group',        \r\n        'AISSearch2.AllGroup':'All',        \r\n        'AISSearch2.NewGroup':'New group',        \r\n        'AISSearch2.NewGroupName':'name',        \r\n        'AISSearch2.CreateGroup':'create',        \r\n        'AISSearch2.DeleteGroup':'delete group',       \r\n        'AISSearch2.DeleteGroupCommand':'Delete group',      \r\n        'AISSearch2.DisplaySection':'Display on map:',    \r\n        'AISSearch2.DisplayVesselName':'vessel name',    \r\n        'AISSearch2.DisplayGroupName':'group name',    \r\n        'AISSearch2.DisplayCog':'cog',    \r\n        'AISSearch2.DisplaySog':'sog',   \r\n        'AISSearch2.KnotShort':' kn',\r\n        'AISSearch2.thisVesselOnly':'Only this ship ',\r\n        'AISSearch2.allTracks':'all ships tracks ',\r\n        'AISSearch2.shipsTracks':'ships tracks ',\r\n        'AISSearch2.markerShadow':'Marker highlight',\r\n        'AISSearch2.labelColor':'Label color',\r\n        'AISSearch2.labelShadow':'Label highlight',\r\n        'AISSearch2.zoomin_com':'Zoom in',\r\n        'AISSearch2.zoomout_com':'Zoom out',\r\n        'AISSearch2.image1_com':'Image 1',\r\n        'AISSearch2.image2_com':'Image 2',\r\n        'AISSearch2.twoimages_com':'Two images',\r\n        'AISSearch2.close_com':'Close',\r\n        'AISSearch2.moving':'Moving',\r\n        'AISSearch2.standing':'Standing',\r\n        'AISSearch2.myFleetInclude': 'include in my fleet',\r\n        'AISSearch2.myFleetExclude': 'exclude from my fleet',\r\n    });\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/locale.js","// Element.closest\r\n(function(proto) {\r\n    proto.matches = proto.matches || proto.mozMatchesSelector || proto.msMatchesSelector || proto.oMatchesSelector || proto.webkitMatchesSelector;\r\n    proto.closest = proto.closest || function closest(selector) {\r\n        if (!this) return null;\r\n        if (this.matches(selector)) return this;\r\n        if (!this.parentElement) {return null}\r\n        else return this.parentElement.closest(selector)\r\n      };\r\n}(Element.prototype));\r\n\r\n// Element.remove\r\n(function() {\r\n    var arr = [window.Element, window.CharacterData, window.DocumentType];\r\n    var args = [];\r\n  \r\n    arr.forEach(function (item) {\r\n      if (item) {\r\n        args.push(item.prototype);\r\n      }\r\n    });  \r\n    // from:https://github.com/jserz/js_piece/blob/master/DOM/ChildNode/remove()/remove().md\r\n    (function (arr) {\r\n      arr.forEach(function (item) {\r\n        if (item.hasOwnProperty('remove')) {\r\n          return;\r\n        }\r\n        Object.defineProperty(item, 'remove', {\r\n          configurable: true,\r\n          enumerable: true,\r\n          writable: true,\r\n          value: function remove() {\r\n            this.parentNode && this.parentNode.removeChild(this);\r\n          }\r\n        });\r\n      });\r\n    })(args);\r\n  })();\r\n\r\n// Element.append, Document.append, DocumentFragment.append\r\n(function (arr) {\r\n  arr.forEach(function (item) {\r\n    if (item.hasOwnProperty('append')) {\r\n      return;\r\n    }\r\n    Object.defineProperty(item, 'append', {\r\n      configurable: true,\r\n      enumerable: true,\r\n      writable: true,\r\n      value: function append() {\r\n        var argArr = Array.prototype.slice.call(arguments),\r\n          docFrag = document.createDocumentFragment();\r\n        \r\n        argArr.forEach(function (argItem) {\r\n          var isNode = argItem instanceof Node;\r\n          docFrag.appendChild(isNode ? argItem : document.createTextNode(String(argItem)));\r\n        });\r\n        \r\n        this.appendChild(docFrag);\r\n      }\r\n    });\r\n  });\r\n})([Element.prototype, Document.prototype, DocumentFragment.prototype]);\r\n\r\n//NodeList.forEach\r\nNodeList.prototype[\"forEach\"] = NodeList.prototype[\"forEach\"] || Array.prototype[\"forEach\"];\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Polyfill2.js","let PRODUCTION = false,\r\n    SIDEBAR2 = false;\r\nif (has('SIDEBAR2'))\r\n    SIDEBAR2 = true;\r\nif (has('PRODUCTION'))\r\n    PRODUCTION = true;\r\n\r\n\r\nmodule.exports = function (sidebarPane, viewFactory, withFooter) {\r\n    let _isReady = false,\r\n        _canvas = document.createElement('div'),\r\n        _activeView,\r\n        _views = viewFactory.create(),\r\n        _createFooter = function () { \r\n            let footer;\r\n            if (withFooter){           \r\n                footer = document.createElement('div');\r\n                footer.className = \"ais_panel_footer\";\r\n                $(_canvas).append(footer);\r\n            }\r\n            return footer;\r\n        },\r\n        _createTabs = function () {\r\n            let tabsTemplate = '<table class=\"ais_tabs\" border=0><tr>' +\r\n                '</td><td class=\"ais_tab myfleet_tab unselectable\" unselectable=\"on\">' + // ACTIVE\r\n                '<div>{{i \"AISSearch2.MyFleetTab\"}}</div>' +\r\n                '<td class=\"ais_tab dbsearch_tab unselectable\" unselectable=\"on\">' +\r\n                '<div>{{i \"AISSearch2.DbSearchTab\"}}</div>' +\r\n                '</td><td class=\"ais_tab scrsearch_tab unselectable\" unselectable=\"on\">' +\r\n                '<div>{{i \"AISSearch2.ScreenSearchTab\"}}</div>' +\r\n                '</td></tr></table>';\r\n\r\n            $(sidebarPane).append(_canvas);\r\n            $(_canvas).append(Handlebars.compile(tabsTemplate));\r\n            $(_canvas).append(_views.map(v => v.frame));\r\n    \r\n            let tabs = $('.ais_tab', _canvas); \r\n            tabs.on('click', function () {\r\n                if (!$(this).is('.active')) {\r\n                    let target = this;\r\n                    tabs.each(function (i, tab) {\r\n                        if (!$(tab).is('.active') && target == tab) {\r\n                            $(tab).addClass('active');\r\n                            _views[i].show();\r\n                            _activeView = _views[i];\r\n                        }\r\n                        else {\r\n                            $(tab).removeClass('active');\r\n                            _views[i].hide();\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n            return tabs;\r\n        },\r\n        _tabs = _createTabs(),\r\n        _footer = _createFooter(),\r\n        _returnInstance = {\r\n            get footer() {return _footer;},\r\n            set footer(element) { \r\n                if (_footer)\r\n                    _footer.append(element);\r\n            },\r\n            show: function () {\r\n                if (!_isReady)\r\n                {     \r\n                    _views.forEach((v,i) =>{\r\n                        v.tab = _tabs.eq(i);\r\n                        v.resize(true);\r\n                    }); \r\n                    // Show the first tab\r\n                    _tabs.eq(0).removeClass('active').click();\r\n                    // All has been done at first time\r\n                    _isReady = true;\r\n                }\r\n                else{           \r\n                    _activeView && _activeView.show(); \r\n                }\r\n            }\r\n        };\r\n    return _returnInstance;\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/aisPluginPanel.js","const ScreenSearchView = require('./Views/ScreenSearchView'),\r\n    ScreenSearchModel = require('./Models/ScreenSearchModel'),\r\n    MyFleetView = require('./Views/MyFleetView'),\r\n    MyFleetModel = require('./Models/MyFleetModel'),\r\n    DbSearchView = require('./Views/DbSearchView'),\r\n    DbSearchModel = require('./Models/DbSearchModel'),\r\n    InfoDialogView = require('./Views/InfoDialogView'),\r\n    Searcher = require('./Search/Searcher');\r\n\r\nmodule.exports = function (options) {\r\n\r\n    const _tools = options.tools;\r\n\r\n    const calendar1 = $('<div id=\"aisViewCalendar1\"></div>'),\r\n          calendar2 = $('<div id=\"aisViewCalendar2\"></div>'),\r\n          daysLimit = 14;\r\n\r\n    // walkaround with focus at first input in ui-dialog\r\n    calendar1.append('<span class=\"ui-helper-hidden-accessible\"><input type=\"text\"/></span>');\r\n    calendar2.append('<span class=\"ui-helper-hidden-accessible\"><input type=\"text\"/></span>');\r\n\r\n    const mapDateInterval = nsGmx.widgets.commonCalendar.getDateInterval(),\r\n          dateInterval = new nsGmx.DateInterval();\r\n\r\n    dateInterval\r\n        .set('dateBegin', mapDateInterval.get('dateBegin'))\r\n        .set('dateEnd', mapDateInterval.get('dateEnd'))\r\n        .on('change', function (e) {\r\n//console.log(this.model.historyInterval) \r\nconsole.log('CHANGE ' + dateInterval.get('dateBegin').toUTCString() + ' ' + dateInterval.get('dateEnd').toUTCString()) \r\n            let d = new Date(e.attributes.dateEnd.getTime() - msd*daysLimit);\r\n            \r\n            _viewCalendar1._dateInputs.datepicker('option', 'minDate', d);\r\n            _viewCalendar1.onChange({ dateBegin: dateInterval.get('dateBegin'), dateEnd: dateInterval.get('dateEnd') });\r\n            _viewCalendar2._dateInputs.datepicker('option', 'minDate', d);\r\n            _viewCalendar2.onChange({ dateBegin: dateInterval.get('dateBegin'), dateEnd: dateInterval.get('dateEnd') }) \r\n \r\n            // this.model.historyInterval = { dateBegin: dateInterval.get('dateBegin'), dateEnd: dateInterval.get('dateEnd') };\r\n            // this.model.isDirty = true;\r\n            // this.show();\r\n        }.bind(this));\r\n    _tools.historyInterval = dateInterval;\r\n    const msd = 24*3600000,\r\n    _viewCalendar1 = new nsGmx.CalendarWidget({\r\n        dateInterval: dateInterval,\r\n        name: 'searchInterval',\r\n        container: calendar1,\r\n        //dateMin: new Date(0, 0, 0),        \r\n        dateMin: new Date(nsGmx.DateInterval.getUTCDayBoundary().dateBegin.getTime() - msd*(daysLimit-1)),\r\n        dateMax: new Date(3015, 1, 1),\r\n        dateFormat: 'dd.mm.yy',\r\n        minimized: false,\r\n        showSwitcher: false,\r\n        dateBegin: new Date(),\r\n        dateEnd: new Date(2000, 10, 10),\r\n        //buttonImage: 'img/calendar.png'\r\n    }),\r\n    _viewCalendar2 = new nsGmx.CalendarWidget({\r\n        dateInterval: dateInterval,\r\n        name: 'searchInterval',\r\n        container: calendar2,\r\n        //dateMin: new Date(0, 0, 0),        \r\n        dateMin: new Date(nsGmx.DateInterval.getUTCDayBoundary().dateBegin.getTime() - msd*(daysLimit-1)),\r\n        dateMax: new Date(3015, 1, 1),\r\n        dateFormat: 'dd.mm.yy',\r\n        minimized: false,\r\n        showSwitcher: false,\r\n        dateBegin: new Date(),\r\n        dateEnd: new Date(2000, 10, 10),\r\n        //buttonImage: 'img/calendar.png'\r\n    })\r\n\r\n    let td = calendar1.find('tr:nth-of-type(1) td');\r\n    td.eq(1).after('<td style=\"font-weight:bold\">&nbsp;&nbsp;&ndash;&nbsp;&nbsp;</td>');\r\n    td.eq(td.length - 1).after('<td>&nbsp;&nbsp;<img class=\"default_date\" style=\"cursor:pointer\" title=\"'+_gtxt('AISSearch2.calendar_today')+'\" src=\"plugins/AIS/AISSearch/svg/calendar.svg\"></td>');\r\n    calendar1.find('.default_date').on('click', () => {\r\n        let db = nsGmx.DateInterval.getUTCDayBoundary(new Date());\r\n        _viewCalendar1.getDateInterval().set('dateBegin', db.dateBegin);\r\n        _viewCalendar1.getDateInterval().set('dateEnd', db.dateEnd);\r\n        _viewCalendar2.getDateInterval().set('dateBegin', db.dateBegin);\r\n        _viewCalendar2.getDateInterval().set('dateEnd', db.dateEnd);\r\n        nsGmx.widgets.commonCalendar.setDateInterval(db.dateBegin, db.dateEnd);\r\n    });\r\n    \r\n    td = calendar2.find('tr:nth-of-type(1) td');\r\n    td.eq(1).after('<td style=\"font-weight:bold\">&nbsp;&nbsp;&ndash;&nbsp;&nbsp;</td>');\r\n    td.eq(td.length - 1).after('<td>&nbsp;&nbsp;<img class=\"default_date\" style=\"cursor:pointer\" title=\"'+_gtxt('AISSearch2.calendar_today')+'\" src=\"plugins/AIS/AISSearch/svg/calendar.svg\"></td>');\r\n    calendar2.find('.default_date').on('click', () => {\r\n        let db = nsGmx.DateInterval.getUTCDayBoundary(new Date());\r\n        _viewCalendar1.getDateInterval().set('dateBegin', db.dateBegin);\r\n        _viewCalendar1.getDateInterval().set('dateEnd', db.dateEnd);\r\n        _viewCalendar2.getDateInterval().set('dateBegin', db.dateBegin);\r\n        _viewCalendar2.getDateInterval().set('dateEnd', db.dateEnd);\r\n        nsGmx.widgets.commonCalendar.setDateInterval(db.dateBegin, db.dateEnd);\r\n    });\r\n\r\n    ///////////////////////////////////////////////\r\n    const //_tools = options.tools,\r\n        _modulePath = options.modulePath,\r\n        _searcher = new Searcher(options),\r\n        _mfm = new MyFleetModel({aisLayerSearcher:_searcher, toolbox:_tools, modulePath: _modulePath}),\r\n        _ssm = new ScreenSearchModel({ aisLayerSearcher: _searcher, myFleetModel: _mfm, vesselLegend: options.vesselLegend }),\r\n        _dbsm = new DbSearchModel(_searcher),\r\n        _dbsv = new DbSearchView(_dbsm, options, _tools, _viewCalendar1),\r\n        _ssv = new ScreenSearchView(_ssm, _tools),\r\n        _mfv = new MyFleetView(_mfm, _tools, _viewCalendar2),\r\n        _idv = new InfoDialogView({\r\n            tools:_tools,\r\n            aisLayerSearcher: _searcher, \r\n            modulePath: _modulePath,\r\n            aisView: _dbsv, \r\n            myFleetView: _mfv,\r\n            menuId: options.menuId\r\n        });\r\n        _ssv.infoDialogView = _idv;\r\n        _mfv.infoDialogView = _idv;\r\n        _dbsv.infoDialogView = _idv;\r\n    return {\r\n        // get tools(){\r\n        //     return _tools;\r\n        // },\r\n        get infoDialogView(){\r\n            return _idv;\r\n        },\r\n        create: function () {\r\n            return [ _mfv, _dbsv, _ssv ];\r\n        }\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/ViewsFactory.js","const BaseView = require('./BaseView.js');\r\nlet _tools, _delayedRepaint;\r\nconst ScreenSearchView = function (model, tools) {\r\n    BaseView.apply(this, arguments);\r\n    _tools = tools;          \r\n    _tools.onLegendSwitched(((showAlternative)=>{\r\n        if (this.isActive)      \r\n            this.model.data && this.model.data.vessels && this.repaint();\r\n        else\r\n            _delayedRepaint = true;\r\n    }).bind(this));\r\n\r\n    this.frame = $(Handlebars.compile('<div class=\"ais_view screensearch_view\">' +\r\n\r\n        '<table border=0 class=\"instruments\">' +\r\n        //'<tr><td colspan=\"2\"><div class=\"filter\"><input type=\"text\" placeholder=\"{{i \"AISSearch2.filter\"}}\"/><i class=\"icon-flclose clicable\"></div></td></tr>'+\r\n        '<tr><td><div class=\"filter\"><input type=\"text\" placeholder=\"{{i \"AISSearch2.filterName\"}}\"/>' +\r\n        '<div><img class=\"search clicable\" src=\"plugins/AIS/AISSearch/svg/search.svg\">' +\r\n        '<img class=\"remove clicable\" src=\"plugins/AIS/AISSearch/svg/remove.svg\">' +\r\n        '</div></div>' +\r\n        '</td></tr>' + \r\n\r\n        // '<tr><td>' + \r\n        // '<span class=\"sync-switch-slider-description\" style=\"padding: 0;line-height:12px\">{{i \"AISSearch2.allTracks\"}}</span>'+ \r\n        // '<label class=\"sync-switch switch all_tracks\" style=\"margin-left:5px\"><input type=\"checkbox\">'+\r\n        // '<div class=\"sync-switch-slider switch-slider round\"></div></label>' +\r\n        // '<div>&nbsp;</div>'+\r\n        // '</td></tr>' + \r\n\r\n        '</table>' +\r\n\r\n        '<table class=\"results\">'+\r\n        '<tr><td class=\"count\"></td>' +\r\n        '<td><div class=\"refresh clicable\" title=\"{{i \"AISSearch2.refresh\"}}\"><div>' + this.gifLoader + '</div></div></td></tr>' +\r\n        '<tr><td colspan=\"2\" style=\"padding:0px\"><div class=\"groups\"></div></td></tr>' +\r\n        '</table>'+\r\n        // '<table class=\"start_screen\"><tr><td>'+\r\n        // '<img src=\"plugins/AIS/AISSearch/svg/steer-weel.svg\">'+\r\n        // '<div>Здесь будут отображаться<br>результаты поиска</div></td></tr></table>'+\r\n        '<div class=\"ais_vessels\">'+\r\n        '<div class=\"ais_vessel\">' +\r\n        '<table border=0><tr><td><div class=\"position\">NO VESSELS</div><div>mmsi: 0 imo: 0</div></td>' +\r\n        '<td><i class=\"icon-ship\" vessel=\"\" title=\"\"></i></td>' +\r\n        '<td><span class=\"date\"></span></td>'+\r\n        '<td><div class=\"info\" vessel=\"aisjson this\" title=\"i AISSearch2.info\">' +\r\n        '<img src=\"plugins/AIS/AISSearch/svg/info.svg\">' +\r\n        '</div></td></tr></table>' +\r\n        '</div>' +       \r\n        '</div>' +\r\n        \r\n        '</div>'\r\n    )());\r\n    Object.defineProperty(this, \"topOffset\", {\r\n        get: function () {\r\n            let th = $('.ais_tabs')[0].getBoundingClientRect().height,\r\n            ih = this.frame.find('.instruments')[0].getBoundingClientRect().height,\r\n            rh = this.frame.find('.results')[0].getBoundingClientRect().height,\r\n            rv = th + ih + rh;\r\n            this.frame.find('.instruments').height(ih);\r\n            return rv;\r\n        }\r\n    });    \r\n    this.container = this.frame.find('.ais_vessels');\r\n    //this.startScreen = this.frame.find('.start_screen');\r\n    this.tableTemplate = '{{#each vessels}}' +\r\n        '<div class=\"ais_vessel\">' +\r\n        '<table border=0><tr><td><div class=\"position\">{{vessel_name}}</div><div>mmsi: {{mmsi}} imo: {{imo}}</div></td>' +       \r\n        '<td><img src=\"{{icon}}\" class=\"rotateimg{{icon_rot}} legend_icon\"><img src=\"{{iconAlt}}\" class=\"rotateimg{{icon_rot}} legend_iconalt\"></td>' +\r\n        \r\n        //'<td><i class=\"icon-ship\" vessel=\"{{aisinfoid this}}\" style=\"{{mf_member}}\" title=\"{{i \"AISSearch2.myFleetMember\"}}\"></i></td>' +\r\n        '<td><span vessel=\"{{aisinfoid this}}\" style=\"{{mf_member}}\" title=\"{{i \"AISSearch2.myFleetMember\"}}\">'+        \r\n        '<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"14px\" height=\"14px\" viewBox=\"0 0 14 14\" xml:space=\"preserve\">' +\r\n        '<g style=\"fill: #48aff1;\">' +\r\n        '<path class=\"st0\" d=\"M13.4,11H0.6c-0.2,0-0.4,0.1-0.5,0.3c-0.1,0.2-0.1,0.4,0,0.6l1.2,1.8C1.4,13.9,1.6,14,1.8,14h9.9   c0.2,0,0.3-0.1,0.4-0.2l1.7-1.8c0.2-0.2,0.2-0.4,0.1-0.7C13.9,11.1,13.7,11,13.4,11z\"/>' +\r\n        '<path class=\"st0\" d=\"M9.3,9.7h2.9c0.2,0,0.4-0.1,0.5-0.3c0.1-0.2,0.1-0.4,0-0.6L9.8,4.5C9.7,4.3,9.4,4.2,9.2,4.3   C8.9,4.4,8.7,4.6,8.7,4.9v4.3C8.7,9.5,9,9.7,9.3,9.7z\"/>' +\r\n        '<path class=\"st0\" d=\"M1.2,9.7H7c0.3,0,0.6-0.3,0.6-0.6V0.6c0-0.3-0.2-0.5-0.4-0.6C6.9-0.1,6.7,0,6.5,0.3L0.7,8.8   C0.6,9,0.5,9.2,0.6,9.4C0.7,9.6,0.9,9.7,1.2,9.7z\"/>' +\r\n        '</g>' +\r\n        '</svg></span></td>'+\r\n        \r\n        '<td><span class=\"date\">{{ts_pos_utc}}</span></td>'+\r\n        '<td><div class=\"info\" vessel=\"{{aisjson this}}\" title=\"{{i \"AISSearch2.info\"}}\">' +\r\n        '<img src=\"plugins/AIS/AISSearch/svg/info.svg\">' +\r\n        '</div></td></tr></table>' +\r\n        '</div>' +\r\n        '{{/each}}' +\r\n        '{{#each msg}}<div class=\"msg\">{{txt}}</div>{{/each}}';\r\n\r\n    let cleanFilter = this.frame.find('.remove'),\r\n        filterReady = this.frame.find('.search'),\r\n        filterInput = this.frame.find('input'),\r\n        delay,\r\n        doFilter = function(){\r\n            this.model.setFilter();             \r\n            this.repaint();\r\n//console.log(\"doFilter\")\r\n        };\r\n        cleanFilter.click(function(e){\r\n            if (this.model.filterString === '')\r\n                return;\r\n            filterInput.val('');\r\n            this.model.filterString = '';  \r\n            clearTimeout(delay)\r\n            doFilter.call(this);\r\n            //nsGmx.leafletMap.removeLayer(highlight);\r\n        }.bind(this))\r\n        filterInput.keyup(function(e){            \r\n            let input = filterInput.val() || \"\";\r\n            input = input.replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n            if (input===\"\"){\r\n                filterReady.show();\r\n                cleanFilter.hide();\r\n            }\r\n            else{\r\n                cleanFilter.show();\r\n                filterReady.hide();\r\n            }\r\n\r\n            if (input==this.model.filterString && e.keyCode!=13)\r\n                return;\r\n            this.model.filterString = input; \r\n            if (e.keyCode==13)\r\n                this.model.filterString += '\\r' ;  \r\n            clearTimeout(delay)\r\n            delay = setTimeout((() => { doFilter.call(this) }).bind(this), 500);\r\n            //nsGmx.leafletMap.removeLayer(highlight);\r\n        }.bind(this))\r\n    \r\n    let needUpdate = function(){\r\n        this.model.isDirty = true;\r\n        if (this.container.is(':visible')) {\r\n \r\n            clearTimeout(delay)\r\n            delay = setTimeout((() => { this.model.update() }).bind(this), 300);  \r\n        }\r\n    };\r\n    nsGmx.leafletMap.on('moveend', needUpdate.bind(this));\r\n    nsGmx.widgets.commonCalendar.getDateInterval().on('change', needUpdate.bind(this));\r\n\r\n    // this.frame.find('.instruments .all_tracks  input[type=\"checkbox\"]').click((e=>{\r\n    //     if (e.currentTarget.checked) {       \r\n    //         _tools.showAllTracks(true);\r\n    //     }\r\n    //     else{            \r\n    //         _tools.showAllTracks(false);  \r\n    //     }\r\n    // }).bind(this));\r\n};\r\n\r\nScreenSearchView.prototype = Object.create(BaseView.prototype);\r\n\r\nconst _clean = function () {\r\n    this.frame.find('.count').text(_gtxt('AISSearch2.found') + 0); \r\n},\r\n_switchLegendIcon = function(showAlternative){\r\n    let ic = this.frame.find('.legend_icon'),\r\n    ica = this.frame.find('.legend_iconalt');\r\n    if (showAlternative){\r\n        ic.hide(); ica.show();\r\n    }\r\n    else{\r\n        ica.hide(); ic.show();\r\n    }\r\n};\r\n\r\nScreenSearchView.prototype.inProgress = function (state) {\r\n    let progress = this.frame.find('.refresh div');\r\n    if (state)\r\n        progress.show();\r\n    else\r\n        progress.hide();\r\n};\r\n\r\nlet\r\n_firstRowsPos = 0,\r\n_firstRowsNum = 40,\r\n_firstRowsShift = 20,\r\n_setEventHandlers = function(){\r\n    let thisInst = this;\r\n    this.container.find('.info', ).on('click', function (e) {\r\n        let target = $(this),\r\n            vessel = JSON.parse(target.attr('vessel'))\r\n//console.log(vessel)\r\n        thisInst.infoDialogView && thisInst.infoDialogView.show(vessel, (v) => {\r\n//console.log(v)\r\n            vessel.xmin = vessel.xmax = v.longitude\r\n            vessel.ymin = vessel.ymax = v.latitude\r\n            if (vessel.hasOwnProperty('ts_pos_utc')) {\r\n                 vessel.ts_pos_utc = v.ts_pos_utc;\r\n                 vessel.ts_pos_org = v.ts_pos_org;\r\n                 v.dt_pos_utc && $(this).closest('tr').find('.date').html(v.dt_pos_utc);\r\n            }\r\n            target.attr('vessel', JSON.stringify(vessel))\r\n        });\r\n        e.stopPropagation();\r\n    });\r\n    this.container.find('.ais_vessel').on('click', function () {\r\n//console.log(JSON.parse($(this).find('.info').attr('vessel')))\r\n        let v = JSON.parse($(this).find('.info').attr('vessel'));                \r\n        v.lastPosition = true;\r\n        thisInst.infoDialogView.showPosition(v);\r\n    }); \r\n//console.log(\"repaint \"+(new Date()-start)+\"ms\" ) \r\n    this.frame.find('.show_groups').on('click', function () {\r\n        arrowHead = arrowHead == 'icon-down-open' ? 'icon-right-open': 'icon-down-open';\r\n        this.repaint();\r\n    }.bind(this));     \r\n}\r\n\r\nlet arrowHead = 'icon-down-open';\r\nScreenSearchView.prototype.repaint = function () {\r\n    _delayedRepaint = false;\r\n//let startRep = new Date();\r\n//console.log(\"REPAINT\")\r\n    //_clean.call(this);\r\n    this.frame.find('.count').html('<div class=\"show_groups clicable ui-helper-noselect ' + arrowHead + '\" ' +\r\n    'style=\"margin-right:5px;display:inline\"></div>' + \r\n    _gtxt('AISSearch2.found') + this.model.data.vessels.length); \r\n    //BaseView.prototype.repaint.apply(this, arguments);\r\n\r\n    this.frame.find('.groups')[0].innerHTML = '';\r\n    if (this.model.data.groups.length && arrowHead == 'icon-down-open')\r\n        this.frame.find('.groups')[0].innerHTML = (Handlebars.compile('<table>' +\r\n            '{{#each groups}}' +\r\n            '<tr><td><img src=\"{{url}}\" style=\"width:20px;height:20px\"></td><td><div class=\"group_name\">{{name}}</div></td><td>{{count}}</td></tr>' +\r\n            '{{/each}}' +\r\n            '</table>')({groups: !_tools.needAltLegend ? this.model.data.groups :  this.model.data.groupsAlt}));\r\n        \r\n    BaseView.prototype.resize.apply(this, arguments);   \r\n     \r\n    ////////////////////////////////////////////////////\r\n    this.container.find('.info').off('click');\r\n    this.container.find('.ais_vessel', ).off('click');   \r\n    let scrollCont = this.container.find('.mCSB_container')\r\n    if (scrollCont[0])\r\n        scrollCont.empty();\r\n    else\r\n        this.container.empty();\r\n    if (!this.model.data)\r\n        return;\r\n\r\n    let thisInst = this,\r\n        tempFirst = this.model.data.vessels.slice(0, _firstRowsNum),\r\n        content = $(Handlebars.compile(this.tableTemplate)({msg:this.model.data.msg, vessels:tempFirst})),\r\n        mcsTopPctPrev = 0,\r\n        rowH;\r\n    _firstRowsPos = _firstRowsNum;\r\n\r\n    if (!scrollCont[0]) {\r\n        this.container.mCustomScrollbar(\"destroy\").append(content).mCustomScrollbar({\r\n            //scrollInertia: 0,//this.model.data.vessels.length > _firstRowsNum ? 0 : 600,\r\n            callbacks:{\r\n                onScroll:function(){                    \r\n                    thisInst.scroledPx = this.mcs.top;\r\n                    //console.log(\"onScroll \" + this.mcs.top + \" \" + thisInst.container.is(':visible'));\r\n                },\r\n                whileScrolling: /*scrollingHandler*/function(){                     \r\n//console.log(\"whileScrolling \" + this.mcs.top + \"px \" + thisInst.container.is(':visible')+\" ss \"+thisInst.startShow)                  \r\n//console.log(\"% \" + this.mcs.topPct + \" pos\" + _firstRowsPos)\r\n                    if (thisInst.startShow && this.mcs.top == 0){\r\n                        return;\r\n                    }\r\n                    else\r\n                    thisInst.startShow = false;\r\n                        \r\n                    if (this.mcs.topPct==100 && mcsTopPctPrev != 100 && thisInst.model.data.vessels.length > _firstRowsPos){\r\n                        let start = _firstRowsPos - _firstRowsNum + _firstRowsShift,\r\n                            end = _firstRowsPos + _firstRowsShift;\r\n                        if (thisInst.model.data.vessels.length-start <= thisInst.container.height()/rowH)\r\n                            start = thisInst.model.data.vessels.length - _firstRowsNum;\r\n///console.log(\">\"+start+\", \"+end)\r\n                        tempFirst = thisInst.model.data.vessels.slice(start, end),\r\n                        _firstRowsPos += _firstRowsShift;                       \r\n                        let scrollCont = thisInst.container.find('.mCSB_container');\r\n                        scrollCont.html(Handlebars.compile(thisInst.tableTemplate)({vessels:tempFirst}));  \r\n//console.log(\"h=\"+rowH) \r\n                        setTimeout(()=>{\r\n                            thisInst.scroledPx = -rowH * _firstRowsShift + thisInst.container.height();\r\n                            thisInst.container.mCustomScrollbar(\"scrollTo\",\r\n                            thisInst.scroledPx, {\r\n                                    scrollInertia: 0,\r\n                                    callbacks: false\r\n                            });\r\n                            _setEventHandlers.call(thisInst);\r\n                        }, 200);\r\n                        _switchLegendIcon.call(thisInst, _tools.needAltLegend);\r\n                    }\r\n                    if (this.mcs.topPct == 0 && mcsTopPctPrev != 0 && _firstRowsPos > _firstRowsNum) {\r\n//console.log(_firstRowsPos)\r\n                        let start = _firstRowsPos - _firstRowsShift - _firstRowsNum,\r\n                            end = _firstRowsPos - _firstRowsShift;\r\n//console.log(\"<\"+start + \", \" + end)\r\n                        tempFirst = thisInst.model.data.vessels.slice(start, end),\r\n                        _firstRowsPos -= _firstRowsShift;                       \r\n                        let scrollCont = thisInst.container.find('.mCSB_container');\r\n                        scrollCont.html(Handlebars.compile(thisInst.tableTemplate)({ vessels: tempFirst })); \r\n//console.log(\"h=\"+rowH)\r\n                        setTimeout(() => {\r\n                            thisInst.scroledPx = rowH * _firstRowsShift;\r\n                            thisInst.container.mCustomScrollbar(\"scrollTo\",\r\n                                thisInst.scroledPx, {\r\n                                    scrollInertia: 0,\r\n                                    callbacks: false\r\n                                }\r\n                            );\r\n                            _setEventHandlers.call(thisInst);\r\n                        }, 200);\r\n                        _switchLegendIcon.call(thisInst, _tools.needAltLegend);\r\n                    }\r\n                    mcsTopPctPrev = this.mcs.topPct;\r\n                }\r\n            }\r\n        });\r\n        scrollCont = this.container.find('.mCSB_container');\r\n        rowH = scrollCont.height()/$('.ais_vessel', scrollCont).length;\r\n    }\r\n    else {\r\n        scrollCont.append(content);\r\n        this.container.mCustomScrollbar(\"scrollTo\", \"top\", {scrollInertia:0, callbacks:false, timeout:200});\r\n    }\r\n    _setEventHandlers.call(this);  \r\n    _switchLegendIcon.call(this, _tools.needAltLegend);\r\n//console.log((new Date().getTime()-startRep)/1000)\r\n};\r\n\r\nScreenSearchView.prototype.show = function () {\r\n    this.startShow = true;\r\n    BaseView.prototype.show.apply(this, arguments);\r\n    if (_delayedRepaint && !this.model.isDirty)\r\n        this.repaint();\r\n\r\n    this.frame.find('.filter input').focus();\r\n\r\n    // if (this.frame.find('.instruments .all_tracks  input[type=\"checkbox\"]')[0].checked)\r\n    //     _tools.showAllTracks(true);\r\n\r\n    if (this.scroledPx) {\r\n        this.container.mCustomScrollbar(\"scrollTo\",\r\n            this.scroledPx, { scrollInertia: 0, callbacks: false }\r\n        );\r\n    }  \r\n};\r\n\r\nmodule.exports = ScreenSearchView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/ScreenSearchView.js","let PRODUCTION = false,\r\n    SIDEBAR2 = false;\r\nif (has('SIDEBAR2'))\r\n    SIDEBAR2 = true;\r\nif (has('PRODUCTION'))\r\n    PRODUCTION = true;\r\n\r\nlet _calcHeight = function () {  \r\n    return $('.iconSidebarControl-pane').height() - \r\n    ($('.ais_panel_footer')[0]?$('.ais_panel_footer').height():0)\r\n    - this.topOffset;\r\n};\r\n\r\nlet _tools;\r\nconst BaseView = function (model, tools) {\r\n    model.view = this;\r\n    this.model = model;\r\n    this.gifLoader = '<img src=\"img/progress.gif\">';\r\n    _tools = tools;\r\n};\r\n\r\nlet _clean = function(){ \r\n    this.container.find('.info').off('click');\r\n    this.container.find('.position', ).off('click');   \r\n    let scrollCont = this.container.find('.mCSB_container')\r\n    if (scrollCont[0])\r\n        scrollCont.empty();\r\n    else\r\n        this.container.empty();\r\n//console.log(\"EMPTY ON BASE.CLEAN\")\r\n};\r\n\r\nBaseView.prototype = function () {\r\n    return {\r\n        get isActive(){\r\n            return this.frame.is(\":visible\");\r\n        },\r\n        resize: function (clean) {\r\n            if (clean){\r\n                this.container.empty()\r\n            }\r\n            let h = _calcHeight.call(this);\r\n            if (this.startScreen && $('.iconSidebarControl-pane:visible')[0]){\r\n                let bb = $('.iconSidebarControl-pane:visible')[0].getBoundingClientRect();\r\n                this.startScreen.css({ position:\"absolute\", left: bb.left+\"px\", top: (bb.height/2-50)+\"px\", \r\n                width: bb.width+\"px\"});\r\n            }\r\n            this.container.height(h);\r\n        },\r\n        repaint: function(){\r\n            _clean.call(this);            \r\n//console.log(this.model.data)\r\n            if (!this.model.data)\r\n                return;\r\n            let scrollCont = this.container.find('.mCSB_container'),\r\n            content = $(Handlebars.compile(this.tableTemplate)(this.model.data));\r\n            if (!scrollCont[0]) {\r\n                this.container.append(content).mCustomScrollbar();\r\n            }\r\n            else {\r\n                $(scrollCont).append(content);\r\n            }\r\n\r\n            var _this = this;\r\n            this.container.find('.info').on('click', function (e) {\r\n                let target = $(this),\r\n                    vessel = JSON.parse(target.attr('vessel'))\r\n//console.log(vessel)\r\n                _this.infoDialogView && _this.infoDialogView.show(vessel, (v) => {\r\n//console.log(v)\r\n                    vessel.xmin = vessel.xmax = v.longitude\r\n                    vessel.ymin = vessel.ymax = v.latitude\r\n                    if (vessel.hasOwnProperty('ts_pos_utc')) {\r\n                         vessel.ts_pos_utc = v.ts_pos_utc;\r\n                         vessel.ts_pos_org = v.ts_pos_org;\r\n                         v.dt_pos_utc && $(this).closest('tr').find('.date').html(v.dt_pos_utc);\r\n                    }\r\n                    target.attr('vessel', JSON.stringify(vessel))\r\n                });\r\n                e.stopPropagation();\r\n            });\r\n            this.container.find('.ais_vessel').on('click', function () {\r\n                let v = JSON.parse($(this).find('.info').attr('vessel'));                \r\n                v.lastPosition = true;\r\n                v.xmax = null;\r\n                v.xmin = null;\r\n                v.ymax = null;\r\n                v.ymin = null;\r\n                _this.infoDialogView.showPosition(v);\r\n            });      \r\n        },\r\n        show: function () {\r\n            _tools.restoreDefault();\r\n            this.frame.show();\r\n            this.model.update();\r\n        },\r\n        hide: function () {\r\n            this.frame.hide();\r\n        }\r\n    }\r\n}();\r\n\r\nmodule.exports = BaseView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/BaseView.js","let _actualUpdate,\r\n_myFleetModel,\r\n_aisLayerSearcher,\r\n_vesselLegend;\r\n\r\nconst ScreenSearchModel = function ({aisLayerSearcher, myFleetModel, vesselLegend}) {\r\n\r\n    let thisInstance = this;\r\n    myFleetModel.onChanged = function(){\r\n        thisInstance.isDirty = true;\r\n        if (thisInstance.view.isActive)\r\n            thisInstance.update();\r\n    };\r\n    _aisLayerSearcher = aisLayerSearcher;\r\n    _myFleetModel = myFleetModel;\r\n    _vesselLegend = vesselLegend;\r\n    this.filterString = \"\";\r\n    this.isDirty = true;\r\n};\r\n\r\nScreenSearchModel.prototype.load = function (actualUpdate) {\r\n    if (!this.isDirty)\r\n        return Promise.resolve();\r\n\r\n    let thisInst = this;\r\n    let s = new Date();\r\n    return Promise.all([\r\n        new Promise(function (resolve, reject) {\r\n            _aisLayerSearcher.searchScreen({\r\n                dateInterval: nsGmx.widgets.commonCalendar.getDateInterval(),\r\n                border: true,\r\n                group: true\r\n            }, function (json) {\r\n//console.log(\"RECEIVED \"+((new Date()-s)/1000));\r\n                if (json.Status.toLowerCase() == \"ok\") {\r\n//console.log(json.Result.elapsed);\r\n                    s = new Date();\r\n\r\n                    // thisInst.filterString = thisInst.filterString.replace(/\\r+$/, \"\"); !!!!!!TO DO FILTER\r\n\r\n                    thisInst.dataSrc = {\r\n                        vessels: json.Result.values.map(function (v) {\r\n                            let d = new Date(v[12]),//nsGmx.widgets.commonCalendar.getDateInterval().get('dateBegin'),\r\n                            vessel = {\r\n                                vessel_name: v[0], mmsi: v[1], imo: v[2], mf_member: 'visibility:hidden', \r\n                                ts_pos_utc: _aisLayerSearcher.formatDate(d), ts_pos_org: Math.floor(d.getTime()/1000),\r\n                                xmin: v[4], xmax: v[5], ymin: v[6], ymax: v[7], maxid: v[3],\r\n                                vessel_type: v[8], sog: v[9], cog: v[10], heading: v[11]\r\n                            };\r\n                            //if (_myFleetModel.findIndex(vessel)>=0)\r\n                            //    vessel.mf_member = \"visibility:visible\";\r\n                            vessel.icon_rot = Math.round(vessel.cog/15)*15;\r\n                            _aisLayerSearcher.placeVesselTypeIcon(vessel);\r\n                            return vessel;\r\n                        })\r\n                    };\r\n\r\n                    thisInst.data = { groups: [], groupsAlt: [] }; \r\n                    for (let k in json.Result.groups){\r\n                        let ic = _vesselLegend.getIcon(k, 1)\r\n                        thisInst.data.groups.push({ url: ic.url, name: ic.name, count: json.Result.groups[k]});\r\n                    }\r\n                    for (let k in json.Result.groupsAlt){\r\n                        if (!isNaN(k)){\r\n                            let ic = _vesselLegend.getIconAlt(\"ABC\", parseInt(k))\r\n                            thisInst.data.groupsAlt.push({ url: ic.url, name: ic.name, count: json.Result.groupsAlt[k]});\r\n                        }\r\n                    }\r\n\r\n//console.log((\"MAP \"+((new Date()-s)/1000)))\r\n                    if (_actualUpdate == actualUpdate) {\r\n                        //console.log(\"ALL CLEAN\")\r\n                        //console.log(\"1>\"+new Date(thisInst._actualUpdate))\r\n                        //console.log(\"2>\"+new Date(actualUpdate))\r\n                        thisInst.isDirty = false;\r\n                    }\r\n                    resolve();\r\n                }\r\n                else {\r\n                    reject(json);\r\n                }\r\n            });\r\n        })\r\n        , _myFleetModel.load()\r\n    ]);\r\n};\r\n\r\nScreenSearchModel.prototype.sortData = function () {\r\n        let sortGrups = function(a, b) {\r\n            return b.count - a.count;\r\n          }\r\n        this.data.groups.sort(sortGrups);\r\n        this.data.groupsAlt.sort(sortGrups);\r\n        // let sortNames = (a,b)=>{\r\n        //     if (a.vessel_name == b.vessel_name)\r\n        //         return 0;\r\n        //     else\r\n        //         return a.vessel_name > b.vessel_name ? 1 : -1;\r\n        // };  \r\n        // this.data.vessels.sort((a,b)=>{\r\n        //     let a_member = _myFleetModel.findIndex(a)>=0,\r\n        //         b_member = _myFleetModel.findIndex(b)>=0;\r\n        //     if (a_member)\r\n        //         a.mf_member = \"visibility:visible\";\r\n        //     if (b_member)\r\n        //         b.mf_member = \"visibility:visible\";\r\n        //     if ((!a_member && !b_member) || (a_member && b_member))\r\n        //         return 0; //sortNames(a,b);\r\n        //     else if (a_member && !b_member)\r\n        //         return -1;\r\n        //     else if (!a_member && b_member)\r\n        //         return 1;\r\n        // });\r\n};\r\nScreenSearchModel.prototype.update = function () {\r\n    if (!this.isDirty)\r\n        return;\r\n    _actualUpdate = new Date().getTime();\r\n    let thisInst = this,\r\n        actualUpdate = _actualUpdate;\r\n    this.view.inProgress(true);       \r\n\r\nlet s = new Date()\r\n    this.load(actualUpdate).then(function () {\r\n        if (_actualUpdate == actualUpdate) {\r\n            if (thisInst.dataSrc)\r\n                _myFleetModel.markMembers(thisInst.dataSrc.vessels);            \r\n            thisInst.data.vessels = thisInst.dataSrc.vessels;\r\n            \r\n            thisInst.sortData();         \r\n            thisInst.view.inProgress(false);\r\n            thisInst.view.repaint(); \r\n        }\r\n    }, function (json) {\r\n        thisInst.dataSrc = null;\r\n//console.logconsole.log(json)\r\n        if (json.Status.toLowerCase() == \"auth\" ||\r\n            (json.ErrorInfo && json.ErrorInfo.some && json.ErrorInfo.some(function (r) { return r.Status.toLowerCase() == \"auth\" })))\r\n            thisInst.data = { msg: [{ txt: _gtxt(\"AISSearch2.auth\") }], vessels: [] };\r\n        else {\r\n            //thisInst.data = {msg:[{txt:\"!!!\"}], vessels:[]};\r\n            console.log(json);\r\n        }\r\n        thisInst.view.inProgress(false);\r\n        thisInst.view.repaint();\r\n    });\r\n};\r\n\r\nmodule.exports = ScreenSearchModel;\n\n\n// WEBPACK FOOTER //\n// ./src/Models/ScreenSearchModel.js","require(\"./MyFleet.css\")\r\nconst BaseView = require('./BaseView.js');\r\nconst GroupList = require('../Controls/GroupList.js');\r\n\r\nconst _switchLegendIcon = function(showAlternative){\r\n    let ic = this.frame.find('.legend_icon'),\r\n    ica = this.frame.find('.legend_iconalt');\r\n    if (showAlternative){\r\n        ic.hide(); //ica.show();\r\n        ica.each( (i,e)=>e.style.display=\"\");\r\n    }\r\n    else{\r\n        ica.hide(); //ic.show();\r\n        ic.each( (i,e)=>e.style.display=\"\");\r\n    }\r\n},\r\n_clean = function(){  \r\n    this.frame.find('.ais_vessels input[type=\"checkbox\"]').off('click');    \r\n    this.startScreen.css({ visibility: \"hidden\" });\r\n};\r\n\r\nlet _tools, \r\n_displayedOnly=[], \r\n_notDisplayed=[],\r\n_saveLabelSettingsPromise = Promise.resolve(0),\r\n_viewState = {\r\n    get displayedOnly(){return _displayedOnly;},\r\n    get notDisplayed(){return _notDisplayed;},\r\n    showTracks: function(trackBuilder, needAlt){\r\n        trackBuilder.showMyFleetTracks(_displayedOnly, needAlt);\r\n    },\r\n    hideTracks: function(trackBuilder, needAlt){\r\n        trackBuilder.hideMyFleetTracks(_notDisplayed, needAlt);\r\n    },\r\n    cleanTracks: function(trackBuilder, needAlt){\r\n        trackBuilder.cleanMyFleetTracks();\r\n    }\r\n};\r\n\r\nconst MyFleetView = function (model, tools, viewCalendar){\r\n    BaseView.apply(this, arguments);\r\n    _tools = tools; \r\n    _tools.onLegendSwitched(((showAlternative)=>{\r\n        _switchLegendIcon.call(this, _tools.needAltLegend);\r\n    }).bind(this));\r\n\r\n    let settings = []; //DEFAULT SETTINGS\r\n    this.frame = $(Handlebars.compile('<div class=\"ais_view myfleet_view\">' +\r\n    '<table class=\"instruments\">'+\r\n    '<tr><td style=\"vertical-align:top; padding-right:0\">'+\r\n\r\n    '<div style=\"width:140px; margin-bottom: 8px;\">{{i \"AISSearch2.DisplaySection\"}}</div>' +\r\n\r\n        '<div style=\"margin-bottom: 5px;\"><label class=\"sync-switch switch only_myflot\"><input type=\"checkbox\">'+\r\n        '<div class=\"sync-switch-slider switch-slider round\"></div></label>' +\r\n        '<span class=\"sync-switch-slider-description\">{{i \"AISSearch2.myFleetOnly\"}}</span></div>'+  \r\n\r\n        '<label class=\"sync-switch switch all_tracks\"><input type=\"checkbox\">'+\r\n        '<div class=\"sync-switch-slider switch-slider round\"></div></label>' +\r\n        '<span class=\"sync-switch-slider-description\" >{{i \"AISSearch2.shipsTracks\"}}</span>'+ \r\n            \r\n    '</td>' +\r\n\r\n    '<td style=\"padding-right:0\">' +\r\n    '<div style=\"width:120px;float:left;\" class=\"setting\"><label><input type=\"checkbox\" id=\"group_name\" ' + (settings.indexOf('group_name')<0?'':'checked') + '>{{i \"AISSearch2.DisplayGroupName\"}}</div>' +\r\n    '<div style=\"width:120px;float:left;\" class=\"setting\"><label><input type=\"checkbox\" id=\"vessel_name\" ' + (settings.indexOf('vessel_name')<0?'':'checked') + '>{{i \"AISSearch2.DisplayVesselName\"}}</label></div>' +\r\n    '<div style=\"width:70px;float:left;\" class=\"setting\"><label><input type=\"checkbox\" id=\"sog\" ' + (settings.indexOf('sog')<0?'':'checked') + '>{{i \"AISSearch2.DisplaySog\"}}</label></div>' +\r\n    '<div style=\"width:45px;float:left;\" class=\"setting\"><label><input type=\"checkbox\" id=\"cog\" ' + (settings.indexOf('cog')<0?'':'checked') + '>{{i \"AISSearch2.DisplayCog\"}}</label></div>' +\r\n    '</td>' +\r\n    '<td><div class=\"refresh\"><div>' + this.gifLoader + '</div></div></td></tr>' +\r\n\r\n    '<tr><td colspan=\"3\" style=\"padding-top:0\">' +\r\n    '<table class=\"newgroup\"><tr><td>{{i \"AISSearch2.NewGroup\"}}</td>' +\r\n    '<td><div class=\"newgroupname\"><input type=\"text\" placeholder=\"{{i \"AISSearch2.NewGroupName\"}}\"/></div></td>' +\r\n    '<td><img class=\"create clicable\" title=\"{{i \"AISSearch2.CreateGroup\"}}\" src=\"plugins/AIS/AISSearch/svg/add.svg\"></td>' +\r\n    '</tr></table>' +\r\n    '</td></tr>' +\r\n\r\n    '<tr><td colspan=\"2\"><style>' + \r\n    '#ui-datepicker-div .ui-datepicker-next {height: 1.8em !important;}' +\r\n    '#ui-datepicker-div .ui-datepicker-next span.ui-icon.ui-icon-circle-triangle-e {background: url(img/arrows.png) no-repeat 0 -18px !important;}' +\r\n    '#ui-datepicker-div .ui-datepicker-next.ui-state-hover span.ui-icon.ui-icon-circle-triangle-e {background: url(img/arrows.png) no-repeat 0 -38px !important;}' +\r\n    '</style><div class=\"calendar\"></div></td>' +\r\n    '<td style=\"padding-left:5px;padding-right:25px;vertical-align:top;\"><div class=\"clicable\" title=\"{{i \"AISSearch2.refresh\"}}\">' +\r\n    //'<div class=\"progress\">' + this.gifLoader + '</div>' +\r\n    '<div class=\"reload\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"#2f3c47\" d=\"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z\"/></svg></div>' +\r\n    '</div></td></tr>' +\r\n\r\n\r\n    '</table>'+ \r\n\r\n    '<div class=\"ais_vessels\">'+\r\n    '<table class=\"results\">'+\r\n    '<td><input type=\"checkbox\" checked></td>' +\r\n    '<td class=\"count\"></td></tr></table>'+\r\n    '<div class=\"ais_vessel\">' +\r\n    '<table border=0><tr>' +\r\n    '<td><input type=\"checkbox\" checked></td>' +\r\n    '<td><div class=\"position\">vessel_name</div><div>mmsi: mmsi imo: imo</div></td>' +\r\n    '<td></td>' +  \r\n    '<td><span class=\"date\">ts_pos_utc</span></td>'+\r\n\r\n    '</tr></table>' +\r\n    '</div>' +      \r\n    '</div>' +\r\n\r\n    '<table class=\"start_screen\"><tr><td>' +\r\n    '<img src=\"plugins/AIS/AISSearch/svg/steer-weel.svg\">' +\r\n    '<div>{{{i \"AISSearh2.myfleet_view\"}}}' +\r\n    '</div></td></tr></table>' +\r\n\r\n    '</div>')());    \r\n\r\n    this.calendar = viewCalendar;\r\n    this.frame.find('.calendar').append(this.calendar.el.parentElement);\r\n\r\n    const reloadTrack = function(){\r\n        if (!this.displayTracks)\r\n            return;              \r\n        if (this.isActive)        \r\n            this.inProgress(true);              \r\n        this.model.loadTracks(this.infoDialogView, _viewState);\r\n    };\r\n    this.calendar.onChange = reloadTrack.bind(this);    \r\n    this.frame.find('.reload').on('click', reloadTrack.bind(this))\r\n\r\n    this.frame.on('click', ((e) => {\r\n        if (e.target.classList.toString().search(/CalendarWidget/) < 0) {\r\n            this.calendar.reset()\r\n        }\r\n        //suggestions.hide();\r\n    }).bind(this));\r\n\r\n    \r\n    Object.defineProperty(this, \"displayTracks\", {\r\n        get: function () {\r\n            const showTracsCtrl = this.frame.find('.instruments .switch.all_tracks input[type=\"checkbox\"]')[0];\r\n            return showTracsCtrl.checked;\r\n        }\r\n    }); \r\n\r\n    Object.defineProperty(this, \"topOffset\", {\r\n        get: function () {\r\n            let th = $('.ais_tabs')[0].getBoundingClientRect().height,\r\n            ih = this.frame.find('.instruments')[0].getBoundingClientRect().height,\r\n            rv = th + ih;\r\n            this.frame.find('.instruments').height(ih);\r\n            return rv;\r\n        }\r\n    });  \r\n\r\n    this.container = this.frame.find('.ais_vessels');     \r\n    this.startScreen = this.frame.find('.start_screen');\r\n    \r\n    // craete group controller\r\n    let newGroupNameValid = function(ngn){\r\n        let isValid = ngn.search(/\\S/)!=-1;\r\n        this.model.data.groups.forEach(g=>{\r\n            if (isValid)\r\n                isValid = g.title!=ngn;\r\n        });\r\n        return isValid;\r\n    },\r\n    createGroup = function(ngn){\r\n        if (newGroupNameValid.call(this, ngn)){\r\n            this.inProgress(true);\r\n            this.model.createGroup(ngn)\r\n            .then((group)=>{\r\n                this.groupList.appendGroup(group, this.model.data.groups.length-1);\r\n                this.inProgress(false);\r\n            },\r\n            (error)=>{\r\n                this.inProgress(false);\r\n                console.log(error)\r\n            }\r\n            );\r\n        }        \r\n    };\r\n    this.frame.find('.instruments .create').on(\"click\", (e=>{\r\n        let input = this.frame.find('.instruments .newgroupname input'),\r\n        ngn = input.val();\r\n        input.val('');\r\n        createGroup.call(this, ngn);\r\n    }).bind(this))\r\n    this.frame.find('.instruments .newgroupname input').on(\"keyup\", (e=>{\r\n        let ngn = e.target.value;\r\n        if (e.keyCode==13){\r\n            e.target.value = '';\r\n            createGroup.call(this, ngn);\r\n        }\r\n    }).bind(this)); \r\n\r\n    // marker settings\r\n    this.frame.find('.instruments .setting input')\r\n    .on('change', (e=>{\r\n        let display = '';\r\n        this.frame.find('.instruments .setting input').each((i, e)=>{\r\n            if (e.checked)\r\n                display += \"{{{\" + e.id + \"}}}\";\r\n        });\r\n        if (display=='')\r\n            display = '{{{foo}}}';  \r\n        this.model.markerTemplate =  this.model.markerTemplate.replace(/<td>\\{\\{\\{.+\\}\\}\\}<\\/td>/, '<td>' + display + '</td>');\r\n        _tools.showVesselsOnMap(_viewState);\r\n            \r\n        _saveLabelSettingsPromise = _saveLabelSettingsPromise.then(((c)=>{return this.model.saveLabelSettings(c);}).bind(this));\r\n    }).bind(this));\r\n  \r\n       \r\n    // tracks controller    \r\n    this.frame.find('.instruments .switch.all_tracks input[type=\"checkbox\"]').on(\"click\", \r\n        function(e){\r\n            if (e.currentTarget.checked) {    \r\n                this.inProgress(true);              \r\n                this.model.loadTracks(this.infoDialogView, _viewState);\r\n            }\r\n            else {\r\n                _tools.showMyFleetTrack();\r\n            }            \r\n        }.bind(this)\r\n    ); \r\n\r\n    // visibility controller\r\n    this.frame.find('.instruments .switch.only_myflot input[type=\"checkbox\"]').on(\"click\", \r\n        function(e){\r\n            _displayedOnly.length = 0;\r\n            if (e.currentTarget.checked)\r\n                _displayedOnly = this.model.vessels.map(v=>v.mmsi.toString());\r\n            _tools.showVesselsOnMap(_viewState);\r\n            _tools.hideVesselsOnMap(_viewState, 'click only'); \r\n        }.bind(this)\r\n    ); \r\n\r\n    // group list\r\n    this.groupList = new GroupList(this.frame);\r\n    this.groupList.onRepaintItem = ((i, elm)=>{\r\n        elm.querySelector('input[type=checkbox]').checked = _notDisplayed.indexOf(elm.querySelector('.mmsi').innerText)<0;\r\n    }).bind(this);\r\n    this.groupList.onDeleteGroup = (group=>{\r\n        this.inProgress(true);\r\n        this.model.deleteGroup(group);\r\n    }).bind(this);\r\n    \r\n    this.tableTemplate = this.groupList.toString();\r\n};\r\n\r\nMyFleetView.prototype = Object.create(BaseView.prototype);\r\n\r\nObject.defineProperty(MyFleetView.prototype, \"notDisplayed\", {\r\n    get() {\r\n        return _notDisplayed;\r\n    }\r\n});\r\n\r\nMyFleetView.prototype.inProgress = function (state) {\r\n    let progress = this.frame.find('.refresh div');\r\n    if (state)\r\n        progress.show();\r\n    else\r\n        progress.hide();\r\n};\r\n\r\nMyFleetView.prototype.repaint = function () {\r\n    _clean.call(this);  \r\n    BaseView.prototype.repaint.apply(this, arguments);\r\n\r\n    // MEMBERS ON MAP\r\n    _displayedOnly.length = 0;\r\n    if (!this.model.vessels.length)\r\n        this.frame.find('.instruments .switch.only_myflot input[type=\"checkbox\"]')[0].checked = false;    \r\n    if (this.frame.find('.instruments .switch.only_myflot input[type=\"checkbox\"]')[0].checked)\r\n        _displayedOnly = this.model.vessels.map(v=>v.mmsi.toString()); \r\n    _tools.showVesselsOnMap(_viewState);\r\n    _tools.hideVesselsOnMap(_viewState, 'repaint'); \r\n    ///////////////// \r\n\r\n    let labelSettings = this.model.markerTemplate.match(/(?!\\{\\{\\{)[^\\{\\}]+(?=\\}\\}\\})/g),\r\n    labelSettingCtrl;\r\n    for (var i in labelSettings){\r\n        labelSettingCtrl = this.frame.find('.instruments .setting input#' + labelSettings[i])[0];\r\n        if (labelSettingCtrl)\r\n            labelSettingCtrl.checked = true;\r\n    }\r\n\r\n    this.groupList.repaint();  \r\n    \r\n    // GROUP LIST EVENTS\r\n    this.groupList.onCheckItem = function(uncheked){\r\n        if (uncheked.length)\r\n            _notDisplayed=uncheked.map(mmsi=>mmsi);\r\n        else\r\n            _notDisplayed.length = 0;\r\n        _tools.hideVesselsOnMap(_viewState, 'check item');\r\n    }\r\n    this.groupList.onChangeGroup = ((mmsi, group)=>{\r\n        let view = this;\r\n        this.inProgress(true);          \r\n        this.model.changeGroup(mmsi, group)\r\n        .then((r)=>{\r\n            view.repaint();\r\n            view.inProgress(false);  \r\n        })\r\n        .catch((err)=>{\r\n            console.log(err)\r\n            view.inProgress(false);   \r\n        });\r\n    }).bind(this);\r\n    this.groupList.onExcludeItem = ((ev, mmsi, i) => {\r\n            ev.stopPropagation();\r\n            let thisView = this;\r\n            let vessel = thisView.model.vessels[i];\r\n            \r\n            thisView.beforeExcludeMember(vessel.mmsi.toString());\r\n\r\n            let dlg = $('.ui-dialog:contains(\"' + vessel.mmsi + '\")');\r\n            if (dlg[0]){ \r\n                dlg.find('.button.addremove').click();\r\n            }\r\n            else{\r\n                thisView.model.changeMembers(vessel, this.infoDialogView).then(function () {\r\n                    thisView.show();\t\t\t\r\n                    _tools.eraseMyFleetMarker(vessel.mmsi);\r\n                })\r\n            }        \r\n    }).bind(this);    \r\n    this.groupList.onGroupMenuShow = ((group)=>{\r\n        let i = parseInt(group.replace(/gr/, ''), 10);\r\n        return {\r\n            marker_style:parseInt(this.model.data.groups[i].marker_style.replace(/#/, ''), 16),\r\n            label_color:parseInt(this.model.data.groups[i].label_color.replace(/#/, ''), 16),\r\n            label_shadow:parseInt(this.model.data.groups[i].label_shadow.color.replace(/#/, ''), 16)\r\n        };\r\n    }).bind(this);\r\n    this.groupList.onChangeGroupStyle = ((group, colors)=>{\r\n        let i = parseInt(group.replace(/gr/, ''), 10);\r\n        this.model.changeGroupStyle(i, colors);\r\n    }).bind(this);\r\n    this.groupList.onSaveGroupStyle = this.model.saveGroupStyle;\r\n    _switchLegendIcon.call(this, _tools.needAltLegend);\r\n};\r\n\r\nMyFleetView.prototype.beforeExcludeMember = function (strMmsi) {\r\n    _displayedOnly = _displayedOnly.filter(m => m != strMmsi);\r\n    _notDisplayed = _notDisplayed.filter(m => m != strMmsi);\r\n}\r\n\r\nMyFleetView.prototype.hide = function () {\r\n    BaseView.prototype.hide.apply(this, arguments); \r\n    _tools.cleanMap(_viewState);\r\n}\r\n\r\n// MyFleetView.prototype.show = function () {\r\n//     BaseView.prototype.show.apply(this, arguments);  \r\n//     _switchLegendIcon.call(this, _tools.needAltLegend);\r\n// }\r\n\r\nmodule.exports = MyFleetView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/MyFleetView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/MyFleet.css\n// module id = 12\n// module chunks = 0","const GroupWidget = require('./GroupWidget.js');\r\n\r\nlet _onRepaintItemHandler,\r\n_onCheckItem,\r\n_onExcludeItem,\r\n_onChangeGroup,\r\n_onDeleteGroup,\r\n_onGroupMenuShow,\r\n_onChangeGroupStyle,\r\n_rolledupGroups = {},\r\n_cp1, _cp2, _cp3,\r\n_getFiltered = function(){\r\n    let filtered = [];\r\n    let group = this.frame.find('.mf_group'), selectAll, selectOne;\r\n    for (let i = 0; i < group.length; i++){\r\n        selectAll = group.eq(i).find('.results input[type=\"checkbox\"]');\r\n        selectOne = group.eq(i).find('.ais_vessel input[type=\"checkbox\"]');\r\n        selectAll[0].checked = true;\r\n        for (let j = 0; j < selectOne.length; j++)\r\n            if (!selectOne[j].checked) {\r\n                filtered.push(selectOne[j].closest('.ais_vessel').querySelector('.mmsi').innerText);\r\n                selectAll[0].checked = false;\r\n            }\r\n    }\r\n    return filtered;\r\n},\r\n_setCheckBoxes = function(){\r\n    this.frame.find('.ais_vessel').each(_onRepaintItemHandler);            \r\n    this.frame.find('.results input[type=\"checkbox\"]')\r\n    .each((i,e)=>{\r\n        let check = true; \r\n        e.closest('.mf_group').querySelectorAll('input').forEach((e,i)=>{\r\n            check = check && e.checked\r\n        }); \r\n        e.checked = check;\r\n    });\r\n},\r\n_setGroupCommands = function(){\r\n    this.frame.find('.results input[type=\"checkbox\"]').off(\"click\").on(\"click\", ((e)=>{\r\n        let group = $(e.target).closest('.mf_group');\r\n        group.find('.ais_vessel input[type=\"checkbox\"]').each((i, elm)=>{\r\n            elm.checked = e.target.checked;\r\n        }) \r\n        let filtered = _getFiltered.call(this);\r\n        _onCheckItem(filtered);\r\n    }).bind(this)); \r\n           \r\n    this.frame.find('.results').off(\"contextmenu\").on(\"contextmenu\", (e=>{  \r\n        e.preventDefault();\r\n        // let values= e.currentTarget.classList.values(), \r\n        // cssClass, group;\r\n        // while (!cssClass || !cssClass.done){\r\n        //     cssClass = values.next(); \r\n        //     group = cssClass.value;\r\n        //     if (group && group.search(/^gr\\d/)==0)\r\n        //         break;\r\n        // }\r\n        let group, classes = e.currentTarget.classList;\r\n        for (let i=0; i<classes.length; ++i){\r\n            group = classes[i];\r\n            if (group && group.search(/^gr\\d/)==0)\r\n                break;\r\n        }\r\n\r\n        let ctxMenu = this.contextMenu,//$('.mf_group_menu'),\r\n        evnt = e;\r\n        if (_cp1)\r\n            _cp1.remove();\r\n        if (_cp2)\r\n            _cp2.remove();   \r\n        if (_cp3)\r\n            _cp3.remove();           \r\n        ctxMenu.html('');\r\n        let colorChangeHandler = function(c, cs){\r\n            _groupStyleChanged = true;            \r\n            cs.style.backgroundColor = \"#\" + c;\r\n            let c1 = cp1.style.backgroundColor,\r\n            c2 = cp2.style.backgroundColor,\r\n            c3 = cp3.style.backgroundColor;\r\n            _onChangeGroupStyle(group, {\r\n                marker_style: c1.substr(0,3)==\"rgb\" ? nsGmx.Utils.rgb2hex(c1) : c1,\r\n                label_color: c2.substr(0,3)==\"rgb\" ? nsGmx.Utils.rgb2hex(c2) : c2,\r\n                label_shadow: c3.substr(0,3)==\"rgb\" ? nsGmx.Utils.rgb2hex(c3) : c3 \r\n            })\r\n        },\r\n        colors = _onGroupMenuShow(group),\r\n        cp1 = nsGmx.Controls.createColorPicker(colors.marker_style, ()=>{}, ()=>{}, (c1, c2, c3)=>{colorChangeHandler(c2, cp1)}),\r\n        cp2 = nsGmx.Controls.createColorPicker(colors.label_color, ()=>{}, ()=>{}, (c1, c2, c3)=>{colorChangeHandler(c2, cp2)}),\r\n        cp3 = nsGmx.Controls.createColorPicker(colors.label_shadow, ()=>{}, ()=>{}, (c1, c2, c3)=>{colorChangeHandler(c2, cp3)});\r\n        _cp1 = document.querySelector(\"#\"+$(cp1).data('colorpickerId'));\r\n        _cp2 = document.querySelector(\"#\"+$(cp2).data('colorpickerId'));\r\n        _cp3 = document.querySelector(\"#\"+$(cp3).data('colorpickerId'));\r\n        $(_cp1).on('mouseleave', (e)=>{if(!e.relatedTarget || !e.relatedTarget.closest('.mf_group_menu')) _hideContextMenu.call(this, e); $(cp1).ColorPickerHide()});\r\n        $(_cp2).on('mouseleave', (e)=>{if(!e.relatedTarget || !e.relatedTarget.closest('.mf_group_menu')) _hideContextMenu.call(this, e); $(cp2).ColorPickerHide()});\r\n        $(_cp3).on('mouseleave', (e)=>{if(!e.relatedTarget || !e.relatedTarget.closest('.mf_group_menu')) _hideContextMenu.call(this, e); $(cp3).ColorPickerHide()});\r\n        cp1.title = \"\";\r\n        cp2.title = \"\";\r\n        cp3.title = \"\";\r\n        let div = $('<div class=\"command marker_color\"></div>');         \r\n        ctxMenu.append(div.append(cp1).append(\"<span>\"+_gtxt(\"AISSearch2.markerShadow\")+\"</span>\"));\r\n        div = $('<div class=\"command label_color\"></div>');         \r\n        ctxMenu.append(div.append(cp2).append(\"<span>\"+_gtxt('AISSearch2.labelColor')+\"</span>\"));\r\n        div = $('<div class=\"command label_shadow\"></div>');         \r\n        ctxMenu.append(div.append(cp3).append(\"<span>\"+_gtxt('AISSearch2.labelShadow')+\"</span>\"));\r\n        ctxMenu.append('<div class=\"command remove\">' + _gtxt(\"AISSearch2.DeleteGroupCommand\") + '</div>');\r\n        \r\n        $(cp1).on('click', e=>$(_cp1).offset({left:$('.colorpicker:visible').offset().left+20}));       \r\n        $(cp2).on('click', e=>$(_cp2).offset({left:$('.colorpicker:visible').offset().left+20}));       \r\n        $(cp3).on('click', e=>$(_cp3).offset({left:$('.colorpicker:visible').offset().left+20}));\r\n        ctxMenu.find('.command.marker_color').on(\"click\",(e)=>{            \r\n            $(cp1).click();\r\n        })\r\n        ctxMenu.find('.command.label_color').on(\"click\",(e)=>{             \r\n            $(cp2).click();\r\n        })\r\n        ctxMenu.find('.command.label_shadow').on(\"click\",(e)=>{             \r\n            $(cp3).click();\r\n        })\r\n        \r\n        if (e.currentTarget.querySelector(\".delete\")) {\r\n            ctxMenu.find('.command.remove').show().on(\"click\", (e) => {\r\n                _onDeleteGroup(evnt.currentTarget.querySelector('.title').innerText);\r\n                ctxMenu.hide();\r\n            })\r\n        }\r\n        else{\r\n            ctxMenu.find('.command.remove').hide();\r\n        }\r\n        ctxMenu.show();\r\n        ctxMenu[0].style.left = (e.clientX - 10) + \"px\";\r\n        if ((e.clientY - 10 + ctxMenu[0].offsetHeight) < window.innerHeight) {\r\n            ctxMenu[0].style.top = (e.clientY - 10) + \"px\";\r\n            ctxMenu[0].style.bottom = \"\";//\"auto\";\r\n        }\r\n        else {  \r\n            ctxMenu[0].style.bottom = (window.innerHeight - e.clientY - 10) + \"px\";\r\n            ctxMenu[0].style.top = \"\";//\"auto\";\r\n        }\r\n    }).bind(this));\r\n\r\n    this.frame.find('.results .upout').off(\"click\").on(\"click\", (e=>{\r\n        let arrow = e.currentTarget,\r\n            title = arrow.closest('.results').querySelector('.title').innerText,\r\n            cl = arrow.classList,\r\n            vessels = arrow.closest('.mf_group').querySelectorAll('.ais_vessel');\r\n        if (cl.contains('icon-down-open')){\r\n            cl.remove('icon-down-open');\r\n            cl.add('icon-right-open');\r\n            vessels.forEach(v=>v.style.display='none');\r\n            _rolledupGroups[title] = true;\r\n        }\r\n        else{\r\n            cl.add('icon-down-open');\r\n            cl.remove('icon-right-open');\r\n            vessels.forEach(v=>v.style.display='block');\r\n            delete(_rolledupGroups[title]);\r\n        }\r\n//console.log(_rolledupGroups)\r\n    }).bind(this))    \r\n    .each((i,el)=>{\r\n        let title = el.closest('.results').querySelector('.title').innerText;\r\n        if (_rolledupGroups[title]){\r\n            el.classList.remove('icon-right-open');\r\n            el.classList.add('icon-down-open');\r\n            el.click();            \r\n        }\r\n    });\r\n    _rolledupGroups = {};\r\n    this.frame.find('.results .icon-right-open').each((i, el) => {\r\n        _rolledupGroups[el.closest('.results').querySelector('.title').innerText] = true;\r\n    })\r\n\r\n    this.frame.find('.results .delete')\r\n    .off(\"click\").on(\"click\", (e=>{\r\n        _onDeleteGroup(e.currentTarget.closest('.results').querySelector('.title').innerText);\r\n    }).bind(this));\r\n},\r\n_onSaveGroupStyle,\r\n_groupStyleChanged,\r\n_saveStylePromise = Promise.resolve(0),\r\n_hideContextMenu = function (e){\r\n    this.contextMenu.hide();\r\n    //if (e.currentTarget.querySelector('.colorSelector') || e.currentTarget.classList.contains('colorpicker'))\r\n    if (_groupStyleChanged){\r\n        _groupStyleChanged = false;\r\n        _saveStylePromise = _saveStylePromise.then(_onSaveGroupStyle);\r\n    }\r\n};\r\n\r\nconst GroupList = function (frame) {\r\n    this.frame = frame;\r\n       \r\n    // context menu\r\n    this.contextMenu = $('<div class=\"mf_group_menu\"></div>')\r\n    .on('mouseleave', (e=>{\r\n        if(!e.relatedTarget || !e.relatedTarget.closest('.colorpicker')){\r\n            _hideContextMenu.call(this, e);\r\n            $('.colorpicker:visible').hide();\r\n        }\r\n    }).bind(this));\r\n    $('body').append(this.contextMenu); \r\n\r\n    this.repaint = function(){\r\n        _setCheckBoxes.call(this);\r\n        _setGroupCommands.call(this);\r\n\r\n        // exclude memeber control\r\n        this.frame.find('.ais_vessel .exclude').each((i, elm)=>{\r\n            $(elm).on('click', (ev)=>{\r\n                $(elm).off('click');\r\n                _onExcludeItem(ev, elm.closest('.ais_vessel').querySelector('.mmsi').innerText, i);\r\n            })\r\n        });\r\n\r\n        // memeber visibility control\r\n        this.frame.find('.ais_vessel input[type=\"checkbox\"]').each(((i, elm)=>{\r\n            $(elm).off('click').on('click', (e => {\r\n                e.stopPropagation();\r\n                let filtered = _getFiltered.call(this);\r\n                _onCheckItem(filtered);\r\n            }).bind(this));\r\n        }).bind(this));  \r\n        \r\n        // context menu event handler\r\n        this.frame.find('.ais_vessel').off(\"contextmenu\").on(\"contextmenu\", (e=>{\r\n            e.preventDefault();\r\n            let mmsi = e.currentTarget.querySelector('.mmsi'),\r\n            ctxMenu = this.contextMenu,//$('.mf_group_menu'),\r\n            groupblock = e.currentTarget.closest('.mf_group'),\r\n            group = groupblock.querySelector('.results .title').innerText,\r\n            groups = this.frame.find('.results .title'),\r\n            template = '';\r\n            if (groups.length==1)\r\n                return;\r\n\r\n            groups.each((i,g)=>{\r\n                if (i>0 && g.innerText!=group)\r\n                    template += ('<div class=\"command\">' + g.innerText + '</div>');\r\n            });\r\n            if (template!='')\r\n                template = ('<div>' + _gtxt(\"AISSearch2.AddIntoGroup\") + '</div>') + template;\r\n            if (groupblock.previousSibling){\r\n                if (template!='')\r\n                    template += ('<div class=\"command remove\">' + _gtxt(\"AISSearch2.RemoveFromGroup\") + '</div>');\r\n                else\r\n                    template += ('<div class=\"command remove lonely\">' + _gtxt(\"AISSearch2.RemoveFromGroup\") + '</div>');\r\n            }\r\n            ctxMenu.html(template);\r\n            \r\n            ctxMenu.find('.command').on(\"click\",(e)=>{\r\n                if(!e.currentTarget.classList.contains('remove'))\r\n                    _onChangeGroup(mmsi.innerText, e.currentTarget.innerText);\r\n                else\r\n                    _onChangeGroup(mmsi.innerText, null);                \r\n                ctxMenu.hide();\r\n            });\r\n            ctxMenu.show();\r\n            ctxMenu[0].style.left = (e.clientX - 10) + \"px\";\r\n            if ((e.clientY - 10 + ctxMenu[0].offsetHeight) < window.innerHeight) {\r\n                ctxMenu[0].style.top = (e.clientY - 10) + \"px\";\r\n                ctxMenu[0].style.bottom = \"\";//\"auto\";\r\n            }\r\n            else {  \r\n                ctxMenu[0].style.bottom = (window.innerHeight - e.clientY - 10) + \"px\";\r\n                ctxMenu[0].style.top = \"\";//\"auto\";\r\n            }\r\n        }).bind(this));       \r\n    };\r\n\r\n    // events\r\n    Object.defineProperty(this, \"onChangeGroup\", {\r\n        set: function (callback) {\r\n            _onChangeGroup = callback;\r\n        }\r\n    });\r\n    Object.defineProperty(this, \"onDeleteGroup\", {\r\n        set: function (callback) {\r\n            _onDeleteGroup = callback;\r\n        }\r\n    });\r\n    Object.defineProperty(this, \"onRepaintItem\", {\r\n        set: function (callback){\r\n            _onRepaintItemHandler = callback;\r\n        }\r\n    }); \r\n    Object.defineProperty(this, \"onCheckItem\", {\r\n        set: function (callback){\r\n            _onCheckItem = callback;\r\n        }\r\n    }); \r\n    Object.defineProperty(this, \"onExcludeItem\", {\r\n        set: function (callback){\r\n            _onExcludeItem = callback;\r\n        }\r\n    }); \r\n    Object.defineProperty(this, \"onGroupMenuShow\", {\r\n        set: function (callback){\r\n            _onGroupMenuShow = callback;\r\n        }\r\n    }); \r\n    Object.defineProperty(this, \"onChangeGroupStyle\", {\r\n        set: function (callback){\r\n            _onChangeGroupStyle = callback;\r\n        }\r\n    }); \r\n    Object.defineProperty(this, \"onSaveGroupStyle\", {\r\n        set: function (callback){\r\n            _onSaveGroupStyle = callback;\r\n        }\r\n    }); \r\n      \r\n    // template\r\n    this.toString = function () {\r\n        return '{{#each groups}}' + GroupWidget.prototype.toString.call() + '{{/each}}' +\r\n            '{{#each msg}}<div class=\"msg\">{{txt}}</div>{{/each}}';\r\n    } \r\n}\r\n\r\nGroupList.prototype.appendGroup = function(group, index){\r\n    this.frame.find('.mf_group').eq(0).parent().append(Handlebars.compile(GroupWidget.prototype.toString.call().replace(/\\{\\{@index\\}\\}/, index))(group));    \r\n    _setGroupCommands.call(this);\r\n}\r\n\r\nmodule.exports = GroupList;\n\n\n// WEBPACK FOOTER //\n// ./src/Controls/GroupList.js","const GroupWidget = function (title){\r\n    \r\n}\r\n\r\nGroupWidget.prototype.toString = function () {\r\n    return '<div class=\"mf_group\">' +\r\n    '<table class=\"results gr{{@index}}\"><tr>'+\r\n    '<td><input type=\"checkbox\" checked><div class=\"upout clicable ui-helper-noselect icon-down-open\" style=\"float: right;\"></div></td>' +\r\n    '<td><span class=\"title\">{{title}}</span></td>' +\r\n    '<td class=\"count\">{{vessels.length}}</td>' +    \r\n    '<td>' +\r\n    '{{#unless default}}' +\r\n    '<img class=\"delete clicable\" title=\"{{i \"AISSearch2.DeleteGroup\"}}\" src=\"plugins/AIS/AISSearch/svg/delete.svg\">' +\r\n    '</td>' +\r\n    '{{/unless}}' +\r\n    '</tr></table>'+\r\n    '{{#each vessels}}' +\r\n    //'{{#unless foovessel}}' +\r\n    '<div class=\"ais_vessel\">' +\r\n    '<table border=0><tr>' +\r\n    '<td><input type=\"checkbox\" checked></td>' +\r\n    '<td><div class=\"position\">{{vessel_name}}</div><div>mmsi: <span class=\"mmsi\">{{mmsi}}</span> imo: <span class=\"imo\">{{imo}}</span></div></td>' +\r\n    '<td><img src=\"{{icon}}\" class=\"course rotateimg{{icon_rot}} legend_icon\"><img src=\"{{iconAlt}}\" class=\"course rotateimg{{icon_rot}} legend_iconalt\">' +\r\n    '<div class=\"info\" vessel=\"{{aisjson this}}\" title=\"{{i \"AISSearch2.info\"}}\">' +\r\n    '<img src=\"plugins/AIS/AISSearch/svg/info.svg\"></div>' +\r\n    '</td>' +\r\n    '<td>' +\r\n    '<div class=\"ais_info_dialog_close-button exclude\" title=\"{{i \"AISSearch2.vesselExclude\"}}\"></div>' +\r\n    '<span class=\"date\">{{dt_pos_utc}}</span></td>' +\r\n    '</tr></table>' +\r\n    '</div>' +\r\n    //'{{/unless}}' +\r\n    '{{/each}}</div>';\r\n}\r\n\r\nmodule.exports = GroupWidget;\n\n\n// WEBPACK FOOTER //\n// ./src/Controls/GroupWidget.js","const Polyfill = require('../Polyfill');\r\nlet emptyGroup = function(title, isDefault, id, style, updateTemplate){\r\n    let ms = \"#ffff00\",\r\n    lsc = \"#ffff00\",\r\n    ls = {\"color\":\"#ffff00\",\"text_shadow\": \"-1px -1px 0 #ffff00, 0px -1px 0 #ffff00, 1px -1px 0 #ffff00, -1px  0px 0 #ffff00, 1px  0px 0 #ffff00, -1px  1px 0 #ffff00, 0px  1px 0 #ffff00, 1px  1px 0 #ffff00\"},\r\n    eg = {\r\n    title: title,\r\n    vessels: [],\r\n    get marker_style(){return ms}, \r\n    set marker_style(c){ms = c},\r\n    //label_shadow:\"color:black;-webkit-text-stroke:1px yellow;\"\r\n    label_color: \"#000000\",\r\n    get label_shadow_color(){return lsc},\r\n    get label_shadow(){return ls},\r\n    set label_shadow(c){ \r\n        lsc = c;\r\n        ls = {\"color\": c, \"text_shadow\": \"-1px -1px 0 \" + c + \", 0px -1px 0 \" + c + \", 1px -1px 0 \" + c + \", -1px  0px 0 \" + c + \", 1px  0px 0 \" + c + \", -1px  1px 0 \" + c + \", 0px  1px 0 \" + c + \", 1px  1px 0 \" + c + \"\"}\r\n    }\r\n    };\r\n    if (isDefault) eg.default = true;\r\n    if (style)\r\n    {\r\n        style = JSON.parse(style);\r\n        eg.marker_style = style.ms;\r\n        eg.label_color = style.lc;\r\n        eg.label_shadow = style.lsc;\r\n        if (isDefault && style.mt && updateTemplate)\r\n            _markerTemplate = style.mt;\r\n    }\r\n    eg.id = id;\r\n    return eg;\r\n}\r\n\r\nconst VesselData = function () {\r\n    this.groups = []\r\n};\r\n\r\nlet _tools,\r\n_trackLoaders = [],\r\n_isDirty = true,\r\n_myFleetLayers = [],\r\n_defaultGroup = _gtxt(\"AISSearch2.AllGroup\"),\r\n_vessels = [],\r\n_mapID,\r\n_modulePath,\r\n_prepared,\r\n_actualUpdate,\r\n_markerTemplate = '<div><table><tr>' +\r\n'<td style=\"vertical-align:top\">' +\r\n//'<svg width=\"12\" height=\"11\" fill=\"#00f\" style=\"{{marker_style}}\" viewBox=\"0 0 260 245\"><use xlink:href=\"#mf_label_icon\"/></svg>' +\r\n'{{{marker}}}' +\r\n'</td><td>{{{foo}}}</td></tr></table></div>',\r\n_data,\r\n_view,\r\n_aisLayerSearcher,\r\n_onChangedHandlers = [],\r\n_fireChanged = function(){ _onChangedHandlers.forEach(h=>h()); },\r\n_loadVoyageInfo = function (vessels) {   \r\n    return new Promise(function (resolve, reject) {\r\n        if (!vessels.length){\r\n            reject();\r\n            return;\r\n        }\r\n\r\n        let data;\r\n        if (Polyfill.findIndex(vessels, v=>v.mmsi || v.imo)<0){\r\n            data = _parseVoyageInfo({Result:{fields:[], values:[]}}, vessels); \r\n            resolve(data);\r\n        } \r\n        else\r\n            _aisLayerSearcher.searchNames(\r\n                vessels,\r\n                function (response) {\r\n                    if (response.Status && response.Status.toLowerCase() == \"ok\") {\r\n                        data = _parseVoyageInfo(response, vessels);\r\n                        resolve(data);\r\n                    }\r\n                    else {\r\n                        reject(response);\r\n                    }\r\n                });\r\n    });\r\n},\r\n_compareGroups = function(l, r){\r\n    if (l.default)\r\n        return -1;\r\n    if (r.default)\r\n        return 1;        \r\n    if (l.id<r.id)\r\n        return -1;\r\n    if (l.id>r.id)\r\n        return 1;        \r\n    return 0;\r\n},\r\n_parseVoyageInfo = function (response, vessels) {\r\n        let mmsi = response.Result.fields.indexOf(\"mmsi\"),\r\n            vessel_name = response.Result.fields.indexOf(\"vessel_name\"),\r\n            ts_pos_utc = response.Result.fields.indexOf(\"ts_pos_utc\"),\r\n            imo = response.Result.fields.indexOf(\"imo\"),\r\n            lat = response.Result.fields.indexOf(\"longitude\"),\r\n            lon = response.Result.fields.indexOf(\"latitude\"),\r\n            vt = response.Result.fields.indexOf(\"vessel_type\"),\r\n            cog = response.Result.fields.indexOf(\"cog\"),\r\n            sog = response.Result.fields.indexOf(\"sog\"),\r\n            data,\r\n            eg;\r\n        if (_data){ // _data.groups.length>1 || _data.groups[0].vessels_length>0\r\n            data = _data;\r\n            data.groups.forEach(g=>g.vessels.length=0);\r\n        }\r\n        else{\r\n            data = new VesselData();\r\n            vessels.forEach(v=>{\r\n                if (!v.mmsi && !v.imo){\r\n                    if (v.group)\r\n                        eg = emptyGroup(v.group, false, v.gmx_id, v.style, true);\r\n                    else\r\n                        eg = emptyGroup(_defaultGroup, true, v.gmx_id, v.style, true);\r\n                    data.groups.push(eg);\r\n                }\r\n            });\r\n            data.groups.sort(_compareGroups);\r\n//console.log(data);\r\n        }\r\n        response.Result.values.forEach(c => {\r\n            let d = new Date(c[ts_pos_utc] * 1000),\r\n                member = {\r\n                    vessel_name: c[vessel_name], mmsi: c[mmsi], imo: c[imo],\r\n                    ts_pos_utc: _aisLayerSearcher.formatDateTime(d), dt_pos_utc: _aisLayerSearcher.formatDate(d),\r\n                    ts_pos_org: c[ts_pos_utc],\r\n                    xmin: c[lat], xmax: c[lat], ymin: c[lon], ymax: c[lon],\r\n                    vessel_type: c[vt], cog: c[cog], sog: c[sog]\r\n                };\r\n            member.icon_rot = Math.round(member.cog / 15) * 15;\r\n            _aisLayerSearcher.placeVesselTypeIcon(member);\r\n\r\n            let i = Polyfill.findIndex(vessels, function (v) {\r\n                return v.mmsi == member.mmsi;\r\n            }),\r\n                gn = i<0 ? \"\" : (!vessels[i].group ? _defaultGroup : vessels[i].group);\r\n            if (gn != \"\") {\r\n                i = Polyfill.findIndex(data.groups, function (g) {\r\n                    return g.title == gn;\r\n                });\r\n                data.groups[i].vessels.push(member);\r\n            }\r\n        });\r\n\r\n        //thisInst.data.vessels.sort(function (a, b) { return +(a.vessel_name > b.vessel_name) || +(a.vessel_name === b.vessel_name) - 1; })\r\n//console.log(\"PARSE VI \" + data.groups.reduce((p,c)=>p+c.vessels.length, 0))\r\n        return data;\r\n},\r\n_persistGroupsLook = function(count, groups){\r\n    return new Promise((resolve, reject)=>{\r\n        let temp = [], style;\r\n        for (let i=0; i<groups.length; ++i){\r\n            style = {ms: groups[i].marker_style, lc: groups[i].label_color, lsc: groups[i].label_shadow_color};\r\n            if(groups[i].default)\r\n                style.mt = _markerTemplate;\r\n            temp.push({\r\n                properties:{style:JSON.stringify(style)}, \r\n                id:groups[i].id, action:\"update\"\r\n            });\r\n        }\r\n        if (!FormData.prototype.set) { \r\n            sendCrossDomainJSONRequest(_aisLayerSearcher.baseUrl +\r\n                'VectorLayer/ModifyVectorObjects.ashx?LayerName=' + _myFleetLayers[0] +\r\n                '&objects=' + encodeURIComponent(JSON.stringify(temp)),\r\n                function (r) {\r\n                    if (!r.Status || r.Status.toLowerCase() != \"ok\")\r\n                        console.log(r);\r\n                    resolve(count + 1);\r\n                }\r\n            );                    \r\n        }\r\n        else {\r\n            let form = new FormData();\r\n            form.set('WrapStyle', 'none');\r\n            form.set('LayerName', _myFleetLayers[0]);\r\n            form.set('objects', JSON.stringify(temp));\r\n            fetch(_aisLayerSearcher.baseUrl + 'VectorLayer/ModifyVectorObjects.ashx', {\r\n                credentials: 'include',\r\n                method: \"POST\",\r\n                body: form\r\n            })\r\n                .then((r) => r.json())\r\n                .then((r) => {\r\n                    if (!r.Status || r.Status.toLowerCase() != \"ok\")\r\n                        console.log(r);\r\n                    resolve(count + 1);\r\n                })\r\n                .catch(err => {\r\n                    console.log(err);\r\n                    resolve(count + 1);\r\n                });\r\n        }                 \r\n    });\r\n    } \r\n;\r\n\r\nmodule.exports = function ({aisLayerSearcher, toolbox, modulePath}) {    \r\n    _modulePath = modulePath;\r\n    _tools = toolbox;\r\n    _aisLayerSearcher = aisLayerSearcher;\r\n    _mapID = String($(_queryMapLayers.buildedTree).find(\"[MapID]\")[0].gmxProperties.properties.MapID);\r\n    let addGroupField = function(lid, resolve, reject, vessels){\r\nconsole.log(\"add group and style field\");\r\n        sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl + 'VectorLayer/Update.ashx?VectorLayerID=' + lid +\r\n            '&columns=[{\"Name\":\"mmsi\",\"OldName\":\"mmsi\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"mmsi\\\\\"\"},{\"Name\":\"imo\",\"OldName\":\"imo\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"imo\\\\\"\"},{\"Name\":\"gmx_id\",\"OldName\":\"gmx_id\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":true,\"IsIdentity\":true,\"IsComputed\":false,\"expression\":\"\\\\\"gmx_id\\\\\"\"},{\"Name\":\"group\",\"OldName\":\"group\",\"ColumnSimpleType\":\"String\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"group\\\\\"\"},{\"Name\":\"style\",\"ColumnSimpleType\":\"String\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"style\\\\\"\"}]',\r\n            function (response) {\r\n                if (response.Status.toLowerCase() == \"ok\")\r\n                    setTimeout(function run() {\r\n                        sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                            \"AsyncTask.ashx?TaskID=\" + response.Result.TaskID, function (response) {\r\n                                if (response.Status.toLowerCase() == \"ok\")\r\n                                    if (!response.Result.Completed)\r\n                                        setTimeout(run, 1000);\r\n                                    else {\r\n                                        if(response.Result.ErorInfo)\r\n                                            reject(response);\r\n                                        else\r\n                                            resolve(vessels);\r\n                                    }\r\n                                else \r\n                                    reject(response);\r\n                            });\r\n                    }, 1000);\r\n            });\r\n        },  \r\n        addDefaultGroup = function(resolve, reject, vessels){\r\n            sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                'VectorLayer/ModifyVectorObjects.ashx?LayerName=' + _myFleetLayers[0] +\r\n                '&objects=[{\"properties\":{\"group\": null},\"action\":\"insert\"}]',\r\n                function (response) {\r\n                    if (response.Status.toLowerCase() == \"ok\") {                           \r\n                        sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                            'VectorLayer/Search.ashx?layer=' + _myFleetLayers[0] +\r\n                            '&query=\"group\" is null and \"mmsi\" is null and \"imo\" is null',\r\n                            function (response) {                                          \r\n                                if (response.Status.toLowerCase() == \"ok\" && response.Result.values && response.Result.values.length>0) {\r\n                                    let f = response.Result.fields, v = response.Result.values;  \r\n                                    console.log(\"insert def group\");\r\n                                    vessels.push({imo:null, mmsi:null, group:null, gmx_id:v[0][f.indexOf('gmx_id')]});\r\n                                    resolve(vessels);\r\n                                }\r\n                                else\r\n                                    reject(response);\r\n                            })\r\n                    }\r\n                    else\r\n                        reject(response);\r\n                }\r\n            ); \r\n        },\r\n        fetchMyFleet = function (lid) {\r\n            return new Promise(function (resolve, reject) {\r\n                sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl + \"VectorLayer/Search.ashx?layer=\" + lid,\r\n                    function (response) {\r\n                        if (response.Status.toLowerCase() == \"ok\") {\r\n                            let v = response.Result.values,\r\n                                f = response.Result.fields,\r\n                                vessels = [];\r\n                            for (let i = 0; i < v.length; ++i) {\r\n                                vessels.push({})\r\n                                for (let j = 0; j < f.length; ++j){\r\n                                    vessels[i][f[j]] = v[i][j];\r\n                                }\r\n                            }\r\n\r\n                            new Promise((rs, rj)=>{\r\n                                if (f.indexOf('group')<0 || f.indexOf('style')<0)\r\n                                    addGroupField(lid, rs, rj, vessels);\r\n                                else \r\n                                    rs();\r\n                            }).then(()=>{\r\n                                if (Polyfill.findIndex(vessels, v=>!v.imo&&!v.mmsi&&!v.group)<0)\r\n                                    addDefaultGroup(resolve, reject, vessels);\r\n                                else\r\n                                    resolve(vessels);\r\n                            },  r=>reject(r));\r\n                        }\r\n                        else\r\n                            reject(response);\r\n                    });\r\n            })\r\n        };\r\n\r\n    _prepared = new Promise((resolve, reject) => {\r\n        sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n            \"User/GetUserInfo.ashx\",\r\n            function (response) {\r\n                if (response.Status.toLowerCase() == \"ok\" && response.Result)\r\n                    resolve(response);\r\n                if (response.Status.toLowerCase() == \"ok\" && !response.Result)\r\n                    reject({Status:\"auth\"});\r\n                else\r\n                    reject(response);\r\n            });\r\n    })\r\n    .then((response) => {\r\n            let nickname = response.Result.Nickname;\r\n            return new Promise((resolve, reject) => {\t\t\t\t\r\n                if ((nickname == 'scf_captain' || nickname == 'scf_captain2020' || nickname == 'scf_master2020')\r\n                 && _mapID=='KGEJB')\r\n\t\t\t\t\tresolve({Status:\"ok\", Result:{count:1, layers:[{LayerID:\"0A5CE9C59487441689ABF3031991BF2F\"}]}});\r\n\t\t\t\telse\r\n                    sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                        \"Layer/Search2.ashx?page=0&pageSize=50&orderby=title &query=([Title]='myfleet\" + _mapID + \"' and [OwnerNickname]='\" + nickname + \"')\",\r\n                        function (response) {\r\n                            if (response.Status.toLowerCase() == \"ok\" && response.Result.count > 0)\r\n                                resolve(response);\r\n                            else \r\n                                reject(response); // no my fleet layer\r\n                        });\r\n            });\r\n    })\r\n    .then((response) => {\r\n            let lid = response.Result.layers[0].LayerID;\r\n            _myFleetLayers.push(lid);\r\n            return fetchMyFleet(lid)\r\n        }\r\n        ,(rejectedResponse) => {\r\n            if (rejectedResponse.Status && rejectedResponse.Status.toLowerCase() == \"ok\")\r\n                return Promise.resolve([]); // no mf layer\r\n            else\r\n                return Promise.reject(rejectedResponse); // smth wrong\r\n        }\r\n    )\r\n    .then((vessels=>{\r\n//console.log('INIT REPAINT MAP')\r\n        _vessels = vessels.map(v=>v);\r\n        _tools.specialVesselFilters = {key: \"drawMarker\", value: (args, ai, displayed)=>{          \r\n            let vessel = Polyfill.find(_vessels, v=>{\r\n                return v.mmsi && v.mmsi==args.properties[ai.mmsi];\r\n            })\r\n            if (vessel){\r\n                let group = Polyfill.find(_vessels, v=>(!v.mmsi && !v.imo && v.group==vessel.group));\r\n                if (vessel.group)\r\n                    group = emptyGroup(vessel.group, false, group.gmx_id, group.style);\r\n                else\r\n                    group = emptyGroup(_defaultGroup, true, group.gmx_id, group.style);\r\n                _tools.drawMyFleetMarker(args, _markerTemplate, group, ai, \r\n                    (displayed==\"all\" || displayed.indexOf(vessel.mmsi.toString())>=0) && _view.notDisplayed.indexOf(vessel.mmsi.toString())<0);\r\n            }\r\n        }}\r\n        // _repaintMap(vessels); // only on init\r\n        return Promise.resolve();\r\n    }).bind(this));\r\n\r\n    return {\r\n        get isDirty() { return _isDirty; },\r\n        set isDirty(value) { _isDirty = value; },\r\n        get data() { return _data; },\r\n        set data(value) { _data = value; },\r\n        get view() { return _view; },\r\n        set view(value) { _view = value; },\r\n        get vessels(){\r\n            let myfleet = _data.groups.reduce((p, c) => {\r\n                c.vessels.forEach(v=>{if(v.mmsi)p.push({mmsi:v.mmsi, imo:v.imo})});\r\n                return p;\r\n            }, []);\r\n            return myfleet;\r\n        },\r\n        findIndex: function (vessel) {\r\n            if (_vessels.length == 0)\r\n                return -1;\r\n            return Polyfill.findIndex(_vessels, function (v) {\r\n                return v.mmsi == vessel.mmsi && v.imo == vessel.imo;\r\n            })\r\n        },\r\n        load: function (actualUpdate) {\r\n            var thisInst = this;\r\n            return _prepared.then(()=>{\r\n                if (_myFleetLayers.length == 0 || !thisInst.isDirty)\r\n                    return Promise.resolve();\r\n\r\n                return fetchMyFleet(_myFleetLayers[0]) \r\n                    .then(vessels=>{\r\n                        _vessels = vessels;\r\n                        return _loadVoyageInfo(vessels);\r\n                    })\r\n                    .then(data=>{\r\n                        _data=data;\r\n                        _isDirty = false;\r\n                        return Promise.resolve();\r\n                    })\r\n                    .catch(error=>{\r\n                        _isDirty = false;\r\n                        return Promise.reject(error);\r\n                    });\r\n            });\r\n        },\r\n        update: function () {\r\n\r\n            //if (!this.isDirty)\r\n            //    return;\r\n\r\n            _actualUpdate = new Date().getTime();\r\n            let thisModel = this,\r\n                actualUpdate = _actualUpdate;\r\n            this.view.inProgress(true);\r\n            this.load(actualUpdate).then(\r\n                function () {\r\nconsole.log('UPDATE')\r\n                    if (_actualUpdate == actualUpdate) {\r\n                        thisModel.view.inProgress(false);\r\n                        if (_data)\r\n                            thisModel.view.repaint();\r\n                    }\r\n                }, \r\n                function (json) {\r\n                    thisModel.dataSrc = null;\r\n                    if ((json.Status && json.Status.toLowerCase() == \"auth\") ||\r\n                        (json.ErrorInfo && json.ErrorInfo.some && json.ErrorInfo.some(function (r) { return r.Status.toLowerCase() == \"auth\" })))\r\n                        thisModel.data = { msg: [{ txt: _gtxt(\"AISSearch2.auth\") }], groups: [] };\r\n                    else {\r\n                        //thisModel.data = {msg:[{txt:\"!!!\"}], vessels:[]};\r\n                        console.log(json);\r\n                    }\r\n                    thisModel.view.inProgress(false);\r\n                    thisModel.view.repaint();\r\n                });\r\n        },\r\n        get markerTemplate(){\r\n            return _markerTemplate;\r\n        },\r\n        set markerTemplate(v){_markerTemplate = v;},\r\n        markMembers: function (vessels) {\r\n            if (this.data && this.data.groups){\r\n                let membCounter = 0;\r\n                this.data.groups.forEach(function (g) {\r\n                    g.vessels.forEach(function (v) {\r\n                        let i = Polyfill.findIndex(vessels, function (vv) { return v.mmsi == vv.mmsi && v.imo == v.imo });\r\n                        if (i>-1){\r\n                            let member = vessels[i]\r\n                            member.mf_member = \"visibilty:visible\";\r\n                            vessels.splice(i, 1);\r\n                            vessels.splice(membCounter++, 0, member);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        },\r\n        createGroup: function(name){\r\n            if (!_myFleetLayers.length)\r\n                return Promise.reject({Status:\"error\", ErrorInfo:\"no data\"});\r\n\r\n            return new Promise((resolve, reject)=>{\r\n                sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                    'VectorLayer/ModifyVectorObjects.ashx?LayerName=' + _myFleetLayers[0] +\r\n                    '&objects=[{\"properties\":{ \"group\": \"' + name.replace(/\"/g, '\\\\\\\"') + '\"},\"action\":\"insert\"}]',\r\n                    function (response) {\r\n                        if (response.Status.toLowerCase() == \"ok\") {                           \r\n                            sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                                'VectorLayer/Search.ashx?layer=' + _myFleetLayers[0] +\r\n                                '&query=\"group\"=\\'' + name.replace(/'/g, \"''\") + '\\'',\r\n                                function (response) {                                          \r\n                                    if (response.Status.toLowerCase() == \"ok\" && response.Result.values && response.Result.values.length>0) {\r\n                                        let f = response.Result.fields, v = response.Result.values;  \r\n                                        let group = emptyGroup(name, false, v[0][f.indexOf('gmx_id')]);\r\n                                        _data.groups.push(group);\r\n                                        _vessels.push({gmx_id: v[0][f.indexOf('gmx_id')], mmsi:null, imo:null, group:name})\r\n                                        resolve(group);\r\n                                    }\r\n                                    else\r\n                                        reject(response);\r\n                                })\r\n                        }\r\n                        else\r\n                            reject(response);\r\n                    }\r\n                ); \r\n            });\r\n        },\r\n        deleteGroup: function(group){\r\n            let objects = [], thisModel = this, i, j=-1;\r\n            for (i = 0; i < _vessels.length; ++i) {\r\n                if (_vessels[i].group == group) {\r\n                    if (!_vessels[i].mmsi && !_vessels[i].imo) {\r\n                        j = i;\r\n                        objects.push({ id: _vessels[i].gmx_id, action: \"delete\" });\r\n                    }\r\n                    else {\r\n                        _vessels[i].group = null;\r\n                        objects.push({ properties: _vessels[i], id: _vessels[i].gmx_id, action: \"update\" });\r\n                    }\r\n                }\r\n            }\r\n            if (j<0)\r\n                return;\r\n            i = Polyfill.findIndex(_data.groups, g=>g.id==_vessels[j].gmx_id);\r\n// console.log(i+\", \"+j + \" - \"+ _data.groups[i].id +\" \"+_vessels[j].gmx_id);    \r\n            _data.groups.splice(i, 1);\r\n            _data.groups.sort(_compareGroups);\r\n// console.log(_data.groups)\r\n// console.log(_vessels);            \r\n            _vessels.splice(j, 1);\r\n            sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                'VectorLayer/ModifyVectorObjects.ashx?LayerName=' + _myFleetLayers[0] +\r\n                '&objects=' + JSON.stringify(objects),\r\n                function (response) {\r\n                    if (response.Status.toLowerCase() == \"ok\") {\r\n                        thisModel.isDirty = true;\r\n                        thisModel.update();\r\n                    }\r\n                    else\r\n                        console.log(response);\r\n                }\r\n            ); \r\n        },\r\n        set onChanged(callback){ \r\n            _onChangedHandlers.push(callback) \r\n        },\r\n        changeMembers: function (vessel, infoDialog) {\r\n//console.log(infoDialog)\r\n            var remove = false;\r\n            for (var i = 0; i < _vessels.length; ++i) {\r\n                if (_vessels[i].imo == vessel.imo && _vessels[i].mmsi == vessel.mmsi) {\r\n                    remove = _vessels[i].gmx_id;\r\n                    _vessels.splice(i, 1);\r\n                }\r\n            }\r\n            return new Promise((resolve, reject) => {\r\n                if (!_myFleetLayers.length){\r\n                    sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                        'VectorLayer/CreateVectorLayer.ashx?Title=myfleet' + _mapID + '&geometrytype=point&Columns=' +\r\n                        '[{\"Name\":\"mmsi\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"mmsi\\\\\"\"},{\"Name\":\"imo\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"imo\\\\\"\"},{\"Name\":\"group\",\"ColumnSimpleType\":\"String\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"group\\\\\"\"},{\"Name\":\"style\",\"ColumnSimpleType\":\"String\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"style\\\\\"\"}]',\r\n                        function (response) {\r\n                            if (response.Status.toLowerCase() == \"ok\") {\r\n                                _myFleetLayers.push(response.Result.properties.name);\r\n                                addDefaultGroup(resolve, reject, []);\r\n                            }\r\n                            else\r\n                                reject(response); // creation failed\r\n                        }\r\n                    );\r\n                }\r\n                else\r\n                    resolve();\r\n            })\r\n            .then(()=>{\r\n                return new Promise((resolve, reject) => {\r\n                    if (!remove)\r\n                        sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                            'VectorLayer/ModifyVectorObjects.ashx?LayerName=' + _myFleetLayers[0] +\r\n                            '&objects=[{\"properties\":{ \"imo\": ' + vessel.imo + ', \"mmsi\": ' + vessel.mmsi + '},\"action\":\"insert\"}]',\r\n                            function (response) {\r\n                                if (response.Status.toLowerCase() == \"ok\") {\r\n                                    resolve();\r\n                                    _vessels.push({ \"mmsi\": vessel.mmsi, \"imo\": vessel.imo, \"gmx_id\": response.Result[0] });\r\n                                }\r\n                                else\r\n                                    reject(response);\r\n                            });\r\n                    else\r\n                        sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                            'VectorLayer/ModifyVectorObjects.ashx?LayerName=' + _myFleetLayers[0] +\r\n                            '&objects=[{\"id\":' + remove + ',\"action\":\"delete\"}]',\r\n                            function (response) {\r\n                                if (response.Status.toLowerCase() == \"ok\")\r\n                                    resolve();\r\n                                else\r\n                                    reject(response);\r\n                            });\r\n                })\r\n                .then(\r\n                function () {\r\n                    this.isDirty = true;\r\n                    _fireChanged();\r\n                    return Promise.resolve();\r\n                }.bind(this),\r\n                function (response) {\r\n                    console.log(response);\r\n                    this.isDirty = true;\r\n                    return Promise.resolve();\r\n                }.bind(this))\r\n                .then(\r\n                    function(){\r\n                        if (remove)\r\n                            _tools.removeMyFleetTrack(vessel.mmsi);\r\n                        else\r\n                            this.view.displayTracks && \r\n                            this.loadTrack(vessel.mmsi, infoDialog);\r\n                            \r\n                        return Promise.resolve();                       \r\n                    }.bind(this)\r\n                );\r\n            });\r\n        },\r\n        changeGroup: function(mmsi, group)  {   \r\n            let i=Polyfill.findIndex(_vessels, (v)=>{return v.mmsi==mmsi})\r\n            if (i<0) \r\n                return Promise.reject(mmsi);\r\n            _vessels[i].group = group;\r\n            return new Promise((resolve, reject)=>{\r\n                sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                    'VectorLayer/ModifyVectorObjects.ashx?LayerName=' + _myFleetLayers[0] +\r\n                    '&objects=[' +\r\n                    '{\"properties\":' + JSON.stringify(_vessels[i]) +\r\n                    ',\"id\":' + _vessels[i].gmx_id + ',\"action\":\"update\"}]', (r)=>{\r\n                    if (r.Status && r.Status.toLowerCase()==\"ok\"){\r\n                        let i, j, found = false;\r\n                        for (i=0; i<_data.groups.length; ++i){\r\n                            for (j=0; j<_data.groups[i].vessels.length; ++j){\r\n                                found = _data.groups[i].vessels[j].mmsi==mmsi;\r\n                                if (found) break;\r\n                            }                            \r\n                            if (found) break; \r\n                        } \r\n                        let temp = _data.groups[i].vessels.splice(j, 1)[0];\r\n                        i = !group?0:Polyfill.findIndex(_data.groups, g=>g.title==group)\r\n                        _data.groups[i].vessels.push(temp);\r\n                        resolve(r);\r\n                    }\r\n                    else\r\n                        reject(r);\r\n                });\r\n            });\r\n        },        \r\n        saveLabelSettings: function(count){\r\n            let groups = [];\r\n            for (let i = 0; i < _data.groups.length; ++i) {\r\n                if (_data.groups[i].default){\r\n                    groups.push(_data.groups[i]);\r\n                    break;\r\n                }\r\n            }\r\n            return _persistGroupsLook(count, groups);\r\n        },        \r\n        saveGroupStyle: function(count){\r\n            return _persistGroupsLook(count, _data.groups);\r\n        },\r\n        changeGroupStyle: function(i, colors){\r\n            _data.groups[i].marker_style = colors.marker_style;\r\n            _data.groups[i].label_color = colors.label_color;\r\n            _data.groups[i].label_shadow = colors.label_shadow;\r\n            _tools.highlightMarker(i, this.data.groups[i]);\r\n            \r\n            let g = _data.groups[i],\r\n            group = Polyfill.find(_vessels, v=>(!v.mmsi && !v.imo && v.gmx_id==g.id)),\r\n            style = {ms: g.marker_style, lc: g.label_color, lsc: g.label_shadow_color};\r\n            if(g.default)\r\n                style.mt = _markerTemplate;\r\n            group.style = JSON.stringify(style);\r\n//console.log(group)\r\n//console.log(this.data.groups[i].marker_style)\r\n        },\r\n        loadTrack: function(mmsi, infoDialog){\r\n            if (window.Worker) {\r\n                const baseUrl = window.serverBase.replace(/^(https?:)/, \"$1\"),\r\n                di = _tools.historyInterval,\r\n                interval = {dateBegin: di.get('dateBegin'), dateEnd: di.get('dateEnd')},\r\n                thisView = this.view;\r\n                let counter = _vessels.length;\r\n\r\n                let v = {mmsi: mmsi},\r\n                    myWorker = new Worker(_modulePath + 'LoaderWorker.js');\r\n                    myWorker.postMessage({mmsi:v.mmsi, url:`${baseUrl}plugins/AIS/SearchMfPositionsAsync.ashx?layer=8EE2C7996800458AAF70BABB43321FA4&mmsi=${v.mmsi}&s=${interval.dateBegin.toISOString()}&e=${interval.dateEnd.toISOString()}`});\r\n                    myWorker.onmessage = function(e) {\r\n//console.log('Message received from worker', e.data);\r\n                        _tools.showMyFleetTrack([e.data], ({pid})=>{\r\n                            _aisLayerSearcher.searchById([pid], response=>{\r\n                                if (response.Status && response.Status.toLowerCase()=='ok' && response.Result){\r\n                                    let v={}, res = response.Result;\r\n                                    res.fields.forEach((f, i)=>v[f] = res.values[0][i]);\r\n                                    infoDialog.show(v, false);\r\n                                }\r\n                            })\r\n                        }, _aisLayerSearcher);\r\n                        counter--;\r\n                        if (!counter)\r\n                            thisView.inProgress(false);\r\n                    }                \r\n                    myWorker.onerror = function(e) {\r\n                        console.log(e);\r\n                        counter--;\r\n                        if (!counter)\r\n                            thisView.inProgress(false)\r\n                    }\r\n                    _trackLoaders.push(myWorker);\r\n            }\r\n            else\r\n                console.log(\"NO WORKERS\")\r\n        },\r\n        loadTracks: function(infoDialog, viewState){\r\n            if (window.Worker) {\r\n                _trackLoaders.forEach(w=>w.terminate());\r\n                _trackLoaders.length = 0;   \r\n\r\n                const baseUrl = window.serverBase.replace(/^(https?:)/, \"$1\"),\r\n                di = _tools.historyInterval,\r\n                interval = {dateBegin: di.get('dateBegin'), dateEnd: di.get('dateEnd')},\r\n                thisView = this.view;\r\n//console.log(_vessels, _vessels.length)\r\n                Promise.all(_vessels.map(v=>new Promise((resolve, reject)=>{\r\n                    if (v.mmsi) {\r\n                        var myWorker = new Worker(_modulePath + 'LoaderWorker.js');\r\n                        myWorker.postMessage({mmsi:v.mmsi, imo:v.imo, url:`${baseUrl}plugins/AIS/SearchMfPositionsAsync.ashx?layer=8EE2C7996800458AAF70BABB43321FA4&mmsi=${v.mmsi}&s=${interval.dateBegin.toISOString()}&e=${interval.dateEnd.toISOString()}`});\r\n                        myWorker.onmessage = function(e) {\r\n                            resolve(e.data);\r\n                        };                \r\n                        myWorker.onerror = function(e) {\r\n                            reject(e);\r\n                        };\r\n                        _trackLoaders.push(myWorker);\r\n                    }\r\n                    else{\r\n                        resolve();\r\n                    }\r\n                })))\r\n                .then(data=>{\r\n//console.log(data, data.length)\r\n                    data.reduce((p,c)=>p.then(()=>{\r\n                        if (!c) return Promise.resolve();\r\n\r\n                        _tools.showMyFleetTrack([c], ({pid})=>{\r\n                            _aisLayerSearcher.searchById([pid], response=>{\r\n                                if (response.Status && response.Status.toLowerCase()=='ok' && response.Result){\r\n                                    let v={}, res = response.Result;\r\n                                    res.fields.forEach((f, i)=>v[f] = res.values[0][i]);\r\n                                    infoDialog.show(v, false);\r\n                                }\r\n                            })\r\n                        }, _aisLayerSearcher, viewState);\r\n//console.log(c,  c.positions ? Math.round(c.positions.length/3.5) : 0)\r\n                        return new Promise(resolve=>setTimeout(()=>resolve(), c.positions ? Math.round(c.positions.length/3.5) : 0));\r\n                    }) , Promise.resolve())\r\n                    .then(()=>thisView.inProgress(false));\r\n                })\r\n                .catch(e=>{\r\n                    console.log(e);\r\n                    thisView.inProgress(false);\r\n                });\r\n\r\n/*\r\n                _vessels.forEach(v=>{ \r\n                    var myWorker = new Worker(_modulePath + 'LoaderWorker.js');\r\n                    myWorker.postMessage({mmsi:v.mmsi, url:`${baseUrl}plugins/AIS/SearchMfPositionsAsync.ashx?layer=8EE2C7996800458AAF70BABB43321FA4&mmsi=${v.mmsi}&s=${interval.dateBegin.toISOString()}&e=${interval.dateEnd.toISOString()}`});\r\n                    myWorker.onmessage = function(e) {\r\n//console.log('Message received from worker', e.data);\r\n                        //if ( e.data.mmsi=='273444660')\r\n                        _tools.showMyFleetTrack([e.data], console.log, _aisLayerSearcher);\r\n                        counter--;\r\n                        if (!counter)\r\n                            thisView.inProgress(false);\r\n                    }                \r\n                    myWorker.onerror = function(e) {\r\n                        console.log(e);\r\n                        counter--;\r\n                        if (!counter)\r\n                            thisView.inProgress(false)\r\n                    }\r\n                    _trackLoaders.push(myWorker);\r\n                });\r\n                */\r\n            }\r\n            else\r\n                console.log(\"NO WORKERS\")\r\n//             return;\r\n// console.log(_tools.historyInterval)                  \r\n//             const di = _tools.historyInterval;\r\n//             _vessels.forEach(v=>{ \r\n//                 new Promise((resolve) => {\r\n//                     _aisLayerSearcher.searchPositionsAgg2Mf(v.mmsi, {dateBegin: di.get('dateBegin'), dateEnd: di.get('dateEnd')}, function (response) {\r\n// //console.log(response)       \r\n//                     if (parseResponse(response)) {\r\n//                         let position, positions = [],\r\n//                             fields = response.Result.fields,\r\n//                             groups = response.Result.values.reduce((p, c) => {\r\n//                                 let obj = {}, d;\r\n//                                 for (var j = 0; j < fields.length; ++j) {\r\n//                                     obj[fields[j]] = c[j];\r\n//                                     if (fields[j] == 'ts_pos_utc'){\r\n//                                         let dt = c[j], t = dt - dt % (24 * 3600);\r\n//                                         d = new Date(t * 1000);\r\n//                                         obj['ts_pos_org'] = c[j];\r\n//                                     }\r\n//                                 }\r\n//                                 if (p[d]) {\r\n//                                     p[d].positions.push(_tools.formatPosition(obj, _aisLayerSearcher));\r\n//                                     p[d].count = p[d].count + 1;\r\n//                                 }\r\n//                                 else\r\n//                                     p[d] = { mmsi: v.mmsi, positions: [_tools.formatPosition(obj, _aisLayerSearcher)], count: 1 };\r\n//                                 return p;\r\n//                             }, {});\r\n//                         let counter = 0;\r\n//                         for (var k in groups) {\r\n//                             groups[k][\"n\"] = counter++;\r\n//                             positions.push(groups[k]);\r\n//                         }\r\n//                         resolve({ Status: \"ok\", Result: { values: positions, total: response.Result.values.length } });\r\n//                     }\r\n//                     else\r\n//                         resolve(response);\r\n//                     });\r\n//                 })\r\n//                 .then(function (response) {\r\n//                     if (response.Status && response.Status.toLowerCase()=='ok' && response.Result && response.Result.values)\r\n//                         _tools.showMyFleetTrack(response.Result.values, console.log);\r\n//                     else\r\n//                         console.log(response);\r\n//                 });\r\n//            });\r\n        }\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Models/MyFleetModel.js","module.exports = { \r\n\tfind: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn value;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn undefined;\r\n\t},\r\n\tfindIndex: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn i;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Polyfill.js","require(\"./DbSearch.css\");\r\nrequire(\"../Controls/SearchControl.css\");\r\nconst BaseView = require('./BaseView.js'),\r\nSearchControl = require('../Controls/SearchControl');\r\n\r\nlet _searchLayer,\r\n    _highlight,\r\n    _tools,\r\n    _displayedOnly = [],\r\n    _displayed = [],\r\n    _viewState = {\r\n        get displayedOnly(){return _displayedOnly;},\r\n        get displayed(){\r\n            return _displayed;\r\n        },\r\n        showTracks: function(trackBuilder, needAlt){\r\n            trackBuilder.showHistoryTracks(this.displayed, needAlt);\r\n        },\r\n        hideTracks: function(trackBuilder, needAlt){\r\n            //trackBuilder.hideHistoryTracks(_notDisplayed, needAlt);\r\n        },\r\n        cleanTracks: function(trackBuilder){\r\n            _displayed = trackBuilder.cleanHistoryTracks();\r\n        }\r\n    };\r\nconst _switchLegendIcon = function(showAlternative){\r\n    let ic = this.frame.find('.legend_icon'),\r\n    ica = this.frame.find('.legend_iconalt');\r\n    if (showAlternative){\r\n        ic.hide(); ica.show();\r\n    }\r\n    else{\r\n        ica.hide(); ic.show();\r\n    }\r\n};\r\nconst DbSearchView = function (model, options, tools, viewCalendar) {\r\n    BaseView.call(this, model, tools);\r\n    _searchLayer = options.aisLastPoint;\r\n    _highlight = options.highlight;\r\n    _tools = tools;\r\n    _viewState.view = this;\r\n    this.frame = $(Handlebars.compile('<div class=\"ais_view search_view\">' +\r\n        '<table border=0 class=\"instruments\">' +\r\n        '<tr><td colspan=\"2\" class=\"search_input_container\">' + \r\n        \r\n        //'<div class=\"filter\"><input type=\"text\" placeholder=\"{{i \"AISSearch2.filter\"}}\"/>' +\r\n        //'<div><img class=\"search clicable\" src=\"plugins/AIS/AISSearch/svg/search.svg\">' +\r\n        //'<img class=\"remove clicable\" src=\"plugins/AIS/AISSearch/svg/remove.svg\">' +\r\n        //'</div></div>' + \r\n        '' +\r\n\r\n        '</td></tr>' +\r\n        '<tr><td class=\"time\" colspan=\"2\"><span class=\"label\">{{i \"AISSearch2.time_switch\"}}:</span>' +\r\n        '<span class=\"utc on unselectable\" unselectable=\"on\">UTC</span><span class=\"local unselectable\" unselectable=\"on\">{{i \"AISSearch2.time_local\"}}</span>'+\r\n        '<span class=\"sync-switch-slider-description\" style=\"padding: 0;margin-left: 10px;line-height:12px\">{{i \"AISSearch2.thisVesselOnly\"}}</span>'+ \r\n        '<label class=\"sync-switch switch only_this\" style=\"margin-left:5px\"><input type=\"checkbox\">'+\r\n        '<div class=\"sync-switch-slider switch-slider round\"></div></label>' +\r\n        '</td></tr>' +\r\n\r\n        '<tr><td><style>' + \r\n        '#ui-datepicker-div .ui-datepicker-next {height: 1.8em !important;}' +\r\n        '#ui-datepicker-div .ui-datepicker-next span.ui-icon.ui-icon-circle-triangle-e {background: url(img/arrows.png) no-repeat 0 -18px !important;}' +\r\n        '#ui-datepicker-div .ui-datepicker-next.ui-state-hover span.ui-icon.ui-icon-circle-triangle-e {background: url(img/arrows.png) no-repeat 0 -38px !important;}' +\r\n        '</style><div class=\"calendar\"></div></td>' +\r\n\r\n        '<td style=\"padding-left:5px;padding-right:25px;vertical-align:top;\"><div class=\"refresh clicable\" title=\"{{i \"AISSearch2.refresh\"}}\">' +\r\n        '<div class=\"progress\">' + this.gifLoader + '</div>' +\r\n        '<div class=\"reload\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"#2f3c47\" d=\"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z\"/></svg></div>' +\r\n        '</div></td></tr>' +\r\n        '</table>' +\r\n\r\n        '<div class=\"ais_history\">' +\r\n        '<table class=\"ais_positions_date\"><tr><td>NO HISTORY FOUND</td></tr></table>' +\r\n        '</div>' +\r\n        '<table class=\"start_screen\"><tr><td>' +\r\n        '<img src=\"plugins/AIS/AISSearch/svg/steer-weel.svg\">' +\r\n        '<div>{{{i \"AISSearh2.searchresults_view\"}}}' +\r\n        '</div></td></tr></table>' +\r\n\r\n        //'<div class=\"suggestions\"><div class=\"suggestion\">SOME VESSEL<br><span>mmsi:0, imo:0</span></div></div>' +\r\n        '</div>'\r\n    )());\r\n\r\n    Object.defineProperty(this, \"topOffset\", {\r\n        get: function () {\r\n            let th = $('.ais_tabs')[0].getBoundingClientRect().height,\r\n            ih = this.frame.find('.instruments')[0].getBoundingClientRect().height,\r\n            rv = th + ih;\r\n            this.frame.find('.instruments').height(ih);\r\n            return rv;\r\n        }\r\n    });  \r\n\r\n    this.container = this.frame.find('.ais_history');\r\n    this.startScreen = this.frame.find('.start_screen');\r\n    this.tableTemplate = '{{#if msg}}<div class=\"message\">{{msg}}</div>{{/if}}' +\r\n\r\n    '<table class=\"ais_positions_date header\"><tr>' +\r\n    '<td></td>' +\r\n    '<td><span class=\"date\"></span></td>' +\r\n    '<td><div class=\"track all\"><input type=\"checkbox\" title=\"{{i \"AISSearch2.allDailyTracks\"}}\"></div></td>' +\r\n    '<td><div class=\"count\">{{total}}</div></td></tr></table>' +\r\n\r\n        '{{#each vessels}}' +\r\n        '<table class=\"ais_positions_date\" border=0><tr>' +\r\n        '<td><div class=\"open_positions ui-helper-noselect icon-right-open\" title=\"{{i \"AISSearch2.voyageInfo\"}}\"></div></td>' +\r\n        '<td><span class=\"date\">{{{ts_pos_utc}}}</span></td>' +\r\n        '<td><div class=\"track\" date=\"{{{ts_pos_utc}}}\"><input type=\"checkbox\" title=\"{{i \"AISSearch2.dailyTrack\"}}\"></div></td>' +\r\n        '<td><div class=\"count\">{{count}}</div></td></tr></table>' +\r\n        '<div id=\"voyage_info{{n}}\"></div>' +\r\n        '{{/each}}';\r\n\r\n        this.calendar = viewCalendar;\r\n        this.frame.find('.calendar').append(this.calendar.el.parentElement);\r\n        this.calendar.onChange = function(interval){\r\n            this.model.historyInterval = interval;\r\n            this.model.isDirty = true;\r\n            if (this.isActive)\r\n                this.show();            \r\n        }.bind(this);\r\n        this.frame.on('click', ((e) => {\r\n            if (e.target.classList.toString().search(/CalendarWidget/) < 0) {\r\n                this.calendar.reset()\r\n            }\r\n            //suggestions.hide();\r\n        }).bind(this));\r\n/*\r\n\r\n    const calendar = this.frame.find('.calendar'),\r\n    daysLimit = 14;\r\n\r\n    // walkaround with focus at first input in ui-dialog\r\n    calendar.append('<span class=\"ui-helper-hidden-accessible\"><input type=\"text\"/></span>');\r\n\r\n    let mapDateInterval = nsGmx.widgets.commonCalendar.getDateInterval(),\r\n        dateInterval = new nsGmx.DateInterval();\r\n    dateInterval\r\n        .set('dateBegin', mapDateInterval.get('dateBegin'))\r\n        .set('dateEnd', mapDateInterval.get('dateEnd'))\r\n        .on('change', function (e) {\r\n//console.log(this.model.historyInterval) \r\n//console.log('CHANGE ' + dateInterval.get('dateBegin').toUTCString() + ' ' + dateInterval.get('dateEnd').toUTCString()) \r\n            let d = new Date(e.attributes.dateEnd.getTime() - msd*daysLimit);\r\n            this.calendar._dateInputs.datepicker('option', 'minDate', d);\r\n\r\n            this.model.historyInterval = { dateBegin: dateInterval.get('dateBegin'), dateEnd: dateInterval.get('dateEnd') };\r\n            this.model.isDirty = true;\r\n            this.show();\r\n        }.bind(this));\r\n    _tools.historyInterval = dateInterval;\r\n    const msd = 24*3600000;\r\n    this.calendar = new nsGmx.CalendarWidget({\r\n        dateInterval: dateInterval,\r\n        name: 'searchInterval',\r\n        container: calendar,\r\n        //dateMin: new Date(0, 0, 0),        \r\n        dateMin: new Date(nsGmx.DateInterval.getUTCDayBoundary().dateBegin.getTime() - msd*(daysLimit-1)),\r\n        dateMax: new Date(3015, 1, 1),\r\n        dateFormat: 'dd.mm.yy',\r\n        minimized: false,\r\n        showSwitcher: false,\r\n        dateBegin: new Date(),\r\n        dateEnd: new Date(2000, 10, 10),\r\n        //buttonImage: 'img/calendar.png'\r\n    })\r\n\r\n    let td = calendar.find('tr:nth-of-type(1) td');\r\n    td.eq(1).after('<td style=\"font-weight:bold\">&nbsp;&nbsp;&ndash;&nbsp;&nbsp;</td>');\r\n    td.eq(td.length - 1).after('<td>&nbsp;&nbsp;<img class=\"default_date\" style=\"cursor:pointer\" title=\"'+_gtxt('AISSearch2.calendar_today')+'\" src=\"plugins/AIS/AISSearch/svg/calendar.svg\"></td>');\r\n    calendar.find('.default_date').on('click', () => {\r\n        let db = nsGmx.DateInterval.getUTCDayBoundary(new Date());\r\n        this.calendar.getDateInterval().set('dateBegin', db.dateBegin);\r\n        this.calendar.getDateInterval().set('dateEnd', db.dateEnd);\r\n        nsGmx.widgets.commonCalendar.setDateInterval(db.dateBegin, db.dateEnd);\r\n    })\r\n\r\n    //sidebarControl && sidebarControl.on('closing', ()=>calendar.reset())\r\n    this.frame.on('click', ((e) => {\r\n        if (e.target.classList.toString().search(/CalendarWidget/) < 0) {\r\n            this.calendar.reset()\r\n        }\r\n        //suggestions.hide();\r\n    }).bind(this));\r\n*/\r\n    this.frame.find('.time .only_this  input[type=\"checkbox\"]').click((e=>{\r\n        _displayedOnly.length = 0;\r\n        if (e.currentTarget.checked && this.frame.find('.ais_positions_date:not(.header)')[0] ) {\r\n            _displayedOnly.push(this.model.data.vessels[0].positions[0].mmsi.toString()); \r\n        }        \r\n        _tools.showVesselsOnMap(_viewState);\r\n \r\n    }).bind(this));\r\n\r\n    _tools.onLegendSwitched((()=>{\r\n        _switchLegendIcon.call(this, _tools.needAltLegend);\r\n    }).bind(this));\r\n\r\n    this.frame.find('.time .utc,.local').click((e => {\r\n        let trg = $(e.currentTarget);\r\n        if (!trg.is('.on')) {\r\n            this.frame.find('.time span').removeClass(\"on\");\r\n            trg.addClass('on')\r\n            if (trg.is('.utc')) {\r\n                this.frame.find('.utc_time').show();\r\n                this.frame.find('.local_time').hide();\r\n                this.frame.find('.utc_date').show();\r\n                this.frame.find('.local_date').hide();\r\n            }\r\n            else {\r\n                this.frame.find('.utc_time').hide();\r\n                this.frame.find('.local_time').show();\r\n                this.frame.find('.utc_date').hide();\r\n                this.frame.find('.local_date').show();\r\n            }\r\n        }\r\n\r\n    }).bind(this));\r\n\r\n    this.frame.find('.refresh .reload').click((e=>{\r\n        if (e.currentTarget.style.display=\"block\"){\r\n            this.model.isDirty = true;\r\n            this.model.update();\r\n        }\r\n    }).bind(this));\r\n\r\n    this.searchInput = new SearchControl({tab:this.frame[0], container:this.frame.find('.search_input_container')[0], \r\n    searcher: {\r\n        searchPromise: function(params){\r\n            var request =  `layer=${_searchLayer}&columns=[{\"Value\":\"vessel_name\"},{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"vessel_type\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"},{\"Value\":\"source\"}]&orderby=vessel_name&${params[0].name}=${params[0].value}`;\r\n            //return Request.fetchRequest('/Plugins/AIS/SearchShip.ashx', request, 'POST');\r\n            return fetch(document.location.protocol + window.serverBase.replace(/^https?:/, '') + 'Plugins/AIS/SearchShip.ashx', {                \r\n                headers: {'Content-Type': 'application/x-www-form-urlencoded'},\r\n                method: 'POST', \r\n                mode: 'cors',\r\n                body: encodeURI(request)\r\n            });\r\n        },\r\n        parser: function(response){ \r\n//console.log(response)               \r\n            if (response.Status && response.Status.toLowerCase()=='ok' && response.Result){                    \r\n                let columns = response.Result.columns,\r\n                    values = response.Result.values;\r\n                return values.map(v=>{\r\n                    let rv = {};\r\n                    columns.forEach((c, i)=>{rv[c] = v[i]});\r\n                    return rv;\r\n                });\r\n            }\r\n            else{\r\n                console.log(response);\r\n                return [];\r\n            }\r\n        }\r\n    },\r\n    callback:(v=>{\r\n//console.log(v)               \r\n        if (v) {\r\n            if (!this.vessel || this.vessel.mmsi != v.mmsi || !this.frame.find('.ais_positions_date:not(.header)')[0]) {\r\n                this.vessel = v;\r\n                this.show();\r\n            }\r\n        }\r\n        else {\r\n            _clean.call(this);\r\n            _cleanMap.call(this);\r\n            this.vessel = null;\r\n        }\r\n    }).bind(this)\r\n});\r\n   \r\n};\r\n\r\nDbSearchView.prototype = Object.create(BaseView.prototype);\r\n\r\nlet _clean = function () {\r\n    this.frame.find('.open_positions').off('click');\r\n    this.frame.find('.ais_positions_date .track input[type=\"checkbox\"]').off('click');\r\n    let scrollCont = this.container.find('.mCSB_container')\r\n    if (scrollCont[0])\r\n        scrollCont.empty();\r\n    else\r\n        this.container.empty();\r\n    //console.log(\"EMPTY ON SELF.CLEAN \"+this)\r\n    this.startScreen.css({ visibility: \"hidden\" });\r\n    nsGmx.leafletMap.removeLayer(_highlight);\r\n    this.showTrack();\r\n},\r\n_cleanMap = function(){  \r\n    if (_displayedOnly.length) \r\n        this.frame.find('.time .only_this  input[type=\"checkbox\"]').click();\r\n};\r\n\r\nDbSearchView.prototype.inProgress = function (state) {\r\n    let progress = this.frame.find('.refresh div.progress'),\r\n    reload = this.frame.find('.refresh div.reload');\r\n    if (state){\r\n        progress.show();\r\n        reload.hide();\r\n    }\r\n    else{\r\n        progress.hide();\r\n        reload.show();\r\n    }\r\n};\r\n\r\nlet _vi_template = '<table class=\"ais_positions\">' +\r\n    '{{#each positions}}' +\r\n    '<tr>' +\r\n    '<td  title=\"{{i \"AISSearch2.info\"}}\"><img class=\"show_info\" id=\"show_info{{@index}}\" src=\"plugins/AIS/AISSearch/svg/info.svg\"></td>' +\r\n    '<td><span class=\"utc_time\">{{tm_pos_utc}}</span><span class=\"local_time\">{{tm_pos_loc}}</span></td>' +\r\n    '<td><span class=\"utc_date\">{{dt_pos_utc}}</span><span class=\"local_date\">{{dt_pos_loc}}</span></td>' +\r\n    '<td><img src=\"{{icon}}\" class=\"legend_icon rotateimg{{icon_rot}}\"><img src=\"{{iconAlt}}\" class=\"legend_iconalt rotateimg{{icon_rot}}\"></td>' +\r\n    '<td><img src=\"{{source}}\"></td>' +\r\n    '<td>{{longitude}}&nbsp;&nbsp;{{latitude}}</td>' +\r\n    '<td><div class=\"show_pos\" id=\"show_pos{{@index}}\" title=\"{{i \"AISSearch2.position\"}}\"><img src=\"plugins/AIS/AISSearch/svg/center.svg\"></div></td>' +\r\n    '</tr>' +\r\n    '<tr><td colspan=\"7\" class=\"more\"><hr><div class=\"vi_more\">' +\r\n\r\n    '<div class=\"c1\">COG | SOG:</div><div class=\"c2\">&nbsp;{{cog}} {{#if cog_sog}}&nbsp;{{/if}} {{sog}}</div>' +\r\n    '<div class=\"c1\">HDG | ROT:</div><div class=\"c2\">&nbsp;{{heading}} {{#if heading_rot}}&nbsp;{{/if}} {{rot}}</div>' +\r\n    '<div class=\"c1\">{{i \"AISSearch2.draught\"}}:</div><div class=\"c2\">&nbsp;{{draught}}</div>' +\r\n    '<div class=\"c1\">{{i \"AISSearch2.destination\"}}:</div><div class=\"c2\">&nbsp;{{destination}}</div>' +\r\n    '<div class=\"c1\">{{i \"AISSearch2.nav_status\"}}:</div><div class=\"c2\">&nbsp;{{nav_status}}</div>' +\r\n    '<div class=\"c1\">ETA:</div><div class=\"c2\">&nbsp;<span class=\"utc_time\">{{eta_utc}}</span><span class=\"local_time\">{{eta_loc}}</span></div>' +\r\n\r\n    '</div></td></tr>' +\r\n    '{{/each}}' +\r\n    '</table>';\r\n\r\nDbSearchView.prototype.repaint = function () {\r\n    _clean.call(this);\r\n    BaseView.prototype.repaint.call(this); \r\n\r\n    if (this.model.data.msg)\r\n        this.frame.find('.ais_positions_date.header').hide();\r\n\r\n// console.log(\"REPAINT\") \r\n    _tools.clearMyFleetMarkers();\r\n    _displayedOnly.length = 0; \r\n    if (this.frame.find('.time .only_this  input[type=\"checkbox\"]')[0].checked) {\r\n        _displayedOnly.push(this.model.data.vessels[0].positions[0].mmsi.toString());  \r\n    }         \r\n    _tools.showVesselsOnMap(_viewState);\r\n\r\n    let openPos = this.frame.find('.open_positions'),    \r\n        infoDialog = this.infoDialogView,\r\n        thisVessel = this.vessel,\r\n        showInfoDialog = function(position){\r\n            position.vessel_name = thisVessel.vessel_name;\r\n            position.latitude = position.ymax;\r\n            position.longitude = position.xmax;\r\n            position.source = position.source_orig;\r\n            infoDialog.show(position, false);\r\n        };\r\n    openPos.each((ind, elm) => {\r\n        $(elm).click(((e) => {\r\n            let icon = $(e.target),\r\n                vi_cont = this.frame.find('#voyage_info' + ind);\r\n            if (icon.is('.icon-down-open')) {\r\n                icon.removeClass('icon-down-open').addClass('.icon-right-open');\r\n                vi_cont.find('.ais_positions td[class!=\"more\"]').off('click')\r\n                vi_cont.empty();\r\n            }\r\n            else {\r\n                icon.addClass('icon-down-open').removeClass('.icon-right-open');\r\n                vi_cont.html(Handlebars.compile(_vi_template)(this.model.data.vessels[ind]));\r\n                if (this.frame.find('.time .local').is('.on')) {\r\n                    vi_cont.find('.utc_time').hide();\r\n                    vi_cont.find('.local_time').show();\r\n                    vi_cont.find('.utc_date').hide();\r\n                    vi_cont.find('.local_date').show();\r\n                }\r\n                //switchLegendIcons();\r\n                _switchLegendIcon.call(this, _tools.needAltLegend);\r\n                vi_cont.find('.ais_positions td[class!=\"more\"]').click((e) => {\r\n                    let td = $(e.currentTarget);\r\n                    if (td.is('.active')) {\r\n                        td.removeClass('active')\r\n                        td.siblings().removeClass('active')\r\n                        td.parent().next().find('td').removeClass('active')\r\n                    }\r\n                    else {\r\n                        td.addClass('active')\r\n                        td.siblings().addClass('active')\r\n                        td.parent().next().find('td').addClass('active')\r\n                    }\r\n                });\r\n                vi_cont.find('.ais_positions .show_info').click(((e) => {\r\n                    let i = e.currentTarget.id.replace(/show_info/, \"\"),\r\n                        position = this.model.data.vessels[ind].positions[i];\r\n                    position.vessel_name = thisVessel.vessel_name;\r\n                    position.latitude = position.ymax;\r\n                    position.longitude = position.xmax;\r\n                    position.source = position.source_orig;\r\n                    infoDialog.show(position, false);\r\n                    e.stopPropagation();\r\n                }).bind(this));\r\n                vi_cont.find('.ais_positions .show_pos').click(((e) => {\r\n                    //showPosition\r\n                    let i = e.currentTarget.id.replace(/show_pos/, \"\"),\r\n                        position = this.model.data.vessels[ind].positions[parseInt(i)];\r\n                    this.positionMap(position, this.calendar.getDateInterval());\r\n\r\n                    this.frame.find('.track:not(.all) input')[ind].checked = true; \r\n                    allTracksInput[0].checked = (this.frame.find('.track:not(.all) input:checked').length==this.model.data.vessels.length);  \r\n\r\n                    let v = this.model.data.vessels[ind], nv = this.model.data.vessels[ind+1];\r\n                    this.showTrack([{\r\n                        mmsi: v.positions[0].mmsi, imo: v.positions[0].imo, ts: v.positions[0].ts_pos_org,\r\n                        positions: v.positions,\r\n                        end: nv && nv.positions ? nv.positions[0] : null\r\n                    }], ({p})=>showInfoDialog(p));\r\n\r\n                    e.stopPropagation();\r\n                }).bind(this));\r\n            }\r\n        }).bind(this));\r\n    });\r\n\r\n    const allTracksInput = this.frame.find('.ais_positions_date .track.all input[type=\"checkbox\"]'),\r\n          tracksInputs = this.frame.find('.ais_positions_date .track:not(.all) input[type=\"checkbox\"]'),\r\n          setMapCalendar = function(calendar){\r\n              let calendarInterval = calendar.getDateInterval(),\r\n                  interval = { dateBegin: calendarInterval.get(\"dateBegin\"), dateEnd: calendarInterval.get(\"dateEnd\") };\r\n              nsGmx.widgets.commonCalendar.setDateInterval(interval.dateBegin, interval.dateEnd);              \r\n          };\r\n    allTracksInput.click(((e) => {        \r\n        setMapCalendar(this.calendar);\r\n        this.frame.find('.ais_positions_date .track:not(.all) input').each((i, el) => {\r\n            el.checked = e.target.checked;\r\n        });\r\n\r\n        let vessels = [], dv = this.model.data.vessels;\r\n        dv.forEach((v, i) => { \r\n            let nv = dv[i+1];\r\n            vessels.push({ \r\n                mmsi: v.positions[0].mmsi, imo: v.positions[0].imo, ts: v.positions[0].ts_pos_org, lastPos: v.lastPos,\r\n                positions: e.target.checked ? v.positions : [],\r\n                end: nv && nv.positions ? nv.positions[0] : null\r\n            });\r\n        });\r\n        this.showTrack(vessels, ({p})=>showInfoDialog(p));\r\n    }).bind(this));\r\n    tracksInputs.each(((i, el)=>{\r\n        let vessels = this.model.data.vessels, v = vessels[i], nv = vessels[i+1];\r\n        el.addEventListener('click', ((e)=>{ \r\n\r\n            setMapCalendar(this.calendar);\r\n            allTracksInput[0].checked = (this.frame.find('.ais_positions_date .track:not(.all) input:checked').length==vessels.length);\r\n            \r\n            this.showTrack([{\r\n                mmsi: v.positions[0].mmsi, imo: v.positions[0].imo, ts: v.positions[0].ts_pos_org, lastPos: v.lastPos,\r\n                positions: e.target.checked ? v.positions : [],\r\n                end: nv && nv.positions ? nv.positions[0] : null\r\n            }], ({p})=>showInfoDialog(p));\r\n\r\n        }).bind(this));\r\n    }).bind(this));\r\n\r\n    if (this.model.data.vessels.length == 1)\r\n        openPos.eq(0).click();\r\n        \r\n    //if (this.withTrack){\r\n        tracksInputs.eq(0).click();\r\n    //    this.withTrack = false;\r\n    //}\r\n\r\n    if (this.vessel.lastPosition){\r\n        this.positionMap(this.vessel, this.calendar.getDateInterval());\r\n        this.vessel.lastPosition = false;\r\n    }   \r\n    \r\n    const intervalEnd = this.model.data.vessels.length;\r\n    if (intervalEnd){\r\n        const lastDate = new Date(this.model.data.vessels[intervalEnd-1].positions[0].ts_pos_org*1000),\r\n              di = this.calendar.getDateInterval(),\r\n              calendarlastDate = di.get('dateBegin');\r\n        lastDate.setUTCHours(0,0,0,0); \r\n//console.log(this.model.historyInterval)   \r\n        if (calendarlastDate.getTime()<lastDate.getTime()){\r\n            di.set('dateBegin', lastDate);\r\n            this.model.historyInterval.dateBegin = lastDate;\r\n//console.log(lastDate, calendarlastDate)  \r\n//console.log(this.model.historyInterval) \r\n        }       \r\n    }\r\n};\r\n\r\nObject.defineProperty(DbSearchView.prototype, \"vessel\", {\r\n    get() {\r\n        return this.model.vessel;\r\n    },\r\n    set(v) {\r\n        this.model.vessel = v;\r\n        if (!v)\r\n            return;\r\n            \r\n        this.searchInput.searchString = v.vessel_name;        \r\n        let positionDate = nsGmx.DateInterval.getUTCDayBoundary(new Date(v.ts_pos_org * 1000));\r\n        let checkInterval = this.calendar.getDateInterval();\r\n        if (positionDate.dateBegin < checkInterval.get('dateBegin') || checkInterval.get('dateEnd') < positionDate.dateEnd){\r\n            this.calendar.getDateInterval().set('dateBegin', positionDate.dateBegin);\r\n            this.calendar.getDateInterval().set('dateEnd', positionDate.dateEnd);      \r\n            this.model.historyInterval = { dateBegin: positionDate.dateBegin, dateEnd: positionDate.dateEnd };\r\n        }\r\n        else\r\n            this.model.historyInterval = { dateBegin: checkInterval.get('dateBegin'), dateEnd: checkInterval.get('dateEnd') };\r\n        this.model.isDirty = true;\r\n    }\r\n});\r\n\r\nDbSearchView.prototype.show = function () {\r\n    BaseView.prototype.show.call(this); \r\n    this.searchInput.focus();       \r\n    _tools.showVesselsOnMap(_viewState); \r\n};\r\n\r\nDbSearchView.prototype.hide = function () { \r\n    BaseView.prototype.hide.call(this); \r\n\r\n    _tools.cleanMap(_viewState);\r\n};\r\n\r\nDbSearchView.prototype.showTrack = function (vessels, onclick) {\r\n\r\n    _displayed = _tools.showHistoryTrack(vessels, onclick);   \r\n\r\n    if (!vessels || !Array.isArray(vessels))\r\n        return;\r\n\r\n    vessels.forEach(vessel => {\r\n        let dlg = $('.ui-dialog:contains(\"' + vessel.mmsi + '\")');\r\n        $('.showtrack').attr('title', _gtxt('AISSearch2.show_track'))\r\n            .removeClass('ais active');\r\n        if (dlg[0])\r\n            dlg.find('.showtrack').attr('title', _gtxt('AISSearch2.hide_track'))\r\n                .addClass('ais active');\r\n    });\r\n};\r\n\r\nDbSearchView.prototype.positionMap = function (vessel, interval) {\r\n//console.log(\"positionMap\")\r\n    if (interval)       \r\n        nsGmx.widgets.commonCalendar.setDateInterval(interval.get(\"dateBegin\"), interval.get(\"dateEnd\"));\r\n\r\n    if (!vessel.xmax && !vessel.longitude && !vessel.ymax && !vessel.latitude){\r\n        vessel.longitude = this.model.data.vessels[0].positions[0].xmax;\r\n        vessel.latitude = this.model.data.vessels[0].positions[0].ymax;\r\n//console.log(vessel);\r\n//console.log(this.model.data.vessels[0].positions[0]);\r\n    }\r\n        \r\n    let xmin = vessel.xmin ? vessel.xmin : vessel.longitude,\r\n        xmax = vessel.xmax ? vessel.xmax : vessel.longitude,\r\n        ymin = vessel.ymin ? vessel.ymin : vessel.latitude,\r\n        ymax = vessel.ymax ? vessel.ymax : vessel.latitude,\r\n        zoom = nsGmx.leafletMap.getZoom();\r\n\r\n    nsGmx.leafletMap.setView([ymax, xmax<0?(360+xmax):xmax], (zoom < 9 ? 12 : zoom));\r\n    nsGmx.leafletMap.removeLayer(_highlight);\r\n    _highlight.vessel = vessel;\r\n    _highlight.setLatLng([ymax, xmax<0?(360+xmax):xmax]).addTo(nsGmx.leafletMap);\r\n};\r\n\r\nDbSearchView.prototype.formatDate = function (d, local){\r\n    return _tools.formatDate(d, local);\r\n};\r\n\r\nDbSearchView.prototype.formatPosition = function (obj, searcher){\r\n    return _tools.formatPosition(obj, searcher);\r\n};\r\n\r\nmodule.exports = DbSearchView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/DbSearchView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/DbSearch.css\n// module id = 18\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Controls/SearchControl.css\n// module id = 19\n// module chunks = 0","\r\n\r\nlet _searchString = \"\",\r\n_sparams = 'imo name mmsi';\r\n\r\n_translationsHash.addtext('rus', {'AISSearchControl.placeholder': 'Поиск'});\r\n_translationsHash.addtext('eng', {'AISSearchControl.placeholder': 'Search'});\r\n\r\nconst SearchControl = function ({ tab, container, callback, searchparams, searcher }) {\r\n\r\n    container.innerHTML = '<div class=\"filter\"><input type=\"text\" placeholder=\"' + _gtxt(\"AISSearchControl.placeholder\") + '\"/>' +\r\n        (!searchparams ? '' : '<div class=\"preferences\"></div>') +\r\n        '<div class=\"searchremove\"><img class=\"search\" src=\"plugins/AIS/AISSearch/svg/search.svg\">' +\r\n        '<img class=\"remove clicable\" src=\"plugins/AIS/AISSearch/svg/remove.svg\"></div>' +\r\n        '</div>';\r\n    let suggestions = tab.appendChild(document.createElement('div'));\r\n    suggestions.classList.add(\"suggestions\");\r\n    suggestions.innerHTML = '<div class=\"suggestion\">SOME VESSEL<br><span>mmsi:0, imo:0</span></div>';\r\n\r\n    this.frame = { find: (q) => { return container.querySelector(q) } };\r\n\r\n    let preferences = false;\r\n    if (searchparams){\r\n        _sparams = localStorage.getItem(searchparams);\r\n        preferences = tab.appendChild(document.createElement('div'));\r\n        preferences.classList.add(\"preferences\");\r\n        preferences.innerHTML = '<div class=\"section\">Поиск по:</div>' +\r\n            '<div class=\"line\"><div class=\"checkbox imo disabled\"></div><div class=\"label\">IMO<label></div></div>' +\r\n            '<div class=\"line\"><div class=\"checkbox mmsi\"></div><div class=\"label\">MMSI<label></div></div>' +\r\n            '<div class=\"line\"><div class=\"checkbox name disabled\"></div><div class=\"label\">названию</div></div>' +\r\n            '<div class=\"line\"><div class=\"checkbox callsign\"></div><div class=\"label\">позывному<label></div></div>' +\r\n            '<div class=\"line\"><div class=\"checkbox owner\"></div><div class=\"label\">собственнику<label></div></div>';\r\n        !_sparams && (_sparams = 'imo name mmsi');\r\n        if (_sparams.search(/imo/) < 0)\r\n            _sparams += ' imo';\r\n        if (_sparams.search(/name/) < 0)\r\n            _sparams += ' name';\r\n        let asparams = _sparams.split(' ');\r\n        asparams.forEach((p, i) => { preferences.querySelector('.' + p).classList.add('checked') });\r\n    }\r\n    else{\r\n        let sr = this.frame.find('.filter .searchremove');\r\n        sr.style.borderRight = 'none';\r\n        sr.style.paddingRight = 0;\r\n        this.frame.find('.filter input').style.width = '85%';\r\n    }\r\n\r\n    this.frame = { find: (q) => { return container.querySelector(q) } }\r\n    this.searchInput = this.frame.find('.filter input');\r\n\r\n    let searchBut = this.frame.find('.filter .search'),\r\n        prefeBut = this.frame.find('.filter .preferences'),\r\n        removeBut = this.frame.find('.filter .remove'),\r\n        delay,\r\n        //suggestions = this.frame.find('.suggestions'),\r\n        suggestionsCount = 5,\r\n        suggestionsFrame = { first: 0, current: 0, last: suggestionsCount - 1 },\r\n        found = { values: [] },\r\n        searchDone = function () {\r\n            if (found.values.length > 0) {\r\n                _searchString = found.values[suggestionsFrame.current].vessel_name;\r\n                this.searchInput.value = (_searchString);\r\n                callback(found.values[suggestionsFrame.current]);\r\n            }\r\n            // else {\r\n            //     _clean.call(this);\r\n            // }\r\n        },\r\n        doSearch = function (actualId) {\r\n            let requests = [];\r\n            // _sparams.split(' ').forEach(sp=>{       \r\n            //     requests.push(fetch(\"//kosmosnimki.ru/demo/lloyds/api/v1/Ship/Search/\" + sp + \"/\" + _searchString));\r\n            // });\r\n            requests.push(new searcher.searchPromise([{name:'query', value: [_searchString]}]));\r\n            Promise.all(requests)\r\n            .then(a=>{\r\n//console.log(a)\r\n                return Promise.all(a.map(r=>{\r\n                    if (r.status != 200){\r\n                        console.log(r)                       \r\n                        return [];\r\n                    }\r\n                    else\r\n                        return r.json()\r\n                }))\r\n            })\r\n            .then(a=>{\r\n//console.log(actualId+\" \"+delay)\r\n                if (actualId==delay){\r\n                    found = {values:[]};\r\n                    a.forEach(r=>{found.values = found.values.concat( searcher.parser(r) );});\r\n//console.log(found.values)\r\n                }\r\n                else \r\n                    return Promise.reject(\"stop\")                    \r\n            })\r\n            .then(function () { // SUCCEEDED\r\n//console.log(_searchString)\r\n                if (found.values.length == 0 || _searchString == \"\") {\r\n                    suggestions.style.display = 'none';\r\n                    return;\r\n                }\r\n\r\n                let scrollCont = suggestions.querySelector('.mCSB_container'),\r\n                    content = Handlebars.compile(\r\n                        '{{#each values}}<div class=\"suggestion\" id=\"{{@index}}\">{{vessel_name}}<br><span>mmsi:{{mmsi}}, imo:{{imo}}, {{callsign}}</span><br><span>{{owner}}</span></div>{{/each}}'\r\n                    )(found);\r\n                if (!scrollCont) {\r\n                    suggestions.innerHTML = (content);\r\n                    $(suggestions).mCustomScrollbar();\r\n                }\r\n                else\r\n                    scrollCont.innerHTML = (content);\r\n\r\n                let suggestion = suggestions.querySelectorAll('.suggestion');\r\n                if (suggestions.style.display != 'block') {\r\n                    let cr = this.frame.find('.filter').getBoundingClientRect();\r\n                    suggestions.style.display = 'block';\r\n                    suggestions.style.position = 'fixed';\r\n                    suggestions.style.left = cr.left + \"px\"; suggestions.style.top = (cr.bottom - 3) + \"px\";\r\n                    suggestions.style.width = (Math.round(cr.width) - 2) + \"px\";\r\n                    // $(suggestions).offset({ left: cr.left, top: cr.bottom - 3 });\r\n                    // $(suggestions).outerWidth(cr.width)\r\n                }\r\n\r\n                suggestions.style.height = suggestion[0].getBoundingClientRect().height *\r\n                    (found.values.length > suggestionsCount ? suggestionsCount : found.values.length) + \"px\";\r\n\r\n                suggestionsFrame = { first: 0, current: 0, last: suggestionsCount - 1 };\r\n                suggestion[suggestionsFrame.current].classList.add('selected');\r\n                suggestion.forEach(((el, i) =>\r\n                    el.onclick = (e => {\r\n                        suggestionsFrame.current = e.currentTarget.id;\r\n                        suggestions.style.display = 'none';\r\n                        searchDone.call(this);\r\n                    }).bind(this)\r\n                ).bind(this));\r\n            }.bind(this),\r\n            function (response) { // FAILED\r\n                if (response!=\"stop\")\r\n                    console.log(response);\r\n            });\r\n        };\r\n\r\n    tab.addEventListener('click', function (e) {\r\n        suggestions.style.display = 'none';\r\n    });\r\n    if (preferences) {\r\n        tab.addEventListener('click', function (e) {\r\n            preferences.style.display = 'none';\r\n        });\r\n        prefeBut.onclick = function (e) {\r\n            if (preferences.style.display != 'block') {\r\n                let cr = this.frame.find('.filter').getBoundingClientRect();\r\n                preferences.style.display = 'block';\r\n                preferences.style.position = 'fixed';\r\n                preferences.style.left = (cr.left + (cr.width - preferences.offsetWidth) / 2) + \"px\";\r\n                preferences.style.top = (cr.bottom + 10) + \"px\";\r\n                e.stopPropagation()\r\n            }\r\n        }.bind(this);\r\n\r\n        preferences.querySelectorAll('.line').forEach(el => el.onclick = e => {\r\n            let ch = el.querySelector('.checkbox');\r\n            if (!ch.classList.contains('disabled')) {\r\n                let sparam = ch.classList.value.replace(/ *(checked|checkbox) */g, '');\r\n                if (ch.classList.contains('checked')) {\r\n                    ch.classList.remove('checked');\r\n                    _sparams = _sparams.replace(new RegExp(sparam), '').replace(/ {2,}/g, ' ');\r\n                }\r\n                else {\r\n                    ch.classList.add('checked');\r\n                    _sparams = _sparams + ' ' + sparam;\r\n                }\r\n                _sparams = _sparams.replace(/^\\s+|\\s+$/g, '')\r\n                localStorage.setItem(searchparams, _sparams);\r\n                //console.log(_sparams)\r\n            }\r\n            e.stopPropagation()\r\n        });\r\n    }\r\n    \r\n    removeBut.onclick = (function (e) {\r\n        _searchString = '';\r\n        callback(null);\r\n        this.searchInput.value = ('');\r\n        this.searchInput.focus();\r\n        clearTimeout(delay)\r\n        removeBut.style.display = 'none';\r\n        searchBut.style.display = 'block';\r\n        suggestions.style.display = 'none';\r\n        //_clean.call(this);\r\n    }.bind(this));\r\n\r\n    this.searchInput.onkeydown = (function (e) {\r\n        let suggestion = suggestions.querySelector('.suggestion.selected');\r\n        if (suggestions.style.display == 'block') {\r\n            if (e.keyCode == 38) {\r\n                if (suggestionsFrame.current > 0) {\r\n                    suggestionsFrame.current--;\r\n                    suggestion.classList.remove('selected')\r\n                    suggestion.previousSibling.classList.add('selected');\r\n                }\r\n            }\r\n            else if (e.keyCode == 40) {\r\n                if (suggestionsFrame.current < found.values.length - 1) {\r\n                    suggestionsFrame.current++;\r\n                    suggestion.classList.remove('selected')\r\n                    suggestion.nextSibling.classList.add('selected');\r\n                }\r\n            }\r\n            if (suggestionsFrame.last < suggestionsFrame.current) {\r\n                suggestionsFrame.last = suggestionsFrame.current;\r\n                suggestionsFrame.first = suggestionsFrame.last - (suggestionsCount - 1);\r\n            }\r\n            if (suggestionsFrame.first > suggestionsFrame.current) {\r\n                suggestionsFrame.first = suggestionsFrame.current;\r\n                suggestionsFrame.last = suggestionsFrame.first + (suggestionsCount - 1);\r\n            }\r\n\r\n            $(suggestions).mCustomScrollbar(\"scrollTo\", \"#\" + suggestionsFrame.first, { scrollInertia: 0 });\r\n        }\r\n    });\r\n\r\n    let prepareSearchInput = function (temp, keyCode) {\r\n        removeBut.style.display = 'block';\r\n        searchBut.style.display = 'none';\r\n//console.log(\"delay clear\"+delay)\r\n//console.log(_searchString + \"==\"+ temp)\r\n        if (_searchString == temp && (!keyCode || keyCode != 13))\r\n            return false;\r\n\r\n        clearTimeout(delay);\r\n\r\n        _searchString = temp;\r\n        if (_searchString == \"\") {\r\n            removeBut.click();\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    this.searchInput.onkeyup = (function (e) {\r\n        let temp = (this.searchInput.value || \"\")\r\n            .replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n        if (!prepareSearchInput(temp, e.keyCode))\r\n            return;\r\n        if (e.keyCode == 13) {\r\n            suggestions.style.display = 'none';\r\n            searchDone.call(this);\r\n        }\r\n        else{\r\n            delay = setTimeout((() => {\r\n                doSearch.apply(this, [delay])\r\n            }).bind(this), 200);\r\n        }\r\n    }.bind(this));\r\n\r\n\r\n    this.searchInput.onpaste = function (e) {\r\n        let temp = ((e.originalEvent || window.clipboardData || e).clipboardData.getData('text') || \"\")\r\n            .replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n        if (!prepareSearchInput(temp))\r\n            return;\r\n        delay = setTimeout((() => {\r\n            doSearch.call(this, [delay])\r\n        }).bind(this), 200);\r\n    }.bind(this);\r\n\r\n    Object.defineProperty(this, \"searchString\", {\r\n        set: function (v) {\r\n            prepareSearchInput(v, 13);\r\n            this.searchInput.value = v;\r\n        }\r\n    }); \r\n\r\n}\r\n\r\nSearchControl.prototype.focus = function () {\r\n    this.searchInput.focus();\r\n}\r\n\r\nmodule.exports = SearchControl;\n\n\n// WEBPACK FOOTER //\n// ./src/Controls/SearchControl.js","module.exports = function (aisLayerSearcher) {\r\n    let _actualUpdate;\r\n    return {\r\n        searcher: aisLayerSearcher,\r\n        filterString: \"\",\r\n        isDirty: false,\r\n        load: function (actualUpdate) {\r\n            if (!this.isDirty)\r\n                return Promise.resolve();\r\n \r\n            var _this = this;\r\n            return new Promise((resolve) => {\r\n                aisLayerSearcher.searchPositionsAgg2(_this.vessel.mmsi, _this.historyInterval, function (response) {\r\n//console.log(response)       \r\n                    if (parseResponse(response)) {\r\n                        let position, positions = [], previous,\r\n                            fields = response.Result.fields,\r\n                            groups = response.Result.values.reduce((p, c) => {\r\n                                let obj = {}, d;\r\n                                for (var j = 0; j < fields.length; ++j) {\r\n                                    obj[fields[j]] = c[j];\r\n                                    if (fields[j] == 'ts_pos_utc'){\r\n                                        let dt = c[j], t = dt - dt % (24 * 3600);\r\n                                        d = new Date(t * 1000);\r\n                                        obj['ts_pos_org'] = c[j];\r\n                                    }\r\n                                }\r\n                                if (p[d]) {\r\n                                    p[d].positions.push(_this.view.formatPosition(obj, aisLayerSearcher));\r\n                                    p[d].count = p[d].count + 1;\r\n                                }\r\n                                else{\r\n                                    p[d] = { ts_pos_utc: _this.view.formatDate(d), positions: [_this.view.formatPosition(obj, aisLayerSearcher)], count: 1 };\r\n                                    if (previous) // todo check date diff!!\r\n                                        previous.lastPos = {xmax: p[d].positions[0].xmax, ymax: p[d].positions[0].ymax};\r\n                                }\r\n                                previous = p[d];\r\n                                return p;\r\n                            }, {});\r\n//console.log(groups)       \r\n                        let counter = 0;\r\n                        for (var k in groups) {\r\n                            groups[k][\"n\"] = counter++;\r\n                            positions.push(groups[k]);\r\n                        }\r\n                        resolve({ Status: \"ok\", Result: { values: positions, total: response.Result.values.length } });\r\n                    }\r\n                    else\r\n                        resolve(response)\r\n                })\r\n            })\r\n                .then(function (response) {\r\n//console.log(response)       \r\n                    _this.isDirty = false;\r\n                    if (response.Status.toLowerCase() == \"ok\") {\r\n                        _this.data = { vessels: response.Result.values, total: response.Result.total }\r\n                        return Promise.resolve();\r\n                    }\r\n                    else {\r\n                        return Promise.reject(response);\r\n                    }\r\n                });\r\n        },\r\n        update: function () {\r\n            if (!this.vessel || !this.isDirty)\r\n                return;\r\n\r\n            _actualUpdate = new Date().getTime();\r\n            let _this = this,\r\n                actualUpdate = _actualUpdate;\r\n            this.view.inProgress(true);\r\n            //this.filterString&&console.log(this.filterString+\" \"+this.filterString.search(/\\r$/))\r\n            //this.filterString&&console.log(this.filterString.replace(/^\\s+/, \"\").replace(/\\s+\\r*$/, \"\")!=\"\")            \r\n\r\n            this.load(actualUpdate).then(function () {\r\n                //console.log(\"LOADED \"+(new Date().getTime()-_this._actualUpdate)+\"ms\")\r\n                //console.log(\"3>\"+new Date(_this._actualUpdate))\r\n                //console.log(\"4>\"+new Date(actualUpdate))\r\n                if (_actualUpdate == actualUpdate) {\r\n//_this.data.vessels && (_this.data.vessels.length>0) && console.log(_this.data.vessels[0].positions[0])                    \r\n                    _this.view.inProgress(false);\r\n                    _this.view.repaint();\r\n                }\r\n            }, function (json) {\r\n                _this.dataSrc = null;\r\n                console.log(json)\r\n                if (json.Status.toLowerCase() == \"auth\" ||\r\n                    (json.ErrorInfo && json.ErrorInfo.some &&\r\n                        json.ErrorInfo.some(function (r) { return r.Status.toLowerCase() == \"auth\" })) ||\r\n                    (json.ErrorInfo && json.ErrorInfo.ErrorMessage.search(/not access/i) != -1))\r\n                    _this.data = { msg: _gtxt(\"AISSearch2.auth\"), vessels: [] };\r\n                else {\r\n                    //_this.data = {msg:[{txt:\"!!!\"}], vessels:[]};\r\n                    console.log(json);\r\n                }\r\n                _this.view.inProgress(false);\r\n                _this.view.repaint();\r\n            });\r\n        }\r\n    };\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/Models/DbSearchModel.js","const displayInfoDialog = require('./infodialog.js'),\r\n      Polyfill = require('../Polyfill'),\r\n      VesselInfoScreen = require('./VesselInfoScreen');\r\n\r\nlet infoDialogCascade = [],\r\n    allIinfoDialogs = [],\r\n    vesselInfoScreen;\r\n\r\nmodule.exports = function ({\r\n    tools,\r\n    aisLayerSearcher: aisLayerSearcher,\r\n    modulePath: modulePath,\r\n    aisView: aisView, \r\n    myFleetView: myFleetView,\r\n    menuId:menuId }) {\r\n\r\n    vesselInfoScreen  = new VesselInfoScreen({modulePath: modulePath, aisServices: aisLayerSearcher.aisServices});\r\n    const _showPosition = function(vessel, track){ \r\n\r\n        aisView.vessel = vessel;\r\n        if (aisView.tab)\r\n        if (aisView.tab.is('.active'))\r\n            aisView.show();\r\n        else\r\n            aisView.tab.click(); \r\n        aisView.showTrack(track);    \r\n        \r\n        \r\n        window.iconSidebarWidget.open(menuId);\r\n    }, \r\n    _updateView = function (displayed, vessel, getmore){\r\n        if (displayed.vessel.ts_pos_utc!=vessel.ts_pos_utc){\r\n            $(displayed.dialog).dialog(\"close\")\r\n            return true;\r\n        }\r\n        else\r\n            return false;\r\n    };\r\n    return {\r\n        showPosition: function(vessel){  \r\n            _showPosition(vessel, vessel);\r\n            //aisView.showTrack(vessel);\r\n        },\r\n        show: function (vessel, getmore) {\r\n            let ind = Polyfill.findIndex(allIinfoDialogs, function (d) { \r\n                return d.vessel.imo == vessel.imo && d.vessel.mmsi == vessel.mmsi \r\n            }),\r\n            isNew = true,\r\n            dialogOffset;\r\n            if (ind >= 0) {\r\n                isNew = false;\r\n                let displayed = allIinfoDialogs[ind];\r\n                dialogOffset = $(displayed.dialog).parent().offset();\r\n                ind = Polyfill.findIndex(infoDialogCascade, function (d) { return d.id == displayed.dialog.id })\r\n                if(!_updateView(displayed, vessel)){\r\n                    $(displayed.dialog).parent().insertAfter($('.ui-dialog').eq($('.ui-dialog').length - 1));\r\n                    return;\r\n                }\r\n            }\r\n\r\n            let dialog = displayInfoDialog({\r\n                vessel: vessel,\r\n                getmore: getmore,\r\n                displayedTrack: tools.displayedTrack,\r\n                closeFunc: function (event) {\r\n                    let ind = Polyfill.findIndex(infoDialogCascade, function (d) { return d.id == dialog.id });\r\n                    if (ind >= 0)\r\n                        infoDialogCascade.splice(ind, 1);\r\n                    ind = Polyfill.findIndex(allIinfoDialogs, function (d) { return d.dialog.id == dialog.id });\r\n                    if (ind >= 0)\r\n                        allIinfoDialogs.splice(ind, 1);\r\n                },\r\n                aisLayerSearcher: aisLayerSearcher,\r\n                modulePath:modulePath, \r\n                aisView: aisView,\r\n                myFleetView: myFleetView,\r\n                tools: tools\r\n            },\r\n                {\r\n                    openVesselInfoScreen: vesselInfoScreen.open,\r\n                    showTrack: tools.showTrack,\r\n                    showPosition: _showPosition\r\n                })\r\n\r\n            if (!dialogOffset && infoDialogCascade.length > 0) {\r\n                let pos = $(infoDialogCascade[infoDialogCascade.length - 1]).parent().position();\r\n                dialogOffset = {left:pos.left - 10, top:pos.top + 10};\r\n            }\r\n            if (dialogOffset)\r\n                $(dialog).dialog(\"option\", \"position\", [dialogOffset.left, dialogOffset.top]);\r\n            if (ind >= 0)\r\n                infoDialogCascade.splice(ind, 0, dialog);\r\n            else if(isNew)\r\n                infoDialogCascade.push(dialog);\r\n\r\n            allIinfoDialogs.push({ vessel: vessel, dialog: dialog });\r\n            $(dialog).on(\"dialogdragstop\", function (event, ui) {\r\n                var ind = Polyfill.findIndex(infoDialogCascade, function (d) { return d.id == dialog.id });\r\n                if (ind >= 0)\r\n                    infoDialogCascade.splice(ind, 1);\r\n            });\r\n\r\n        }\r\n    };\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/Views/InfoDialogView.js","require(\"./infodialog.css\")\r\nconst SpecialFloatView = require('./SpecialFloatView.js');\r\n\r\nlet addUnit = function (v, u) {\r\n\treturn v != null && v != \"\" ? v + u : \"\";\r\n},\r\n\tformatDate,\r\n\tformatDateTime,\r\n\tround = function (d, p) {\r\n\t\tlet isNeg = d < 0,\r\n\t\t\tpower = Math.pow(10, p)\r\n\t\treturn d ? ((isNeg ? -1 : 1) * (Math.round((isNeg ? d = -d : d) * power) / power)) : d\r\n\t},\r\n\tformatVessel = function (vessel) {\r\n\t\tlet d = new Date(vessel.ts_pos_utc * 1000);\r\n\t\tvessel.ts_pos_org = vessel.ts_pos_utc;\r\n\t\tvessel.dt_pos_utc = formatDate(d);\r\n\t\tvessel.ts_pos_utc = formatDateTime(d);\r\n\t\tvessel.ts_pos_loc = \"<br><span class='local'>\" + formatDateTime(d, true) + \"</span>\";\r\n\t\tvessel.ts_eta = vessel.ts_eta ? formatDateTime(new Date(vessel.ts_eta * 1000)) : \"\";\r\n\t\tvessel.cog = !isNaN(vessel.cog)?addUnit(round(vessel.cog, 5), \"°\"):vessel.cog;\r\n\t\tvessel.sog = !isNaN(vessel.sog)?addUnit(round(vessel.sog, 5), nsGmx.Translations.getLanguage()==\"rus\"?\" уз\":\" kn\"):vessel.sog;\r\n\t\tvessel.rot = !isNaN(vessel.rot)?addUnit(round(vessel.rot, 5), nsGmx.Translations.getLanguage()==\"rus\"?\"°/мин\":\"°/min\"):vessel.rot;\r\n\t\tvessel.heading = !isNaN(vessel.heading)?addUnit(round(vessel.heading, 5), \"°\"):vessel.heading;\r\n\t\tvessel.draught = !isNaN(vessel.draught)?addUnit(round(vessel.draught, 5), nsGmx.Translations.getLanguage()==\"rus\"?\" м\":\" m\"):vessel.draught;\r\n\t\tvessel.length = !isNaN(vessel.length)?addUnit(vessel.length, nsGmx.Translations.getLanguage()==\"rus\"?\" м\":\" m\"):vessel.length;\r\n\t\tvessel.width = !isNaN(vessel.width)?addUnit(vessel.width, nsGmx.Translations.getLanguage()==\"rus\"?\" м\":\" m\"):vessel.width;\r\n\t\tvessel.source = vessel.source == 'T-AIS' ? _gtxt('AISSearch2.tais') : _gtxt('AISSearch2.sais');\r\n\t\treturn vessel;\r\n\t},\r\n\ttoDd = function (D, lng) {\r\n\t\tlet dir = D < 0 ? lng ? 'W' : 'S' : lng ? 'E' : 'N',\r\n\t\t\tdeg = Math.round((D < 0 ? D = -D : D) * 1000000) / 1000000\r\n\t\treturn deg + \"°\" + dir\r\n\t},\r\n\tddToDms = function (D, lng) {\r\n\t\tlet dms = {\r\n\t\t\tdir: D < 0 ? lng ? 'W' : 'S' : lng ? 'E' : 'N',\r\n\t\t\tdeg: 0 | (D < 0 ? D = -D : D),\r\n\t\t\tmin: 0 | D % 1 * 60,\r\n\t\t\tsec: (0 | D * 60 % 1 * 6000) / 100\r\n\t\t};\r\n\t\treturn dms.deg + \"°\" + dms.min + \"'\" + dms.sec + \"\\\" \" + dms.dir\r\n\t},\r\n\tshipCams = {};\r\n\r\nmodule.exports = function ({ vessel, closeFunc, aisLayerSearcher, getmore,\r\n\tmodulePath,\taisView, displayedTrack,\r\n\tmyFleetView, tools }, commands) {\r\n\r\n\tif (!shipCams[vessel.mmsi]){\r\n\t\tnsGmx.gmxMap.layers.forEach(l => {\r\n\t\t\tif (l && l._gmx && l._gmx.properties) {\r\n\t\t\t\tlet props = l._gmx.properties,\r\n\t\t\t\t\ttitle = props.title,\r\n\t\t\t\t\tmeta = props.MetaProperties;\r\n\t\t\t\tif (title && (title.search(/^shipcam[^_]*_/) != -1) &&\r\n\t\t\t\tmeta.ships && (meta.ships.Value.search(new RegExp('\"'+vessel.mmsi+'\"'))!=-1)) {\r\n\t\t\t\t\tshipCams[vessel.mmsi] = { \r\n\t\t\t\t\t\tlayer: props.name,\r\n\t\t\t\t\t\turls: meta.urls.Value\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n//console.log(shipCams);\r\n\t}\r\n\r\n\tformatDate = aisLayerSearcher.formatDate;\r\n\tformatDateTime = aisLayerSearcher.formatDateTime;\r\n\r\n\tlet myFleetModel = myFleetView.model,\r\n\t\tadd = myFleetModel && myFleetModel.findIndex(vessel) < 0;\r\n\r\n\tlet canvas = $('<div class=\"ais_myfleet_dialog\"/>'),\r\n\t\tmenu = $('<div class=\"column1 menu\"></div>').appendTo(canvas),\r\n\t\tphoto = $('<div class=\"photo\"><div></div></div>').appendTo(menu),\r\n\t\tunderphoto = $('<div class=\"underphoto\"><div></div></div>').appendTo(menu),\r\n\t\tcontent = $('<div class=\"column2 content\"></div>'),\r\n\t\tbuttons = $('<div class=\"column3 buttons\"></div>'),\r\n\t\tgifLoader = '<img src=\"img/progress.gif\">'\r\n\t//console.log(content);\r\n\r\n\tcanvas.append(content).append(buttons)\r\n\r\n\tlet searchInput = $('.leaflet-ext-search'),\r\n\t\tdialogW = 610, dialogH = 250,\r\n\t\tposX = searchInput.offset().left + searchInput.width() - dialogW,\r\n\t\tposY = searchInput.offset().top + searchInput.height() + 10,\r\n\t\tdialog = showDialog(vessel.vessel_name, canvas[0], { \r\n\t\t\twidth: dialogW, height: dialogH, posX: posX, posY:posY, \r\n\t\t\tcloseFunc: closeFunc \r\n\t\t}),\r\n\t\tvessel2,\r\n\t\tmoreInfo = function (v) {\r\n\t\t\tlet smallShipIcon = '<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"14px\" height=\"14px\" viewBox=\"0 0 14 14\" style=\"margin-left: 10px\" xml:space=\"preserve\">' +\r\n\t\t\t\t'<g style=\"fill: #48aff1;\">' +\r\n\t\t\t\t'<path class=\"st0\" d=\"M13.4,11H0.6c-0.2,0-0.4,0.1-0.5,0.3c-0.1,0.2-0.1,0.4,0,0.6l1.2,1.8C1.4,13.9,1.6,14,1.8,14h9.9   c0.2,0,0.3-0.1,0.4-0.2l1.7-1.8c0.2-0.2,0.2-0.4,0.1-0.7C13.9,11.1,13.7,11,13.4,11z\"/>' +\r\n\t\t\t\t'<path class=\"st0\" d=\"M9.3,9.7h2.9c0.2,0,0.4-0.1,0.5-0.3c0.1-0.2,0.1-0.4,0-0.6L9.8,4.5C9.7,4.3,9.4,4.2,9.2,4.3   C8.9,4.4,8.7,4.6,8.7,4.9v4.3C8.7,9.5,9,9.7,9.3,9.7z\"/>' +\r\n\t\t\t\t'<path class=\"st0\" d=\"M1.2,9.7H7c0.3,0,0.6-0.3,0.6-0.6V0.6c0-0.3-0.2-0.5-0.4-0.6C6.9-0.1,6.7,0,6.5,0.3L0.7,8.8   C0.6,9,0.5,9.2,0.6,9.4C0.7,9.6,0.9,9.7,1.2,9.7z\"/>' +\r\n\t\t\t\t'</g>' +\r\n\t\t\t\t'</svg>',\r\n\t\t\t\tvesselPropTempl = '<div class=\"vessel_prop vname\"><b>{{vessel_name}}</b>' + smallShipIcon + '</div>' +\r\n\t\t\t\t\t'<div class=\"vessel_prop altvname\"><b>' + (vessel2.registry_name && vessel2.registry_name != vessel2.vessel_name ? vessel2.registry_name : '') + '&nbsp;</b></div>'\r\n\r\n\t\t\t$('.content', canvas).append(Handlebars.compile(\r\n\t\t\t\t'<div class=\"vessel_props1\">' + vesselPropTempl +\r\n\t\t\t\t'<table>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.vessel_type\"}}: </div></td><td><div class=\"vessel_prop value\">{{vessel_type}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.flag\"}}: </div></td><td><div class=\"vessel_prop value\">{{flag_country}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">IMO: </div></td><td><div class=\"vessel_prop value\">{{imo}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">MMSI: </div></td><td><div class=\"vessel_prop value mmsi\">{{mmsi}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.callsign\"}}: </div></td><td><div class=\"vessel_prop value mmsi\">{{callsign}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.source\"}}: </div></td><td><div class=\"vessel_prop value\">{{source}}</div></td></tr>' +\r\n\t\t\t\t'</table>' +\r\n\t\t\t\t'</div>'\r\n\t\t\t)(v));\r\n\r\n\t\t\t$('.content', canvas).append(Handlebars.compile(\r\n\t\t\t\t'<div class=\"vessel_props2\">' + vesselPropTempl +\r\n\t\t\t\t'<table>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">COG | SOG: </div></td><td><div class=\"vessel_prop value\">{{cog}}&nbsp;&nbsp;&nbsp;{{sog}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">HDG | ROT: </div></td><td><div class=\"vessel_prop value\">{{heading}}&nbsp;&nbsp;&nbsp;{{rot}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.draught\"}}: </div></td><td><div class=\"vessel_prop value\">{{draught}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.destination\"}}: </div></td><td><div class=\"vessel_prop value\">{{destination}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.nav_status\"}}: </div></td><td><div class=\"vessel_prop value\">{{nav_status}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">ETA: </div></td><td><div class=\"vessel_prop value\">{{ts_eta}}</div></td></tr>' +\r\n\r\n\t\t\t\t'</div>'\r\n\t\t\t)(v));\r\n\r\n\t\t\t$(underphoto).append('<table><tr>' +\r\n\t\t\t\t'<td class=\"ais_refresh\"><svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" height=\"16\" width=\"16\"><g class=\"nc-icon-wrapper\" fill=\"#444444\"><polyline data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 15,16 7,16 7,13 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 15,18 17,16 15,14 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" data-stroke=\"none\" fill=\"#444444\" points=\"15,18 17,16 15,14 \" stroke-linejoin=\"miter\" stroke-linecap=\"square\" style=\"stroke: currentColor;fill: currentColor;\"/> <polyline data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 9,8 17,8 17,11 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\"9,6 7,8 9,10 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" data-stroke=\"none\" fill=\"#444444\" points=\"9,6 7,8 9,10 \" stroke-linejoin=\"miter\" stroke-linecap=\"square\" style=\"stroke: currentColor;fill: currentColor;\"/> <rect x=\"2\" y=\"1\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" width=\"20\" height=\"22\" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/></g></svg></td>' +\r\n\t\t\t\t'<td><div class=\"vessel_prop coordinates\"><span class=\"small\">' +\r\n\t\t\t\tddToDms(v.latitude, false) + ' ' + ddToDms(v.longitude, true) +\r\n\t\t\t\t'</small></div></td>' +\r\n\t\t\t\t'</tr></table>'\r\n\t\t\t);\r\n\r\n\t\t\tlet swap = \"<span class='small'>\" + toDd(v.latitude, false) + \" \" + toDd(v.longitude, true) + \"</span>\"\r\n\t\t\t$('.ais_refresh', underphoto).click((e) => {\r\n\t\t\t\tlet mi = $('.coordinates', underphoto),\r\n\t\t\t\t\tt = mi.html()\r\n\t\t\t\tmi.html(swap)\r\n\t\t\t\tswap = t\r\n\t\t\t})\r\n\r\n\t\t\t$('.vessel_props1', canvas).hide()\r\n\t\t\t$('.vessel_prop.vname svg', canvas).css('visibility', add ? 'hidden' : 'visible')\r\n\r\n\t\t}\r\n\r\n\t$(dialog).dialog({ resizable: false });\r\n\r\n\tif (!getmore) {\r\n\t\tvessel2 = $.extend({}, vessel);\r\n\t\tmoreInfo(formatVessel(vessel2));\r\n\t}\r\n\telse\r\n\t\taisLayerSearcher.searchNames([{ mmsi: vessel.mmsi, imo: vessel.imo }], function (response) {\r\n\t\t\tif (parseResponse(response)) {\r\n\t\t\t\tvessel2 = {};\r\n\t\t\t\tfor (var i = 0; i < response.Result.fields.length; ++i)\r\n\t\t\t\t\tvessel2[response.Result.fields[i]] = response.Result.values[0][i];\r\n\t\t\t\tmoreInfo(formatVessel(vessel2));\r\n\t\t\t\t$('.date', titlebar).html('<span class=\"utc\">' + vessel2.ts_pos_utc + ' UTC</span>' + vessel2.ts_pos_loc);\r\n\t\t\t\tif (typeof (getmore) == \"function\")\r\n\t\t\t\t\tgetmore(vessel2)\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tconsole.log(response)\r\n\t\t})\r\n\r\n\t// IMAGE\t\r\n\tlet scheme = document.location.href.replace(/^(https?:).+/, \"$1\");\r\n\r\n\t$('<img src=\"' + scheme + window.serverBase.replace(/^https?:/, \"\")+'plugins/ais/getphoto.ashx?mmsi=' + vessel.mmsi + '\">')\r\n\t.load(function(){\t\r\n\t\tif (this) $('div', photo).replaceWith(this);\r\n\t})\r\n\t.error(function(){\t\t\r\n\t\t$('<img src=\"' + scheme + '//photos.marinetraffic.com/ais/showphoto.aspx?size=thumb&mmsi=' + vessel.mmsi + '\">')\r\n\t\t.load(function(){\r\n\t\t\t\tif (this) $('div', photo).replaceWith(this);\r\n\t\t})\r\n\t});\t\r\n\r\n\t// BUTTONS\r\n\tlet menubuttons = $('<div class=\"menubuttons\"></div>').appendTo(buttons)\r\n\r\n\tlet openpage = $('<div class=\"button openpage\" title=\"' + _gtxt('AISSearch2.show_info') + '\">' +\r\n\t\t'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">' +\r\n\t\t'<g class=\"nc-icon-wrapper\" style=\"fill:currentColor\">' +\r\n\t\t'<path d=\"M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 9h2V7h-2v2z\"/>' +\r\n\t\t'</g>' +\r\n\t\t'</svg>'\r\n\t\t+ '</div>')\r\n\t\t.appendTo(menubuttons)\r\n\t\t.on('click', () => commands.openVesselInfoScreen.call(null, vessel, vessel2));\r\n\r\n\tlet showpos = $('<div class=\"button showpos\" title=\"' + _gtxt('AISSearch2.show_pos') + '\">' +\r\n\t\t'<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" width=\"20\" height=\"20\"><g class=\"nc-icon-wrapper\" fill=\"#444444\"><polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 1,7 1,1 7,1 \" stroke-linejoin=\"miter\"/> <polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 17,1 23,1 23,7 \" stroke-linejoin=\"miter\"/> <polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 23,17 23,23 17,23 \" stroke-linejoin=\"miter\"/> <polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 7,23 1,23 1,17 \" stroke-linejoin=\"miter\"/> <rect style=\"stroke:currentColor\" x=\"8\" y=\"8\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" width=\"8\" height=\"8\" stroke-linejoin=\"miter\"/></g></svg>' +\r\n\t\t'</div>')\r\n\t\t.appendTo(menubuttons)\r\n\t\t.on('click', function () {\r\n\t\t\tif (!vessel.ts_pos_org)\r\n\t\t\t\tvessel.ts_pos_org = vessel.ts_pos_utc;\r\n\t\t\tvessel.lastPosition = true;\r\n\t\t\tcommands.showPosition(vessel);\r\n\t\t\t// if(showtrack.is('.active'))\r\n\t\t\t// \tcommands.showTrack.call(null, [vessel.mmsi])\r\n\t\t});\t\r\n\r\n\r\n\tlet shipCam = shipCams[vessel.mmsi.toString()],\r\n\tsetImages = function(shipCam, vessel){\r\n\t\tlet moment = new Date(vessel.ts_pos_org*1000);\r\n\t\tmoment.setMinutes(moment.getMinutes() + moment.getTimezoneOffset())\r\n\t\tmoment = moment.getFullYear() + \"-\" + (moment.getMonth()+1) + \"-\" + moment.getDate() + \" \" + \r\n\t\tmoment.getHours() + \":\" + moment.getMinutes() + \":\" + moment.getSeconds();\r\n//console.log(moment)\t\r\n\t\tlet images = [];\r\n\t\tshipCam.urls.split(' ').forEach((url) => {\r\n\t\t\timages.push({url: serverBase.replace(/https?:/, document.location.protocol).replace(/\\/$/, \"\") + url.replace(/\"/g, '') + \r\n\t\t\t(url.search(/\\?/)!=-1?'&':'?') +\r\n\t\t\t'layer=' + shipCam.layer +\r\n\t\t\t'&mmsi=' + vessel.mmsi +\r\n\t\t\t'&ts=' + moment});\r\n\t\t});\r\n//console.log(images)\t\r\n\t\treturn images;\r\n\t}\r\n\r\n\tif (shipCam) {\r\n\t\tif (!shipCam.view) {\r\n\t\t\tshipCam.view = new SpecialFloatView(\r\n\t\t\t\tsetImages(shipCam, vessel2 ? vessel2 : vessel),\r\n\t\t\t\tvessel.mmsi\r\n\t\t\t);\r\n\t\t}\r\n\t\tlet special = shipCam.view;\r\n\t\t//console.log(special);\r\n\t\tlet showCamBut = $('<div class=\"ais button showcam\" title=\"' + _gtxt('AISSearch2.show_pos') + '\">' +\r\n\t\t\t'<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"22\" height=\"22\"><title>camera</title><g class=\"nc-icon-wrapper\" fill=\"#384b50\" style=\"fill:currentColor\"><path d=\"M21,4H17L15,1H9L7,4H3A3,3,0,0,0,0,7V19a3,3,0,0,0,3,3H21a3,3,0,0,0,3-3V7A3,3,0,0,0,21,4ZM12,18a5,5,0,1,1,5-5A5,5,0,0,1,12,18Z\"/></g></svg>' +\r\n\t\t\t'</div>')\r\n\t\t\t.appendTo(menubuttons)\r\n\t\t\t.on('click', function (e) {\r\n\t\t\t\tlet b = e.currentTarget\r\n\t\t\t\tif (b.classList.contains('active')) {\r\n\t\t\t\t\tb.classList.remove('active');\r\n\t\t\t\t\tshipCam.visible = false;\r\n\t\t\t\t\tspecial.close();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tb.classList.add('active');\r\n\t\t\t\t\tspecial.show(setImages(shipCam, vessel2 ? vessel2 : vessel), () => {\r\n\t\t\t\t\t\tb.classList.remove('active');\r\n\t\t\t\t\t\tshipCam.visible = false;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tshipCam.visible = true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t//console.log(showCamBut)\r\n\t\t//console.log(shipCams[vessel.mmsi.toString()].visible)\r\n\t\tif (shipCam.visible) {\r\n\t\t\tshowCamBut[0].classList.add('active');\r\n\t\t\tspecial.show(setImages(shipCam, vessel2 ? vessel2 : vessel), () => {\r\n\t\t\t\tshowCamBut[0].classList.remove('active');\r\n\t\t\t\tshipCam.visible = false;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tlet addremoveIcon = function (add) {\r\n\t\treturn (add ? '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><g class=\"nc-icon-wrapper\" fill=\"#444444\" style=\"fill: currentColor;\"><path d=\"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z\"/></g></svg>'\r\n\t\t\t: '<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"24px\" height=\"24px\" viewBox=\"0 0 24 24\" style=\"enable-background:new 0 0 24 24;fill: currentColor;\" xml:space=\"preserve\"><g><path class=\"st0\" d=\"M4,6H2v14c0,1.1,0.9,2,2,2h14v-2H4V6z M20,2H8C6.9,2,6,2.9,6,4v12c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2V4    C22,2.9,21.1,2,20,2z M19,11h-4v4h-2v-4H9V9h4V5h2v4h4V11z\"/></g><rect x=\"9\" y=\"5\" class=\"st0\" width=\"10\" height=\"4\"/><rect x=\"9\" y=\"11\" class=\"st0\" width=\"10\" height=\"4\"/></g></svg>')\r\n\t}\r\n\t\r\n\tlet addremove = $('<div class=\"button addremove\">' + addremoveIcon(add) + '</div>')\r\n\t\t.attr('title', add ? _gtxt('AISSearch2.myfleet_add') : _gtxt('AISSearch2.myfleet_remove'))\r\n\t\t.appendTo(menubuttons)\r\n\tif (myFleetModel.filterUpdating)\r\n\t\taddremove.addClass('disabled');\r\n\r\n\taddremove.on('click', function () {\r\n\t\tif (addremove.is('.disabled'))\r\n\t\t\treturn;\r\n\r\n\t\t$('.addremove').addClass('disabled')\r\n\t\taddremove.hide()\r\n\t\tprogress.append(gifLoader)\r\n\r\n\t\tmyFleetView.beforeExcludeMember(vessel.mmsi.toString());\r\n\t\tmyFleetModel.changeMembers(vessel, myFleetView.infoDialogView).then(function () {\r\n\t\t\tadd = myFleetModel.findIndex(vessel) < 0;\r\n\t\t\tvar info = $('.icon-ship[vessel=\"' + vessel.mmsi + ' ' + vessel.imo + '\"]');\r\n\t\t\tinfo.css('visibility', !add ? 'visible' : 'hidden');\r\n\t\t\t$('.vessel_prop.vname svg', canvas).css('visibility', add ? 'hidden' : 'visible')\r\n\t\t\t\r\n\t\t\taddremove.attr('title', add ? _gtxt('AISSearch2.myFleetInclude') : _gtxt('AISSearch2.myFleetExclude'))\r\n\t\t\t\t.html(addremoveIcon(add))\r\n\t\t\tprogress.text('');\r\n\t\t\t$('.addremove').removeClass('disabled').show();\r\n\t\t\t\r\n\t\t\ttools.eraseMyFleetMarker(vessel.mmsi);\r\n\t\t\tif (myFleetView.isActive)\r\n\t\t\t\tmyFleetView.show();\r\n\t\t\telse\r\n\t\t\t\ttools.redrawMarkers();\r\n\t\t})\r\n\t\t.catch((ex)=>console.log(ex));\r\n\t});\r\n\t//}\r\n\r\n\tlet progress = $('<div class=\"progress\"></div>')\r\n\t\t.appendTo(menubuttons);\r\n\r\n\t// TITLEBAR\t\r\n\tcanvas.parent('div').css({ 'margin': '0', 'overflow': 'hidden' })\r\n\tlet titlebar = $(dialog).parent().find('.ui-dialog-titlebar').css('padding', '0')\r\n\t\t.html('<table class=\"ais_info_dialog_titlebar\">' +\r\n\t\t'<tr><td><div class=\"date\">' +\r\n\t\t(!getmore ? Handlebars.compile('<span class=\"utc\">{{{ts_pos_utc}}} UTC</span>{{{ts_pos_loc}}}')(vessel2 ? vessel2 : vessel) : '') +\r\n\t\t'</div></td>' +\r\n\t\t\r\n\t\t'<td><div class=\"choose chooser done\"><span unselectable=\"on\">'+_gtxt('AISSearch2.dialog_tab_params')+'</span></div></td>' +\r\n\t\t'<td><div class=\"choose chooser\"><span unselectable=\"on\">'+_gtxt('AISSearch2.dialog_tab_general')+'</span></div></td>' +\r\n\t\t\r\n\t\t'<td id=\"closebut\" title=\"'+_gtxt('AISSearch2.close_but')+'\"><div class=\"ais_info_dialog_close-button\" title=\"'+_gtxt(\"AISSearch2.close_but\")+'\"></div></td></tr>' +\r\n\t\t'</table>'),\r\n\t\tonDone = function (e) { \r\n\t\t\te.stopPropagation(); \r\n\t\t\t$('.choose', titlebar).removeClass('done'); \r\n\t\t\t$(e.currentTarget).addClass('done'); \r\n\t\t};\r\n\r\n\t$('#closebut', titlebar).on('click', (e) => {$(dialog).dialog(\"close\"); })\r\n\t.on('mouseover', (e) => { \r\n\t\t$('.ais_info_dialog_close-button', titlebar).css('background', 'url(\"data:image/svg+xml;charset=utf8,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\'%3E%3Cline x1=\\'0\\' y1=\\'0\\' x2=\\'12\\' y2=\\'12\\' style=\\'stroke:%2348aff1;stroke-width:2px\\'/%3E%3Cline x1=\\'0\\' y1=\\'12\\' x2=\\'12\\' y2=\\'0\\' style=\\'stroke:%2348aff1;stroke-width:2px\\'/%3E%3C/svg%3E\") no-repeat')\r\n\t})\r\n\t.on('mouseout', (e) => { \r\n\t\t$('.ais_info_dialog_close-button', titlebar).attr('style', '')\r\n\t})\r\n\t//url(\"data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3Cline x1='0' y1='0' x2='12' y2='12' style='stroke:%2348aff1;stroke-width:2px'/%3E%3Cline x1='0' y1='12' x2='12' y2='0' style='stroke:%2348aff1;stroke-width:2px'/%3E%3C/svg%3E\") no-repeat\r\n\t$('.chooser', titlebar).eq(1).on('mousedown', (e) => { onDone(e); $('.vessel_props1', canvas).show(); $('.vessel_props2', canvas).hide() })\r\n\t$('.chooser', titlebar).eq(0).on('mousedown', (e) => { onDone(e); $('.vessel_props2', canvas).show(); $('.vessel_props1', canvas).hide() })\r\n\t$('.date span', titlebar).on('mousedown', (e) => { e.stopPropagation(); })\r\n\r\n\t//$( dialog ).on( \"dialogdragstart\", function( e, ui ) {console.log(e);console.log(ui)} );\r\n\r\n\treturn dialog\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Views/infodialog.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/infodialog.css\n// module id = 24\n// module chunks = 0","require(\"./SpecialFloatView.css\")\r\nconst _cssClassName = \"special\";\r\nconst BaseFloatView = require('./BaseFloatView.js');\r\nconst SpecialFloatView = function (images, mmsi){\r\n    BaseFloatView.apply(this, arguments);\r\n    this.images = images;\r\n//console.log(this.images)\r\n    this.frame.innerHTML = '<div class=\"' + _cssClassName + '\"></div><img class=\"img1\"><img class=\"img2\">';\r\n    if (FormData.prototype.set && mmsi==273316240)\r\n        this.frame.innerHTML += '<table class=\"logos\"><tr><td><img src=\"plugins/AIS/AISSearch/png/anchors.png\" style=\"position: unset;\"></td></tr>' +\r\n        '<tr><td><img src=\"plugins/AIS/AISSearch/png/rscc-logo.png\" style=\"position: unset;\"></td></tr></table>';\r\n    else\r\n        this.frame.innerHTML += '<table class=\"logos\" style=\"background:none\"><tr><td></td></tr></table>';\r\n    this.left = -10000;\r\n\r\n    this.contextMenu = document.createElement(\"div\"); \r\n    this.contextMenu.className = 'mf_group_menu';\r\n    let html = '<div class=\"command zoomin\">' + _gtxt('AISSearch2.zoomin_com') + '</div>' +\r\n    '<div class=\"command zoomout\" style=\"display:none\">' + _gtxt('AISSearch2.zoomout_com') + '</div>'; \r\n    if (images.length == 2) {\r\n        html += '<div class=\"command image1\">' + _gtxt('AISSearch2.image1_com') + '</div>' +\r\n            '<div class=\"command image2\">' + _gtxt('AISSearch2.image2_com') + '</div>' +\r\n            '<div class=\"command twoimages\">' + _gtxt('AISSearch2.twoimages_com') + '</div>';\r\n    }\r\n    html += '<div class=\"command close\">' + _gtxt('AISSearch2.close_com') + '</div>';\r\n    this.contextMenu.innerHTML = html;\r\n\r\n    this.contextMenu.addEventListener('mousedown', (e=>{\r\n        if(e.stopPropagation) e.stopPropagation();\r\n        //if(e.preventDefault) e.preventDefault();\r\n        e.cancelBubble=true;\r\n        e.returnValue=false;\r\n    }).bind(this)); \r\n    this.contextMenu.addEventListener('mouseleave', (e=>{\r\n            this.contextMenu.style.display = \"none\";\r\n            this.contextMenu.remove();\r\n    }).bind(this));  \r\n\r\n    let closeCom = this.contextMenu.querySelector('.close'),\r\n    zinCom = this.contextMenu.querySelector('.zoomin'),\r\n    zoutCom = this.contextMenu.querySelector('.zoomout'),\r\n    img1Com = this.contextMenu.querySelector('.image1'),\r\n    img2Com = this.contextMenu.querySelector('.image2'),\r\n    twoimgCom = this.contextMenu.querySelector('.twoimages'),\r\n    l, t , w , h,\r\n    rc1, rc2,\r\n    content = this.frame.querySelector('.'+_cssClassName),    \r\n    image1 = this.frame.querySelector('img.img1'),\r\n    image2 = this.frame.querySelector('img.img2'),\r\n    logos = this.frame.querySelector('.logos'),\r\n    showTwo = false,\r\n    restoreSize = function(){\r\n        let h1 = Math.floor(image1.getBoundingClientRect().height),\r\n        h2 = Math.floor(image2.getBoundingClientRect().height);\r\n        if (h1)        \r\n            content.style.height = h1+\"px\"; \r\n        else if (h2)       \r\n            content.style.height = h2+\"px\";\r\n        showTwo = false;         \r\n    },\r\n    zoomIn = function(image, w, h, wiw, wih){\r\n        let setPlace1 = function(){\r\n            image.style.width = wiw + \"px\";\r\n            image.style.height = \"\";\r\n\r\n            image.style.left = 0;\r\n            image.style.top = Math.round((wih - image.getBoundingClientRect().height)/2) + \"px\";\r\n        },\r\n        setPlace2 = function(){\r\n            image.style.width = \"\";\r\n            image.style.height = wih + \"px\";\r\n \r\n            image.style.left = Math.round((wiw - image.getBoundingClientRect().width)/2) + \"px\"; \r\n            image.style.top = 0; \r\n        };\r\n        if(wiw/wih>1)\r\n            if(parseInt(w)/parseInt(h)>wiw/wih)\r\n                setPlace1();\r\n            else\r\n                setPlace2();\r\n        else\r\n            if(parseInt(w)/parseInt(h)>wiw/wih)\r\n                setPlace1();\r\n            else\r\n                setPlace2();\r\n    },\r\n    zoomIn2 = function(image1, image2, w, h, wiw, wih){\r\n        let setPlace1 = function(){\r\n            image1.style.width = wiw + \"px\";\r\n            image2.style.width = wiw + \"px\";\r\n            image1.style.height = \"\";\r\n            image2.style.height = \"\";\r\n\r\n            image1.style.left = 0;\r\n            image2.style.left = 0;\r\n            image1.style.top = Math.round(wih/2 - image1.getBoundingClientRect().height) + \"px\";           \r\n            image2.style.top = image1.getBoundingClientRect().bottom + \"px\"; \r\n        },\r\n        setPlace2 = function(){\r\n            image1.style.width = \"\";\r\n            image2.style.width = \"\";\r\n            image1.style.height = Math.ceil(wih/2) + \"px\";\r\n            image2.style.height = Math.floor(wih/2) + \"px\";\r\n\r\n            image1.style.top = 0;       \r\n            image2.style.top = image1.getBoundingClientRect().bottom + \"px\"; \r\n            image1.style.left = Math.round((wiw - image1.getBoundingClientRect().width)/2) + \"px\"; \r\n            image2.style.left = image1.style.left;             \r\n        };\r\n        if(wiw/wih>1)\r\n            if(parseInt(w)/parseInt(h)>wiw/wih)\r\n                setPlace1();\r\n            else\r\n                setPlace2();\r\n        else\r\n            if(parseInt(w)/parseInt(h)>wiw/wih)        \r\n                setPlace1();\r\n            else\r\n                setPlace2();\r\n    };\r\n    closeCom.addEventListener(\"click\",(e=>{ \r\n        !this.allowMove && zoutCom.click(); \r\n        this.contextMenu.remove(); \r\n        this.left = -10000;\r\n\r\n        image1.style.display = \"block\";\r\n        image2.style.display = \"none\";\r\n        restoreSize();\r\n\r\n        this.hide(); \r\n        image1.src = \"\";\r\n        image2.src = \"\";\r\n\r\n        this.closeCallback();\r\n    }).bind(this));\r\n    zinCom.addEventListener(\"click\",(e=>{\r\n        this.contextMenu.remove();\r\n        e.srcElement.style.display = 'none'; \r\n        zoutCom.style.display = 'block';\r\n        img1Com && (img1Com.style.display = 'none');\r\n        img2Com && (img2Com.style.display = 'none');\r\n        twoimgCom && (twoimgCom.style.display = 'none');\r\n        let st = getComputedStyle(content);\r\n        w = st.width; h = st.height; \r\n        l = this.left; t = this.top;\r\n        this.left = 0; \r\n        this.top = 0;  \r\n\r\n        content.style.width = window.innerWidth + \"px\";   \r\n        content.style.height = window.innerHeight + \"px\"; \r\n\r\n        rc1 = image1.getBoundingClientRect();\r\n        rc2 = image2.getBoundingClientRect();\r\n        let wiw = window.innerWidth, wih = window.innerHeight;\r\n// console.log((parseInt(w)+\"/ \"+parseInt(h)));\r\n// console.log(\"w/h \"+(parseInt(w)/parseInt(h)));\r\n// console.log(\"wiw/wih \"+(wiw/wih));\r\n\r\n        if (rc1.width && rc1.height && !rc2.width && !rc2.height){\r\n            zoomIn(image1, w, h, wiw, wih);\r\n            logos.style.left = image1.style.left;\r\n            logos.style.top = image1.style.top;\r\n        }\r\n        if (rc2.width && rc2.height && !rc1.width && !rc1.height){\r\n            zoomIn(image2, w, h, wiw, wih);\r\n            logos.style.left = image2.style.left;\r\n            logos.style.top = image2.style.top;\r\n        }\r\n        if (rc2.width && rc2.height && rc1.width && rc1.height){\r\n            zoomIn2(image1, image2, w, h, wiw, wih);\r\n            logos.style.left = image1.style.left;\r\n            logos.style.top = image1.style.top;\r\n        }\r\n\r\n        content.classList.add('zoomed_in');  \r\n        image1.classList.add('zoomed_in');   \r\n        image2.classList.add('zoomed_in'); \r\n        logos.classList.add('zoomed_in'); \r\n        this.allowMove = false;\r\n    }).bind(this));\r\n    zoutCom.addEventListener(\"click\",(e=>{\r\n        this.contextMenu.remove();\r\n        e.srcElement.style.display = 'none'; \r\n        zinCom.style.display = 'block';\r\n        img1Com && (img1Com.style.display = 'block');\r\n        img2Com && (img2Com.style.display = 'block');\r\n        twoimgCom && (twoimgCom.style.display = 'block');\r\n        this.left = l; \r\n        this.top = t;\r\n        content.style.width = w;   \r\n        content.style.height = h; \r\n\r\n        if (rc1.width && rc1.height) {     \r\n            image1.style.left = Math.floor(rc1.left) + \"px\";\r\n            image1.style.top = Math.floor(rc1.top) + \"px\";              \r\n            image1.style.height = Math.floor(rc1.height) + \"px\";\r\n            image1.style.width = Math.floor(rc1.width) + \"px\"; \r\n        }\r\n        if (rc2.width && rc2.height) {     \r\n            image2.style.left = Math.floor(rc2.left) + \"px\";\r\n            image2.style.top = Math.floor(rc2.top) + \"px\";       \r\n            image2.style.height = Math.floor(rc2.height) + \"px\";\r\n            image2.style.width = Math.floor(rc2.width) + \"px\";\r\n        }        \r\n        logos.style.left = 0;\r\n        logos.style.top = 0;\r\n\r\n        content.classList.remove('zoomed_in'); \r\n        image1.classList.remove('zoomed_in');   \r\n        image2.classList.remove('zoomed_in');   \r\n        logos.classList.remove('zoomed_in');  \r\n        this.allowMove = true;  \r\n    }).bind(this));\r\n    img1Com && img1Com.addEventListener(\"click\",(e=>{\r\n        this.contextMenu.remove();\r\n        restoreSize();\r\n        image1.style.top = 0;\r\n        image1.style.display = \"block\";\r\n        image2.style.display = \"none\";\r\n    }).bind(this));\r\n    img2Com && img2Com.addEventListener(\"click\",(e=>{\r\n        this.contextMenu.remove();\r\n        restoreSize();\r\n        image2.style.top = 0;\r\n        image2.style.display = \"block\";\r\n        image1.style.display = \"none\";\r\n    }).bind(this));\r\n    twoimgCom && twoimgCom.addEventListener(\"click\",(e=>{\r\n        showTwo = true;\r\n\r\n        this.contextMenu.remove();\r\n        image1.style.display = \"block\";\r\n        image2.style.display = \"block\"; \r\n        let h1 = Math.floor(image1.getBoundingClientRect().height),\r\n        h2 = Math.floor(image2.getBoundingClientRect().height);\r\n        image2.style.top = Math.floor(h1)+\"px\";\r\n        if (h1 || h2)\r\n            content.style.height = (h1 + h2) + \"px\"; \r\n    }).bind(this));\r\n    image1.addEventListener(\"click\", (e=>{\r\n        if(!this.allowMove)\r\n            zoutCom.click();\r\n    }).bind(this));\r\n    image2.addEventListener(\"click\", (e=>{\r\n        if(!this.allowMove)\r\n            zoutCom.click();\r\n    }).bind(this));\r\n    content.addEventListener(\"click\", (e=>{\r\n        if(!this.allowMove)\r\n            zoutCom.click();\r\n    }).bind(this));\r\n\r\n    this.frame.addEventListener(\"contextmenu\", (e=>{\r\n        e.preventDefault();\r\n        this.frame.append(this.contextMenu);\r\n        this.contextMenu.style.display = \"block\";\r\n\r\n        if ((e.clientX - 10 + this.contextMenu.offsetWidth) < window.innerWidth) { \r\n            this.contextMenu.style.left = (e.clientX - this.left - 10) + \"px\";\r\n            this.contextMenu.style.right = \"\";\r\n        }\r\n        else{ \r\n            this.contextMenu.style.right = (this.right - e.clientX - 10) + \"px\";\r\n            this.contextMenu.style.left = \"\";\r\n        }\r\n        if ((e.clientY - 10 + this.contextMenu.offsetHeight) < window.innerHeight) {\r\n            this.contextMenu.style.top = (e.clientY - this.top - 10) + \"px\";\r\n            this.contextMenu.style.bottom = \"\";\r\n        }\r\n        else {  \r\n            this.contextMenu.style.bottom = (this.bottom - e.clientY - 10) + \"px\";\r\n            this.contextMenu.style.top = \"\";\r\n        }       \r\n    }).bind(this));\r\n}\r\n\r\nSpecialFloatView.prototype = Object.create(BaseFloatView.prototype);\r\n\r\nSpecialFloatView.prototype.close = function(){ \r\n    this.contextMenu.querySelector('.close').click();\r\n}\r\n\r\nSpecialFloatView.prototype.show = function(images, closeCallback){    \r\n    BaseFloatView.prototype.show.apply(this, arguments);\r\n    this.closeCallback = closeCallback;\r\n    if (this.left>-9999 && images.length>1)\r\n        return; \r\n    this.images = images;  \r\n//console.log(this.images)  \r\n\r\n    let content = this.frame.querySelector('.'+_cssClassName),\r\n    image1 = this.frame.querySelector('img.img1'),\r\n    image2 = this.frame.querySelector('img.img2'),\r\n    rc = this.frame.getBoundingClientRect(),\r\n    imageUrl = this.images[0].url + (this.images[0].url.search(/\\?/)!=1?\"&r=\":\"?r=\"),\r\n    timers = [];\r\n \r\n    let downloadingImage1 = new Image();\r\n    downloadingImage1.onload = function(){\r\n        image1.src = this.src; \r\n        image1.style.left = 0; image1.style.top = 0;\r\n        image1.style.width = rc.width + \"px\";\r\n        //image1.style.height = getComputedStyle(image1).height;\r\n//console.log(downloadingImage1.width)  \r\n//console.log(getComputedStyle(image1).height)  \r\n//console.log(this.width)  \r\n//console.log(image1.getBoundingClientRect())  \r\n        if (image1.getBoundingClientRect().height)        \r\n            content.style.height = Math.floor(image1.getBoundingClientRect().height)+\"px\"; \r\n    };\r\n    downloadingImage1.onerror = function (e) {\r\n        image1.src = \"\";\r\n        image1.style.height = \"\"; \r\n    };\r\n    downloadingImage1.src = imageUrl + Math.random();\r\n\r\n    if (this.images[1]) {\r\n        let downloadingImage2 = new Image(),        \r\n        imageUrl = this.images[1].url + (this.images[1].url.search(/\\?/)!=1?\"&r=\":\"?r=\");\r\n        downloadingImage2.onload = function () {\r\n            image2.src = this.src;\r\n            image2.style.left = 0; image2.style.top = 0;\r\n            image2.style.width = rc.width + \"px\";\r\n            //image2.style.height = getComputedStyle(image2).height;\r\n            image2.style.display = \"none\";\r\n            //console.log(image1.getBoundingClientRect())\r\n        };\r\n        downloadingImage2.onerror = function (e) {\r\n            image2.src = \"\";\r\n            image2.style.height = \"\"; \r\n        };\r\n        downloadingImage2.src = imageUrl + Math.random();\r\n    }\r\n \r\n\r\n    if (this.left>-9999)\r\n        return; \r\n\r\n    this.left = document.defaultView.getWindowWidth() - this.width;\r\n    this.top = 0;\r\n\r\n//console.log(\"SET TIMERS\")\r\n\r\n    // UPDATE 1\r\n    let intrerval = 1000 * 60 * 1,\r\n    thisInst = this,\r\n    timer = setTimeout(function update() {\r\n//console.log(\"TIME1 \" + timer)\r\n        let downloadingImage1 = new Image();\r\n        downloadingImage1.onload = function () {\r\n            image1.src = downloadingImage1.src;\r\n        };\r\n        downloadingImage1.src = thisInst.images[0].url + (thisInst.images[0].url.search(/\\?/)!=1?\"&r=\":\"?r=\") + Math.random();\r\n//console.log(downloadingImage1.src)\r\n        timers[0] = setTimeout(update, intrerval);\r\n    }, intrerval);\r\n    timers.push(timer);\r\n\r\n    // UPDATE 2    \r\n    if (this.images[1]) {\r\n        timer = setTimeout(function update() {\r\n//console.log(\"TIME2 \" + timer)\r\n            let downloadingImage2 = new Image();\r\n            downloadingImage2.onload = function () {\r\n                image2.src = downloadingImage2.src;\r\n            };\r\n            downloadingImage2.src = thisInst.images[1].url + (thisInst.images[1].url.search(/\\?/)!=1?\"&r=\":\"?r=\") + Math.random();\r\n//console.log(downloadingImage2.src)\r\n            timers[1] = setTimeout(update, intrerval);\r\n        }, intrerval);\r\n        timers.push(timer)\r\n    }\r\n    \r\n    let closeCom = this.contextMenu.querySelector('.close');\r\n    this.disposeTimer && closeCom.removeEventListener(\"click\", this.disposeTimer);\r\n    this.disposeTimer = function () {\r\n//console.log(\"STOP TIME\")\r\n        timers.forEach(t=>clearTimeout(t));\r\n        timers.length = 0;\r\n    };\r\n    closeCom.addEventListener(\"click\", this.disposeTimer);\r\n}\r\n\r\nmodule.exports = SpecialFloatView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/SpecialFloatView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/SpecialFloatView.css\n// module id = 26\n// module chunks = 0","let _getMaxZindex = function(){\r\n    let dialogs = document.querySelectorAll('.ui-dialog'),\r\n    z,\r\n    zMax = Array.prototype.map.call(document.querySelectorAll('.ui-front'), e=>e).reduce((p,c)=>{\r\n        z = parseFloat(getComputedStyle(c).zIndex);\r\n        return isNaN(z) || z<=p ? p : z;\r\n    }, 0);\r\n    zMax = Array.prototype.map.call(document.querySelectorAll('.float_view'), e=>e).reduce((p,c)=>{\r\n        z = parseFloat(getComputedStyle(c).zIndex);\r\n        return isNaN(z) || z<=p ? p : z;\r\n    }, zMax);\r\n    return zMax;\r\n};\r\nconst BaseFloatView = function (){\r\n    let frame = document.createElement(\"div\"); \r\n    frame.className = \"float_view\";\r\n    frame.style.position = \"absolute\";\r\n    frame.style.display = \"none\";\r\n    let x, y;\r\n    frame.addEventListener('mousedown', e=>{\r\n        if (!this.allowMove)\r\n            return;\r\n            \r\n        x = e.clientX; y = e.clientY;\r\n        frame.style.zIndex = _getMaxZindex();\r\n        document.body.append(frame);\r\n            \r\n        if(e.stopPropagation) e.stopPropagation();\r\n        if(e.preventDefault) e.preventDefault();\r\n        e.cancelBubble=true;\r\n        e.returnValue=false;\r\n    });\r\n    frame.addEventListener('mouseup', e=>{\r\n        x = false; y = false;\r\n    });\r\n    document.body.addEventListener('mousemove', e=>{\r\n        if (!x && !y)\r\n            return;\r\n        let dx = e.clientX - x, dy = e.clientY - y,\r\n        rect = frame.getBoundingClientRect(),\r\n        fx = rect.left, fy = rect.top;\r\n        frame.style.left = fx + dx + \"px\";\r\n        frame.style.top = fy + dy + \"px\";\r\n        x = e.clientX; y = e.clientY;\r\n\r\n        if(e.stopPropagation) e.stopPropagation();\r\n        if(e.preventDefault) e.preventDefault();\r\n        e.cancelBubble=true;\r\n        e.returnValue=false;\r\n    }); \r\n    this.frame = frame;   \r\n    this.allowMove = true;\r\n}\r\n\r\nBaseFloatView.prototype = function () {\r\n    return {\r\n        get left(){ return this.frame.getBoundingClientRect().left; },\r\n        set left(v){ this.frame.style.left = v + \"px\"; },\r\n        get top(){ return this.frame.getBoundingClientRect().top; },\r\n        set top(v){ this.frame.style.top = v + \"px\"; },\r\n        get right(){ return this.frame.getBoundingClientRect().right; },\r\n        get bottom(){ return this.frame.getBoundingClientRect().bottom; },\r\n        get width(){ return this.frame.getBoundingClientRect().width; },\r\n        set width(v){ this.frame.style.width = v + \"px\"; },\r\n        get height(){ return this.frame.getBoundingClientRect().height; },\r\n        set height(v){ this.frame.style.height = v + \"px\"; },\r\n        show: function () {\r\n            this.frame.style.zIndex = _getMaxZindex();\r\n            document.body.append(this.frame);\r\n            this.frame.style.display = \"block\";\r\n        },\r\n        hide: function () {\r\n            this.frame.remove();\r\n        }\r\n    }\r\n}();\r\n\r\nmodule.exports = BaseFloatView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/BaseFloatView.js","require(\"./VesselInfoScreen.css\")\r\n\r\nmodule.exports = function ({modulePath, aisServices}){\r\n        var _ais,  \r\n        _galery, \r\n        _register, \r\n        _regcap,    \r\n        _leftPanel,  \r\n        _minh,\r\n        _lloyds,\r\n        resize,\r\n        menuAction,       \r\n\t    scheme = document.location.href.replace(/^(https?:).+/, \"$1\"),\r\n        show = function(vessel){\r\n//console.log(vessel) \r\n            $(\"body\").append(''+  \r\n'<table class=\"vessel-info-page overlay\">' +\r\n        '<tr>' +\r\n            '<td>' +\r\n'<table class=\"vessel-info-page container\">' +\r\n    '<tr>' +\r\n        '<td class=\"column1\">' +\r\n                '<table>' +\r\n                    '<tr>' +\r\n                        '<td>' +\r\n                            '<div>' +\r\n                                '<div class=\"title\">' +\r\n                                   '<div class=\"cell\">'+vessel.vessel_name+'<div class=\"timestamp\">'+vessel.ts_pos_utc+'</div></div>  ' +                  \r\n                                '</div>' +\r\n                                '<div class=\"menu\">' +\r\n                                '<div class=\"ais cell menu-item active\"><img src=\"'+modulePath+'svg/info_gen.svg\" class=\"icon\">'+_gtxt(\"AISSearch2.infoscreen_gen\")+'</div>' +\r\n                                '<div class=\"register cell menu-item\"><img src=\"'+modulePath+'svg/info.svg\" class=\"icon\">'+_gtxt(\"AISSearch2.infoscreen_reg\")+'</div>' +\r\n                                '<div class=\"galery cell menu-item\"><img src=\"'+modulePath+'svg/photogallery.svg\" class=\"icon\">'+_gtxt(\"AISSearch2.infoscreen_gal\")+'<div class=\"counter\">0</div></div>' +\r\n                               '</div>' +\r\n                            '</div>  ' +\r\n                        '</td>' +\r\n                    '</tr>' +\r\n                    '<tr>' +\r\n                        '<td class=\"frame\">' +\r\n                                '<div class=\"photo\">' +\r\n                                    '<img src=\"'+modulePath+'svg/no-image.svg\" class=\"no-image\">' +\r\n                                '</div>  ' +  \r\n                        '</td>' +\r\n                    '</tr>' +\r\n                '</table>' +\r\n    '</td>' +\r\n    '<td class=\"column2\">' +\r\n        '<div class=\"close-button-holder\">' +\r\n            '<div class=\"close-button\" title=\"'+_gtxt(\"AISSearch2.close_but\")+'\"></div>' +\r\n        '</div>' +\r\n        '<div class=\"register panel\">' +\r\n            '<div class=\"caption\">' +\r\n                '<span style=\"display: inline-block;height: 100%;vertical-align: middle;width: 40px;\"></span>' +\r\n                '<img src=\"img/progress.gif\" style=\"vertical-align: middle\">' +\r\n            '</div>' +\r\n            '<div class=\"menu\">' +\r\n                '<div>' +\r\n                    '<table>' +\r\n                        '<tr>' +\r\n                            '<td><div class=\"general menu-item active\">'+_gtxt(\"AISSearch2.reg_general_tab\")+'</div></td>' +\r\n                            '<td><div class=\"build menu-item\">'+_gtxt(\"AISSearch2.reg_build_tab\")+'</div></td>' +\r\n                            '<td><div class=\"dimensions menu-item\">'+_gtxt(\"AISSearch2.reg_chars_tab\")+'</div></td>' +\r\n                            '<td><div class=\"gears menu-item\">'+_gtxt(\"AISSearch2.reg_devs_tab\")+'</div></td>' +\r\n                        '</tr>' +\r\n                    '</table>' +\r\n                '</div>' +\r\n            '</div>' +\r\n            '<div class=\"content\">' +\r\n                '<div class=\"placeholder\"></div>' +\r\n            '</div>' +\r\n        '</div>' +\r\n\r\n        '<div class=\"galery panel\">' +   \r\n'<form action=\"' + aisServices + 'Upload.ashx\" class=\"uploadFile\" method=\"post\" enctype=\"multipart/form-data\" target=\"upload_target\" style=\"display:none\" >' +\r\n    '<input name=\"Filedata\" class=\"chooseFile\" type=\"file\">' +    \r\n    '<input name=\"imo\" type=\"hidden\" value=\"'+vessel.imo+'\">' +    \r\n    '<input name=\"mmsi\" type=\"hidden\" value=\"'+vessel.mmsi+'\">' +\r\n          //'<input type=\"submit\" name=\"submitBtn\" value=\"Upload\" />' +\r\n'</form>' + \r\n'<iframe id=\"upload_target\" name=\"upload_target\" src=\"#\" style=\"width:0;height:0;border:0px solid #fff;\"></iframe>' + \r\n            '<div class=\"placeholder\">' +\r\n                '<div class=\"photo\" onclick=\"document.querySelector(\\'.vessel-info-page .chooseFile\\').click();\"'+\r\n                ' style=\"background-image: url('+modulePath+'svg/add-image.svg);background-size: 50px;\"></div>' +                \r\n            '</div>' +\r\n        '</div>' +\r\n\r\n        '<div class=\"ais panel\">' +\r\n            '<div class=\"placeholder\"></div>' +\r\n        '</div>' +\r\n    '</td>' +\r\n    '</tr>' +\r\n'</table>' +\r\n            '</td>' +\r\n        '</tr>' +\r\n    '</table>'           \r\n            );\r\n        window.addEventListener(\"message\", function(e){\r\n            if (e.data.search(/\"uploaded\"\\:/)<0)\r\n                return;\r\n            var data = JSON.parse(e.data);    \r\n            if (data.id && parseInt(data.id)) { //uploaded:\r\n//console.log('UPLOADED '+id)\r\n                var counter = $('.vessel-info-page .menu-item .counter'), \r\n                count = parseInt(counter.text())+1;\r\n                counter.text(count).css('display', 'inline');\r\n                var preview = $(\"<div class='photo preview' id='\"+data.id+\"' style='background-image: url(\"+aisServices+\"getphoto.ashx?id=\"+data.id+\")'/>\");\r\n                $('.vessel-info-page .uploader').replaceWith(preview);\r\n                preview.click(showPicture);\r\n//console.log(preview)\r\n            }\r\n            else {//uploadError:            \r\n                $('.vessel-info-page .uploader').remove();\r\n                console.log(data.errmsg)\r\n            }  \r\n        }, false);\r\n\r\n        $('<img src=\"' + scheme + window.serverBase.replace(/^https?:/, \"\")+'plugins/ais/getphoto.ashx?mmsi=' + vessel.mmsi + '\">')\r\n        .load(function () {\t\r\n            if (this)\r\n                $('.column1 .photo img.no-image').replaceWith(this);\t\r\n        }).error(function(){\t\t\t\r\n            $('<img src=\"' + scheme + '//photos.marinetraffic.com/ais/showphoto.aspx?size=thumb&mmsi=' + vessel.mmsi + '\">').load(function () {\r\n                    if (this)\r\n                        $('.column1 .photo img.no-image').replaceWith(this);\r\n            });\r\n        });\r\n\r\n        $('.vessel-info-page .chooseFile').change(function(){            \r\n            $('<div class=\"photo uploader\" style=\"background-image:url(img/progress.gif);background-size:20px;\"></div>')\r\n            .insertAfter($('.vessel-info-page .galery .placeholder .photo').eq(0));\r\n            $('.vessel-info-page .uploadFile')[0].submit();\r\n        })\r\n        $('.vessel-info-page .close-button').click(function(){\r\n            $('.vessel-info-page.overlay').remove();\r\n        });\r\n/**/\r\n        $('.vessel-info-page .menu img[src$=\".svg\"]').each(function() {\r\n            var $img = jQuery(this);\r\n            var imgURL = $img.attr('src');\r\n            var attributes = $img.prop(\"attributes\");\r\n\r\n            $.get(imgURL, function(data) {\r\n                // Get the SVG tag, ignore the rest\r\n                var $svg = jQuery(data).find('svg');\r\n\r\n                // Remove any invalid XML tags\r\n                $svg = $svg.removeAttr('xmlns:a');\r\n\r\n                // Loop through IMG attributes and apply on SVG\r\n                $.each(attributes, function() {\r\n                    $svg.attr(this.name, this.value);\r\n                });\r\n\r\n                // Replace IMG with SVG\r\n                $img.replaceWith($svg);\r\n            }, 'xml');\r\n        });\r\n\r\n        _ais = document.querySelector('.vessel-info-page .column2 .ais') \r\n        _galery = document.querySelector('.vessel-info-page .column2 .galery')\r\n        _register = document.querySelector('.vessel-info-page .column2 .register .content')\r\n        _regcap = document.querySelector('.vessel-info-page .column2 .register .caption')    \r\n        _leftPanel = document.querySelector('.vessel-info-page .column1 table')      \r\n        _minh = 420\r\n        resize = function(){\r\n            var h = Math.floor(window.innerHeight*0.8);\r\n            if (h>_minh){\r\n                _leftPanel.style.height = _ais.style.height = _galery.style.height = h + \"px\";\r\n                _register.style.height = h - _regcap.offsetHeight + \"px\";\r\n            }\r\n            else{\r\n                _leftPanel.style.height = _ais.style.height = _galery.style.height = _minh + \"px\";\r\n                _register.style.height = _minh - _regcap.offsetHeight + \"px\";\r\n            }      \r\n        }\r\n        menuAction = function(e){\r\n            var target = e.currentTarget, p = target.parentElement, mia;\r\n            while(!(mia = p.querySelectorAll('.menu-item')) || mia.length<2){\r\n                p = p.parentElement;\r\n            }\r\n            for (var j=0; j<mia.length; ++j){\r\n                    //console.log( mia[j])\r\n                mia[j].className = mia[j].className.replace(/ active/, \"\");\r\n                var panel = document.querySelector('.panel.' + mia[j].classList[0]);\r\n                if (panel){\r\n                    if (mia[j]!=target)\r\n                    panel.style.display = \"none\";\r\n                    else{\r\n                    panel.style.display = \"block\";\r\n                    }\r\n                }\r\n            }\r\n            target.className += \" active\"\r\n            resize(); \r\n        }\r\n\r\n        window.addEventListener(\"resize\", resize, false); \r\n    \r\n        var mia = document.querySelectorAll('.column1 .menu-item');\r\n        for (var i=0; i<mia.length; ++i){\r\n            mia[i].addEventListener('click', menuAction)\r\n        }\r\n    \r\n        resize();    \r\n        $(_ais).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        $(_galery).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        $(_register).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        document.querySelector('.vessel-info-page .container').style.display = \"table\";  \r\n    },\r\n    showPicture = function(){\r\n//console.log($(this))\r\n            $('.vessel-info-page .picture').remove();\r\n            var div = $('<div class=\"picture\" style=\"display:none;position:absolute;\"></div>')\r\n            .insertAfter('.vessel-info-page.container').click(function(){this.remove()});\r\n            $('<img src=\"'+aisServices+'getphoto.ashx?id='+this.id+'\">').load(function() {\r\n                    if (this){\r\n                        var w = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,\r\n                        h = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\r\n                        div.append(this)\r\n                        .css('display', 'table')\r\n                        .offset({\r\n                            left:(w-this.offsetWidth)/2,\r\n                            top:(h-this.offsetHeight)/2})\r\n//console.log($(this))\r\n//console.log(window.screen.width+\"-\"+$(this)[0].offsetWidth)\r\n//console.log((window.screen.width-$(this)[0].offsetWidth)/2)\r\n                    }\r\n            });\r\n        },\r\n    drawGallery = function(gallery){\r\n        if (gallery.length>0)\r\n            $('.vessel-info-page .menu-item .counter').text(gallery.length).css('display', 'inline');   \r\n        var galcontent = $(\".vessel-info-page .galery .placeholder\")\r\n        for (var i=0; i<gallery.length; ++i)\r\n            galcontent.append(\"<div class='photo preview' id='\"+gallery[i]+\"' style='background-image: url(\"+aisServices+\"getphoto.ashx?id=\"+gallery[i]+\")'/>\" )             \r\n        $('.photo.preview').click(showPicture)\r\n        resize();     \r\n    },\r\n    drawAis = function(ledokol){\r\n    var aiscontent = document.querySelector(\".vessel-info-page .ais .placeholder\")\r\n    aiscontent.innerHTML = \"\" +                \r\n    \"<div class='caption'><div>\"+_gtxt(\"AISSearch2.vessel_info\")+\"</div></div>\" +\r\n    \"<table>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.vessel_name\")+\"</td><td><b>\"+ledokol.vessel_name+(ledokol.registry_name?\" (\"+ledokol.registry_name+\")\":\"\")+\"</b></td></tr>\" +\r\n        \"<tr><td>IMO</td><td>\"+ledokol.imo+\"</td></tr>\" +\r\n        \"<tr><td>MMSI</td><td>\"+ledokol.mmsi+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.vessel_type\")+\"</td><td>\"+ledokol.vessel_type+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.flag\")+\"</td><td>\"+ledokol.flag_country+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.callsign\")+\"</td><td>\"+ledokol.callsign+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.length\")+\"</td><td>\"+ledokol.length+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.width\")+\"</td><td>\"+ledokol.width+\"</td></tr>\" +\r\n    \"</table>\" +\r\n    \"<div class='caption'><div>\"+_gtxt(\"AISSearch2.vessel_voyage\")+\"</div></div>\" +\r\n    \"<table>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.nav_status\")+\"</td><td>\"+ledokol.nav_status+\"</td></tr>\" +\r\n        \"<tr><td>COG</td><td>\"+ledokol.cog+\"</td></tr>\" +\r\n        \"<tr><td>SOG</td><td>\"+ledokol.sog+\"</td></tr>\" +\r\n        \"<tr><td>HDG</td><td>\"+ledokol.heading+\"</td></tr>\" +\r\n        \"<tr><td>ROT</td><td>\"+ledokol.rot+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.draught\")+\"</td><td>\"+ledokol.draught+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.destination\")+\"</td><td>\"+ledokol.destination+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.eta\")+\"</td><td>\"+ledokol.ts_eta+\"</td></tr>\" +\r\n    \"</table>\";     \r\n        resize();        \r\n    },\r\n    drawRegister = function(ledokol){\r\n        let regcontent = _register.querySelector(\".placeholder\"),\r\n        drawTable = function(groups, article, display){\r\n            let s = \"<div class='panel \"+article+\" article' style='display:\"+display+\"'>\";\r\n            for(let i=0; i<groups.length; ++i){\r\n                if (!groups[i])\r\n                    continue;\r\n                s += \"<div class='group'>\"+groups[i].name+\"</div><table>\"\r\n                for(let j=0; j<groups[i].properties.length; ++j){\r\n                    let pn = groups[i].properties[j].name,\r\n                    desc = nsGmx.Translations.getLanguage()==\"rus\"?groups[i].properties[j].description:null, \r\n                    pv = groups[i].properties[j].value\r\n                    s+= \"<tr><td>\"+pn+\r\n                    (desc ? \"<div class='description'>\" + desc + \"</div>\" : \"\")+ \r\n                    \"</td><td>\"+(pn==\"Название судна\"||pn==\"Латинское название\"?\"<b>\"+pv+\"</b>\":pv)+\"</td></tr>\"\r\n                }\r\n                s += \"<tr><td>&nbsp;</td><td>&nbsp;</td></tr></table>\"\r\n            }\r\n            s += \"</div>\"\r\n            return s;\r\n        }\t\r\n\r\n        _regcap.innerHTML = \"<table class='register-title'>\"+\r\n        \"<tr><td><span class='switch active'>\"+_gtxt(\"AISSearch2.rmrs\")+\"</span> <span class='switch'>Lloyd's register</span></td></tr>\"+\r\n        \"<tr><td><span class='update'></span></td></tr>\"+\r\n        \"</table>\";\r\n\r\n        let drawRMR = function(){\r\n            if (ledokol) {\r\n                regcontent.innerHTML =\r\n                    drawTable([ledokol.data[0], ledokol.data[1], ledokol.data[9]], \"general\", \"block\") +\r\n                    drawTable([ledokol.data[2]], \"build\", \"none\") +\r\n                    drawTable([ledokol.data[3]], \"dimensions\", \"none\") +\r\n                    drawTable([ledokol.data[4], ledokol.data[5], ledokol.data[6], ledokol.data[7], ledokol.data[8]], \"gears\", \"none\");\r\n                _regcap.querySelector('.update').innerText = _gtxt(\"AISSearch2.last_update\") + \" \" + ledokol.version.replace(/ \\S+$/g, '');\r\n            }\r\n            else{\r\n                regcontent.innerHTML = \"\";\r\n                _regcap.querySelector('.update').innerHTML = \"&nbsp;\"; \r\n            }\r\n        },\r\n        drawLloyds = function(){\r\n            regcontent.innerHTML =\r\n                drawTable([_lloyds.data[15], _lloyds.data[14], _lloyds.data[13], _lloyds.data[11], _lloyds.data[0]], \"general\", \"block\") +\r\n                drawTable([_lloyds.data[10], _lloyds.data[12]], \"build\", \"none\") +\r\n                drawTable([_lloyds.data[9], _lloyds.data[8], _lloyds.data[7], _lloyds.data[6]], \"dimensions\", \"none\") +\r\n                drawTable([_lloyds.data[4], _lloyds.data[3], _lloyds.data[2], _lloyds.data[1], _lloyds.data[5]], \"gears\", \"none\");\r\n            _regcap.querySelector('.update').innerText = _gtxt(\"AISSearch2.last_update\") + \" \" + _lloyds.version.replace(/ \\S+$/g, '');   \r\n        },\r\n        regSwitches = _regcap.querySelectorAll(\".switch\");\r\n        regSwitches.forEach((item, i)=>item.addEventListener('click', e => {\r\n            let cl = e.currentTarget.classList;\r\n            if (!cl.contains('active')) {\r\n                _regcap.querySelector(\".switch.active\").classList.remove('active');\r\n                cl.add('active');\r\n                switch (i){\r\n                    case 0:\r\n                        drawRMR();\r\n                        break;\r\n                    case 1:\r\n                        if (_lloyds)\r\n                            drawLloyds();\r\n                        else\r\n                            regcontent.innerHTML = \"\";                        \r\n                        break;\r\n                }           \r\n                resize();   \r\n                mia[0] && mia[0].click();\r\n            }\r\n        }));\r\n        var mia = document.querySelectorAll('.column2 .menu-item');\r\n        for (var i=0; i<mia.length; ++i){\r\n            mia[i].addEventListener('click', menuAction)\r\n        }\r\n        drawRMR();             \r\n        resize(); \r\n        if (!ledokol)        \r\n            regSwitches[1].click();         \r\n    }\r\n\t\r\n\tlet open = function(vessel, vessel2){\r\n                    show(vessel2);\r\n                    var onFail = function(error){\r\n                        if (error!='register_no_data')\r\n                            console.log(error)\r\n                        _regcap.innerHTML = \"\";\r\n                    } \r\n                    new Promise(function(resolve, reject){\r\n                        (function wait(){\r\n                            if(!vessel2)\r\n                                setTimeout(wait, 100);\r\n                        })();\r\n                        resolve(vessel2)\r\n                    })\r\n                    .then(function(ship){\r\n//console.log(ship)\r\n                        drawAis(ship)\r\n                    }, \r\n                    onFail);\r\n                    var registerServerUrl = scheme + \"//kosmosnimki.ru/demo/register/api/v1/\",\r\n                        lloydsServerUrl = scheme + \"//kosmosnimki.ru/demo/lloyds/api/v1/\",\r\n                        rmr;\r\n                    if(vessel.imo && vessel.imo!=0 && vessel.imo!=-1){\r\n                        fetch(registerServerUrl+\"Ship/Search/\"+vessel.imo+(nsGmx.Translations.getLanguage()==\"rus\"?\"/ru\":\"/en\"))\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            if (ship.length>0)\r\n                                return fetch(registerServerUrl+\"Ship/Get/\"+ship[0].RS+(nsGmx.Translations.getLanguage()==\"rus\"?\"/ru\":\"/en\"))\r\n                            else\r\n                                return Promise.resolve({json:()=>null});\r\n                            //else\r\n                            //    return Promise.reject('register_no_data');\r\n                        })\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            //console.log(ship)\r\n                            rmr = ship;\r\n                            if (rmr)\r\n                                drawRegister(rmr);\r\n                            return fetch(lloydsServerUrl+\"Ship/Search/\"+vessel.imo+(nsGmx.Translations.getLanguage()==\"rus\"?\"/ru\":\"/en\"));\r\n                        })                        \r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            if (ship.length>0)\r\n                                return fetch(lloydsServerUrl+\"Ship/Get/\"+ship[0].RS+(nsGmx.Translations.getLanguage()==\"rus\"?\"/ru\":\"/en\"))\r\n                            else\r\n                                return Promise.reject('register_no_data');\r\n                        })\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            _lloyds = ship;\r\n                            if (nsGmx.Translations.getLanguage()!=\"rus\"){\r\n                                _lloyds.data[15].name = \"Vessel Data\";\r\n                                _lloyds.data[14].name = \"Type and Status\";\r\n                                _lloyds.data[13].name = \"Companies\";\r\n                                _lloyds.data[12].name = \"Companies\";\r\n                                _lloyds.data[11].name = \"Safety\";\r\n                                _lloyds.data[10].name = \"History\";\r\n                                _lloyds.data[9].name = \"Characteristics\";\r\n                                _lloyds.data[8].name = \"Dimensions\";\r\n                                _lloyds.data[7].name = \"Hull\";\r\n                                _lloyds.data[6].name = \"Capacity\";\r\n                                _lloyds.data[5].name = \"Cargo\";\r\n                                _lloyds.data[4].name = \"Machinery\";\r\n                                _lloyds.data[3].name = \"Fuel\";\r\n                                _lloyds.data[2].name = \"Energy Supply\";\r\n                                _lloyds.data[1].name = \"Propellers and Thrusters\";\r\n                                _lloyds.data[0].name = \"Codes\";\r\n                            }\r\n                            if (!rmr)\r\n                                drawRegister(rmr);\r\n                        })\r\n                        .catch( onFail );\r\n                    }\r\n                    else                    \r\n                        _regcap.innerHTML = \"\";\r\n\r\n                    new Promise(function(resolve, reject){\r\n                        sendCrossDomainJSONRequest(aisServices + \r\n                            \"gallery.ashx?mmsi=\"+vessel.mmsi+\"&imo=\"+vessel.imo, function(response){\r\n                            if (response.Status==\"ok\") \r\n                                resolve(response.Result);\r\n                            else\r\n                                reject(response)\r\n                        });\r\n                    })\r\n                    .then(function(gallery){\r\n                        drawGallery(gallery)\r\n                    }, \r\n                    onFail);\r\n                }\r\n        \r\n    return {\r\n\t\topen:open,\r\n            show: show,\r\n            drawRegister: drawRegister,\r\n            drawAis: drawAis,\r\n            drawGallery:drawGallery\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Views/VesselInfoScreen.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/VesselInfoScreen.css\n// module id = 29\n// module chunks = 0","module.exports = function (options) {\r\n    const _baseUrl = document.location.href.replace(/^(https?:).+/, \"$1\") +\r\n        (window.serverBase.replace(/^https?:/, \"\") || '//maps.kosmosnimki.ru/'),\r\n        _aisServices = _baseUrl + \"Plugins/AIS/\",\r\n        _serverScript = _baseUrl + 'VectorLayer/Search.ashx',\r\n        { aisLastPoint: _aisLastPoint,\r\n            screenSearchLayer: _screenSearchLayer,\r\n            aisLayerID: _aisLayerID,\r\n            historyLayer: _historyLayer,\r\n            lastPointLayerAlt: _lastPointLayerAlt,\r\n            vesselLegend: _vesselLegend\r\n        } = options;\r\n\r\n    return {\r\n        baseUrl: _baseUrl,\r\n        get screenSearchLayer(){return _screenSearchLayer},\r\n        aisServices: _aisServices,\r\n        getBorder: function () {\r\n            var lmap = nsGmx.leafletMap;\r\n            var dFeatures = lmap.gmxDrawing.getFeatures();\r\n            if (dFeatures.length) { return dFeatures[dFeatures.length - 1].toGeoJSON(); }\r\n            var latLngBounds = lmap.getBounds(),\r\n                sw = latLngBounds.getSouthWest(),\r\n                ne = latLngBounds.getNorthEast(),\r\n                min = { x: sw.lng, y: sw.lat },\r\n                max = { x: ne.lng, y: ne.lat },\r\n                minX = min.x,\r\n                maxX = max.x,\r\n                geo = { type: 'Polygon', coordinates: [[[minX, min.y], [minX, max.y], [maxX, max.y], [maxX, min.y], [minX, min.y]]] },\r\n                w = (maxX - minX) / 2;\r\n\r\n            if (w >= 180) {\r\n                geo = { type: 'Polygon', coordinates: [[[-180, min.y], [-180, max.y], [180, max.y], [180, min.y], [-180, min.y]]] };\r\n            }\r\n            else if (maxX > 180 || minX < -180) {\r\n                var center = ((maxX + minX) / 2) % 360;\r\n                if (center > 180) { center -= 360; }\r\n                else if (center < -180) { center += 360; }\r\n                minX = center - w; maxX = center + w;\r\n                if (minX < -180) {\r\n                    geo = {\r\n                        type: 'MultiPolygon', coordinates: [\r\n                            [[[-180, min.y], [-180, max.y], [maxX, max.y], [maxX, min.y], [-180, min.y]]],\r\n                            [[[minX + 360, min.y], [minX + 360, max.y], [180, max.y], [180, min.y], [minX + 360, min.y]]]\r\n                        ]\r\n                    };\r\n                } else if (maxX > 180) {\r\n                    geo = {\r\n                        type: 'MultiPolygon', coordinates: [\r\n                            [[[minX, min.y], [minX, max.y], [180, max.y], [180, min.y], [minX, min.y]]],\r\n                            [[[-180, min.y], [-180, max.y], [maxX - 360, max.y], [maxX - 360, min.y], [-180, min.y]]]\r\n                        ]\r\n                    };\r\n                }\r\n            }\r\n            return geo;\r\n        },\r\n\r\n        formatTime: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleTimeString();\r\n        },\r\n        formatDate: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleDateString();\r\n        },\r\n        formatDateTime: function (d, local) {\r\n            if (d.isNaN)\r\n                return \"\";\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleString().replace(/,/, \"\");\r\n        },\r\n\r\n        formatDate2: function (d, local) {\r\n            var dd, m, y, h, mm;\r\n            if (local) {\r\n                dd = (\"0\" + d.getDate()).slice(-2);\r\n                m = (\"0\" + (d.getMonth() + 1)).slice(-2);\r\n                y = d.getFullYear();\r\n                h = (\"0\" + d.getHours()).slice(-2);\r\n                mm = (\"0\" + d.getMinutes()).slice(-2);\r\n                return dd + \".\" + m + \".\" + y + \" \" + h + \":\" + mm +\r\n                    \" (\" + (\"0\" + d.getUTCHours()).slice(-2) + \":\" + (\"0\" + d.getUTCMinutes()).slice(-2) + \" UTC)\";\r\n            }\r\n            else {\r\n                dd = (\"0\" + d.getUTCDate()).slice(-2);\r\n                m = (\"0\" + (d.getUTCMonth() + 1)).slice(-2);\r\n                y = d.getUTCFullYear();\r\n                h = (\"0\" + d.getUTCHours()).slice(-2);\r\n                mm = (\"0\" + d.getUTCMinutes()).slice(-2);\r\n                var\r\n                    ldd = (\"0\" + d.getDate()).slice(-2),\r\n                    lm = (\"0\" + (d.getMonth() + 1)).slice(-2),\r\n                    ly = d.getFullYear(),\r\n                    lh = (\"0\" + d.getHours()).slice(-2),\r\n                    lmm = (\"0\" + d.getMinutes()).slice(-2),\r\n                    offset = -d.getTimezoneOffset() / 60;\r\n                return dd + \".\" + m + \".\" + y + \" <span class='utc'>\" + h + \":\" + mm + \" UTC</span> (\" + lh + \":\" + lmm + \")\"\r\n                //return dd+\".\"+m+\".\"+y+\" \"+h+\":\"+mm+\" UTC <br>\"+\r\n                //\"<span class='small'>(\"+ldd+\".\"+lm+\".\"+ly+\" \"+lh+\":\"+lmm+\" UTC\"+(offset>0?\"+\":\"\")+offset+\")</span>\";\r\n            }\r\n        },\r\n        placeVesselTypeIcon: function(vessel){\r\n            let protocol = document.location.protocol,\r\n            icon;            \r\n            // speed icon\r\n            icon = _vesselLegend.getIconAlt(\"vessel.vessel_name\", vessel.sog);\r\n            if (icon){\r\n                vessel.iconAlt = protocol + icon.url; \r\n                vessel.imgAlt =  icon.img;\r\n                vessel.colorAlt = icon.color;\r\n            }         \r\n            // type icon\r\n            icon = _vesselLegend.getIcon(vessel.vessel_type, vessel.sog);\r\n            if (icon){\r\n                vessel.icon = protocol + icon.url;\r\n                vessel.img =  icon.img;\r\n                vessel.color = icon.color;\r\n            }\r\n        },\r\n        searchPositionsAgg2: function (mmsi, dateInterval, callback) {\r\n            fetch(`${_baseUrl}plugins/AIS/SearchPositionsAsync.ashx?layer=${_historyLayer}&mmsi=${mmsi}&s=${dateInterval.dateBegin.toISOString()}&e=${dateInterval.dateEnd.toISOString()}`, {\r\n                method: 'POST', // *GET, POST, PUT, DELETE, etc.\r\n                mode: 'cors', // no-cors, cors, *same-origin\r\n                cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\r\n                credentials: 'include' // include, *same-origin, omit\r\n            })\r\n            .then(response => response.json())\r\n            .then(callback);\r\n        },\r\n        searchPositionsAgg2Mf: function (mmsi, dateInterval, callback) {\r\n            fetch(`${_baseUrl}plugins/AIS/SearchMfPositionsAsync.ashx?layer=${_historyLayer}&mmsi=${mmsi}&s=${dateInterval.dateBegin.toISOString()}&e=${dateInterval.dateEnd.toISOString()}`, {\r\n                method: 'POST', // *GET, POST, PUT, DELETE, etc.\r\n                mode: 'cors', // no-cors, cors, *same-origin\r\n                cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\r\n                credentials: 'include' // include, *same-origin, omit\r\n            })\r\n            .then(response => response.json())\r\n            .then(callback);\r\n        },\r\n        searchPositionsAgg: function (vessels, dateInterval, callback) {\r\n            //console.log(dateInterval);\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _historyLayer, //'8EE2C7996800458AAF70BABB43321FA4',//\r\n                orderdirection: 'desc',\r\n                orderby: 'ts_pos_utc',\r\n                columns:'[{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"flag_country\"},{\"Value\":\"callsign\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"cog\"},{\"Value\":\"sog\"},{\"Value\":\"draught\"},{\"Value\":\"vessel_type\"},'+\r\n                '{\"Value\":\"destination\"},{\"Value\":\"ts_eta\"},{\"Value\":\"nav_status\"},{\"Value\":\"heading\"},{\"Value\":\"rot\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"},{\"Value\":\"source\"}]',\r\n                \r\n                query: \"([mmsi] IN (\" + vessels.join(',') + \")) and '\" + dateInterval.dateBegin.toISOString() + \"'<=[ts_pos_utc] and [ts_pos_utc]<'\" + dateInterval.dateEnd.toISOString() + \"'\"\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchPositions: function (vessels, dateInterval, callback) {\r\n            //console.log(\"searchById\");\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _historyLayer, //'8EE2C7996800458AAF70BABB43321FA4',//\r\n                //orderdirection: 'desc',\r\n                //orderby: 'ts_pos_utc',\r\n                query: \"([mmsi] IN (\" + vessels.join(',') + \")) and '\" + dateInterval.dateBegin.toISOString() + \"'<=[ts_pos_utc] and [ts_pos_utc]<'\" + dateInterval.dateEnd.toISOString() + \"'\"\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchById: function (aid, callback) {\r\n            //console.log(\"searchById\");\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _aisLayerID, //'8EE2C7996800458AAF70BABB43321FA4'\r\n                columns: `[{\"Value\":\"id\"},\r\n                        {\"Value\":\"vessel_name\"},\r\n                        {\"Value\":\"mmsi\"},\r\n                        {\"Value\":\"imo\"},\r\n                        {\"Value\":\"flag_country\"},\r\n                        {\"Value\":\"callsign\"},\r\n                        {\"Value\":\"ts_pos_utc\"},\r\n                        {\"Value\":\"cog\"},\r\n                        {\"Value\":\"sog\"},\r\n                        {\"Value\":\"draught\"},\r\n                        {\"Value\":\"vessel_type\"},\r\n                        {\"Value\":\"destination\"},\r\n                        {\"Value\":\"ts_eta\"},\r\n                        {\"Value\":\"nav_status\"},\r\n                        {\"Value\":\"heading\"},\r\n                        {\"Value\":\"rot\"},\r\n                        {\"Value\":\"longitude\"},\r\n                        {\"Value\":\"latitude\"},\r\n                        {\"Value\":\"source\"}]`,                \r\n                query: \"([id] IN (\" + aid.join(',') + \"))\"\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        \r\n        searchString2: function (query, isfuzzy, callback) {\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _aisLastPoint,\r\n                columns: '[{\"Value\":\"vessel_name\"},{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"vessel_type\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"},{\"Value\":\"source\"}]',\r\n                //orderdirection: 'desc',\r\n                //orderby: 'vessel_name',\r\n                query: query\r\n            };\r\n            if (isfuzzy)\r\n                request.pagesize = 1000;\r\n            L.gmxUtil.sendCrossDomainPostRequest(_aisServices + \"searchship.ashx\", request, callback);\r\n        },\r\n        searchString: function (searchString, isfuzzy, callback) {\r\n            //console.log(_aisLastPoint+\", \"+_aisLayerID)\r\n            var query = \"\";\r\n            if (searchString) {\r\n                searchString = searchString.toUpperCase();\r\n                if (searchString.search(/[^\\d, ]/) === -1) {\r\n                    var arr = searchString.replace(/ /g, '').split(/,/);\r\n                    query = \"([mmsi] IN (\" + arr.join(',') + \"))\" +\r\n                        \"OR ([imo] IN (\" + arr.join(',') + \"))\"\r\n                } else {\r\n                    if (isfuzzy)\r\n                        query = '([vessel_name] startswith \\'' + searchString + '\\') OR ([vessel_name] contains \\' ' + searchString + '\\')';\r\n                    else\r\n                        query = '([vessel_name] startswith \\'' + searchString + '\\') OR ([vessel_name] contains \\' ' + searchString + '\\')';\r\n                }\r\n            }\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _aisLastPoint,\r\n                columns: '[{\"Value\":\"vessel_name\"},{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"vessel_type\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"},{\"Value\":\"source\"}]',\r\n                //orderdirection: 'desc',\r\n                //orderby: 'vessel_name',\r\n                query: query\r\n            };\r\n            if (isfuzzy)\r\n                request.pagesize = 1000;\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchNames: function (avessels, callback) {\r\n            var a = avessels.reduce((p,c)=>{\r\n                if((c.mmsi && c.mmsi!=\"\") || (c.imo && c.imo!=\"\" && c.imo!=-1)) \r\n                    p.push(c); \r\n                return p;\r\n            },[]),\r\n            request = {\r\n                WrapStyle: 'window',\r\n                layer: _aisLastPoint,\r\n                orderdirection: 'desc',\r\n                orderby: 'ts_pos_utc',\r\n                query: a.map(function (v) { return \"([mmsi]=\" + v.mmsi + (v.imo && v.imo != \"\" ? (\" and [imo]=\" + v.imo) : \"\") + \")\" }).join(\" or \")\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchScreen: function (options, callback) {\r\n            var lmap = nsGmx.leafletMap;\r\n            var latLngBounds = lmap.getBounds(),\r\n                sw = latLngBounds.getSouthWest(),\r\n                ne = latLngBounds.getNorthEast(),\r\n                min = { x: sw.lng, y: sw.lat },\r\n                max = { x: ne.lng, y: ne.lat };\r\n            // let queryParams = { WrapStyle: 'window', minx: min.x, miny: min.y, maxx: max.x, maxy: max.y, layer: _screenSearchLayer },\r\n            // dateInterval = nsGmx.widgets.commonCalendar.getDateInterval();\r\n            // queryParams.s = options.dateInterval.get('dateBegin').toJSON(),\r\n            // queryParams.e = options.dateInterval.get('dateEnd').toJSON();\r\n//console.log(queryParams);\r\n            //L.gmxUtil.sendCrossDomainPostRequest(_aisServices + \"SearchScreenAsync.ashx\",\r\n            // L.gmxUtil.sendCrossDomainPostRequest(_aisServices + \"SearchScreen.ashx\",\r\n            //     queryParams,\r\n            //     callback);\r\n            fetch(_aisServices + `SearchScreenAsync.ashx?minx=${min.x}&miny=${min.y}&maxx=${max.x}&maxy=${max.y}&layer=${_screenSearchLayer}\r\n&s=${options.dateInterval.get('dateBegin').toJSON()}&e=${options.dateInterval.get('dateEnd').toJSON()}`, {\r\n                method: 'GET', \r\n                mode: 'cors', \r\n                cache: 'no-cache', \r\n                credentials: 'include', \r\n            })\r\n            .then(function(response) {\r\n                return response.json();\r\n            })\r\n            .then(callback);\r\n        }\r\n    };\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/Search/Searcher.js","const LegendControl = function (tools, aisLastPointLayer, lastPointLayerAlt) {\r\n    const _layersByID = nsGmx.gmxMap.layersByID,\r\n        _layers = [_layersByID[aisLastPointLayer], _layersByID[lastPointLayerAlt]],\r\n        _getIcons = function () {\r\n            _layers[0] && _layers[0]._gmx.properties.gmxStyles.styles.forEach(s => {\r\n                let icon = {\r\n                    \"filter\": s.Filter, \r\n                    \"url\": s.RenderStyle.iconUrl.replace(/^https?:/, \"\")\r\n                        .replace(/^\\/\\/kosmosnimki.ru/, \"//www.kosmosnimki.ru\"), \"name\": s.Name,\r\n                    \"img\": new Image(),\r\n                    \"typeColor\": {}\r\n                };\r\n                _icons.push(icon);\r\n                _iconsDict[icon.filter] = {url:icon.url, name:icon.name, img: icon.img, color: icon.typeColor};\r\n            });\r\n            _layers[1] && _layers[1]._gmx.properties.gmxStyles.styles.forEach(s => {\r\n                let icon = {\r\n                    \"filter\": s.Filter.replace(/([^<>=])=([^=])/g, \"$1==$2\")\r\n                        .replace(/ *not ((.(?!( and | or |$)))+.)/ig, \" !($1)\")\r\n                        .replace(/ or /ig, \" || \").replace(/ and /ig, \" && \"), \r\n                    \"url\": s.RenderStyle.iconUrl.replace(/^https?:/, \"\")\r\n                        .replace(/^\\/\\/kosmosnimki.ru/, \"//www.kosmosnimki.ru\"), \"name\": s.Name,\r\n                    \"img\": new Image(),\r\n                    \"typeColor\": {}\r\n                };\r\n                _iconsAlt.push(icon);\r\n                _iconsAltDict[icon.filter] = {url:icon.url, name:icon.name, img: icon.img, color: icon.typeColor};\r\n            });\r\n// console.log(_icons);\r\n// console.log(_iconsAlt);\r\n        },\r\n        _getSvgPromise = ic => {\r\n            return new Promise(resolve => {\r\n                let httpRequest = new XMLHttpRequest();\r\n                httpRequest.onreadystatechange = function () {\r\n                    if (httpRequest.readyState === 4) {\r\n                        ic.svg = httpRequest.responseText;\r\n                        let a = /\\.cls-1{fill:(#[^};]+)/.exec(ic.svg);\r\n                        ic.color = '#888';\r\n                        if (a && a.length)\r\n                            ic.color = a[1];\r\n\r\n                        ic.typeColor.value = ic.color;\r\n \r\n                        let svg = httpRequest.responseText;\r\n                        let svg64 = btoa(unescape(encodeURIComponent(svg)));\r\n                        let b64Start = 'data:image/svg+xml;base64,';\r\n                        let image64 = b64Start + svg64; \r\n                        let imgSvg = new Image();             \r\n                        imgSvg.src = image64; \r\n//console.log(imgSvg)\r\n                        imgSvg.onload = function(){\r\n                        let canvas = document.createElement(\"canvas\");\r\n                        document.body.appendChild(canvas)\r\n                        canvas.width = imgSvg.width;\r\n                        canvas.height = imgSvg.height;\r\n                        let ctx = canvas.getContext(\"2d\");\r\n                        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n                        ctx.drawImage(imgSvg, 0, 0);\r\n                        ic.img.src = canvas.toDataURL(\"image/png\");\r\n                        //ic.img.onload = function(){\r\n//console.log(ic.img)\r\n                        document.body.removeChild(canvas);\r\n\r\n\r\n                        resolve();\r\n                        //}\r\n                        }\r\n                    }\r\n                }\r\n                httpRequest.open(\"GET\", document.location.protocol + ic.url.replace(/^https?:/, \"\"));\r\n                httpRequest.send();\r\n            })\r\n        };\r\n\r\n    let _icons = [], _iconsAlt = [], _iconsDict = {}, _iconsAltDict = {};\r\n    _getIcons();\r\n\r\n    const _svgLoader = Promise.all(_icons.map(_getSvgPromise)),\r\n        _svgAltLoader = Promise.all(_iconsAlt.map(_getSvgPromise)),\r\n        _createSwitch = function (container) {\r\n            let div = document.createElement('div');\r\n            div.innerHTML = '<table class=\"ais_legend_switch\">' +\r\n                '<tr><td class=\"legend\" colspan=\"2\"><span class=\"label\">' + _gtxt(\"AISSearch2.legend_switch\") + ':</span>' +\r\n                '<span class=\"type unselectable on\" unselectable=\"on\">' + _gtxt(\"AISSearch2.legend_type\") + '</span>' +\r\n                '<span class=\"speed unselectable\" unselectable=\"on\">' + _gtxt(\"AISSearch2.legend_speed\") + '</span></td>' +\r\n                '<td class=\"show_info\">' +\r\n                '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"24\" height=\"24\"><g><circle style=\"fill:white\" cx=\"12\" cy=\"12\" r=\"8\"></circle><path d=\"M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 9h2V7h-2v2z\" style=\"fill:#48aff1\"></path></g></svg>' +\r\n                '</td></tr>' +\r\n                '</table>';\r\n            container.footer = div;\r\n            let lswitchClick = e => {\r\n                let cl = e.target.classList;\r\n                if (!cl.contains('on')) {\r\n                    tools.switchLegend(cl.contains('.speed'));\r\n                    container.footer.querySelector('span.on').classList.remove('on');\r\n                    cl.add('on');\r\n                    if (legendDiv) {\r\n                        legendDiv.remove();\r\n                        legendDiv = null;\r\n                        container.footer.querySelector('td.show_info').click();\r\n                    }                    \r\n                }\r\n            }\r\n            container.footer.querySelector('span.speed').addEventListener('click', lswitchClick);\r\n            container.footer.querySelector('span.type').addEventListener('click', lswitchClick);\r\n            let legendDiv;\r\n            container.footer.querySelector('td.show_info').addEventListener('click', () => {\r\n                if (legendDiv) {\r\n                    legendDiv.remove();\r\n                    legendDiv = null;\r\n                    return;\r\n                }\r\n                legendDiv = document.createElement('div');\r\n                legendDiv.className = 'ais_legend_info';\r\n\r\n                let loader = !tools.needAltLegend ? _svgLoader : _svgAltLoader,\r\n                    iconCollection = !tools.needAltLegend ? _icons : _iconsAlt;\r\n                loader.then(r => {\r\n//console.log(r);\r\n                    let template = !tools.needAltLegend ? '<table class=\"colors\">' : '<table class=\"movement_colors\">';\r\n                    iconCollection.forEach((ic, i) => {\r\n                        if (ic.name.search(/\\S/) != -1) {\r\n                            // let a = /\\.cls-1{fill:(#[^};]+)/.exec(ic.svg);\r\n                            // ic.color = '#fff';\r\n                            // if (a && a.length)\r\n                            //     ic.color = a[1];\r\n                            if (!tools.needAltLegend)\r\n                                template += '<tr><td class=\"color\"><div style=\"width:10px; height:10px; background-color:' + ic.color + '\"></div></td><td>' + ic.name + '</td></tr>';\r\n                            else{\r\n                                let svg = i==iconCollection.length-1 ? '<div style=\"padding-top:2px\">' + _getAtAnchorIcon(0, ic.color, '#fff') + '</div>'\r\n                                : _getUnderWayIcon(0, ic.color, '#fff')\r\n                                template += '<tr><td class=\"color\">'+ svg + '</td><td>' + ic.name + '</td></tr>';\r\n                            }\r\n                        }\r\n                    });\r\n                    if (!tools.needAltLegend) {\r\n                        template += '<tr><td colspan=\"2\" style=\"padding: 8px 10px 0;\"><div style=\"border-bottom: solid 1px #e1e8ed;width: 100%;\"></div></td></tr>'\r\n                        template += '</table><table class=\"movement\"><tr><td>' + _getUnderWayIcon(0, '#888', '#fff') + '</td><td>' + _gtxt(\"AISSearch2.moving\") + '</td>' +\r\n                            '<td style=\"padding-top:10px\">' + _getAtAnchorIcon(0, '#888', '#fff') + '</td><td>' + _gtxt(\"AISSearch2.standing\") + '</td></tr></table>';\r\n                    }\r\n//console.log(template)\r\n                    legendDiv.innerHTML = template;\r\n                    document.body.append(legendDiv);\r\n                    let rc = legendDiv.getClientRects()[0];\r\n                    legendDiv.style.left = (window.innerWidth - rc.width - 20) + 'px';\r\n                    legendDiv.style.top = (window.innerHeight - rc.height - 40) + 'px';\r\n                });\r\n            });\r\n            if (tools.needAltLegend)\r\n                container.footer.querySelector('span.speed').click();\r\n\r\n        };\r\n\r\n    const _getUnderWayIcon = function (cog, type_color, group_style) {\r\n        return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"21\" height=\"21\" viewBox=\"0 0 21 21\" style=\"transform:rotate(' + (!cog ? 0 : cog) + 'deg)\"><title>1</title><path style=\"fill:' + type_color + ';\" d=\"M13.8,20.07a1,1,0,0,1-.69-0.28l-1.79-1.72a0.72,0.72,0,0,0-1,0L8.52,19.79a1,1,0,0,1-.69.28,1,1,0,0,1-1-1V8.65c0-1.52,1.55-7.59,4-7.59s4,6.07,4,7.59V19a1,1,0,0,1-1,1h0Z\"/><path style=\"fill:' + group_style + ';\" d=\"M10.82,1.57c1.93,0,3.5,5.57,3.5,7.09V19a0.52,0.52,0,0,1-.51.53,0.49,0.49,0,0,1-.34-0.14l-1.79-1.72a1.22,1.22,0,0,0-1.71,0L8.17,19.42a0.49,0.49,0,0,1-.34.14A0.52,0.52,0,0,1,7.32,19V8.65c0-1.51,1.57-7.09,3.5-7.09h0m0-1c-3,0-4.5,6.72-4.5,8.09V19a1.52,1.52,0,0,0,1.51,1.53,1.49,1.49,0,0,0,1-.42l1.79-1.72a0.22,0.22,0,0,1,.32,0l1.79,1.72a1.49,1.49,0,0,0,1,.42A1.52,1.52,0,0,0,15.32,19V8.65c0-1.37-1.51-8.09-4.5-8.09h0Z\"/><ellipse style=\"fill:#fff;\" cx=\"10.82\" cy=\"10.54\" rx=\"1.31\" ry=\"1.35\"/><path style=\"fill:#fff;\" d=\"M10.73,3.34h0.12a0.35,0.35,0,0,1,.35.35v6.85a0,0,0,0,1,0,0H10.38a0,0,0,0,1,0,0V3.69A0.35,0.35,0,0,1,10.73,3.34Z\"/></svg>';\r\n    },\r\n        _getAtAnchorIcon = function (cog, type_color, group_style) {\r\n            return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"21\" height=\"21\" viewBox=\"0 0 21 21\" style=\"transform:rotate(' + (!cog ? 0 : cog) + 'deg)\"><title>1</title><rect style=\"fill:' + type_color + ';stroke:' + group_style + ';stroke-miterlimit:10;\" x=\"5.9\" y=\"5.6\" width=\"9.19\" height=\"9.19\" rx=\"2\" ry=\"2\" transform=\"translate(-4.13 10.41) rotate(-45)\"/><circle style=\"fill:#fff;\" cx=\"10.5\" cy=\"10.19\" r=\"1.5\"/></svg>';\r\n        };\r\n    return {\r\n        getUnderWayIcon: _getUnderWayIcon,\r\n        getAtAnchorIcon: _getAtAnchorIcon,\r\n        createSwitch: _createSwitch,\r\n        get icons(){return _icons;},\r\n        get iconsAlt(){return _iconsAlt;},\r\n        //get iconsDict(){return _iconsDict;},\r\n        //get iconsAltDict(){return _iconsAltDict;},\r\n        getIconAlt: function(vessel_name, sog){           \r\n            // speed icon\r\n            for(let f in _iconsAltDict){\r\n                let cond = f.replace(/\"sog\"/ig,  sog);\r\n                if (vessel_name)\r\n                    cond = cond.replace(/\"vessel_name\"/ig,  \r\n                    \"'\" + vessel_name.replace(/'/g, \"\\\\\\'\").replace(/\\\\[^']/g, \"\\\\\\\\\") + \"'\");\r\n//console.log(cond + \" \" + \"eval(cond)\")\r\n                if(eval(cond))\r\n                    return _iconsAltDict[f];\r\n            }\r\n        },\r\n        getIcon: function(vessel_type, sog){ \r\n            for(let f in _iconsDict){\r\n                let re1 = new RegExp(\"'\"+vessel_type+\"'\"),\r\n                re2 = new RegExp(sog != 0 ? \">0\" : \"=0\");\r\n//console.log(vessel_type+\" \"+sog+\" \"+f+\" \"+f.search(re1)+\" \"+f.search(re2))\r\n                if(f.search(re1)!=-1 && f.search(re2)!=-1){\r\n//console.log( _iconsDict[f])\r\n                    return _iconsDict[f];\r\n                }\r\n            }\r\n        },\r\n        getIconAltUrl: function(vessel_name, sog){ \r\n            let icon = this.getIconAlt(vessel_name, sog)\r\n            return icon && icon.url; \r\n        },\r\n        getIconUrl: function(vessel_type, sog){ \r\n            let icon = this.getIcon(vessel_type, sog)\r\n            return icon && icon.url; \r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = LegendControl;\n\n\n// WEBPACK FOOTER //\n// ./src/Controls/LegendControl.js","const Track  = require('./Track');\r\nconst Polyfill = require('./Polyfill');\r\n\r\nmodule.exports = function (options) {\r\n    const _lmap = nsGmx.leafletMap,\r\n        _layersByID = nsGmx.gmxMap.layersByID;\r\n      let _aisLayer = _layersByID[options.aisLayerID],\r\n          _screenSearchLayer = _layersByID[options.searchLayer],\r\n          _lastPointLayerAlt = _layersByID[options.lastPointLayerAlt],\r\n          _lastPointLayerAltFact = _layersByID[options.lastPointLayerAlt];\r\n\r\n    let   _almmsi, _tlmmsi, _aldt, _tldt;\r\n    try{\r\n          _almmsi = _aisLayer.getGmxProperties().attributes.indexOf(\"mmsi\") + 1, \r\n          _aldt = _aisLayer.getGmxProperties().attributes.indexOf(\"ts_pos_utc\") + 1;\r\n// console.log(_almmsi+\" \"+_aldt)\r\n// console.log(_tlmmsi+\" \"+_tldt)\r\n    }\r\n    catch(ex){}\r\n\r\n    let _displayedVessels = \"all\",  \r\n    _notDisplayedVessels = [],\r\n    _filterFunc = function (args) {\r\n        let mmsiArr = [];\r\n        let mmsi = args.properties[args.properties.length > 20 ? _almmsi : _tlmmsi].toString(),\r\n            dt = new Date(new Date(args.properties[args.properties.length>20 ? _aldt : _tldt]*1000).setUTCHours(0,0,0,0)),\r\n            i, j;\r\n        for (i = 0; i < mmsiArr.length; i++) {\r\n            if (mmsi == mmsiArr[i]) { \r\n                if (dates)\r\n                    for (j=0; j<dates.length; ++j){\r\n                        if (dates[j].getTime()==dt.getTime()){\r\n                            return true;\r\n                        }\r\n                    }\r\n                else{\r\n                    return true; \r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }, \r\n    _specialVesselFilters,\r\n    _setVesselFilter = function(){\r\n        if (_screenSearchLayer) {\r\n            _screenSearchLayer.removeFilter();  \r\n\r\n            if (_displayedVessels!=\"all\" || _notDisplayedVessels.length || _specialVesselFilters) {            \r\n                let ai = _screenSearchLayer._gmx.tileAttributeIndexes, fields = [];\r\n                for (var k in ai)\r\n                    fields[ai[k]] = k;\r\n                _screenSearchLayer.setFilter((args) => {\r\n\r\n                    for(var f in _specialVesselFilters)\r\n                            _specialVesselFilters[f](args, ai, _displayedVessels);\r\n\r\n                    let mmsi = args.properties[ai.mmsi].toString();\r\n                    if ((_displayedVessels==\"all\" || _displayedVessels.indexOf(mmsi) >= 0) && \r\n                        _notDisplayedVessels.indexOf(mmsi) < 0)\r\n                        return true;\r\n                    else\r\n                        return false;\r\n                });\r\n            } \r\n        }\r\n\r\n    },\r\n    _historyInterval,\r\n    _markers,\r\n    _visibleMarkers = [],\r\n    _icons = {},\r\n    _getSvg = function(url){\r\n        let svg = _icons[url]\r\n        if (!svg){\r\n            return new Promise(resolve=>{\r\n                let httpRequest = new XMLHttpRequest();\r\n                httpRequest.onreadystatechange = function () {\r\n                    if (httpRequest.readyState === 4) {\r\n                        _icons[url] = httpRequest.responseText\r\n                        resolve(_icons[url]);\r\n                    }\r\n                }\r\n                httpRequest.open(\"GET\", document.location.protocol + url.replace(/^https?:/, \"\"));\r\n                httpRequest.send();\r\n            })\r\n        }\r\n        return Promise.resolve(svg);\r\n    },\r\n    _markerIcon = function(icon, cog, sog, vtype, group_style){ \r\n        return _getSvg(icon).then(\r\n            svg=>{\r\n                let type_color = '#00f',\r\n                    a = /\\.cls-1{fill:(#[^};]+)/.exec(svg)\r\n                if (a && a.length)\r\n                    type_color = a[1];\r\n//console.log(type_color)\r\n                if (sog)\r\n                    return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"21\" height=\"21\" viewBox=\"0 0 21 21\" style=\"transform:rotate(' + (!cog ? 0 : cog) + 'deg)\"><title>1</title><path style=\"fill:' + type_color + ';\" d=\"M13.8,20.07a1,1,0,0,1-.69-0.28l-1.79-1.72a0.72,0.72,0,0,0-1,0L8.52,19.79a1,1,0,0,1-.69.28,1,1,0,0,1-1-1V8.65c0-1.52,1.55-7.59,4-7.59s4,6.07,4,7.59V19a1,1,0,0,1-1,1h0Z\"/><path style=\"fill:' + group_style + ';\" d=\"M10.82,1.57c1.93,0,3.5,5.57,3.5,7.09V19a0.52,0.52,0,0,1-.51.53,0.49,0.49,0,0,1-.34-0.14l-1.79-1.72a1.22,1.22,0,0,0-1.71,0L8.17,19.42a0.49,0.49,0,0,1-.34.14A0.52,0.52,0,0,1,7.32,19V8.65c0-1.51,1.57-7.09,3.5-7.09h0m0-1c-3,0-4.5,6.72-4.5,8.09V19a1.52,1.52,0,0,0,1.51,1.53,1.49,1.49,0,0,0,1-.42l1.79-1.72a0.22,0.22,0,0,1,.32,0l1.79,1.72a1.49,1.49,0,0,0,1,.42A1.52,1.52,0,0,0,15.32,19V8.65c0-1.37-1.51-8.09-4.5-8.09h0Z\"/><ellipse style=\"fill:#fff;\" cx=\"10.82\" cy=\"10.54\" rx=\"1.31\" ry=\"1.35\"/><path style=\"fill:#fff;\" d=\"M10.73,3.34h0.12a0.35,0.35,0,0,1,.35.35v6.85a0,0,0,0,1,0,0H10.38a0,0,0,0,1,0,0V3.69A0.35,0.35,0,0,1,10.73,3.34Z\"/></svg>';\r\n                else\r\n                    return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"21\" height=\"21\" viewBox=\"0 0 21 21\" style=\"transform:rotate(' + (!cog ? 0 : cog) + 'deg)\"><title>1</title><rect style=\"fill:' + type_color + ';stroke:' + group_style + ';stroke-miterlimit:10;\" x=\"5.9\" y=\"5.6\" width=\"9.19\" height=\"9.19\" rx=\"2\" ry=\"2\" transform=\"translate(-4.13 10.41) rotate(-45)\"/><circle style=\"fill:#fff;\" cx=\"10.5\" cy=\"10.19\" r=\"1.5\"/></svg>';\r\n            }\r\n        );\r\n    },\r\n    _eraseMyFleetMarker = function(mmsi){\r\n        if (!_markers)\r\n            _markers = L.layerGroup().addTo(_lmap);\r\n        else{\r\n            let layers = _markers.getLayers(), layer;\r\n            for (var i in layers)\r\n                if (layers[i].id==mmsi){\r\n                    layer = layers[i];\r\n                    break;\r\n                }\r\n                layer && _markers.removeLayer(layer);\r\n        }\r\n    },\r\n    _drawMyFleetMarker = function(args, markerTemplate, group, ai, isVisible){ \r\n        let data = args.properties;\r\n        let di = nsGmx.widgets.commonCalendar.getDateInterval();\r\n        let icon = args.parsedStyleKeys.iconUrl;//args.parsedStyleKeys.iconUrl.replace(/.+(\\/|%5C)(?=[^\\/]+$)/, '')\r\n        _eraseMyFleetMarker(data[ai.mmsi]);\r\n\r\n        if (!isVisible)\r\n            return;\r\n\r\n        let label_line = function(label, label_color, label_shadow){\r\n            if (label!=\"\")\r\n            return '<div style=\"height:14px;\">'+\r\n            '<div class=\"label_shadow\" style=\"height:14px;color' + label_shadow.color + \";text-shadow:\" + label_shadow.text_shadow + '\">' + label + '</div>'+\r\n            '<div class=\"label_color\" style=\"position:relative;top:-14px;color:' + label_color + '\">' + label + '</div></div>';\r\n            else\r\n            return \"\";\r\n        }\r\n        if (di.get(\"dateBegin\").getTime()<=data[ai.ts_pos_utc]*1000 && data[ai.ts_pos_utc]*1000<di.get(\"dateEnd\").getTime()){ \r\n            _markerIcon(icon, data[ai.cog], data[ai.sog], data[ai.vessel_type], group.marker_style).then(marker=>{\r\n\r\n                _eraseMyFleetMarker(data[ai.mmsi]);\r\n\r\n                let temp = {};\r\n                temp.group_name = label_line(group.default?\"\":(group.title), group.label_color, group.label_shadow)\r\n                temp.vessel_name = label_line(data[ai.vessel_name], group.label_color, group.label_shadow);    \r\n                temp.sog = label_line(data[ai.sog] + _gtxt(\"AISSearch2.KnotShort\"), group.label_color, group.label_shadow);  \r\n                temp.cog = label_line(isNaN(data[ai.cog])?\"\":data[ai.cog].toFixed(1) + \"&deg;\", group.label_color, group.label_shadow);                 \r\n                temp.marker = marker;\r\n                let m = L.marker([data[ai.latitude], data[ai.longitude]>0?data[ai.longitude]:360+data[ai.longitude]],\r\n                    {\r\n                        id:data[ai.mmsi],\r\n                        icon: L.divIcon({\r\n                            className: 'mf_label gr' + group.id,\r\n                            html: Handlebars.compile(markerTemplate)(temp)\r\n                        }),\r\n                        zIndexOffset:1000\r\n                    });\r\n                m.id = data[ai.mmsi];\r\n                _markers.addLayer(m);\r\n            });\r\n        }\r\n\r\n    },\r\n    _switchLayers = function(l1, l2){\r\n        //l1 && console.log(l1.getGmxProperties().name +\" \"+ !!(l1._map))\r\n        if (!l2 || l2._map)\r\n            return;\r\n        if (l1 && l2){\r\n            _lmap.removeLayer(l1);\r\n            _lmap.addLayer(l2);\r\n        }\r\n    },\r\n    _legendSwitchedHandlers = [],\r\n    _legendSwitched = function(showAlternative){\r\n        _legendSwitchedHandlers.forEach(h=>h(showAlternative));\r\n    },\r\n\r\n    _round = function (d, p) {\r\n        let isNeg = d < 0,\r\n            power = Math.pow(10, p)\r\n        return d ? ((isNeg ? -1 : 1) * (Math.round((isNeg ? d = -d : d) * power) / power)) : d\r\n    },\r\n    _addUnit = function (v, u) {\r\n        return v != null && v != \"\" ? v + u : \"\";\r\n    },        \r\n    _toDd = function (D, lng) {\r\n        let dir = D < 0 ? lng ? 'W' : 'S' : lng ? 'E' : 'N',\r\n            deg = Math.round((D < 0 ? D = -D : D) * 1000000) / 1000000\r\n        return deg.toFixed(2) + \" \"//\"°\"\r\n            + dir\r\n    };\r\n\r\n    const _trackBuilder = new Track();\r\n\r\n    return {\r\n        set specialVesselFilters({key, value}) {\r\n            if (!_specialVesselFilters)\r\n                _specialVesselFilters = {};\r\n            _specialVesselFilters[key] = value;\r\n            //_setVesselFilter();\r\n        },\r\n        get hasAlternativeLayers(){ return _lastPointLayerAlt; },\r\n        get needAltLegend(){\r\n            //return !!(_lastPointLayerAlt && _lastPointLayerAlt._map); \r\n            return !!(_lastPointLayerAltFact && _lastPointLayerAltFact._map); \r\n        },\r\n        get historyInterval(){return _historyInterval;},\r\n        set historyInterval(v){_historyInterval = v;},\r\n\r\n        ///////////////////////\r\n        removeMyFleetTrack: function (mmsi){\r\n            _trackBuilder.removeMyFleetTrack(mmsi);\r\n        }, \r\n\r\n        showMyFleetTrack: function (vessels, onclick, aisLayerSearcher, viewState) {\r\n            _trackBuilder.showMyFleetTrack (vessels, onclick, aisLayerSearcher, viewState, this.needAltLegend);\r\n        },\r\n     \r\n        showHistoryTrack: function (vessels, onclick) {\r\n            return _trackBuilder.showHistoryTrack(vessels, onclick, this.needAltLegend);\r\n        },\r\n\r\n        restoreDefault: function(){                   \r\n            _lmap.addLayer(_screenSearchLayer);\r\n            _lastPointLayerAlt && _lmap.removeLayer(_lastPointLayerAlt); \r\n        },\r\n\r\n        cleanMap: function(viewState){\r\n            _displayedVessels = 'all';\r\n            _notDisplayedVessels.length = 0;\r\n            _setVesselFilter();   \r\n\r\n            viewState.cleanTracks(_trackBuilder, this.needAltLegend);\r\n        },\r\n\r\n        hideVesselsOnMap: function (viewState, comment) {      \r\n            if (viewState.notDisplayed.length)\r\n                _notDisplayedVessels = viewState.notDisplayed.map(v => v);\r\n            else\r\n                _notDisplayedVessels.length = 0;\r\nconsole.log('hideOnMap', comment, _notDisplayedVessels)           \r\n            _setVesselFilter();\r\n            viewState.hideTracks(_trackBuilder, this.needAltLegend);\r\n        },\r\n\r\n        showVesselsOnMap: function (viewState) { \r\n            _displayedVessels = viewState.displayedOnly && viewState.displayedOnly.length ? viewState.displayedOnly.map(v=>v) : \"all\"; \r\nconsole.log('showOnMap', _displayedVessels)           \r\n            _setVesselFilter();\r\n\r\n            viewState.showTracks(_trackBuilder, this.needAltLegend);\r\n        },\r\n\r\n        redrawMarkers: function () {\r\n            _setVesselFilter();\r\n        },\r\n\r\n        clearMyFleetMarkers: function(){\r\n//console.log(\"clearMyFleetMarkers\")\r\n            _markers && _markers.clearLayers();\r\n        },\r\n\r\n        eraseMyFleetMarker: _eraseMyFleetMarker,\r\n\r\n        drawMyFleetMarker: _drawMyFleetMarker,\r\n\r\n        highlightMarker: function(i, group){\r\n            $('.mf_label.gr'+group.id+' svg').each((i,e)=>{\r\n                let paths = e.querySelectorAll('path');\r\n                if(paths[1])\r\n                    paths[1].style.fill = group.marker_style;\r\n            })\r\n            $('.mf_label.gr'+group.id+' svg rect').css({\"stroke\":group.marker_style});\r\n\r\n            $('.mf_label.gr'+group.id+' .label_color').css({\"color\":group.label_color});\r\n            $('.mf_label.gr'+group.id+' .label_shadow').css({\"color\":group.label_shadow.color, \"text-shadow\":group.label_shadow.text_shadow});\r\n        },\r\n\r\n        switchLegend: function(showAlternative){\r\n            _switchLayers(_screenSearchLayer, _lastPointLayerAlt);\r\n            let temp = _screenSearchLayer;\r\n            _screenSearchLayer = _lastPointLayerAlt;\r\n            _lastPointLayerAlt = temp;\r\n\r\n            _setVesselFilter();\r\n            _legendSwitched(showAlternative);\r\n\r\n//console.log(showAlternative, this.needAltLegend)\r\n            _trackBuilder.switchLegend(this.needAltLegend, _notDisplayedVessels);\r\n            // for (let t in _tracks){\r\n            //     //if (_notDisplayedVessels.indexOf(t)<0)\r\n            //     if (this.needAltLegend){\r\n            //         _lmap.removeLayer(_tracks[t]);\r\n            //         _lmap.addLayer(_tracksAlt[t]);\r\n            //     }\r\n            //     else{\r\n            //         _lmap.addLayer(_tracks[t]);\r\n            //         _lmap.removeLayer(_tracksAlt[t]);\r\n            //     }\r\n            // }\r\n            // for (let t in _tracksMF){\r\n            //     if (_notDisplayedVessels.indexOf(t)<0)\r\n            //     if (this.needAltLegend){\r\n            //         _lmap.removeLayer(_tracksMF[t]);\r\n            //         _lmap.addLayer(_tracksAltMF[t]);\r\n            //     }\r\n            //     else{\r\n            //         _lmap.addLayer(_tracksMF[t]);\r\n            //         _lmap.removeLayer(_tracksAltMF[t]);\r\n            //     }\r\n            // }\r\n        },\r\n\r\n        onLegendSwitched: function(handler){    \r\n            _legendSwitchedHandlers.push(handler);\r\n        },\r\n\r\n        formatPosition: function (vessel, aisLayerSearcher) {\r\n            vessel.cog_sog = vessel.cog && vessel.sog\r\n            vessel.heading_rot = vessel.heading && vessel.rot\r\n            vessel.x_y = vessel.longitude && vessel.latitude\r\n            let d = new Date(vessel.ts_pos_utc * 1000)\r\n            let eta = new Date(vessel.ts_eta * 1000)\r\n            vessel.tm_pos_utc = this.formatTime(d);\r\n            vessel.tm_pos_loc = this.formatTime(d, true);\r\n            vessel.dt_pos_utc = this.formatDate(d);\r\n            vessel.dt_pos_loc = this.formatDate(d, true);\r\n            vessel.eta_utc = aisLayerSearcher.formatDateTime(eta);\r\n            vessel.eta_loc = aisLayerSearcher.formatDateTime(eta, true);\r\n            vessel.icon_rot = Math.round(vessel.cog/15)*15;\r\n            vessel.cog = _addUnit(_round(vessel.cog, 5), \"°\");\r\n            vessel.rot = _addUnit(_round(vessel.rot, 5), \"°/мин\");\r\n            vessel.heading = _addUnit(_round(vessel.heading, 5), \"°\");\r\n            vessel.draught = _addUnit(_round(vessel.draught, 5), \" м\");\r\n            //vessel.length = _addUnit(vessel.length, \" м\");\r\n            //vessel.width = _addUnit(vessel.width, \" м\");\r\n            //vessel.source = 'plugins/AIS/AISSearch/svg/satellite-ais.svg'//vessel.source=='T-AIS'?_gtxt('AISSearch2.tais'):_gtxt('AISSearch2.sais');\r\n            vessel.source_orig = vessel.source;\r\n            vessel.source = vessel.source=='T-AIS'?'plugins/AIS/AISSearch/svg/waterside-radar.svg':'plugins/AIS/AISSearch/svg/satellite-ais.svg';\r\n                \r\n            vessel.xmin = vessel.longitude;\r\n            vessel.xmax = vessel.longitude;           \r\n            vessel.ymin = vessel.latitude;\r\n            vessel.ymax = vessel.latitude; \r\n        \r\n            vessel.longitude = _toDd(vessel.longitude, true);\r\n            vessel.latitude = _toDd(vessel.latitude);\r\n            aisLayerSearcher.placeVesselTypeIcon(vessel);\r\n            vessel.sog = _addUnit(_round(vessel.sog, 5), \" уз\");\r\n        \r\n            return vessel;\r\n        },\r\n        formatTime: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleTimeString();\r\n        },\r\n        formatDate: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleDateString();\r\n        }\r\n\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Toolbox.js","const vesselMarker = require('./VesselMarker');\r\nmodule.exports = function (options) {\r\n\r\n    const _lmap = nsGmx.leafletMap,\r\n        _tracks = {}, _tracksAlt = {},\r\n        _tracksMF = {}, _tracksAltMF = {},\r\n        _canvas = L.canvas(),\r\n        _addMarker = function (p, ep, group, onclick, style, placeVesselTypeIcon) {\r\n            if (placeVesselTypeIcon)\r\n                placeVesselTypeIcon(p);\r\n            var options = {\r\n                radius: 10,\r\n                fillColor: style != 'SPEED' ? p.color.value : p.colorAlt.value,\r\n                fillOpacity: 0.25,\r\n                weight: 2,\r\n                color: 'SPEED' ? p.color.value : p.colorAlt.value,\r\n                cog: parseInt(p.cog),\r\n                img: style != 'SPEED' ? p.img : p.imgAlt,\r\n                renderer: _canvas,\r\n                pid: p.id,\r\n                next: !ep ? null : L.latLng(ep.ymax, ep.xmax < 0 ? 360 + ep.xmax : ep.xmax),\r\n                ts: new Date()\r\n            },\r\n                m = vesselMarker(L.latLng(p.ymax, p.xmax < 0 ? 360 + p.xmax : p.xmax), options);\r\n            m.on('click', e => onclick({ p, pid: p.id }));\r\n            group.addLayer(m);\r\n        },\r\n        _addMarkers = function (data, next, onclick, style, placeVesselTypeIcon) {\r\n            const group = L.layerGroup(null, { renderer: _canvas });\r\n            for (var i = 0; i < data.length; i++) {\r\n                if (data[i].positions) {\r\n                    for (var j = 0; j < data[i].positions.length; j++) {\r\n                        var p = data[i].positions[j];\r\n                        p.mmsi = data[i].mmsi; p.imo = data[i].imo;\r\n                        if (data[i].positions[j + 1])\r\n                            _addMarker(p, data[i].positions[j + 1], group, onclick, style, placeVesselTypeIcon);\r\n                        else\r\n                            _addMarker(p, null, group, onclick, style, placeVesselTypeIcon);\r\n                    }\r\n                }\r\n                else {\r\n                    if (data[i + 1])\r\n                        _addMarker(data[i], data[i + 1], group, onclick, style, placeVesselTypeIcon);\r\n                    else {\r\n                        _addMarker(data[i], next, group, onclick, style, placeVesselTypeIcon);\r\n                        if (next) {\r\n                            _addMarker(next, null, group, onclick, style, placeVesselTypeIcon);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return group;\r\n        }\r\n    let _prevCursor = null, _historyMmsi = null;\r\n\r\n    document.body.addEventListener('mousemove', e => {\r\n        if (!_canvas._container)\r\n            return;\r\n        _canvas._onMouseMove(e);\r\n        if (_canvas._container.className.search(/interactive/) > -1) {\r\n            if (_canvas._map._container.style.cursor != 'pointer') {\r\n                _prevCursor = _canvas._map._container.style.cursor;\r\n                _canvas._map._container.style.cursor = 'pointer'\r\n            }\r\n        }\r\n        else {\r\n            if (_prevCursor !== null) {\r\n                _canvas._map._container.style.cursor = _prevCursor;\r\n                _prevCursor = null;\r\n            }\r\n        }\r\n    });\r\n    document.body.addEventListener('click', e => {\r\n        if (!_canvas._container)\r\n            return;\r\n        if (_canvas._container.className.search(/interactive/) > -1)\r\n            _canvas._onClick(e);\r\n    });\r\n\r\n    return {\r\n        showHistoryTrack: function (vessels, onclick, needAltLegend) {\r\n            if (!vessels) { // CLEAN ALL  \r\n                for (let t in _tracks) {\r\n                    _lmap.removeLayer(_tracks[t]);\r\n                    _lmap.removeLayer(_tracksAlt[t]);\r\n                    delete _tracks[t];\r\n                    delete _tracksAlt[t];\r\n                }\r\n                return [];\r\n            }\r\n\r\n            for (let i = 0; i < vessels.length; ++i) {\r\n                let trackId = vessels[i].mmsi + '_' + vessels[i].imo + '_' + vessels[i].ts;\r\n                if (vessels[i].positions.length) {\r\n                    if (!_tracks[trackId]) {\r\n                        _tracks[trackId] = _addMarkers(vessels[i].positions, vessels[i].end, p => onclick(p, false), 'TYPE');\r\n                        _tracksAlt[trackId] = _addMarkers(vessels[i].positions, vessels[i].end, p => onclick(p, false), 'SPEED');\r\n                        //console.log(i, _tracks[trackId])\r\n\r\n                        if (!needAltLegend)\r\n                            _lmap.addLayer(_tracks[trackId]);\r\n                        else\r\n                            _lmap.addLayer(_tracksAlt[trackId]);\r\n                    }\r\n                }\r\n                else { // HIDE SOME\r\n                    _lmap.removeLayer(_tracks[trackId]);\r\n                    _lmap.removeLayer(_tracksAlt[trackId]);\r\n                    delete _tracks[trackId];\r\n                    delete _tracksAlt[trackId];\r\n                }\r\n            }\r\n\r\n            if (_canvas._container)\r\n                _canvas._container.style.pointerEvents = 'none';\r\n            \r\n            return Object.keys(_tracks);\r\n        },\r\n\r\n        showMyFleetTrack: function (vessels, onclick, aisLayerSearcher, viewState, needAltLegend) {\r\n            //console.log(vessels);\r\n            if (!vessels) {\r\n                for (let t in _tracksMF) {   \r\n                    _lmap.removeLayer(_tracksMF[t]);\r\n                    _lmap.removeLayer(_tracksAltMF[t]);\r\n                    delete _tracksMF[t];\r\n                    delete _tracksAltMF[t];\r\n                }\r\n                return;\r\n            }   \r\n\r\n            if (vessels.length && vessels[0].mmsi) {\r\n                let trackId = vessels[0].mmsi.toString();\r\n                if (_tracksMF[trackId]){                    \r\n                    _lmap.removeLayer(_tracksMF[trackId]);\r\n                    _lmap.removeLayer(_tracksAltMF[trackId]);\r\n                }\r\n                if (vessels[0].positions.length) {\r\n\r\n                    _tracksMF[trackId] = _addMarkers(vessels, null, onclick, 'TYPE', aisLayerSearcher.placeVesselTypeIcon);\r\n                    _tracksAltMF[trackId] = _addMarkers(vessels, null,  onclick, 'SPEED', aisLayerSearcher.placeVesselTypeIcon);\r\n\r\n                    if (!viewState || viewState.notDisplayed.indexOf(trackId)<0)\r\n                        if (!needAltLegend)\r\n                            _lmap.addLayer(_tracksMF[trackId]);\r\n                        else\r\n                            _lmap.addLayer(_tracksAltMF[trackId]);\r\n\r\n                    if (_canvas._container)\r\n                        _canvas._container.style.pointerEvents = 'none'; \r\n                }\r\n            }\r\n        },\r\n\r\n        showMyFleetTracks: function(displayed, needAltLegend){\r\n            const a = displayed=='all' ? Object.keys(_tracksMF) : displayed;\r\n            a.forEach(mmsi => {\r\n                if (_tracksMF[mmsi])\r\n                    if (!needAltLegend)\r\n                        _lmap.addLayer(_tracksMF[mmsi]);\r\n                    else\r\n                        _lmap.addLayer(_tracksAltMF[mmsi]);\r\n            });\r\n        },\r\n        hideMyFleetTracks: function(notDisplayed, needAltLegend){\r\n            const a = Object.keys(_tracksMF);\r\n            a.forEach(mmsi => {\r\n                if (notDisplayed.indexOf(mmsi) < 0) {\r\n                    if (!needAltLegend)\r\n                        !_tracksMF[mmsi]._map && _lmap.addLayer(_tracksMF[mmsi]);\r\n                    else\r\n                        !_tracksAltMF[mmsi]._map && _lmap.addLayer(_tracksAltMF[mmsi]);\r\n                }\r\n                else {\r\n                    _lmap.removeLayer(_tracksMF[mmsi]);\r\n                    _lmap.removeLayer(_tracksAltMF[mmsi]);\r\n                }\r\n            });\r\n        },\r\n        cleanMyFleetTracks: function(){\r\n            for (let k in _tracksMF){\r\n                _lmap.removeLayer(_tracksMF[k]);\r\n                _lmap.removeLayer(_tracksAltMF[k]);\r\n            }\r\n        },\r\n        showHistoryTracks: function(displayed, needAltLegend){\r\n//console.log('showHistoryTracks', displayed);\r\n            const a = Object.keys(_tracks);\r\n            a.forEach(id => {\r\n                if (displayed.indexOf(id) > -1) {\r\n                    if (!needAltLegend)\r\n                        !_tracks[id]._map && _lmap.addLayer(_tracks[id]);\r\n                    else\r\n                        !_tracksAlt[id]._map && _lmap.addLayer(_tracksAlt[id]);\r\n                }\r\n                else {\r\n                    _lmap.removeLayer(_tracks[id]);\r\n                    _lmap.removeLayer(_tracksAlt[id]);\r\n                }\r\n            });\r\n\r\n        },\r\n        cleanHistoryTracks: function(){\r\n            const ra = [];\r\n            for (let k in _tracks){\r\n                if (_tracks[k]._map || _tracksAlt[k]._map)\r\n                    ra.push(k);\r\n                _lmap.removeLayer(_tracks[k]);\r\n                _lmap.removeLayer(_tracksAlt[k]);\r\n            }\r\n            return ra;\r\n        },\r\n\r\n       \r\n        switchLegend: function(needAltLegend, notDisplayedVessels){\r\n            for (let t in _tracks){\r\n                //if (notDisplayedVessels.indexOf(t)<0)\r\n                if (needAltLegend){\r\n                    if (_tracks[t]._map){\r\n                    _lmap.removeLayer(_tracks[t]);\r\n                    _lmap.addLayer(_tracksAlt[t]);\r\n                    }\r\n                }\r\n                else{\r\n                    if (_tracksAlt[t]._map){\r\n                    _lmap.removeLayer(_tracksAlt[t]);\r\n                    _lmap.addLayer(_tracks[t]);\r\n                    }\r\n                }\r\n            }\r\n            \r\n            for (let t in _tracksMF){\r\n                if (notDisplayedVessels.indexOf(t)<0){\r\n                    if (needAltLegend){\r\n                        if (_tracksMF[t]._map){\r\n                            _lmap.removeLayer(_tracksMF[t]);\r\n                            _lmap.addLayer(_tracksAltMF[t]);\r\n                        }\r\n                    }\r\n                    else{\r\n                        if (_tracksAltMF[t]._map){\r\n                            _lmap.removeLayer(_tracksAltMF[t]);\r\n                            _lmap.addLayer(_tracksMF[t]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        removeMyFleetTrack: function (mmsi){            \r\n            mmsi = mmsi.toString();\r\n            if (_tracksMF[mmsi]){\r\n                _lmap.removeLayer(_tracksMF[mmsi]);\r\n                _lmap.removeLayer(_tracksAltMF[mmsi]);\r\n                delete _tracksMF[mmsi];\r\n                delete _tracksAltMF[mmsi];\r\n            }\r\n        }, \r\n\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Track.js","L.Canvas.include({\r\n    _updateVesselMarker: function (layer) {\r\n        if (!this._drawing || layer._empty()) { return; }\r\n\r\n        this._drawnLayers[layer._leaflet_id] = layer;\r\n\r\n        var p = layer._point,\r\n            ctx = this._ctx,\r\n            r = Math.max(Math.round(layer._radius), 1);\r\n        //ctx.globalCompositeOperation = 'destination-over';    \r\n        \r\n//         var bounds = this._redrawBounds;\r\n// console.log(bounds)\r\n// \t\tif (bounds) {\r\n// \t\t\tvar size = bounds.getSize();\r\n//             //this._ctx.clearRect(bounds.min.x, bounds.min.y, size.x, size.y);\r\n \r\n//             ctx.strokeStyle = '#ff0000';           \r\n// \t\t\tctx.beginPath();\r\n// \t\t\tctx.rect(bounds.min.x, bounds.min.y, size.x, size.y);\r\n//             ctx.stroke();\r\n//         }\r\n\r\n        if (layer.options.next){\r\n            var np = layer._map.latLngToLayerPoint(layer.options.next);\r\n            ctx.lineWidth = layer.options.weight;\r\n            ctx.strokeStyle = layer.options.fillColor;\r\n            ctx.beginPath();\r\n            ctx.moveTo(p.x, p.y);\r\n            ctx.lineTo(np.x, np.y);\r\n            ctx.stroke();\r\n        }\r\n\r\n        //ctx.beginPath();\r\n        //ctx.arc(p.x, p.y, r, 0, Math.PI * 2)\r\n        //this._fillStroke(ctx, layer);\r\n\r\n        let img = layer.options.img,\r\n        cog = layer.options.cog;\r\n        if (img && cog) {\r\n            ctx.save();\r\n            ctx.translate(p.x, p.y);\r\n            ctx.rotate(cog * Math.PI / 180.0);\r\n            ctx.drawImage(img, -(img.width / 2), -(img.height / 2))\r\n            ctx.restore();\r\n        }\r\n    }\r\n});\r\n\r\nvar VesselMarker = L.CircleMarker.extend({\r\n    _updatePath: function () {\r\n        this._renderer._updateVesselMarker(this);\r\n    }\r\n    // , _containsPoint: function(p) {\r\n    //     return L.CircleMarker.prototype._containsPoint.call(this, p.subtract([0, 10]));\r\n    // }\r\n});\r\n\r\nconst vesselMarker = function (p, options) {\r\n    return new VesselMarker(p, options);\r\n}\r\n\r\nmodule.exports = vesselMarker;\n\n\n// WEBPACK FOOTER //\n// ./src/VesselMarker.js"],"sourceRoot":""}