{"version":3,"sources":["webpack:///webpack/bootstrap 455a38f9df559aeea46d","webpack:///./src/entry.js","webpack:///./src/all.css","webpack:///./src/locale.js","webpack:///./src/polyfill.js","webpack:///./src/Views/BaseView.js","webpack:///./src/Search/Searcher.js","webpack:///./src/Models/MyFleetModel.js","webpack:///./src/Models/ScreenSearchModel.js","webpack:///./src/Models/DbSearchModel.js","webpack:///./src/Models/HistoryModel.js","webpack:///./src/Views/SearchView.js","webpack:///./src/Views/MyFleetView.js","webpack:///./src/Views/VesselInfoView.js","webpack:///./src/Views/HistoryView.js","webpack:///./src/Views/HistoryView.css","webpack:///./src/infodialog.js","webpack:///./src/infodialog.css"],"names":["NOSIDEBAR","PRODUCTION","SIDEBAR2","require","polyFind","polyFindIndex","BaseView","Searcher","MyFleetModel","ScreenSearchModel","DbSearchModel","HistoryModel","SearchView","MyFleetView","VesselInfoView","HistoryView","createInfoDialog","showTrack","mmsiArr","bbox","lmap","nsGmx","leafletMap","filterFunc","args","mmsi","properties","i","len","length","fitBounds","maxZoom","aisLayer","displaingTrack","setFilter","_map","addLayer","removeFilter","removeLayer","tracksLayer","Handlebars","registerHelper","context","imo","JSON","stringify","pluginName","cssTable","toolbarIconId","modulePath","gmxCore","getModulePath","scheme","document","location","href","replace","baseUrl","window","serverBase","aisServiceUrl","myFleetLayers","tracksLayerID","historyLayer","defaultSearch","infoDialogCascade","allIinfoDialogs","highlight","L","marker","icon","className","iconAnchor","iconSize","iconUrl","zIndexOffset","publicInterface","afterViewer","params","map","_params","extend","path","layersByID","gmxMap","aisLayerID","aisLayerSearcher","searchLayer","screenSearchLayer","aisLastPoint","setLocaleDate","layer","bindPopup","on","e","result","re","lastIndex","template","str","gmx","templateBalloon","props","exec","substring","index","hasOwnProperty","search","formatDate","Date","summary","popup","setContent","setLayerClickHandler","removeEventListener","addEventListener","showInfo","forLayers","key","split","id","myFleetMembersModel","mapLayers","target","vessel","aisPluginPanel","views","aisSearchView","myFleetMembersView","historyView","activeView","iconOpt_mf","togglable","title","_gtxt","text","options","svgSprite","iconOpt","regularImageUrl","regularImage","activeImageUrl","activeImage","icon_mf","control","gmxIcon","ev","isActive","show","hide","addControl","sidebar","sidebarWidget","sidebarControl","sidebarTab","setPane","createTab","createTabFunction","active","inactive","hint","a","toLowerCase","substr","x","filter","c","indexOf","y","setLatLng","addTo","showHistory","drawBackground","$","_canvas","removeClass","eq","click","getmore","ind","d","dialog","parent","insertAfter","closeFunc","event","splice","aisView","openVesselInfoView","vesselInfoView","open","pos","position","left","top","push","ui","gifLoader","aisScreenSearchModel","aisDbSearchModel","historyModel","_leftMenuBlock","_div","_activeView","_views","_aisSearchView","_myFleetMembersView","_historyView","value","leftMenu","createWorkCanvas","_iconClick","ready","tabsTemplate","append","compile","workCanvas","tabs","_this","is","each","tab","addClass","create","_frame","_container","_refresh","_search","_count","setModel","canvas","needUpdate","setDirty","bind","widgets","commonCalendar","getDateInterval","parentWorkCanvas","attr","blockItem","leftPanelItem","blockTitle","panelCanvas","toggleTitle","isCollapsed","addModule","css","_translationsHash","addtext","module","exports","predicate","list","Object","thisArg","arguments","call","undefined","_waitTime","model","_model","_calcHeight","h","getBoundingClientRect","height","H","n","Math","ceil","_clean","doClean","off","empty","controls","createForm","bindControlEvents","_start","getTime","clearTimeout","_wait","rest","_lastUpdate","update","setTimeout","positionMap","ts_pos_utc","interval","DateInterval","getUTCDayBoundary","setDateInterval","dateBegin","dateEnd","ymin","xmin","ymax","xmax","animate","showPosition","item","parse","find","maxid","searchById","response","Status","Result","values","console","log","repaint","scrollCont","content","_tableTemplate","data","mCustomScrollbar","v","longitude","latitude","closest","html","vi","currentTarget","_repaintControls","_serverScript","getBorder","dFeatures","gmxDrawing","getFeatures","toGeoJSON","latLngBounds","getBounds","sw","getSouthWest","ne","getNorthEast","min","lng","lat","max","minX","maxX","geo","type","coordinates","w","center","local","dd","m","mm","getDate","slice","getMonth","getFullYear","getHours","getMinutes","getUTCHours","getUTCMinutes","getUTCDate","getUTCMonth","getUTCFullYear","ldd","lm","ly","lh","lmm","offset","getTimezoneOffset","searchPositions","vessels","dateInterval","callback","request","WrapStyle","query","join","toISOString","gmxUtil","sendCrossDomainPostRequest","aid","columns","searchString","isfuzzy","toUpperCase","arr","orderdirection","orderby","pagesize","searchNames","avessels","searchScreen","dt1","get","dt2","s","toJSON","minx","miny","maxx","maxy","view","findIndex","_isDirty","getDirty","_parseFilter","attributes","myRe","myArray","getCount","layers","load","msg","txt","Promise","resolve","errors","promises","lid","reject","sendCrossDomainJSONRequest","layerId","parentLayerId","ParentLayer","Filter","all","then","l","ErrorInfo","reduce","p","fields","vessel_name","lon","some","sort","b","_actualUpdate","actualUpdate","r","markMembers","forEach","member","vv","mf_member","changeFilter","add","temp","today","run","TaskID","Completed","ErorInfo","layersVersion","chkVersion","border","group","json","dataSrc","filterString","RegExp","_searchString","ErrorMessage","_view","_vessel","_historyInterval","round","isNeg","power","pow","addUnit","u","toDd","D","dir","deg","formatVessel","cog_sog","cog","sog","heading_rot","heading","rot","x_y","draught","source","historyInterval","parseResponse","positions","j","ts_pos_utc_org","instance","change","models","selectedIndex","val","siblings","keyup","input","keyCode","searchType","_ais","_galery","_register","_regcap","_leftPanel","_minh","resize","menuAction","parseInt","counter","count","preview","replaceWith","showPicture","remove","errmsg","submit","$img","jQuery","imgURL","prop","$svg","removeAttr","name","querySelector","floor","innerHeight","style","offsetHeight","parentElement","mia","querySelectorAll","panel","classList","display","theme","div","innerWidth","documentElement","clientWidth","body","clientHeight","offsetWidth","drawGallery","gallery","galcontent","drawAis","ledokol","aiscontent","innerHTML","registry_name","vessel_type","flag_country","callsign","width","nav_status","destination","ts_eta","drawRegister","regcontent","drawTable","groups","article","pn","pv","version","vessel2","onFail","error","wait","ship","registerServerUrl","fetch","RS","catch","_caption","_calendar","_dateInterval","_template","mapDateInterval","set","setHours","UTC","calendar","CalendarWidget","container","dateMin","dateMax","dateFormat","minimized","showSwitcher","toString","reset","ddToDms","dms","sec","commands","menu","appendTo","photo","moreinfo","buttons","showDialog","moreInfo","smallShipIcon","vesselPropTempl","swap","mi","t","resizable","titlebar","menubuttons","openpage","showpos","showVessel","isNaN","templ","showtrack","addremoveIcon","addremove","filterUpdating","progress","info","onDone","stopPropagation"],"mappings":"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","file":"AISSearch2.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 455a38f9df559aeea46d","\tlet NOSIDEBAR = false,\r\n\t\tPRODUCTION = false,\r\n\t\tSIDEBAR2 = false;\r\n\tif (has('NOSIDEBAR'))\r\n\t\tNOSIDEBAR = true;\r\n\tif (has('SIDEBAR2'))\r\n\t\tSIDEBAR2 = true;\r\n\tif (has('PRODUCTION'))\r\n\t\tPRODUCTION = true;\r\n\t\r\n\trequire(\"./all.css\")\r\n\trequire(\"./locale.js\")\r\n\tconst {polyFind, polyFindIndex} = require(\"./polyfill.js\"),\t\r\n\t\tBaseView = require('./Views/BaseView.js'),\r\n\t\tSearcher = require('./Search/Searcher.js'), \r\n\t\tMyFleetModel = require('./Models/MyFleetModel.js'),\t\r\n\t\tScreenSearchModel = require('./Models/ScreenSearchModel.js'),\r\n\t\tDbSearchModel = require('./Models/DbSearchModel.js'),\r\n\t\tHistoryModel = require('./Models/HistoryModel.js'),\r\n\t\tSearchView = require('./Views/SearchView.js'),\t\r\n\t\tMyFleetView = require('./Views/MyFleetView.js'),\t\r\n\t\tVesselInfoView  = require('./Views/VesselInfoView.js'),\t\r\n\t\tHistoryView  = require('./Views/HistoryView.js'),\r\n\t\tcreateInfoDialog = require('./infodialog.js')\r\n\t\r\n\tlet showTrack = function (mmsiArr, bbox) { \r\n                var lmap = nsGmx.leafletMap;                 \r\n                var filterFunc = function (args) {\r\n                        var mmsi = args.properties[1],\r\n                            i, len;\r\n                        for (i = 0, len = mmsiArr.length; i < len; i++) {\r\n                            if (mmsi === mmsiArr[i]) { return true; }\r\n                        }\r\n                        return false;\r\n                };\r\n                    if (bbox) { lmap.fitBounds(bbox, { maxZoom: 11 }); }\r\n                    if (aisLayer) {\r\n                        if (mmsiArr.length) {\r\n                            displaingTrack = mmsiArr[0];\r\n                            aisLayer.setFilter(filterFunc);\r\n                            if (!aisLayer._map) {\r\n                                lmap.addLayer(aisLayer);\r\n                            }\r\n                        } else {\r\n                            displaingTrack = false;\r\n                            aisLayer.removeFilter();\r\n                            lmap.removeLayer(aisLayer);\r\n                        }\r\n                    }\r\n                    if (tracksLayer) {\r\n                        if (mmsiArr.length) {\r\n                            tracksLayer.setFilter(filterFunc);\r\n                            if (!tracksLayer._map) {\r\n                                lmap.addLayer(tracksLayer);\r\n                            }\r\n                        } else {\r\n                            tracksLayer.removeFilter();\r\n                            lmap.removeLayer(tracksLayer);\r\n                        }\r\n                    }\r\n\t}\r\n\t\t\r\n\tHandlebars.registerHelper('aisinfoid', function(context) {\r\n\t\treturn context.mmsi+\" \"+context.imo;\r\n\t});\r\n\r\n\tHandlebars.registerHelper('aisjson', function(context) {\r\n\t\treturn JSON.stringify(context);\r\n\t});\r\n\r\n\tlet pluginName = 'AISSearch2',\r\n\t\tcssTable = pluginName\r\n\tif (!PRODUCTION)\r\n\t\tpluginName += 'Test'\r\n\t\t\r\n\t\r\n    let toolbarIconId = 'AISSearch2',\r\n        modulePath = gmxCore.getModulePath(pluginName),\r\n        scheme = document.location.href.replace(/^(https?:).+/, \"$1\"),\r\n        baseUrl = window.serverBase || scheme + '//maps.kosmosnimki.ru/',\r\n        aisServiceUrl = baseUrl + \"Plugins/AIS/\",\r\n\t\t\r\n        myFleetLayers = [],\r\n        tracksLayerID,\r\n        aisLayer,\r\n        tracksLayer,\r\n\t\thistoryLayer,\r\n        displaingTrack,\r\n\t\tdefaultSearch,\r\n\t\t\r\n        infoDialogCascade = [],  \r\n        allIinfoDialogs = [],\r\n\t\t\r\n\t\thighlight = L.marker([0, 0], {icon:L.icon({className:\"ais_highlight-icon\", iconAnchor:[12, 12], iconSize:[25,25], iconUrl:'plugins/ais/aissearch/highlight.png'}), zIndexOffset:1000}),\r\n\r\n\r\n        publicInterface = {\r\n            pluginName: pluginName,\r\n            afterViewer: function (params, map) {\t\t\t\t\r\n                let _params = L.extend({\r\n                        // regularImage: 'ship.png',\r\n                        // activeImage: 'active.png'\r\n                    }, params),\r\n                path = gmxCore.getModulePath(pluginName),\r\n                layersByID = nsGmx.gmxMap.layersByID,\r\n                lmap = map; \r\n\r\n                aisLayer = params.aisLayerID && layersByID[params.aisLayerID]; // for track markers\r\n\t\t\t\t\r\n                aisLayerSearcher.aisLayerID = params.searchLayer || '8EE2C7996800458AAF70BABB43321FA4';\t// searchById\t\t\t\r\n\t\t\t\taisLayerSearcher.screenSearchLayer = params.searchLayer || '8EE2C7996800458AAF70BABB43321FA4'; // screen search\t\t\t\t\r\n                aisLayerSearcher.aisLastPoint = params.aisLastPoint || '303F8834DEE2449DAF1DA9CD64B748FE'; // db search\r\n\t\t\t\t\r\n\t\t\t\thistoryLayer = params.historyLayer;\r\n\t\t\t\taisLayerSearcher.historyLayer = historyLayer;\r\n\t\r\n                tracksLayerID = params.tracksLayerID || '13E2051DFEE04EEF997DC5733BD69A15';\r\n                tracksLayer = layersByID[tracksLayerID];\r\n\t\t\t\t\r\n\t\t\t\tdefaultSearch = params.defaultSearch || 'screen';\r\n\t\t\t\ttoolbarIconId = params.toolbarIconId;\r\n\t\t\t\t\r\n                let setLocaleDate = function(layer){\r\n                    if (layer)\r\n                    layer.bindPopup('').on('popupopen',function(e){\r\n//console.log(e);\r\n\r\n                        var result, re = /\\[([^\\[\\]]+)\\]/g, lastIndex = 0, template = \"\", \r\n                        str = e.gmx.templateBalloon, props = e.gmx.properties;\r\n                        while ((result = re.exec(str)) !== null) {\r\n                            template += str.substring(lastIndex, result.index);\r\n                            if (props.hasOwnProperty(result[1]))\r\n                                if (result[1].search(/^ts_pos_utc/i)!=-1){\r\n                                    template += aisLayerSearcher.formatDate(new Date(props[result[1]]*1000))\r\n\t\t\t\t\t\t\t\t}\r\n                                else if (result[1].search(/^Date/i)!=-1){\r\n                                    template += aisLayerSearcher.formatDate(new Date(props[result[1]]*1000)).replace(/ .+/, \"\")\r\n\t\t\t\t\t\t\t\t}\r\n                                else\r\n                                    template += props[result[1]]\r\n\t\t\t\t\t\t\tif (result[1].search(/summary/i)!=-1){\r\n                                    template += e.gmx.summary\r\n\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\r\n//console.log(lastIndex+\", \"+result.index+\" \"+str.substring(lastIndex, result.index)+\" \"+props[result[1]]+\" \"+result[1])\r\n                            lastIndex = re.lastIndex;\r\n                        }  \r\n                        template += str.substring(lastIndex);                      \r\n//console.log(lastIndex+\", \"+re.lastIndex+\" \"+str.substring(lastIndex))\r\n                        e.popup.setContent(template);\r\n                    })\r\n                },\r\n                setLayerClickHandler = function(layer){\r\n                        layer.removeEventListener('click')\r\n                        layer.addEventListener('click', function(e){\r\n//console.log(e)\r\n                        if (e.gmx && e.gmx.properties.hasOwnProperty(\"imo\"))\r\n                        publicInterface.showInfo(e.gmx.properties)\r\n                        })           \r\n                },\r\n                forLayers = function(layer){\r\n                    if (layer){\r\n                            setLocaleDate(layer)                 \r\n                            setLayerClickHandler(layer)\r\n                    }        \r\n                }\r\n\t\t\t\t\r\n                for (var key in params) {\r\n//console.log(key + ' ' +params[key])\r\n                    if (key==\"myfleet\"){\r\n                        myFleetLayers = params[key].split(\",\").map(function(id){\r\n                           return  id.replace(/\\s/, \"\");\r\n                        });\r\n                        for (var i=0; i<myFleetLayers.length; ++i) { \r\n                            forLayers(layersByID[myFleetLayers[i]])\r\n                        }\r\n                    }\r\n                    else{ \r\n                        forLayers(layersByID[params[key]] )\r\n                    }\r\n                }\r\n\t\t\t\t\r\n\t\t\t\tmyFleetMembersModel.mapLayers = myFleetLayers\r\n\t\t\t\t\r\n\t\t\t\thighlight.addEventListener('click', function(e){e.target.vessel && publicInterface.showInfo(e.target.vessel, true)});\r\n\t\t\t\t\t\r\n\t\t\t\taisPluginPanel.views = {aisSearchView:aisSearchView, myFleetMembersView:myFleetMembersView, historyView:historyView}\r\n\t\t\t\taisPluginPanel.activeView = aisSearchView\r\n\r\n\t\t\t\tif (NOSIDEBAR){\r\n\t\t\t\t\tvar iconOpt_mf = {\r\n                    //id: toolbarIconId,\r\n\t\t\t\t\tclassName: \"VesselSearchTool\",\r\n                    togglable: true,\r\n                    title: _gtxt('AISSearch2.caption')\r\n\t\t\t\t\t};\t\r\n\t\t\t\t\tif (toolbarIconId)\r\n\t\t\t\t\t\ticonOpt_mf.id = toolbarIconId;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\ticonOpt_mf.text = _gtxt('AISSearch2.capShort');\r\n\t\t\t\t\r\n\t\t\t\t\tif (!lmap.options.svgSprite) {\r\n\t\t\t\t\t\tL.extend(iconOpt, {\r\n\t\t\t\t\t\t\tregularImageUrl: _params.regularImage.search(/^https?:\\/\\//) !== -1 ? _params.regularImage : path + _params.regularImage,\r\n\t\t\t\t\t\t\tactiveImageUrl: _params.activeImage.search(/^https?:\\/\\//) !== -1 ? _params.activeImage : path + _params.activeImage\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar icon_mf = L.control.gmxIcon(iconOpt_mf).on('statechange', function (ev) {\r\n\t\t\t\t\t\tif (ev.target.options.isActive) {\r\n\t\t\t\t\t\t\t//console.log(icon_mf);\r\n\t\t\t\t\t\t\taisPluginPanel.show(icon_mf);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\taisPluginPanel.hide();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tlmap.addControl(icon_mf);\t\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tlet sidebar = SIDEBAR2 ? window.sidebarWidget : window.sidebarControl,\r\n\t\t\t\t\t\tsidebarTab = sidebar.setPane(\r\n\t\t\t\t\t\t\"AISSearch\", {\r\n\t\t\t\t\t\t\tcreateTab: window.createTabFunction({\r\n\t\t\t\t\t\t\t\ticon: \"AISSearch\",\r\n\t\t\t\t\t\t\t\tactive: \"ais_sidebar-icon-active\",\r\n\t\t\t\t\t\t\t\tinactive: \"ais_sidebar-icon\",\r\n\t\t\t\t\t\t\t\thint: _gtxt('AISSearch2.caption')\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t)\r\n\r\n\t\t\t\t\tsidebar.on('opened', function (e) {\r\n\t\t\t\t\t\tif (e.id=='AISSearch')\r\n\t\t\t\t\t\t\taisPluginPanel.show(sidebarTab);\r\n\t\t\t\t\t})\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\tif (location.search.search(/x=[^y=]+y=/i)!=-1){\r\n\t\t\t\t\tvar a = location.search.toLowerCase().substr(1).split('&'),\r\n\t\t\t\t\tx = a.filter(function(c){return !c.indexOf(\"x=\")})[0].substr(2),\r\n\t\t\t\t\ty = a.filter(function(c){return !c.indexOf(\"y=\")})[0].substr(2)\r\n\t\t\t\t\thighlight.vessel = null;\r\n\t\t\t\t\thighlight.setLatLng([y, x]).addTo(nsGmx.leafletMap);\r\n\t\t\t\t}\r\n            },\r\n            showHistory: function(vessel){\r\n\t\t\t\thistoryView.vessel = vessel\r\n\t\t\t\thistoryView.drawBackground()\r\n\t\t\t\t$('.ais_tab', _canvas).removeClass('active').eq(2).click();\r\n\t\t\t},\r\n            showInfo: function(vessel, getmore){\r\n                var ind = polyFindIndex(allIinfoDialogs, function(d){return d.vessel.imo==vessel.imo && d.vessel.mmsi==vessel.mmsi});\r\n                if (ind>=0){\r\n                    $(allIinfoDialogs[ind].dialog).parent().insertAfter($('.ui-dialog').eq($('.ui-dialog').length-1));\r\n                    return;\r\n                }\r\n\r\n                var dialog = createInfoDialog({\r\n\t\t\t\t\tvessel:vessel, \r\n\t\t\t\t\tgetmore:getmore, displaingTrack:displaingTrack,\r\n\t\t\t\t\tcloseFunc:function(event){\r\n                            var ind = polyFindIndex(infoDialogCascade, function(d){return d.id==dialog.id});\r\n                            if (ind>=0)\r\n                                infoDialogCascade.splice(ind, 1);\r\n                            ind = polyFindIndex(allIinfoDialogs, function(d){return d.dialog.id==dialog.id});\r\n                            if (ind>=0)\r\n                                allIinfoDialogs.splice(ind, 1);\r\n                        },\r\n\t\t\t\t\taisLayerSearcher:aisLayerSearcher, //publicInterface:publicInterface,\r\n\t\t\t\t\tscheme:scheme, aisServiceUrl:aisServiceUrl, \r\n\t\t\t\t\taisView:aisView, myFleetMembersView:myFleetMembersView, \r\n\t\t\t\t\tmodulePath:modulePath,\r\n\t\t\t\t\taisPluginPanel:aisPluginPanel\r\n\t\t\t\t},\r\n\t\t\t\t{ \r\n\t\t\t\t\topenVesselInfoView: vesselInfoView.open,\r\n\t\t\t\t\tshowTrack: showTrack\t\t\t\t\t\r\n\t\t\t\t})\t\t\t\t\r\n            \r\n                if (infoDialogCascade.length>0){\r\n                    var pos  = $(infoDialogCascade[infoDialogCascade.length-1]).parent().position();\r\n                    $(dialog).dialog(\"option\", \"position\", [pos.left+10, pos.top+10]);   \r\n                }\r\n\r\n                infoDialogCascade.push(dialog);\r\n                allIinfoDialogs.push({vessel:vessel, dialog:dialog});\r\n                $(dialog).on( \"dialogdragstop\", function( event, ui ) {\r\n                    var ind = polyFindIndex(infoDialogCascade, function(d){return d.id==dialog.id});\r\n                    if (ind>=0)\r\n                        infoDialogCascade.splice(ind, 1);\r\n                });\r\n             \r\n            }\r\n        },\r\n\r\n\t\tgifLoader = '<img src=\"img/progress.gif\">',\r\n\r\n\t\tvesselInfoView  = new VesselInfoView({modulePath:modulePath, aisServiceUrl:aisServiceUrl, scheme:scheme}),\r\n\t\taisLayerSearcher = new Searcher({baseUrl:baseUrl, aisServiceUrl: aisServiceUrl}),\r\n\r\n\t\tmyFleetMembersModel = new MyFleetModel({baseUrl:baseUrl, aisLayerSearcher:aisLayerSearcher, polyFind:polyFind, polyFindIndex:polyFindIndex, myFleetLayers:myFleetLayers}),\t\r\n\t\taisScreenSearchModel = new ScreenSearchModel({myFleetMembersModel:myFleetMembersModel, aisLayerSearcher:aisLayerSearcher}),\r\n\t\taisDbSearchModel = new DbSearchModel({myFleetMembersModel:myFleetMembersModel, aisLayerSearcher:aisLayerSearcher}),\r\n\t\thistoryModel = new HistoryModel({baseUrl:baseUrl, aisLayerSearcher:aisLayerSearcher, polyFind:polyFind, polyFindIndex:polyFindIndex}),\t\r\n\r\n\t\taisView = new BaseView({publicInterface:publicInterface, highlight:highlight}),\t\t\t\t\t\r\n\t\taisSearchView = new SearchView({aisView:aisView, aisScreenSearchModel:aisScreenSearchModel, aisDbSearchModel:aisDbSearchModel, highlight:highlight}),\t\t\t\t\r\n\t\tmyFleetMembersView = new MyFleetView({aisView:aisView, myFleetMembersModel:myFleetMembersModel}),\r\n\t\thistoryView  = new HistoryView({aisView, historyModel, gifLoader})\r\n\r\n    //************************************\r\n    //  AIS PANEL\r\n    //************************************\r\n\tlet _leftMenuBlock = null,\r\n\t\t_canvas = _div(null),\r\n        _activeView,\r\n\t\t_views,\r\n\t\t_aisSearchView,\r\n\t\t_myFleetMembersView,\r\n\t\t_historyView,\r\n\t\taisPluginPanel = {\r\n\t\tset activeView(value){_activeView = value},\r\n\t\tset views(value){\r\n\t\t\tlet {aisSearchView, myFleetMembersView, historyView} = value\r\n\t\t\t_aisSearchView = aisSearchView\r\n\t\t\t_myFleetMembersView = myFleetMembersView\r\n\t\t\t_historyView = historyView\r\n\t\t\t_views = [aisSearchView, myFleetMembersView, historyView]\r\n\t\t},\r\n        get activeView(){\r\n            return _activeView;\r\n        },\r\n        show: function(sidebarTab){\r\n\t\t\r\n            if (NOSIDEBAR && !_leftMenuBlock)\r\n                _leftMenuBlock = new leftMenu();\r\n            if (NOSIDEBAR && (!_leftMenuBlock.createWorkCanvas(\"aispanel\", function(){ icon._iconClick() },\r\n\t\t\t\t{ path:[_gtxt('AISSearch2.caption')] })) ||\r\n\t\t\t\t(!this.ready)) // SIDEBAR\r\n\t\t\t{ \r\n                var tabsTemplate = '<table class=\"ais_tabs\" border=0><tr>' +\r\n                    '<td class=\"ais_tab search_tab\">' +\r\n                        '{{i \"AISSearch2.title\"}}' +\r\n                    '</td><td class=\"ais_tab myfleet_tab\">' + // ACTIVE\r\n                        '{{i \"AISSearch2.myFleetDialog\"}}' +\r\n                    '</td>'\r\n\r\n\t\t\t\tif  (historyLayer)\r\n\t\t\t\t\ttabsTemplate += '</td><td class=\"ais_tab history_tab\">' +\r\n                        '{{i \"AISSearch2.historyTab\"}}' +\r\n                    '</td>'\t\r\n\t\t\t\t\t\r\n\t\t\t\ttabsTemplate +=\r\n                '</tr></table>' +\r\n                '<div class=\"ais_view search_view\">'+\r\n\t\t\t\t\t//SEARCH FORM\r\n                    '<table border=0 class=\"instruments\"><tr>'+\r\n                    '<td><div><i class=\"icon-down-dir\"><select>'+\r\n\t\t\t\t\t(defaultSearch=='screen'?\r\n\t\t\t\t\t'<option value=\"0\">{{i \"AISSearch2.screen\"}}</option>'+'<option value=\"1\">{{i \"AISSearch2.database\"}}</option>' :\r\n\t\t\t\t\t'<option value=\"1\">{{i \"AISSearch2.database\"}}</option>'+'<option value=\"0\">{{i \"AISSearch2.screen\"}}</option>')+\r\n\t\t\t\t\t'</select></i></div></td>'+\r\n                    '<td><div class=\"refresh clicable\" title=\"{{i \"AISSearch2.refresh\"}}\"><div>'+gifLoader+'</div></div></td>'+\r\n                    '<td><span class=\"count\"></span></td></tr>'+\r\n                    '<tr><td colspan=\"3\"><div class=\"filter\"><input type=\"text\" placeholder=\"{{i \"AISSearch2.filter\"}}\"/><i class=\"icon-search clicable\"></div></td></tr></table>'+\r\n                    \r\n                    '<div class=\"ais_vessels\"><div class=\"ais_vessel\">'+\r\n                    '<table><tr><td>NO VESSELS FOUND</td>'+\r\n                    '<td><div class=\"info\">'+\r\n                    '<i class=\"clicable icon-info\"></i>'+\r\n                    '</div></td></tr></table>'+\r\n                    '</div></div>'+\r\n                '</div>'+\r\n                '<div class=\"ais_view myfleet_view\">'+   \r\n\t\t\t\t\t//MY FLEET FORM                 \r\n                    '<table border=0 class=\"instruments\"><tr>'+\r\n                    '<td><div class=\"refresh\"><div>'+gifLoader+'</div></div></td><td></td><td></td>'+\r\n                    '</tr></table>'+\r\n                    \r\n                    '<div class=\"ais_vessels\"><div class=\"ais_vessel\">NO VESSELS SELECTED</div></div>'+\r\n                '</div>'\r\n\t\t\t\tif  (historyLayer)\r\n\t\t\t\t\ttabsTemplate += _historyView.template\r\n\t\t\t\t\r\n                $(_canvas).append(Handlebars.compile(tabsTemplate));\r\n\t\t\t\t\r\n\t\t\t\tif (NOSIDEBAR)\r\n\t\t\t\t\t$(_leftMenuBlock.workCanvas).append(_canvas);\r\n\t\t\t\telse\r\n\t\t\t\t\t$(sidebarTab).append(_canvas);\r\n\r\n                var tabs = $('.ais_tab', _canvas),\r\n\t\t\t\t\t_this = this;\r\n                tabs.on('click', function(){\r\n                    if (!$(this).is('.active')){\r\n                        var target = this;\r\n                        tabs.each(function(i, tab){ \r\n                            if(!$(tab).is('.active') && target==tab){\r\n                                $(tab).addClass('active');                                \r\n                                _views[i].show();\r\n                                _activeView = _views[i];\r\n                            }\r\n                            else{\r\n                                $(tab).removeClass('active');                                \r\n                                _views[i].hide();\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n                \r\n                _aisSearchView.create({\r\n                    _frame: $('.search_view', _canvas),\r\n                    _container: $('.search_view .ais_vessels', _canvas),\r\n                    _refresh: $('.search_view .refresh div', _canvas),\r\n                    _search: $('.filter', _canvas),\r\n                    _count: $('.count', _canvas)\r\n                });\r\n\t\t\t\t_aisSearchView.setModel(defaultSearch);\r\n\r\n                _myFleetMembersView.create({\r\n                    _frame: $('.myfleet_view', _canvas),\r\n                    _container: $('.myfleet_view .ais_vessels', _canvas),\r\n                    _refresh: $('.myfleet_view .refresh div', _canvas)\r\n                });\r\n\t\t\t\t\r\n                _historyView.create({ canvas: _canvas });\r\n\t\t\t\t\r\n                var needUpdate = function(){\r\n                    _aisSearchView.setDirty();\r\n                    if (_activeView===_aisSearchView){\r\n                        _aisSearchView.show();\r\n                    }\r\n                }; \r\n                nsGmx.leafletMap.on('moveend', needUpdate.bind(this));\r\n                nsGmx.widgets.commonCalendar.getDateInterval().on('change', needUpdate.bind(this));\r\n\t\t\t\tthis.ready = true\r\n            }\r\n\t\r\n\t\t\tif (NOSIDEBAR){\r\n\t\t\t\t$(_leftMenuBlock.parentWorkCanvas)\r\n\t\t\t\t.attr('class', 'left_aispanel')\r\n\t\t\t\t.insertAfter('.layers-before');\r\n\t\t\t\tvar blockItem = _leftMenuBlock.leftPanelItem,\r\n\t\t\t\t\tblockTitle = $('.leftmenu-path', blockItem.panelCanvas);\r\n\t\t\t\tvar toggleTitle = function(){\r\n\t\t\t\t\tif(blockItem.isCollapsed())\r\n\t\t\t\t\t\tblockTitle.show();\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tblockTitle.hide();\r\n\t\t\t\t}\r\n\t\t\t\t$(blockItem).on('changeVisibility', toggleTitle);\r\n\t\t\t\ttoggleTitle();\r\n\t\t\t}\r\n\t\t\t\r\n            // Show the first tab\r\n            $('.ais_tab', _canvas).eq(0).removeClass('active').click();\r\n            _aisSearchView.drawBackground();\r\n            _myFleetMembersView.drawBackground();\r\n            _historyView.drawBackground();\r\n\t\t\t\r\n        }\r\n    };\r\n\t\r\n\tif (NOSIDEBAR){\r\n        aisPluginPanel.hide = function(){\r\n            $(_leftMenuBlock.parentWorkCanvas).hide()\r\n\t\t\tnsGmx.leafletMap.removeLayer(highlight)\r\n        }\t\t\r\n\t}\r\n\r\n    gmxCore.addModule(pluginName, publicInterface, {\r\n        css: cssTable + '.css'\r\n    });\r\n\t\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/entry.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/all.css\n// module id = 1\n// module chunks = 0","\r\n    _translationsHash.addtext('rus', {\r\n        'AISSearch2.title': 'Поиск судов',\r\n        'AISSearch2.title1': 'Найдено судов',\r\n        'AISSearch2.title2': '<b>Данных не найдено!</b>',\r\n        'AISSearch2.error': '<b>Ошибка при получении данных!</b>',\r\n        'AISSearch2.iconTitle': 'Поиск судов по экрану',\r\n        'AISSearch2.placeholder_0': 'Поиск по адресам, координатам',\r\n        'AISSearch2.placeholder_1': 'Поиск судна по названию / MMSI',\r\n        // 'AISSearch2.placeholder_1': 'Поиск судна по названию / MMSI. Поиск по адресам, координатам, кадастровым номерам'\r\n        'AISSearch2.myFleetDialog': 'Мой флот',\r\n        'AISSearch2.vesselName': 'название',\r\n        'AISSearch2.vesselAdd': 'добавить',\r\n        'AISSearch2.vesselRemove': 'удалить',\r\n        'AISSearch2.myFleetMembers': 'Состав',\r\n        'AISSearch2.myFleetMember': 'мой флот',\r\n        'AISSearch2.info': 'информация',\r\n        'AISSearch2.found':'Найдено: ',\r\n        'AISSearch2.filter':'Введите название или mmsi или imo судна',\r\n        'AISSearch2.screen':'По экрану',\r\n        'AISSearch2.database':'По базе данных',\r\n        'AISSearch2.capShort': 'Поиск судов',\r\n        'AISSearch2.caption': 'Поиск судов и \"Мой флот\"',\r\n        'AISSearch2.refresh': 'обновить',\r\n        'AISSearch2.refreshing': 'обновляется',\r\n        'AISSearch2.nomyfleet': 'Сервис не доступен',\r\n        'AISSearch2.auth': 'Требуется авторизация',\r\n        'AISSearch2.vessel_name': 'Название',\r\n        'AISSearch2.mmsi': 'MMSI',\r\n        'AISSearch2.imo': 'IMO',\r\n        'AISSearch2.flag_country': 'Страна',\r\n        'AISSearch2.vessel_type': 'Тип судна',\r\n        'AISSearch2.draught': 'Осадка',\r\n        'AISSearch2.destination': 'Назначение',\r\n        'AISSearch2.nav_status': 'Статус',\r\n        'AISSearch2.last_sig': 'Последний сигнал',\r\n        'AISSearch2.show_track': 'трек за сутки',\r\n        'AISSearch2.hide_track': 'скрыть трек',\r\n\t\t'AISSearch2.source': 'Источник данных',\r\n\t\t'AISSearch2.sais': 'спутниковый AIS',\r\n\t\t'AISSearch2.tais': 'береговой AIS',\r\n\t\t'AISSearch2.lon': 'Долгота',\r\n\t\t'AISSearch2.lat': 'Широта',\r\n\t\t'AISSearch2.historyTab': 'История',\r\n\t\t'AISSearch2.voyageInfo': 'Параметры движения'\r\n    });\r\n    _translationsHash.addtext('eng', {\r\n        'AISSearch2.title': 'Searching vessels',\r\n        'AISSearch2.title1': 'Vessels found',\r\n        'AISSearch2.title2': '<b>Vessels not found!</b>',\r\n        'AISSearch2.error': '<b>Vessels not found!</b>',\r\n        'AISSearch2.iconTitle': 'Search vessels within the view area',\r\n        'AISSearch2.placeholder_0': 'Search for addresses, coordinates',\r\n        'AISSearch2.placeholder_1': 'Search by vessel name / MMSI',\r\n        // 'AISSearch2.placeholder_1' : 'Search by vessel name / MMSI. Search by addresses, coordinates, cadastre number'\r\n        'AISSearch2.myFleetDialog': 'My fleet',\r\n        'AISSearch2.vesselName': 'name',\r\n        'AISSearch2.vesselAdd': 'add',\r\n        'AISSearch2.vesselRemove': 'remove',\r\n        'AISSearch2.myFleetMembers': 'Members',\r\n        'AISSearch2.myFleetMember': 'my fleet',\r\n        'AISSearch2.info': 'info',\r\n        'AISSearch2.found':'Found ',\r\n        'AISSearch2.filter':'Insert vessel name or mmsi or imo',\r\n        'AISSearch2.screen':'On screen',\r\n        'AISSearch2.database':'In database',\r\n        'AISSearch2.capShort': 'Vessel Search',\r\n        'AISSearch2.caption': 'Vessel Search & My Fleet',\r\n        'AISSearch2.refresh': 'refresh',\r\n        'AISSearch2.refreshing': 'refreshing',\r\n        'AISSearch2.nomyfleet': 'Service is unavailable',\r\n        'AISSearch2.auth': 'Authorization required',\r\n        'AISSearch2.vessel_name': 'Name',\r\n        'AISSearch2.mmsi': 'MMSI',\r\n        'AISSearch2.imo': 'IMO',\r\n        'AISSearch2.flag_country': 'Flag',\r\n        'AISSearch2.vessel_type': 'Vessel type',\r\n        'AISSearch2.draught': 'Draught',\r\n        'AISSearch2.destination': 'Destination',\r\n        'AISSearch2.nav_status': 'Navigation status',\r\n        'AISSearch2.last_sig': 'Last signal',\r\n        'AISSearch2.show_track': 'show track',\r\n        'AISSearch2.hide_track': 'hide track',\r\n\t\t'AISSearch2.source': 'Source',\r\n\t\t'AISSearch2.sais': 'S-AIS',\r\n\t\t'AISSearch2.tais': 'T-AIS',\r\n\t\t'AISSearch2.lon': 'Longitude',\r\n\t\t'AISSearch2.lat': 'Latitude',\r\n\t\t'AISSearch2.historyTab': 'History',\r\n\t\t'AISSearch2.voyageInfo': 'Voyage info'\r\n    });\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/locale.js","module.exports = { \r\n\tpolyFind: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn value;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn undefined;\r\n\t},\r\n\tpolyFindIndex: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn i;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/polyfill.js","//************************************\r\n//  BASE AIS VIEW\r\n//************************************\r\nlet NOSIDEBAR = false,\r\n\tSIDEBAR2 = false;\r\nif (has('NOSIDEBAR'))\r\n\tNOSIDEBAR = true;\r\nif (has('SIDEBAR2'))\r\n\tSIDEBAR2 = true;\r\n\t\r\nmodule.exports = function({publicInterface, highlight}){\r\n\tconst _waitTime = 1000\r\n\treturn {\r\n\t\tget model() { return this._model },\r\n        _calcHeight: function(){\r\n\t\t\tlet h = $('.ais_vessel')[0].getBoundingClientRect().height+5\r\n\t\t\tif (NOSIDEBAR)\r\n\t\t\t\treturn h*5-5\r\n\t\t\telse{\r\n\t\t\t\t//let H = $('.iconSidebarControl-content').height()-150,\r\n\t\t\t\tlet H = $('.gmx-sidebar-pane').height()-150,\r\n\t\t\t\tn = Math.ceil(H/h)\r\n//console.log(H)\r\n\t\t\t\treturn h*n-5\r\n\t\t\t}\r\n\t\t},\r\n        drawBackground: function(){\r\n            this._clean();\r\n        },\r\n        _clean: function(){\r\n            if (this.doClean)\r\n                this.doClean();\r\n            $('.info', this._container).off('click');\r\n            $('.position', this._container).off('click');\r\n            $('.history', this._container).off('click');\r\n            if ($('.mCSB_container', this._container)[0])\r\n                $('.mCSB_container', this._container).empty();\r\n            else\r\n                $(this._container).empty();\r\n        },\r\n        create: function(controls){\r\n            $.extend(this, controls);\r\n            if (this.createForm)\r\n                this.createForm();\t\t\t\r\n            $(this._container).height(this._calcHeight())\r\n            if (this.bindControlEvents)\r\n                this.bindControlEvents();\r\n\t\t\tif (NOSIDEBAR){\r\n\t\t\t\tif ($('.icon-down-dir', this._frame)[0] && $('.icon-down-dir', this._frame).height()==34)\r\n\t\t\t\t\t$('.icon-down-dir', this._frame).css({position:'relative', top:'2px'})\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tif (SIDEBAR2){\r\n\t\t\t\t\tif ($('.icon-down-dir', this._frame)[0] && $('.icon-down-dir', this._frame).height()==34)\r\n\t\t\t\t\t\t$('.icon-down-dir', this._frame).css({position:'relative', top:'2px'})\r\n\t\t\t\t\t$('.ais_tab').css({'border-top':'none'})\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t\t$('.icon-down-dir', this._frame).css({position:'relative', top:'1px'})\r\n\t\t\t}\r\n        },\r\n        show: function(){\r\n            this._start = new Date().getTime();\r\n            \r\n            //if(clean) this._clean();\r\n            $(this._frame).show();\r\n\r\n            var _this = this;\r\n            clearTimeout(this._wait);\r\n            var rest = new Date().getTime()-this._lastUpdate;\r\n//console.log(rest) \r\n            //this._refresh.parent().removeClass('clicable');\r\n            //this._refresh.parent().attr('title', ''); \r\n            //this._refresh.addClass('animate-spin');\r\n            this._refresh.show();\r\n\r\n            if (!this._lastUpdate || rest>=_waitTime){\r\n                this._lastUpdate = new Date().getTime();  \r\n                this._model.update();\r\n            }\r\n            else{\r\n                this._wait = setTimeout(function(){  \r\n                    _this._lastUpdate = new Date().getTime();  \r\n                    _this._model.update();\r\n                }, _waitTime-rest);\r\n            }\r\n        },\r\n        hide: function(){            \r\n            $(this._frame).hide();\r\n        },\r\n        positionMap: function(vessel){\r\n//console.log(vessel);\r\n            if (vessel.ts_pos_utc){\r\n                var d = new Date(vessel.ts_pos_utc.replace(/(\\d\\d).(\\d\\d).(\\d\\d\\d\\d).+/, \"$3-$2-$1\")),\r\n                interval = nsGmx.DateInterval.getUTCDayBoundary(d);\r\n                nsGmx.widgets.commonCalendar.setDateInterval(interval.dateBegin, interval.dateEnd);\r\n            }\r\n\r\n \t\t\t\tnsGmx.leafletMap.fitBounds([\r\n    \t\t\t\t\t[vessel.ymin, vessel.xmin],\r\n    \t\t\t\t\t[vessel.ymax, vessel.xmax]\r\n    \t\t\t\t], {\r\n    \t\t\t\t\tmaxZoom: 9,//config.user.searchZoom,\r\n    \t\t\t\t\tanimate: false\r\n    \t\t\t})\r\n\t\t\t\r\n\t\t\tnsGmx.leafletMap.removeLayer(highlight);\r\n\t\t\thighlight.vessel = vessel;\r\n\t\t\thighlight.setLatLng([vessel.ymax, vessel.xmax]).addTo(nsGmx.leafletMap);\t\t\t\t\r\n        },        \r\n        showPosition: function(item){\r\n            var vessel = JSON.parse(item.parent().parent().find('.info').attr('vessel'));\r\n            if (vessel.maxid && vessel.xmax!=vessel.xmin && vessel.ymax!=vessel.ymin){\r\n                var _this = this;\r\n                // search latest position in group \r\n                aisLayerSearcher.searchById([vessel.maxid], function(response){\r\n                    if (response.Status.toLowerCase()==\"ok\"){\r\n                        vessel.ymin = response.Result.values[0][5]; vessel.xmin = response.Result.values[0][4];\r\n    \t\t\t\t\tvessel.ymax = response.Result.values[0][5]; vessel.xmax = response.Result.values[0][4];\r\n                        item.parent().parent().find('.info').attr('vessel', JSON.stringify(vessel));\r\n                        _this.positionMap(vessel);\r\n                    }\r\n                    else{\r\n                        console.log(response);\r\n                    }\r\n                });\r\n            }\r\n            else\r\n\t\t\t\tthis.positionMap(vessel);\t\r\n\r\n        },  \r\n        repaint: function(){\r\n\r\n            if (!$(this._container).is(':visible'))\r\n                return;\r\n\r\n//console.log(\"REPAINT \"+(new Date().getTime()-this._start)+\"ms\")\r\n\r\n            //this._refresh.removeClass('animate-spin');\r\n            this._refresh.hide();\r\n            //this._refresh.parent().addClass('clicable');\r\n            //this._refresh.parent().attr('title', _gtxt('AISSearch2.refresh'));\r\n\r\n            this._clean();\r\n\r\n//console.log(this._model.data.vessels[0].heading_rot);\r\n            var scrollCont = $(this._container).find('.mCSB_container');\r\n            var content = $(Handlebars.compile(this._tableTemplate)(this._model.data));\r\n//console.log(content);\r\n            if (!scrollCont[0]){\r\n                $(this._container).append(content).mCustomScrollbar(); \r\n            }\r\n            else{\r\n                $(scrollCont).append(content);\r\n            } \r\n            var _this = this;           \r\n            $('.info', this._container).on('click', function(){\r\n\t\t\t\tlet target = $(this),\r\n\t\t\t\t\tvessel = JSON.parse(target.attr('vessel'))\r\n                publicInterface.showInfo(vessel, (v)=>{\r\n//console.log(vessel)\r\n\t\t\t\t\tvessel.xmin = vessel.xmax = v.longitude\r\n\t\t\t\t\tvessel.ymin = vessel.ymax = v.latitude\r\n\t\t\t\t\tif (vessel.hasOwnProperty('ts_pos_utc')){\r\n\t\t\t\t\t\tvessel.ts_pos_utc = v.ts_pos_utc\r\n\t\t\t\t\t\t$(this).closest('tr').find('.date').html('('+v.ts_pos_utc+')')\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttarget.attr('vessel', JSON.stringify(vessel))\r\n\t\t\t\t});\r\n            });          \r\n            $('.position', this._container).on('click', function(){\r\n                _this.showPosition($(this))\r\n                publicInterface.showHistory(JSON.parse($(this).closest('tr').find('.info').attr('vessel')), true);\r\n            });\r\n            $('.history', this._container).on('click', function(){\r\n                publicInterface.showHistory(JSON.parse($(this).closest('tr').find('.info').attr('vessel')), true);\r\n            }); \r\n            $('.show_voyage_info', this._container).on('click', function(e){\r\n                let vi = $(e.currentTarget).closest('div').find('div.voyage_info')\r\n\t\t\t\tif (vi.is(':visible')) vi.hide()\r\n\t\t\t\telse vi.show()\r\n            }); \t\t\t\r\n\t\t\t\r\n            if (this._repaintControls)\r\n                this._repaintControls();         \r\n        }\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Views/BaseView.js","//************************************\r\n// AIS LAYERS SEARCHER\r\n//************************************\r\n\r\nmodule.exports = function({baseUrl,  aisServiceUrl, aisLastPoint, screenSearchLayer, aisLayerID, historyLayer}){\r\n\treturn {\r\n        _serverScript: baseUrl + 'VectorLayer/Search.ashx',\r\n\t\t\r\n\t\tset aisLastPoint(value){\r\n\t\t\taisLastPoint = value\r\n\t\t},\r\n\t\tset aisLayerID(value){\r\n\t\t\taisLayerID = value\r\n\t\t},\r\n\t\tset screenSearchLayer(value){\r\n\t\t\tscreenSearchLayer = value\r\n\t\t},\r\n\t\tget aisLayerID(){\r\n\t\t\treturn aisLayerID\r\n\t\t},\r\n\t\tset historyLayer(value){\r\n\t\t\thistoryLayer = value\r\n\t\t},\t\t\t\r\n\t\t\r\n        getBorder :function () {\r\n            var lmap = nsGmx.leafletMap;\r\n            var dFeatures = lmap.gmxDrawing.getFeatures();\r\n            if (dFeatures.length) { return dFeatures[dFeatures.length - 1].toGeoJSON(); }\r\n            var latLngBounds = lmap.getBounds(),\r\n                sw = latLngBounds.getSouthWest(),\r\n                ne = latLngBounds.getNorthEast(),\r\n                min = { x: sw.lng, y: sw.lat },\r\n                max = { x: ne.lng, y: ne.lat },\r\n                minX = min.x,\r\n                maxX = max.x,\r\n                geo = { type: 'Polygon', coordinates: [[[minX, min.y], [minX, max.y], [maxX, max.y], [maxX, min.y], [minX, min.y]]] },\r\n                w = (maxX - minX) / 2;\r\n\r\n            if (w >= 180) {\r\n                    geo = { type: 'Polygon', coordinates: [[[-180, min.y], [-180, max.y], [180, max.y], [180, min.y], [-180, min.y]]] };\r\n            } \r\n            else if (maxX > 180 || minX < -180) {\r\n                var center = ((maxX + minX) / 2) % 360;\r\n                if (center > 180) { center -= 360; }\r\n                else if (center < -180) { center += 360; }\r\n                minX = center - w; maxX = center + w;\r\n                if (minX < -180) {\r\n                    geo = { type: 'MultiPolygon', coordinates: [\r\n                                    [[[-180, min.y], [-180, max.y], [maxX, max.y], [maxX, min.y], [-180, min.y]]],\r\n                                    [[[minX + 360, min.y], [minX + 360, max.y], [180, max.y], [180, min.y], [minX + 360, min.y]]]\r\n                                ]\r\n                    };\r\n                } else if (maxX > 180) {\r\n                    geo = { type: 'MultiPolygon', coordinates: [\r\n                                    [[[minX, min.y], [minX, max.y], [180, max.y], [180, min.y], [minX, min.y]]],\r\n                                    [[[-180, min.y], [-180, max.y], [maxX - 360, max.y], [maxX - 360, min.y], [-180, min.y]]]\r\n                                ]\r\n                    };\r\n                }\r\n            }\r\n            return geo;\r\n        },   \r\n        formatDate: function(d, local){\r\n            var dd,m,y,h,mm;\r\n            if (local){\r\n                dd = (\"0\"+d.getDate()).slice(-2);\r\n                m = (\"0\"+(d.getMonth()+1)).slice(-2);\r\n                y = d.getFullYear();\r\n                h = (\"0\"+d.getHours()).slice(-2);\r\n                mm = (\"0\"+d.getMinutes()).slice(-2);\r\n\t\t\t\treturn dd+\".\"+m+\".\"+y+\" \"+h+\":\"+mm+\r\n\t\t\t\t\" (\"+(\"0\"+d.getUTCHours()).slice(-2)+\":\"+(\"0\"+d.getUTCMinutes()).slice(-2)+\" UTC)\";\r\n            }\r\n            else{\r\n                dd = (\"0\"+d.getUTCDate()).slice(-2);\r\n                m = (\"0\"+(d.getUTCMonth()+1)).slice(-2);\r\n                y = d.getUTCFullYear();\r\n                h = (\"0\"+d.getUTCHours()).slice(-2);\r\n                mm = (\"0\"+d.getUTCMinutes()).slice(-2);\r\n\t\t\t\tvar\r\n                ldd = (\"0\"+d.getDate()).slice(-2),\r\n                lm = (\"0\"+(d.getMonth()+1)).slice(-2),\r\n                ly = d.getFullYear(),\r\n                lh = (\"0\"+d.getHours()).slice(-2),\r\n                lmm = (\"0\"+d.getMinutes()).slice(-2),\r\n\t\t\t\toffset = -d.getTimezoneOffset()/60;\t\t\t\t\r\n\t\t\t\treturn dd+\".\"+m+\".\"+y+\" <span class='utc'>\"+h+\":\"+mm+\" UTC</span> (\"+lh+\":\"+lmm+\")\"\r\n\t\t\t\t//return dd+\".\"+m+\".\"+y+\" \"+h+\":\"+mm+\" UTC <br>\"+\r\n\t\t\t\t//\"<span class='small'>(\"+ldd+\".\"+lm+\".\"+ly+\" \"+lh+\":\"+lmm+\" UTC\"+(offset>0?\"+\":\"\")+offset+\")</span>\";\r\n            }\r\n        }, \r\n        searchPositions: function(vessels, dateInterval, callback){\r\n//console.log(\"searchById\");\r\n            var request =  {\r\n                            WrapStyle: 'window',\r\n                            layer: historyLayer, //'8EE2C7996800458AAF70BABB43321FA4',//\r\n                            //orderdirection: 'desc',\r\n                            //orderby: 'ts_pos_utc',\r\n                            query: \"([mmsi] IN (\"+vessels.join(',')+\")) and '\"+dateInterval.dateBegin.toISOString()+\"'<=[ts_pos_utc] and [ts_pos_utc]<'\"+dateInterval.dateEnd.toISOString()+\"'\"\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(this._serverScript, request, callback);\r\n        },\r\n        searchById: function(aid, callback){\r\n//console.log(\"searchById\");\r\n            var request =  {\r\n                            WrapStyle: 'window',\r\n                            layer: aisLayerID, //'8EE2C7996800458AAF70BABB43321FA4'\r\n                            columns: '[{\"Value\":\"vessel_name\"},{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"}]',\r\n                            query: \"([id] IN (\" + aid.join(',') + \"))\"\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(this._serverScript, request, callback);\r\n        },\r\n        searchString: function(searchString, isfuzzy, callback){\r\n//console.log(aisLastPoint+\", \"+aisLayerID)\r\n            var query = \"\"; \r\n            if (searchString) {\r\n                searchString = searchString.toUpperCase();\r\n                    if (searchString.search(/[^\\d, ]/) === -1) {\r\n                            var arr = searchString.replace(/ /g, '').split(/,/);\r\n                            query = \"([mmsi] IN (\" + arr.join(',') + \"))\"+\r\n                            \"OR ([imo] IN (\" + arr.join(',') + \"))\"\r\n                    } else {\r\n                        if (isfuzzy)\r\n                            query = '([vessel_name] startswith \\'' + searchString + '\\') OR ([vessel_name] contains \\' ' + searchString + '\\')';\r\n                        else\r\n                            query = '([vessel_name] startswith \\'' + searchString + '\\') OR ([vessel_name] contains \\' ' + searchString + '\\')';\r\n                    }\r\n            }\r\n            var request =  {\r\n                            WrapStyle: 'window',\r\n                            layer: aisLastPoint, \r\n                            columns: '[{\"Value\":\"vessel_name\"},{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"}]',\r\n                            orderdirection: 'desc',\r\n                            orderby: 'ts_pos_utc',\r\n                            query: query\r\n            };\r\n            if (isfuzzy)\r\n                request.pagesize = 1000;\r\n            L.gmxUtil.sendCrossDomainPostRequest(this._serverScript, request, callback);\r\n        },            \r\n        searchNames: function(avessels, callback){\r\n            var request =  {\r\n                            WrapStyle: 'window',\r\n                            layer: aisLastPoint, \r\n                            orderdirection: 'desc',\r\n                            orderby: 'ts_pos_utc',\r\n                            query: avessels.map(function(v){return \"([mmsi]=\"+v.mmsi+(v.imo && v.imo!=\"\"?(\" and [imo]=\"+v.imo):\"\")+\")\"}).join(\" or \")\r\n                            //([mmsi] IN (\" + ammsi.join(',') + \"))\"+\r\n                            //\"and ([imo] IN (\" + aimo.join(',') + \"))\"\r\n            };\r\n//console.log(request)\r\n            L.gmxUtil.sendCrossDomainPostRequest(this._serverScript, request, callback);\r\n        },\r\n        searchScreen:  function(options, callback) {\r\n            var lmap = nsGmx.leafletMap;\r\n            var dt1 = options.dateInterval.get('dateBegin'),\r\n                dt2 = options.dateInterval.get('dateEnd');\r\n                //query += '([' + TemporalColumnName + '] >= \\'' + dt1.toJSON() + '\\')';\r\n                //query += ' and ([' + TemporalColumnName + '] < \\'' + dt2.toJSON() + '\\')';\r\n            var latLngBounds = lmap.getBounds(),\r\n                sw = latLngBounds.getSouthWest(),\r\n                ne = latLngBounds.getNorthEast(),\r\n                min = { x: sw.lng, y: sw.lat },\r\n                max = { x: ne.lng, y: ne.lat };\r\n//console.log(min);\r\n//console.log(max);\r\n            L.gmxUtil.sendCrossDomainPostRequest(aisServiceUrl + \"SearchScreen.ashx\", \r\n            {WrapStyle: 'window',s:dt1.toJSON(),e:dt2.toJSON(),minx:min.x,miny:min.y,maxx:max.x,maxy:max.y, layer:screenSearchLayer}, \r\n            callback);\r\n        }\r\n    };  \r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Search/Searcher.js","//************************************\r\n// MY FLEET MODEL\r\n//************************************\r\n\t\r\nmodule.exports = function({baseUrl, myFleetLayers, aisLayerSearcher, myFleetMembersView, polyFind, polyFindIndex}){\r\n\treturn {\t\t\r\n\t\tset view(value){ myFleetMembersView = value },\t\r\n\t\tset mapLayers(value){ myFleetLayers = value },\r\n\t\t//get mapLayers(){ return myFleetLayers },\r\n\t\t\r\n\t\tfindIndex: function(vessel){\r\n\t\t\tif (!this.data)\r\n\t\t\t\treturn -1;\r\n\t\t\treturn polyFindIndex(this.data.vessels, function(v){\r\n                return v.mmsi==vessel.mmsi && v.imo==vessel.imo;\r\n            })\r\n\t\t},\r\n\t\t\r\n        _isDirty: true,\r\n        getDirty: function(){return this._isDirty},\r\n        setDirty: function(){this._isDirty = true},\r\n        _parseFilter: function(filter){\r\n            var vessels = [];\r\n            var attributes = filter.toLowerCase().replace(/and \\[ts_pos_utc\\].+$/, \"\").split(\"or\");\r\n//console.log(attributes);\r\n            var myRe = /\\[*([^\\[\\]=]+)\\]*=([^ \\)]+)\\)? *\\)?( |$)/ig;\r\n            var myArray;\r\n            for (var i=0; i<attributes.length; ++i){\r\n                var vessel = null;\r\n                while ((myArray = myRe.exec(attributes[i])) !== null) {\r\n                    if (!vessel) vessel = {};\r\n                    vessel[myArray[1]] = myArray[2];\r\n                }\r\n                if (vessel)\r\n                    vessels.push(vessel);\r\n            }  \r\n//console.log(vessels);   \r\n            return vessels;  \r\n        },\r\n        getCount: function(){\r\n            return this.data ? this.data.vessels.length : 0;\r\n        },\r\n        layers: [],\r\n        load: function(){\r\n            var _this = this;\r\n            //var layerId = myFleetLayers\r\n\r\n            if (myFleetLayers.length==0)\r\n                this.data = {msg:[{txt:_gtxt(\"AISSearch2.nomyfleet\")}]};\r\n\r\n            if (myFleetLayers.length==0 || !this._isDirty)\r\n                return Promise.resolve();\r\n\r\n            this.layers = [];\r\n            var errors = [],\r\n                promises = myFleetLayers.map(function(lid){return new Promise(function(resolve, reject) {\r\n                        sendCrossDomainJSONRequest(baseUrl + \"Layer/GetLayerInfo.ashx?NeedAttrValues=false&LayerName=\" +\r\n                        lid, function(response){   \r\n//console.log(response);                         \r\n                            if (response.Status.toLowerCase()==\"ok\")\r\n                                _this.layers.push({layerId:lid, parentLayerId:response.Result.ParentLayer, filter:response.Result.Filter});\r\n                            else\r\n                                errors.push(response);\r\n                            resolve(response); \r\n                        }); \r\n                    })})\r\n                \r\n            return Promise.all(promises)\r\n            .then(function() { \r\n//console.log(_this.layers)                                    \r\n                            if (_this.layers.length>0){\r\n                                var layer = polyFind(_this.layers, function(l){return l.parentLayerId!='13E2051DFEE04EEF997DC5733BD69A15' && l.filter!=\"([mmsi]=-1000)\";})// NOT TRACKS\r\n//console.log(layer)      \r\n                                if (!layer)\r\n                                    return Promise.resolve({Status:\"ok\", Result:{values:[]}});\r\n//console.log(layer.filter)                                    \r\n                                var vessels = _this._parseFilter(layer.filter);\r\n                                return new Promise(function(resolve, reject) {\r\n                                    aisLayerSearcher.searchNames(\r\n                                        vessels,\r\n                                        //vessels.map(function(v){return v.mmsi}), \r\n                                        //vessels.map(function(v){return v.imo}),\r\n                                        function(response){ \r\n                                            resolve(response);\r\n                                        });\r\n                                });\r\n                            }\r\n                            else{\r\n                                return Promise.resolve({Status:\"error\", ErrorInfo:errors});\r\n                            }\r\n                        }\r\n            )\r\n            .then(function(response) {  \r\n//console.log(response)  \r\n//console.log(\"LOAD MY FLEET FINISH\")               \r\n                        if (response.Status.toLowerCase()==\"ok\"){                          \r\n                            _this.data = {vessels:response.Result.values.reduce(function(p,c){\r\n\t\t\t\t\t\t\t\tvar mmsi = response.Result.fields.indexOf(\"mmsi\"), \r\n\t\t\t\t\t\t\t\tvessel_name = response.Result.fields.indexOf(\"vessel_name\"), \r\n\t\t\t\t\t\t\t\tts_pos_utc = response.Result.fields.indexOf(\"ts_pos_utc\"),\r\n\t\t\t\t\t\t\t\timo = response.Result.fields.indexOf(\"imo\"),\r\n\t\t\t\t\t\t\t\tlat = response.Result.fields.indexOf(\"longitude\"),\r\n\t\t\t\t\t\t\t\tlon = response.Result.fields.indexOf(\"latitude\");\r\n                                if (!p.some(function(v){return v.mmsi==c[mmsi]})) {\r\n                                    var d = new Date(c[ts_pos_utc]*1000);\r\n                                    p.push({vessel_name:c[vessel_name], mmsi:c[mmsi], imo:c[imo], ts_pos_utc: aisLayerSearcher.formatDate(d),\r\n                                    xmin:c[lat], xmax:c[lat], ymin:c[lon], ymax:c[lon]}); \r\n                                }\r\n                                return p;\r\n                            }, [])}; \r\n\t\t\t\t\t\t\t_this.data.vessels.sort(function(a,b){return +(a.vessel_name > b.vessel_name) || +(a.vessel_name === b.vessel_name) - 1;})\r\n                            _this._isDirty = false;                         \r\n                            return Promise.resolve(); \r\n                        }\r\n                        else{                                           \r\n                            return Promise.reject(response); \r\n                        }\r\n                    });\r\n        },\r\n        update: function(){\r\n            var _this = this;\r\n            this._actualUpdate = new Date();\r\n            var actualUpdate = this._actualUpdate;\r\n            this.load().then(function(){\r\n//console.log(_this.layers)\r\n                if (_this._actualUpdate==actualUpdate)\r\n                    myFleetMembersView.repaint();\r\n            }, function(response){\r\n                _this.data = null;\r\n                if (response.Status.toLowerCase()==\"auth\" || \r\n                    (response.ErrorInfo && response.ErrorInfo.some && response.ErrorInfo.some(function(r){return r.Status.toLowerCase()==\"auth\"})))\r\n                    _this.data = {msg:[{txt:_gtxt(\"AISSearch2.auth\")}], vessels:[]};\r\n                else{\r\n                    console.log(response);\r\n                }\r\n                myFleetMembersView.repaint();              \r\n            });\r\n        },\r\n        markMembers:function(vessels){\r\n            if (this.data && this.data.vessels)\r\n            this.data.vessels.forEach(function(v){\r\n                var member = polyFind(vessels, function(vv){return v.mmsi==vv.mmsi && v.imo==v.imo});\r\n                if (member)\r\n                    member.mf_member = \"display:inline\";\r\n            });\r\n        },\r\n        // Layer filter example \"(([mmsi]=273452320 and [imo]=8971059) or ([mmsi]=273349220 and [imo]=8811015)) and [ts_pos_utc]>=2017-07-08\"\r\n        changeFilter: function(vessel){\r\n//console.log(this.data);\r\n            var add = true, temp = {vessels:[]}, vessels = this.data.vessels;\r\n            for (var i=0; i< this.data.vessels.length; ++i){\r\n                if ( this.data.vessels[i].imo==vessel.imo &&  this.data.vessels[i].mmsi==vessel.mmsi)\r\n                    add = false;\r\n                else\r\n                    temp.vessels.push(this.data.vessels[i]);\r\n            }\r\n            if (add)\r\n                    temp.vessels.push(vessel);\r\n            this.data = temp;\r\n            var _this = this;\r\n            this.layers.forEach(function(layer){\r\n                layer.filter = _this.data.vessels.length==0?\r\n                \"([mmsi]=-1000)\":\r\n                _this.data.vessels.map(function(v){\r\n                    return layer.parentLayerId!='13E2051DFEE04EEF997DC5733BD69A15'? // IS TRACKS\r\n                    \"([mmsi]=\"+v.mmsi+\" and [imo]=\"+v.imo+\")\":\r\n                    \"([mmsi]=\"+v.mmsi+\")\";\r\n                }).join(\" or \");\r\n\r\n                /*\r\n                        var editFilter = layer.parentLayerId!='13E2051DFEE04EEF997DC5733BD69A15'? // IS TRACKS\r\n                        \"([mmsi]=\"+vessel.mmsi+\" and [imo]=\"+vessel.imo+\")\":\r\n                        \"([mmsi]=\"+vessel.mmsi+\")\";\r\n                        if(layer.filter.search(/(mmsi|imo)/i)!=-1){\r\n\r\n                            var conditions = layer.filter.replace(/\\( *(\\(.+\\)) *\\).*$/, \"$1\").split(\" or \"),\r\n                            pos = conditions.indexOf(editFilter);\r\n//console.log(conditions)\r\n                            if (pos!=-1)\r\n                                conditions.splice(pos, 1);\r\n                            else\r\n                                conditions.push(editFilter);\r\n                            if (conditions.length>0)\r\n                                layer.filter = conditions.join(\" or \");\r\n                            else\r\n                                layer.filter = \"(1=0)\";\r\n                        }\r\n                        else{\r\n                            layer.filter = editFilter;\r\n                        }\r\n                */\r\n                var today = new Date(new Date()-3600*24*7*1000);\r\n                today = today.getFullYear()+\"-\"+(\"0\"+(today.getMonth()+1)).slice(-2)+\"-\"+(\"0\"+today.getDate()).slice(-2);\r\n\t\t\t\tif (layer.filter!=\"([mmsi]=-1000)\"){\r\n\t\t\t\t\tif (layer.parentLayerId!='13E2051DFEE04EEF997DC5733BD69A15')\r\n\t\t\t\t\t\tlayer.filter = \"(\"+layer.filter+\") and [ts_pos_utc]>='\"+ today +\"'\";\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tlayer.filter = \"(\"+layer.filter+\") and [Date]>='\"+ today +\"'\";\r\n\t\t\t\t}\r\n//console.log(layer.filter)\r\n            });\r\n            return Promise.all(this.layers.map(function(l){\r\n                /* return new Promise(function(resolve){\r\n                    var t = setTimeout(function(){\r\n                        resolve();\r\n                    }, 1000);\r\n                });\r\n               */\r\n                        return new Promise(function(resolve, reject) {\r\n                        sendCrossDomainJSONRequest(baseUrl + \r\n                        \"VectorLayer/Update.ashx?VectorLayerID=\"+l.layerId+\"&filter=\" +\r\n                        l.filter, function(response){\r\n                            if (response.Status.toLowerCase() == \"ok\") \r\n                                setTimeout(function run() {\r\n\r\n                                    sendCrossDomainJSONRequest(baseUrl + \r\n                                    \"AsyncTask.ashx?TaskID=\"+response.Result.TaskID, function(response){\r\n                                        if (response.Status.toLowerCase() == \"ok\") \r\n                                            if (!response.Result.Completed)\r\n                                                setTimeout(run, 1000);\r\n                                            else{\r\n                                                if(response.Result.ErorInfo){\r\n                                                    console.log(response)\r\n                                                    reject();\r\n                                                }\r\n                                                else\r\n                                                    resolve();\r\n                                        }\r\n                                        else{\r\n                                            console.log(response)\r\n                                            reject();\r\n                                        }\r\n\r\n                                    });\r\n                                }, 1000);\r\n                            else{\r\n                                console.log(response);\r\n                                reject();\r\n                            }\r\n                        }); \r\n                        });\r\n                \r\n                    })\r\n            ).then(\r\n            //return Promise.resolve().then(\r\n            function(){\r\n                this._isDirty = true;\r\n//console.log(this.data);\r\n                L.gmx.layersVersion.chkVersion();\r\n                return Promise.resolve();\r\n            }.bind(this),\r\n            function(){\r\n                return Promise.reject();\r\n            });\r\n        }\r\n    }; \r\n}\t\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Models/MyFleetModel.js","//************************************\r\n// AIS SCREEN SEARCH MODEL\r\n//************************************\r\n\r\nmodule.exports = function({myFleetMembersModel, aisLayerSearcher, aisSearchView}){\r\n\treturn {\r\n\t\t\r\n\t\tset view(value){ aisSearchView = value },\r\n\t\t\r\n        _isDirty: true,\r\n        getDirty: function(){return this._isDirty},\r\n        setDirty: function(){this._isDirty = true},\r\n        getCount: function(){\r\n            return this.data ? this.data.vessels.length : 0;\r\n        },\r\n        load: function(actualUpdate){\r\n            var _this = this;\r\n            if (!this._isDirty){\r\n                return Promise.resolve();\r\n            }\r\n            return Promise.all([new Promise(function(resolve, reject){\r\n                aisLayerSearcher.searchScreen({\r\n                    dateInterval: nsGmx.widgets.commonCalendar.getDateInterval(),\r\n                    border: true,\r\n                    group:true\r\n                }, function (json) {\r\n//console.log(json)\r\n                    if (json.Status.toLowerCase()==\"ok\")\r\n                    {\r\n                        _this.dataSrc = {vessels: json.Result.values.map(function(v){\r\n                            return {vessel_name:v[0], mmsi:v[1], imo:v[2], mf_member:'display:none', \r\n                        xmin:v[4], xmax:v[5], ymin:v[6], ymax:v[7], maxid:v[3]}\r\n                        })};\r\n                        if (_this._actualUpdate==actualUpdate){\r\n//console.log(\"ALL CLEAN\")\r\n//console.log(\"1>\"+new Date(_this._actualUpdate))\r\n//console.log(\"2>\"+new Date(actualUpdate))\r\n                            _this._isDirty = false;\r\n                        }\r\n                        resolve();\r\n                    }\r\n                    else{\r\n                        reject(json);\r\n                    }\r\n//console.log(\"LOAD SCREEN SEARCH DONE\")\r\n                    //return resolve();\r\n                });\r\n            })\r\n            ,myFleetMembersModel.load()\r\n            ]);\r\n        },\r\n        _actualUpdate: new Date().getTime(),\r\n        filterString: \"\",\r\n        update: function(){\r\n            var _this = this;\r\n            this._actualUpdate = new Date().getTime();\r\n            var actualUpdate = this._actualUpdate;  \r\n//this.filterString&&console.log(this.filterString+\" \"+this.filterString.search(/\\r$/))\r\n//this.filterString&&console.log(this.filterString.replace(/^\\s+/, \"\").replace(/\\s+\\r*$/, \"\")!=\"\")\r\n\r\n            this.load(actualUpdate).then(function(){\r\n//console.log(\"LOADED \"+(new Date().getTime()-_this._actualUpdate)+\"ms\")\r\n//console.log(\"3>\"+new Date(_this._actualUpdate))\r\n//console.log(\"4>\"+new Date(actualUpdate))\r\n                if (_this._actualUpdate==actualUpdate){\r\n                    _this.filterString = _this.filterString.replace(/\\r+$/, \"\");\r\n                    if (_this.dataSrc)\r\n                        if(_this.filterString!=\"\"){\r\n                            _this.data = {vessels:_this.dataSrc.vessels.filter(function(v){\r\n                                return v.vessel_name.search(new RegExp(\"\\\\b\"+_this.filterString, \"ig\"))!=-1;\r\n                            })}; \r\n                        }\r\n                        else{\r\n                            _this.data = {vessels:_this.dataSrc.vessels.map(function(v){return v;})};\r\n                        }\r\n                    \r\n                    if (_this.data)\r\n                        myFleetMembersModel.markMembers(_this.data.vessels);\r\n                    aisSearchView.repaint();\r\n                }\r\n            }, function(json){\r\n                _this.dataSrc = null;\r\nconsole.log(json)\r\n                if (json.Status.toLowerCase()==\"auth\" || \r\n                    (json.ErrorInfo && json.ErrorInfo.some && json.ErrorInfo.some(function(r){return r.Status.toLowerCase()==\"auth\"})))\r\n                    _this.data = {msg:[{txt:_gtxt(\"AISSearch2.auth\")}], vessels:[]};\r\n                else{\r\n                    //_this.data = {msg:[{txt:\"!!!\"}], vessels:[]};\r\n                    console.log(json);\r\n                }\r\n                aisSearchView.repaint();\r\n            });\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Models/ScreenSearchModel.js","//************************************\r\n// DB SEARCH MODEL\r\n//************************************\r\n\r\nmodule.exports = function({aisSearchView, myFleetMembersModel, aisLayerSearcher}){\r\n\treturn {\r\n\t\tset view(value) {\r\n\t\t\taisSearchView = value\r\n\t\t},\r\n        getCount: function(){\r\n            return this.data ? this.data.vessels.length : 0;\r\n        },\r\n        filterString: \"\",\r\n        _searchString: \"\",\r\n        update: function(){\r\n            var _this = this;\r\n            this._actualUpdate = new Date().getTime();\r\n            var actualUpdate = this._actualUpdate; \r\n            \r\n//this.filterString&&console.log(this.filterString+\" \"+this.filterString.search(/\\r$/))\r\n//this.filterString&&console.log(this._searchString+\" \"+this._searchString.search(/\\r$/))\r\n            this.filterString = this.filterString.replace(/\\r+$/, \"\");\r\n \r\n            new Promise(function(resolve, reject){\r\n                if (_this.filterString.length>0 && _this.filterString!=_this._searchString)\r\n                {\r\n                    _this._searchString = _this.filterString;\r\n                    aisLayerSearcher.searchString(_this._searchString, true, function(response){\r\n                        if (response.Status.toLowerCase()==\"ok\")\r\n                        {\r\n                            _this.data = {vessels: response.Result.values.map(function(v){\r\n                                return {vessel_name:v[0], mmsi:v[1], imo:v[2], mf_member:'display:none', ts_pos_utc: aisLayerSearcher.formatDate(new Date(v[3]*1000)),\r\n                            xmin:v[4], xmax:v[4], ymin:v[5], ymax:v[5]}\r\n                            })};\r\n                            resolve();\r\n                        }\r\n                        else{\r\n                            reject(response);\r\n                        }\r\n                    })\r\n                }\r\n                else if(_this.filterString.length==0){\r\n                    _this.data = null;\r\n                    resolve();\r\n                }\r\n                else\r\n                    resolve();\r\n            })\r\n            .then(function(){\r\n//console.log(\"LOADED \"+(new Date().getTime()-_this._actualUpdate)+\"ms\")\r\n                if (_this._actualUpdate==actualUpdate){\r\n                    if (_this.data)\r\n                        myFleetMembersModel.markMembers(_this.data.vessels);\r\n                    aisSearchView.repaint();\r\n                }\r\n            },\r\n            function(response){\r\nconsole.log(response);                \r\n                if (response.Status.toLowerCase()==\"auth\" || \r\n                (response.ErrorInfo && response.ErrorInfo.ErrorMessage.search(/can not access/i)!=-1))\r\n                    _this.data = {msg:[{txt:_gtxt(\"AISSearch2.auth\")}], vessels:[]};\r\n                else\r\n                    console.log(response);\r\n                _this.dataSrc = null;\r\n                aisSearchView.repaint();\r\n            });\r\n        }\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Models/DbSearchModel.js","//************************************\r\n// HISTORY MODEL\r\n//************************************\r\n\t\r\nmodule.exports = function({baseUrl, aisLayerSearcher, polyFind, polyFindIndex}){\r\n\t\t\t\r\n\tlet _isDirty = false,\r\n\t_view,\r\n\t_vessel,\r\n\t_historyInterval = {},\r\n\tround = function(d, p){\r\n\t\tlet isNeg = d<0,\r\n\t\t\tpower = Math.pow(10, p)\r\n\t\treturn d?((isNeg?-1:1)*(Math.round((isNeg?d=-d:d)*power)/power)):d\r\n\t},\r\n\taddUnit = function(v, u){\r\n        return v!=null && v!=\"\" ? v+u : \"\"; \r\n    },\r\n\ttoDd = function(D, lng){\r\n\t\tlet dir = D<0?lng?'W':'S':lng?'E':'N',\r\n\t\tdeg = Math.round((D<0?D=-D:D)*1000000)/1000000\r\n\t\treturn deg+\"°\"+dir\r\n\t},\r\n\tformatVessel = function(vessel, formatDate){\t\t\t\t\r\n\t\t\t\t\tvessel.cog_sog = vessel.cog || vessel.sog\t\t\t\t\t\r\n\t\t\t\t\tvessel.heading_rot = vessel.heading || vessel.rot\t\t\t\t\r\n\t\t\t\t\tvessel.x_y = vessel.longitude || vessel.latitude\r\n\t\t\t\t\t\r\n                    vessel.ts_pos_utc = formatDate(new Date(vessel.ts_pos_utc*1000));\r\n                    //vessel.ts_eta = formatDate(new Date(vessel.ts_eta*1000));\r\n                    vessel.cog = addUnit(round(vessel.cog, 5), \"°\");\r\n                    vessel.sog = addUnit(round(vessel.sog, 5), \" уз\");\r\n                    vessel.rot = addUnit(round(vessel.rot, 5), \"°/мин\");\r\n                    vessel.heading = addUnit(round(vessel.heading, 5), \"°\");\r\n                    vessel.draught = addUnit(round(vessel.draught, 5), \" м\");\r\n                    //vessel.length = addUnit(vessel.length, \" м\");\r\n                    //vessel.width = addUnit(vessel.width, \" м\");\r\n\t\t\t\t\tvessel.source = vessel.source=='T-AIS'?_gtxt('AISSearch2.tais'):_gtxt('AISSearch2.sais');\r\n\t\t\t\t\tvessel.longitude = toDd(vessel.longitude, true)\r\n\t\t\t\t\tvessel.latitude = toDd(vessel.latitude)\r\n\t\r\n                    return vessel;\r\n    }\r\n\treturn {\t\t\r\n\t\tset view(value){ _view = value },\r\n\t\tget historyInterval(){\r\n\t\t\treturn _historyInterval\r\n\t\t},\r\n\t\tset historyInterval(value){\r\n\t\t\t_historyInterval = value\r\n\t\t},\r\n\t\tget vessel(){\r\n\t\t\treturn _vessel\r\n\t\t},\r\n\t\tset vessel(value){\r\n\t\t\t_vessel = value\r\n\t\t},\r\n\t\r\n        getDirty: function(){return _isDirty},\r\n        setDirty: function(){_isDirty = true},\r\n        getCount: function(){\r\n            return this.data ? this.data.vessels.length : 0;\r\n        },\r\n        load: function(){\r\n\t\t\t\r\n            if (!_isDirty)\r\n                return Promise.resolve();\r\n\t\t\t\t//return new Promise((resolve)=>setTimeout(resolve, 1000))\r\n\t\t\t\t\r\n//console.log('LOAD ' + _historyInterval['dateBegin'].toUTCString() + ' ' + _historyInterval['dateEnd'].toUTCString())     \r\n\r\n            var _this = this;\r\n\t\t\treturn new Promise((resolve)=>{\t\t\t\t\r\n\t\t\t\taisLayerSearcher.searchPositions([_vessel.mmsi], _historyInterval, function(response){\r\n\t\t\t\t\t\t\t\tif (parseResponse(response)){                    \r\n\t\t\t\t\t\t\t\t\tlet position, positions = [];\r\n\t\t\t\t\t\t\t\t\tfor(var i=0; i<response.Result.values.length; ++i){\r\n\t\t\t\t\t\t\t\t\t\tposition = {}\r\n\t\t\t\t\t\t\t\t\t\tfor (var j=0; j<response.Result.fields.length; ++j){\r\n\t\t\t\t\t\t\t\t\t\t\tposition[response.Result.fields[j]] = response.Result.values[i][j];\r\n\t\t\t\t\t\t\t\t\t\t\tif(response.Result.fields[j]=='ts_pos_utc')\r\n\t\t\t\t\t\t\t\t\t\t\t\tposition['ts_pos_utc_org'] = response.Result.values[i][j];\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tpositions.push(formatVessel(position, aisLayerSearcher.formatDate))\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tpositions.sort((a,b)=>{\r\n\t\t\t\t\t\t\t\t\t\tif (a.ts_pos_utc_org > b.ts_pos_utc_org) return -1\r\n\t\t\t\t\t\t\t\t\t\tif (a.ts_pos_utc_org < b.ts_pos_utc_org) return 1;\r\n\t\t\t\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\tresolve({Status:\"ok\", Result:{values:positions}});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\tresolve(response)\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t\t.then(function(response) {    \r\n//console.log(response)       \r\n                _isDirty = false;               \r\n                if (response.Status.toLowerCase()==\"ok\"){\r\n\t\t\t\t\t_this.data = {vessels:response.Result.values}          \r\n                    return Promise.resolve(); \r\n                }\r\n                else{                                           \r\n                    return Promise.reject(response); \r\n                }\r\n            });\r\n\t\t},\r\n        update: function(){\r\n            let _this = this,\r\n\t\t\t\tactualUpdate = this._actualUpdate = new Date();\r\n            this.load().then(function(){\r\n//console.log(_this.data)\r\n                if (_this._actualUpdate==actualUpdate){\r\n                    _view.repaint();\r\n\t\t\t\t}\r\n            }, \r\n\t\t\tfunction(response){\r\n                _this.data = null;\r\n                if (response.Status.toLowerCase()==\"auth\" || \r\n                    (response.ErrorInfo && response.ErrorInfo.some && response.ErrorInfo.some(function(r){return r.Status.toLowerCase()==\"auth\"})))\r\n                    _this.data = {msg:[{txt:_gtxt(\"AISSearch2.auth\")}], vessels:[]};\r\n                else{\r\n                    console.log(response);\r\n                }\r\n                _view.repaint();              \r\n            });\r\n        },\r\n\t}\r\n\r\n}\t\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Models/HistoryModel.js","//************************************\r\n// AIS SEARCH VIEW\r\n//************************************\r\n\r\nmodule.exports = function({aisView, aisScreenSearchModel, aisDbSearchModel, highlight}){\r\n\tvar instance = $.extend({\r\n        _tableTemplate: '{{#each vessels}}' +\r\n        '<div class=\"ais_vessel\">' +\r\n        '<table border=0><tr><td><span class=\"position\">{{vessel_name}}</span>'+\r\n        '{{#if ts_pos_utc}} <span class=\"date\">({{{ts_pos_utc}}})</span>{{/if}}'+\r\n        '</td><td><i class=\"icon-ship\" vessel=\"{{aisinfoid this}}\" style=\"{{mf_member}}\" title=\"{{i \"AISSearch2.myFleetMember\"}}\"></i></td>'+\r\n\t\t\r\n        //'<td><div class=\"history\" title=\"\"> H </td>'+\t// HISTORY\r\n\t\t\r\n        '<td><div class=\"info\" vessel=\"{{aisjson this}}\" title=\"{{i \"AISSearch2.info\"}}\">'+\r\n        //'<i class=\"clicable icon-info\" vessel=\"{{aisjson this}}\" title=\"{{i \"AISSearch2.info\"}}\"></i>'+\r\n        '<div></td></tr></table>' +\r\n        '</div>' +\r\n        '{{/each}}'+\r\n        '{{#each msg}}<div class=\"msg\">{{txt}}</div>{{/each}}',\r\n        _model: aisScreenSearchModel,\r\n        _repaintControls: function(){\r\n            $(this._count).text(_gtxt('AISSearch2.found')+this._model.getCount());\r\n        },\r\n        doClean: function(){\r\n            $(this._count).text(_gtxt('AISSearch2.found')+0);\r\n        },\r\n        bindControlEvents: function(){\r\n                var _this = this;\r\n                $('select', this._canvas).change(function(e){\r\n                    var models = [aisScreenSearchModel, aisDbSearchModel];\r\n                    _this._model = models[e.target.options[e.target.selectedIndex].value]; \r\n                    //_this._model = models[(e.target.selectedOptions[0].value)];\r\n                    $('input', _this._search).val(_this._model.filterString);\r\n                    _this.show();\r\n\t\t\t\t\tnsGmx.leafletMap.removeLayer(highlight);\r\n                });\r\n                this._refresh.parent().click(function(){\r\n                    //console.log(_this._refresh)\r\n                    _this.show();\r\n\t\t\t\t\tnsGmx.leafletMap.removeLayer(highlight);\r\n                })\r\n                $('i', this._search).click(function(e){\r\n                    _this._model.filterString = $(this).siblings('input').val()+'\\r';\r\n                    _this.show();\r\n\t\t\t\t\tnsGmx.leafletMap.removeLayer(highlight);\r\n                })\r\n                this._search.keyup(function(e){\r\n                    var input = $('input', this).val() || \"\";\r\n                    input = input.replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n                    if (input==_this._model.filterString && e.keyCode!=13)\r\n                        return;\r\n                    _this._model.filterString = input; \r\n                    if (e.keyCode==13)\r\n                        _this._model.filterString += '\\r' \r\n                    _this.show();\r\n\t\t\t\t\tnsGmx.leafletMap.removeLayer(highlight);\r\n                })\r\n        },\r\n\t\tsetModel: function(searchType){this._model = searchType=='screen' ? aisScreenSearchModel : aisDbSearchModel},\r\n\t\tsetDirty: function(){ aisScreenSearchModel.setDirty(); }\r\n    }, aisView);\r\n\taisDbSearchModel.view = instance;\r\n\taisScreenSearchModel.view = instance;\r\n\treturn instance;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Views/SearchView.js","//************************************\r\n// MY FLEET VIEW\r\n//************************************\r\nmodule.exports = function({aisView, myFleetMembersModel}){\r\n\tconst instance = $.extend({\r\n\t\tget model(){ return this._model },\r\n        _tableTemplate: '{{#each vessels}}' +\r\n        '<div class=\"ais_vessel\">' +\r\n        '<table border=0><tr><td><span class=\"position\">{{vessel_name}}</span> <span class=\"date\">({{{ts_pos_utc}}})</span></td>'+\r\n\t\t\t\t\r\n        //'<td><div class=\"history\" title=\"\"> H </td>'+\t// HISTORY\r\n\r\n        '<td><div class=\"info\" vessel=\"{{aisjson this}}\" title=\"{{i \"AISSearch2.info\"}}\">'+\r\n        //'<i class=\"clicable icon-info\" vessel=\"{{aisjson this}}\" title=\"{{i \"AISSearch2.info\"}}\"></i>'+\r\n        '</div></td></tr></table>' +\r\n        '</div>' +\r\n        '{{/each}}'+\r\n        '{{#each msg}}<div class=\"msg\">{{txt}}</div>{{/each}}',\r\n        _model: myFleetMembersModel\r\n    }, aisView);\r\n\tmyFleetMembersModel.view = instance\r\n\treturn instance\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Views/MyFleetView.js","//************************************\r\n// VESSEL INFO VIEW\r\n//************************************  \r\n\r\nmodule.exports = function ({scheme, modulePath, aisServiceUrl}){\r\n        var _ais,  \r\n        _galery, \r\n        _register, \r\n        _regcap,    \r\n        _leftPanel,  \r\n        _minh,\r\n        resize,\r\n        menuAction,\r\n        show = function(vessel){\r\n//console.log(vessel) \r\n            $(\"body\").append(''+  \r\n'<table class=\"vessel-info-page overlay\">' +\r\n        '<tr>' +\r\n            '<td>' +\r\n'<table class=\"vessel-info-page container\">' +\r\n    '<tr>' +\r\n        '<td class=\"column1\">' +\r\n                '<table>' +\r\n                    '<tr>' +\r\n                        '<td>' +\r\n                            '<div>' +\r\n                                '<div class=\"title\">' +\r\n                                   '<div class=\"cell\">'+vessel.vessel_name+'<div class=\"timestamp\">'+vessel.ts_pos_utc+'</div></div>  ' +                  \r\n                                '</div>' +\r\n                                '<div class=\"menu\">' +\r\n                                '<div class=\"ais cell menu-item active\"><img src=\"'+modulePath+'svg/info_gen.svg\" class=\"icon\">Основные сведения</div>' +\r\n                                '<div class=\"register cell menu-item\"><img src=\"'+modulePath+'svg/info.svg\" class=\"icon\">Регистр</div>' +\r\n                                '<div class=\"galery cell menu-item\"><img src=\"'+modulePath+'svg/photogallery.svg\" class=\"icon\">Фотогалерея <div class=\"counter\">0</div></div>' +\r\n                               '</div>' +\r\n                            '</div>  ' +\r\n                        '</td>' +\r\n                    '</tr>' +\r\n                    '<tr>' +\r\n                        '<td class=\"frame\">' +\r\n                                '<div class=\"photo\">' +\r\n                                    '<img src=\"'+modulePath+'svg/no-image.svg\" class=\"no-image\">' +\r\n                                '</div>  ' +  \r\n                        '</td>' +\r\n                    '</tr>' +\r\n                '</table>' +\r\n    '</td>' +\r\n    '<td class=\"column2\">' +\r\n        '<div class=\"close-button-holder\">' +\r\n            '<div class=\"close-button\" title=\"закрыть\"></div>' +\r\n        '</div>' +\r\n        '<div class=\"register panel\">' +\r\n            '<div class=\"caption\"></div>' +\r\n            '<div class=\"menu\">' +\r\n                '<div>' +\r\n                    '<table>' +\r\n                        '<tr>' +\r\n                            '<td><div class=\"general menu-item active\">Общие сведения</div></td>' +\r\n                            '<td><div class=\"build menu-item\">Сведения о постройке</div></td>' +\r\n                            '<td><div class=\"dimensions menu-item\">Размеры и скорость</div></td>' +\r\n                            '<td><div class=\"gears menu-item\">Оборудование</div></td>' +\r\n                        '</tr>' +\r\n                    '</table>' +\r\n                '</div>' +\r\n            '</div>' +\r\n            '<div class=\"content\">' +\r\n                '<div class=\"placeholder\"></div>' +\r\n            '</div>' +\r\n        '</div>' +\r\n\r\n        '<div class=\"galery panel\">' +   \r\n'<form action=\"' + aisServiceUrl + 'Upload.ashx\" class=\"uploadFile\" method=\"post\" enctype=\"multipart/form-data\" target=\"upload_target\" style=\"display:none\" >' +\r\n    '<input name=\"Filedata\" class=\"chooseFile\" type=\"file\">' +    \r\n    '<input name=\"imo\" type=\"hidden\" value=\"'+vessel.imo+'\">' +    \r\n    '<input name=\"mmsi\" type=\"hidden\" value=\"'+vessel.mmsi+'\">' +\r\n          //'<input type=\"submit\" name=\"submitBtn\" value=\"Upload\" />' +\r\n'</form>' + \r\n'<iframe id=\"upload_target\" name=\"upload_target\" src=\"#\" style=\"width:0;height:0;border:0px solid #fff;\"></iframe>' + \r\n            '<div class=\"placeholder\">' +\r\n                '<div class=\"photo\" onclick=\"document.querySelector(\\'.vessel-info-page .chooseFile\\').click();\"'+\r\n                ' style=\"background-image: url('+modulePath+'svg/add-image.svg);background-size: 50px;\"></div>' +                \r\n            '</div>' +\r\n        '</div>' +\r\n\r\n        '<div class=\"ais panel\">' +\r\n            '<div class=\"placeholder\"></div>' +\r\n        '</div>' +\r\n    '</td>' +\r\n    '</tr>' +\r\n'</table>' +\r\n            '</td>' +\r\n        '</tr>' +\r\n    '</table>'           \r\n            );\r\n        window.addEventListener(\"message\", function(e){\r\n            if (e.data.search(/\"uploaded\"\\:/)<0)\r\n                return;\r\n            var data = JSON.parse(e.data);    \r\n            if (data.id && parseInt(data.id)) { //uploaded:\r\n//console.log('UPLOADED '+id)\r\n                var counter = $('.vessel-info-page .menu-item .counter'), \r\n                count = parseInt(counter.text())+1;\r\n                counter.text(count).css('display', 'inline');\r\n                var preview = $(\"<div class='photo preview' id='\"+data.id+\"' style='background-image: url(\"+aisServiceUrl+\"getphoto.ashx?id=\"+data.id+\")'/>\");\r\n                $('.vessel-info-page .uploader').replaceWith(preview);\r\n                preview.click(showPicture);\r\n//console.log(preview)\r\n            }\r\n            else {//uploadError:            \r\n                $('.vessel-info-page .uploader').remove();\r\n                console.log(data.errmsg)\r\n            }  \r\n        }, false);\r\n\r\n        $('<img src=\"'+scheme+'//photos.marinetraffic.com/ais/showphoto.aspx?mmsi='+vessel.mmsi+'\">').load(function() {\r\n            if (this){\r\n                $('.column1 .photo img.no-image').replaceWith(this);\r\n            }\r\n        });\r\n        $('.vessel-info-page .chooseFile').change(function(){            \r\n            $('<div class=\"photo uploader\" style=\"background-image:url(img/progress.gif);background-size:20px;\"></div>')\r\n            .insertAfter($('.vessel-info-page .galery .placeholder .photo').eq(0));\r\n            $('.vessel-info-page .uploadFile')[0].submit();\r\n        })\r\n        $('.vessel-info-page .close-button').click(function(){\r\n            $('.vessel-info-page.overlay').remove();\r\n        });\r\n/**/\r\n        $('.vessel-info-page .menu img[src$=\".svg\"]').each(function() {\r\n            var $img = jQuery(this);\r\n            var imgURL = $img.attr('src');\r\n            var attributes = $img.prop(\"attributes\");\r\n\r\n            $.get(imgURL, function(data) {\r\n                // Get the SVG tag, ignore the rest\r\n                var $svg = jQuery(data).find('svg');\r\n\r\n                // Remove any invalid XML tags\r\n                $svg = $svg.removeAttr('xmlns:a');\r\n\r\n                // Loop through IMG attributes and apply on SVG\r\n                $.each(attributes, function() {\r\n                    $svg.attr(this.name, this.value);\r\n                });\r\n\r\n                // Replace IMG with SVG\r\n                $img.replaceWith($svg);\r\n            }, 'xml');\r\n        });\r\n\r\n        _ais = document.querySelector('.vessel-info-page .column2 .ais') \r\n        _galery = document.querySelector('.vessel-info-page .column2 .galery')\r\n        _register = document.querySelector('.vessel-info-page .column2 .register .content')\r\n        _regcap = document.querySelector('.vessel-info-page .column2 .register .caption')    \r\n        _leftPanel = document.querySelector('.vessel-info-page .column1 table')      \r\n        _minh = 420\r\n        resize = function(){\r\n            var h = Math.floor(window.innerHeight*0.8);\r\n            if (h>_minh){\r\n                _leftPanel.style.height = _ais.style.height = _galery.style.height = h + \"px\";\r\n                _register.style.height = h - _regcap.offsetHeight + \"px\";\r\n            }\r\n            else{\r\n                _leftPanel.style.height = _ais.style.height = _galery.style.height = _minh + \"px\";\r\n                _register.style.height = _minh - _regcap.offsetHeight + \"px\";\r\n            }      \r\n        }\r\n        menuAction = function(e){\r\n            var target = e.currentTarget, p = target.parentElement, mia;\r\n            while(!(mia = p.querySelectorAll('.menu-item')) || mia.length<2){\r\n                p = p.parentElement;\r\n            }\r\n            for (var j=0; j<mia.length; ++j){\r\n                    //console.log( mia[j])\r\n                mia[j].className = mia[j].className.replace(/ active/, \"\");\r\n                var panel = document.querySelector('.panel.' + mia[j].classList[0]);\r\n                if (panel){\r\n                    if (mia[j]!=target)\r\n                    panel.style.display = \"none\";\r\n                    else{\r\n                    panel.style.display = \"block\";\r\n                    }\r\n                }\r\n            }\r\n            target.className += \" active\"\r\n            resize(); \r\n        }\r\n\r\n        window.addEventListener(\"resize\", resize, false); \r\n    \r\n        var mia = document.querySelectorAll('.column1 .menu-item');\r\n        for (var i=0; i<mia.length; ++i){\r\n            mia[i].addEventListener('click', menuAction)\r\n        }\r\n    \r\n        resize();    \r\n        $(_ais).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        $(_galery).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        $(_register).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        document.querySelector('.vessel-info-page .container').style.display = \"table\";  \r\n    },\r\n    showPicture = function(){\r\n//console.log($(this))\r\n            $('.vessel-info-page .picture').remove();\r\n            var div = $('<div class=\"picture\" style=\"display:none;position:absolute;\"></div>')\r\n            .insertAfter('.vessel-info-page.container').click(function(){this.remove()});\r\n            $('<img src=\"'+aisServiceUrl+'getphoto.ashx?id='+this.id+'\">').load(function() {\r\n                    if (this){\r\n                        var w = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,\r\n                        h = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\r\n                        div.append(this)\r\n                        .css('display', 'table')\r\n                        .offset({\r\n                            left:(w-this.offsetWidth)/2,\r\n                            top:(h-this.offsetHeight)/2})\r\n//console.log($(this))\r\n//console.log(window.screen.width+\"-\"+$(this)[0].offsetWidth)\r\n//console.log((window.screen.width-$(this)[0].offsetWidth)/2)\r\n                    }\r\n            });\r\n        },\r\n    drawGallery = function(gallery){\r\n        if (gallery.length>0)\r\n            $('.vessel-info-page .menu-item .counter').text(gallery.length).css('display', 'inline');   \r\n        var galcontent = $(\".vessel-info-page .galery .placeholder\")\r\n        for (var i=0; i<gallery.length; ++i)\r\n            galcontent.append(\"<div class='photo preview' id='\"+gallery[i]+\"' style='background-image: url(\"+aisServiceUrl+\"getphoto.ashx?id=\"+gallery[i]+\")'/>\" )             \r\n        $('.photo.preview').click(showPicture)\r\n        resize();     \r\n    },\r\n    drawAis = function(ledokol){\r\n    var aiscontent = document.querySelector(\".vessel-info-page .ais .placeholder\")\r\n    aiscontent.innerHTML = \"\" +                \r\n    \"<div class='caption'><div>ИНФОРМАЦИЯ О СУДНЕ</div></div>\" +\r\n    \"<table>\" +\r\n        \"<tr><td>Название судна</td><td><b>\"+ledokol.vessel_name+(ledokol.registry_name?\" (\"+ledokol.registry_name+\")\":\"\")+\"</b></td></tr>\" +\r\n        \"<tr><td>IMO</td><td>\"+ledokol.imo+\"</td></tr>\" +\r\n        \"<tr><td>MMSI</td><td>\"+ledokol.mmsi+\"</td></tr>\" +\r\n        \"<tr><td>Тип</td><td>\"+ledokol.vessel_type+\"</td></tr>\" +\r\n        \"<tr><td>Флаг</td><td>\"+ledokol.flag_country+\"</td></tr>\" +\r\n        \"<tr><td>Позывной</td><td>\"+ledokol.callsign+\"</td></tr>\" +\r\n        \"<tr><td>Длина</td><td>\"+ledokol.length+\"</td></tr>\" +\r\n        \"<tr><td>Ширина</td><td>\"+ledokol.width+\"</td></tr>\" +\r\n    \"</table>\" +\r\n    \"<div class='caption'><div>СВЕДЕНИЯ О ДВИЖЕНИИ</div></div>\" +\r\n    \"<table>\" +\r\n        \"<tr><td>Навигационный статус</td><td>\"+ledokol.nav_status+\"</td></tr>\" +\r\n        \"<tr><td>COG</td><td>\"+ledokol.cog+\"</td></tr>\" +\r\n        \"<tr><td>SOG</td><td>\"+ledokol.sog+\"</td></tr>\" +\r\n        \"<tr><td>HDG</td><td>\"+ledokol.heading+\"</td></tr>\" +\r\n        \"<tr><td>ROT</td><td>\"+ledokol.rot+\"</td></tr>\" +\r\n        \"<tr><td>Осадка</td><td>\"+ledokol.draught+\"</td></tr>\" +\r\n        \"<tr><td>Назначение</td><td>\"+ledokol.destination+\"</td></tr>\" +\r\n        \"<tr><td>Расчетное время прибытия</td><td>\"+ledokol.ts_eta+\"</td></tr>\" +\r\n    \"</table>\";     \r\n        resize();        \r\n    },\r\n    drawRegister = function(ledokol){\r\n        var regcontent = _register.querySelector(\".placeholder\"),\r\n        drawTable = function(groups, article, display){\r\n            var s = \"<div class='panel \"+article+\" article' style='display:\"+display+\"'>\";\r\n            for(var i=0; i<groups.length; ++i){\r\n                s += \"<div class='group'>\"+groups[i].name+\"</div><table>\"\r\n                for(var j=0; j<groups[i].properties.length; ++j){\r\n                    var pn = groups[i].properties[j].name,\r\n                    pv = groups[i].properties[j].value\r\n                    s+= \"<tr><td>\"+pn+\"</td><td>\"+(pn==\"Название судна\"||pn==\"Латинское название\"?\"<b>\"+pv+\"</b>\":pv)+\"</td></tr>\"\r\n                }\r\n                s += \"</table>\"\r\n            }\r\n            s += \"</div>\"\r\n            return s;\r\n        }\r\n        regcontent.innerHTML = \r\n        drawTable([ledokol.data[0], ledokol.data[1], ledokol.data[9]], \"general\", \"block\") + \r\n        drawTable([ledokol.data[2]], \"build\", \"none\") + \r\n        drawTable([ledokol.data[3]], \"dimensions\", \"none\") + \r\n        drawTable([ledokol.data[4], ledokol.data[5], ledokol.data[6], ledokol.data[7], ledokol.data[8]], \"gears\", \"none\");\r\n\t\t\r\n        _regcap.innerHTML = \"<table><tr><td>Обновление базы данных \"+ledokol.version.replace(/ \\S+$/g, '')+\"</td></tr></table>\"\r\n\r\n        var mia = document.querySelectorAll('.column2 .menu-item');\r\n        for (var i=0; i<mia.length; ++i){\r\n            mia[i].addEventListener('click', menuAction)\r\n        }\r\n             \r\n        resize();        \r\n    }\r\n\t\r\n\tlet open = function(vessel, vessel2){\r\n                    show(vessel2);\r\n                    var onFail = function(error){\r\n                        if (error!='register_no_data')\r\n                        console.log(error)\r\n                    } \r\n                    new Promise(function(resolve, reject){\r\n                        (function wait(){\r\n                            if(!vessel2)\r\n                                setTimeout(wait, 100);\r\n                        })();\r\n                        resolve(vessel2)\r\n                    })\r\n                    .then(function(ship){\r\n//console.log(ship)\r\n                        drawAis(ship)\r\n                    }, \r\n                    onFail);\r\n                    var registerServerUrl = scheme + \"//kosmosnimki.ru/demo/register/api/v1/\";\r\n                    if(vessel.imo && vessel.imo!=0 && vessel.imo!=-1)\r\n                        fetch(registerServerUrl+\"Ship/Search/\"+vessel.imo+\"/ru\")\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            if (ship.length>0)\r\n                                return fetch(registerServerUrl+\"Ship/Get/\"+ship[0].RS+\"/ru\")\r\n                            else\r\n                                return Promise.reject('register_no_data');\r\n                        })\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            //console.log(ship)\r\n                            drawRegister(ship)\r\n                        })\r\n                        .catch( onFail );\r\n\r\n                    new Promise(function(resolve, reject){\r\n                        sendCrossDomainJSONRequest(aisServiceUrl + \r\n                            \"gallery.ashx?mmsi=\"+vessel.mmsi+\"&imo=\"+vessel.imo, function(response){\r\n                            if (response.Status==\"ok\") \r\n                                resolve(response.Result);\r\n                            else\r\n                                reject(response)\r\n                        });\r\n                    })\r\n                    .then(function(gallery){\r\n                        drawGallery(gallery)\r\n                    }, \r\n                    onFail);\r\n                }\r\n        \r\n    return {\r\n\t\topen:open,\r\n            show: show,\r\n            drawRegister: drawRegister,\r\n            drawAis: drawAis,\r\n            drawGallery:drawGallery\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Views/VesselInfoView.js","//************************************\r\n// HISTORY VIEW\r\n//************************************\r\nrequire('./HistoryView.css')\r\n\t\r\nmodule.exports = function({aisView, historyModel, gifLoader}){\r\n\tlet _frame, _container, _refresh, _caption, _calendar,\r\n\t_dateInterval = new nsGmx.DateInterval(),\r\n\t_template = '<div class=\"ais_view history_view\">'+ \r\n\t\t\t\t\t//HIST FORM      \r\n\t\t\t\t\t'<div class=\"calendar\"></div>'+             \r\n                    '<table border=0 class=\"instruments\">'+\r\n                    '<tr><td><div class=\"caption\">&nbsp;</div></td><td></td><td><div class=\"refresh\"><div>'+gifLoader+'</div></div></td></tr>'+\r\n                    '</table>'+                    \r\n                    '<div class=\"ais_vessels\"><div class=\"ais_vessel\">NO HISTORY</div></div>'+\r\n\t'</div>'\r\n\tconst instance = $.extend({\r\n\t\tget model(){ return this._model },\r\n\t\tset vessel(value){ \r\n\t\t\t_caption.text(value.vessel_name) \r\n\t\t\tthis._model.vessel = value\r\n            let mapDateInterval = nsGmx.widgets.commonCalendar.getDateInterval()\r\n\t\t\tif (!value.ts_pos_utc){\t\t\t\t\r\n\t\t\t\tthis._model.historyInterval = {dateBegin:mapDateInterval.get('dateBegin'), dateEnd:null}\t\t\t\r\n\t\t\t\t_dateInterval.set('dateBegin', this._model.historyInterval['dateBegin'])\t\t\t\t\r\n\t\t\t\tthis._model.historyInterval.dateEnd = mapDateInterval.get('dateEnd')\t\r\n\t\t\t\t_dateInterval.set('dateEnd', this._model.historyInterval['dateEnd']) \r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tlet a = value.ts_pos_utc.replace(/ [\\s\\S]+$/g, '').split('.'),\r\n\t\t\t\t\tdateEnd = new Date(new Date().setHours(24,0,0,0))\t\t\t\r\n\t\t\t\tthis._model.historyInterval = {dateBegin: new Date(Date.UTC(a[2], parseInt(a[1])-1, a[0], 0, 0, 0, 0)), dateEnd:null}\t\t\t\r\n\t\t\t\t_dateInterval.set('dateBegin', this._model.historyInterval['dateBegin'])\t\t\t\t\r\n\t\t\t\tthis._model.historyInterval.dateEnd = new Date(Date.UTC(dateEnd.getFullYear(), dateEnd.getMonth(), dateEnd.getDate(), 0, 0, 0, 0))\r\n\t\t\t\t_dateInterval.set('dateEnd', this._model.historyInterval['dateEnd'])\r\n\t\t\t}\r\n\t\t\tthis._model.setDirty()\t\r\n\t\t},\r\n\t\ttemplate: _template,\r\n        _tableTemplate: '{{#each vessels}}' +\r\n        '<div class=\"ais_vessel\">' +\r\n        '<table border=0><tr><td><span>({{{ts_pos_utc}}})</span></td><td><span class=\"show_voyage_info\" title=\"{{i \"AISSearch2.voyageInfo\"}}\">...</span></td></tr></table>'+\r\n        '<div class=\"voyage_info\"><table>'+\r\n\t\t'<tr><td>X | Y:</td><td>{{longitude}} {{#if x_y}}&nbsp;{{/if}} {{latitude}}</td></tr>'+\r\n\t\t'<tr><td>COG | SOG:</td><td>{{cog}} {{#if cog_sog}}&nbsp;{{/if}} {{sog}}</td></tr>'+\r\n\t\t'<tr><td>HDG | ROT:</td><td>{{heading}} {{#if heading_rot}}&nbsp;{{/if}} {{rot}}</td></tr>'+\r\n\t\t'<tr><td>Осадка:</td><td>{{draught}}</td></tr>'+\r\n        '</table></div>' +\r\n        '</div>' +\r\n        '{{/each}}'+\r\n        '{{#each msg}}<div class=\"msg\">{{txt}}</div>{{/each}}',\r\n        _model: historyModel,\t\r\n\t\tdoClean: function(){\r\n\t\t\t$('.show_voyage_info', _container).off('click')\r\n\t\t},\r\n\t\t\r\n        get _frame(){ return _frame },\r\n        get _container(){ return _container },\r\n        get _refresh(){ return _refresh },\r\n\t\tget _caption(){ return _caption },\r\n\t\tget _calendar(){ return _calendar },\r\n                \r\n\t\tcreateForm: function(){\r\n\t\t\t\r\n\t\t\t_frame = $('.history_view', this.canvas)\r\n\t\t\t_container = $('.history_view .ais_vessels', this.canvas)\r\n\t\t\t_refresh = $('.history_view .refresh div', this.canvas)\r\n\t\t\t_caption = $('.history_view .caption', this.canvas)\r\n\t\t\t_calendar = $('.history_view .calendar', this.canvas)\t\t\t\t\r\n\t\t\t\r\n\r\n\t        // walkaround with focus at first input in ui-dialog\r\n            _calendar.append('<span class=\"ui-helper-hidden-accessible\"><input type=\"text\"/></span>')\r\n            let mapDateInterval = nsGmx.widgets.commonCalendar.getDateInterval();\r\n            _dateInterval\r\n                    .set('dateBegin', mapDateInterval.get('dateBegin'))\r\n                    .set('dateEnd', mapDateInterval.get('dateEnd'))\r\n                    .on('change', function (e) { \r\n\t\t\t\t\tif (this._model.historyInterval['dateEnd'])\r\n\t\t\t\t\t\tif (this._model.historyInterval['dateBegin'].getTime()!=_dateInterval.get('dateBegin').getTime ||\r\n\t\t\t\t\t\tthis._model.historyInterval['dateEnd'].getTime()!=_dateInterval.get('dateEnd').getTime){\r\n//console.log(this._model.historyInterval['dateBegin'].toUTCString() + ' ' + (this._model.historyInterval['dateEnd'] && this._model.historyInterval['dateEnd'].toUTCString())) \r\n//console.log('CHANGE ' + _dateInterval.get('dateBegin').toUTCString() + ' ' + _dateInterval.get('dateEnd').toUTCString()) \r\n\t\t\t\t\t\t\tthis._model.historyInterval['dateBegin']=_dateInterval.get('dateBegin')\r\n\t\t\t\t\t\t\tthis._model.historyInterval['dateEnd']=_dateInterval.get('dateEnd')\r\n\t\t\t\t\t\t\tthis._model.setDirty()\r\n\t\t\t\t\t\t\tthis.show();\t\r\n\t\t\t\t\t\t}\r\n                }.bind(this));\r\n\t\t\t\t\r\n                let calendar = new nsGmx.CalendarWidget({\r\n                    dateInterval: _dateInterval,\r\n                    name: 'fobConsumptionInterval',\r\n                    container: _calendar,\r\n                    dateMin: new Date(0, 0, 0),\r\n                    dateMax: new Date(3015, 1, 1),\r\n                    dateFormat: 'dd.mm.yy',\r\n                    minimized: false,\r\n                    showSwitcher: false,\r\n                    dateBegin: new Date(),\r\n                    dateEnd: new Date(2000, 10, 10),\r\n                    //buttonImage: 'img/calendar.png'\r\n                })\t\t\t\t\r\n\t\t\t\t//sidebarControl && sidebarControl.on('closing', ()=>calendar.reset())\r\n\t\t\t\t$(this.canvas).on('click', (e)=>{\r\n\t\t\t\t\tif(e.target.classList.toString().search(/CalendarWidget/)<0){ \r\n\t\t\t\t\t\tcalendar.reset()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\t\r\n\t\t}\r\n    }, aisView);\r\n\thistoryModel.view = instance\r\n\treturn instance\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Views/HistoryView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/HistoryView.css\n// module id = 15\n// module chunks = 0","require(\"./infodialog.css\")\r\n\r\nlet addUnit = function(v, u){\r\n        return v!=null && v!=\"\" ? v+u : \"\"; \r\n    },\r\n\tformatDate,\r\n\tround = function(d, p){\r\n\t\tlet isNeg = d<0,\r\n\t\t\tpower = Math.pow(10, p)\r\n\t\treturn d?((isNeg?-1:1)*(Math.round((isNeg?d=-d:d)*power)/power)):d\r\n\t},\r\n    formatVessel = function(vessel){\r\n                    vessel.ts_pos_utc = formatDate(new Date(vessel.ts_pos_utc*1000));\r\n                    vessel.ts_eta = formatDate(new Date(vessel.ts_eta*1000));\r\n                    vessel.cog = addUnit(round(vessel.cog, 5), \"°\");\r\n                    vessel.sog = addUnit(round(vessel.sog, 5), \" уз\");\r\n                    vessel.rot = addUnit(round(vessel.rot, 5), \"°/мин\");\r\n                    vessel.heading = addUnit(round(vessel.heading, 5), \"°\");\r\n                    vessel.draught = addUnit(round(vessel.draught, 5), \" м\");\r\n                    vessel.length = addUnit(vessel.length, \" м\");\r\n                    vessel.width = addUnit(vessel.width, \" м\");\r\n\t\t\t\t\tvessel.source = vessel.source=='T-AIS'?_gtxt('AISSearch2.tais'):_gtxt('AISSearch2.sais');\r\n                    return vessel;\r\n    },\r\n\ttoDd = function(D, lng){\r\n\t\tlet dir = D<0?lng?'W':'S':lng?'E':'N',\r\n\t\tdeg = Math.round((D<0?D=-D:D)*1000000)/1000000\r\n\t\treturn deg+\"°\"+dir\r\n\t},\r\n\tddToDms = function(D, lng){\r\n\t\tlet dms = {\r\n\t\t\tdir : D<0?lng?'W':'S':lng?'E':'N',\r\n\t\t\tdeg : 0|(D<0?D=-D:D),\r\n\t\t\tmin : 0|D%1*60,\r\n\t\t\tsec :(0|D*60%1*6000)/100\r\n\t\t};\r\n\t\treturn dms.deg+\"°\"+dms.min+\"'\"+dms.sec+\"\\\" \"+dms.dir\r\n\t}\r\n\r\nmodule.exports = function({vessel, closeFunc, aisLayerSearcher, getmore, scheme, modulePath,\r\naisView, displaingTrack, myFleetMembersView, aisPluginPanel }, commands){\r\n\r\n\tformatDate = aisLayerSearcher.formatDate\t\t\t\t\r\n\t\t\t\t\r\n\tlet myFleetMembersModel = myFleetMembersView.model,\r\n\t\tadd = myFleetMembersModel && myFleetMembersModel.findIndex(vessel)<0\r\n\t\r\n    let canvas = $('<div class=\"ais_myfleet_dialog\"/>'),\r\n        menu = $('<div class=\"column1 menu\"></div>').appendTo(canvas),\r\n        photo = $('<div class=\"photo\"><div></div></div>').appendTo(menu),\r\n        moreinfo = $('<div class=\"moreinfo\"><div></div></div>').appendTo(menu),\r\n        content = Handlebars.compile(\r\n                    '<div class=\"column2 content\">'+\r\n                    '</div>') (vessel),\r\n\t\tbuttons = $('<div class=\"column3 buttons\"></div>'),\t\t\r\n\t\tgifLoader = '<img src=\"img/progress.gif\">'\r\n                    //console.log(content);\r\n\t\r\n    canvas.append(content).append(buttons)\r\n\t\t\t\t\r\n\tlet dialog = showDialog(vessel.vessel_name, canvas[0], {width: 610, height: 230, closeFunc: closeFunc }),     \r\n\tvessel2,\r\n    moreInfo = function(v){\r\n\t\t\t\t\t\tlet smallShipIcon = '<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"14px\" height=\"14px\" viewBox=\"0 0 14 14\" style=\"margin-left: 10px\" xml:space=\"preserve\">'+\r\n\t\t\t\t\t\t\t'<g style=\"fill: #48aff1;\">'+\r\n\t\t\t\t\t\t\t\t'<path class=\"st0\" d=\"M13.4,11H0.6c-0.2,0-0.4,0.1-0.5,0.3c-0.1,0.2-0.1,0.4,0,0.6l1.2,1.8C1.4,13.9,1.6,14,1.8,14h9.9   c0.2,0,0.3-0.1,0.4-0.2l1.7-1.8c0.2-0.2,0.2-0.4,0.1-0.7C13.9,11.1,13.7,11,13.4,11z\"/>'+\r\n\t\t\t\t\t\t\t\t'<path class=\"st0\" d=\"M9.3,9.7h2.9c0.2,0,0.4-0.1,0.5-0.3c0.1-0.2,0.1-0.4,0-0.6L9.8,4.5C9.7,4.3,9.4,4.2,9.2,4.3   C8.9,4.4,8.7,4.6,8.7,4.9v4.3C8.7,9.5,9,9.7,9.3,9.7z\"/>'+\r\n\t\t\t\t\t\t\t\t'<path class=\"st0\" d=\"M1.2,9.7H7c0.3,0,0.6-0.3,0.6-0.6V0.6c0-0.3-0.2-0.5-0.4-0.6C6.9-0.1,6.7,0,6.5,0.3L0.7,8.8   C0.6,9,0.5,9.2,0.6,9.4C0.7,9.6,0.9,9.7,1.2,9.7z\"/>'+\r\n\t\t\t\t\t\t\t'</g>'+\r\n\t\t\t\t\t\t'</svg>',\r\n\t\t\t\t\t\tvesselPropTempl = '<div class=\"vessel_prop vname\"><b>{{vessel_name}}</b>'+smallShipIcon+'</div>'+\r\n\t\t\t\t\t\t'<div class=\"vessel_prop altvname\"><b>'+(vessel2.registry_name && vessel2.registry_name!=vessel2.vessel_name ? vessel2.registry_name:'')+'&nbsp;</b></div>'\r\n\t\t\t\t\t\t\r\n                        $('.content', canvas).append(Handlebars.compile(\r\n\t\t\t\t\t\t'<div class=\"vessel_props1\">'+vesselPropTempl+\r\n\t\t\t\t\t\t'<table>'+\r\n                        '<tr><td><div class=\"vessel_prop\">Тип судна: </div></td><td><div class=\"vessel_prop value\">{{vessel_type}}</div></td></tr>'+\r\n                        '<tr><td><div class=\"vessel_prop\">Флаг: </div></td><td><div class=\"vessel_prop value\">{{flag_country}}</div></td></tr>'+\r\n                        '<tr><td><div class=\"vessel_prop\">IMO: </div></td><td><div class=\"vessel_prop value\">{{imo}}</div></td></tr>'+\r\n                        '<tr><td><div class=\"vessel_prop\">MMSI: </div></td><td><div class=\"vessel_prop value\">{{mmsi}}</div></td></tr>'+\r\n                        '<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.source\"}}: </div></td><td><div class=\"vessel_prop value\">{{source}}</div></td></tr>'+\r\n\t\t\t\t\t\t'</table>'+\r\n\t\t\t\t\t\t'</div>'\r\n                        )(v));\r\n\t\t\t\t\t\t\r\n                        $('.content', canvas).append(Handlebars.compile(\t\r\n\t\t\t\t\t\t'<div class=\"vessel_props2\">'+vesselPropTempl+\t\r\n\t\t\t\t\t\t'<table>'+\t\t\t\t\r\n                        '<tr><td><div class=\"vessel_prop\">COG | SOG: </div></td><td><div class=\"vessel_prop value\">{{cog}}&nbsp;&nbsp;&nbsp;{{sog}}</div></td></tr>'+\r\n                        '<tr><td><div class=\"vessel_prop\">HDG | ROT: </div></td><td><div class=\"vessel_prop value\">{{heading}}&nbsp;&nbsp;&nbsp;{{rot}}</div></td></tr>'+\r\n                        '<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.draught\"}}: </div></td><td><div class=\"vessel_prop value\">{{draught}}</div></td></tr>'+\r\n                        '<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.destination\"}}: </div></td><td><div class=\"vessel_prop value\">{{destination}}</div></td></tr>'+\r\n                        '<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.nav_status\"}}: </div></td><td><div class=\"vessel_prop value\">{{nav_status}}</div></td></tr>'+\r\n\t\t\t\t\t\t'</table>'+\r\n\t\t\t\t\t\t'</div>'\r\n                        )(v));\r\n\t\t\t\t\t\t\r\n                        $(moreinfo).append('<table><tr>'+\r\n'<td class=\"ais_refresh\"><svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" height=\"16\" width=\"16\"><g class=\"nc-icon-wrapper\" fill=\"#444444\"><polyline data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 15,16 7,16 7,13 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 15,18 17,16 15,14 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" data-stroke=\"none\" fill=\"#444444\" points=\"15,18 17,16 15,14 \" stroke-linejoin=\"miter\" stroke-linecap=\"square\" style=\"stroke: currentColor;fill: currentColor;\"/> <polyline data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 9,8 17,8 17,11 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\"9,6 7,8 9,10 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" data-stroke=\"none\" fill=\"#444444\" points=\"9,6 7,8 9,10 \" stroke-linejoin=\"miter\" stroke-linecap=\"square\" style=\"stroke: currentColor;fill: currentColor;\"/> <rect x=\"2\" y=\"1\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" width=\"20\" height=\"22\" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/></g></svg></td>'+\r\n\t\t\t\t\t\t'<td><div class=\"vessel_prop coordinates\"><span class=\"small\">'+\r\n\t\t\t\t\t\ttoDd(v.latitude, false)+' '+toDd(v.longitude, true)+\r\n\t\t\t\t\t\t'</small></div></td>'+\r\n\t\t\t\t\t\t'</tr></table>'\r\n                        );\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet swap = \"<span class='small'>\"+ddToDms(v.latitude, false)+\" \"+ddToDms(v.longitude, true)+\"</span>\"\t\t\t\t\t\t\r\n\t\t\t\t\t\t$('.ais_refresh', moreinfo).click((e)=>{\r\n\t\t\t\t\t\t\tlet mi = $('.coordinates', moreinfo),\r\n\t\t\t\t\t\t\tt = mi.html()\r\n\t\t\t\t\t\t\tmi.html(swap)\r\n\t\t\t\t\t\t\tswap = t\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$('.vessel_props2', canvas).hide()\r\n\t\t\t\t\t\t$('.vessel_prop.vname svg', canvas).css('visibility', add?'hidden':'visible')\r\n\t\t\t\t\t\t\r\n    }\r\n\r\n\t$(dialog).dialog({resizable: false}); \t\r\n    \r\n\tif (!getmore){\r\n        vessel2 = $.extend({}, vessel);\r\n        moreInfo(formatVessel(vessel2));\r\n    }\r\n    else\r\n        aisLayerSearcher.searchNames([{mmsi:vessel.mmsi,imo:vessel.imo}], function(response){\r\n                      if (parseResponse(response)){                    \r\n                            vessel2 = {};\r\n\t\t\t\t\t\t\tfor (var i=0; i<response.Result.fields.length; ++i)\r\n\t\t\t\t\t\t\t\tvessel2[response.Result.fields[i]] = response.Result.values[0][i];\r\n                            moreInfo(formatVessel(vessel2));\r\n\t\t\t\t\t\t\t//if (!vessel.hasOwnProperty('ts_pos_utc'))\r\n\t\t\t\t\t\t\t$('.date span', titlebar).html(vessel2.ts_pos_utc)\r\n\t\t\t\t\t\t\tif (typeof(getmore)==\"function\")\r\n\t\t\t\t\t\t\t\tgetmore(vessel2)\r\n                        }\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\tconsole.log(response)\r\n        })\r\n\r\n\t// IMAGE\r\n    $('<img src=\"'+scheme+'//photos.marinetraffic.com/ais/showphoto.aspx?size=thumb&mmsi='+vessel.mmsi+'\">').load(function() {\r\n        if (this)\r\n            $('div', photo).replaceWith(this);\r\n    });\r\n\t\r\n\t// BUTTONS\r\n    let menubuttons = $('<div class=\"menubuttons\"></div>').appendTo(buttons)\r\n\t\r\n\tlet openpage = $('<div class=\"button openpage\" title=\"информация о судне\">'+\r\n\t\t\t\t'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">'+\r\n\t\t\t\t\t'<g class=\"nc-icon-wrapper\" style=\"fill:currentColor\">'+\r\n\t\t\t\t\t\t'<path d=\"M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 9h2V7h-2v2z\"/>'+\r\n\t\t\t\t\t'</g>'+\t\t\t\t\r\n\t\t\t\t'</svg>'\r\n\t\t\t\t+'</div>')\r\n                .appendTo(menubuttons)                   \r\n                .on('click', ()=>commands.openVesselInfoView.call(null, vessel, vessel2)); \r\n\r\n    let showpos = $('<div class=\"button showpos\" title=\"показать положение\">'+\r\n'<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" width=\"20\" height=\"20\"><g class=\"nc-icon-wrapper\" fill=\"#444444\"><polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 1,7 1,1 7,1 \" stroke-linejoin=\"miter\"/> <polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 17,1 23,1 23,7 \" stroke-linejoin=\"miter\"/> <polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 23,17 23,23 17,23 \" stroke-linejoin=\"miter\"/> <polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 7,23 1,23 1,17 \" stroke-linejoin=\"miter\"/> <rect style=\"stroke:currentColor\" x=\"8\" y=\"8\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" width=\"8\" height=\"8\" stroke-linejoin=\"miter\"/></g></svg>'+\r\n\t\t\t\t'</div>')\r\n                .appendTo(menubuttons)                   \r\n                .on('click', function(){\r\n                    var showVessel = {\r\n                        xmin:vessel.xmin?vessel.xmin:vessel.longitude, \r\n                        xmax:vessel.xmax?vessel.xmax:vessel.longitude, \r\n                        ymin:vessel.ymin?vessel.ymin:vessel.latitude, \r\n                        ymax:vessel.ymax?vessel.ymax:vessel.latitude, \r\n                        ts_pos_utc:vessel.ts_pos_utc && !isNaN(vessel.ts_pos_utc)?aisLayerSearcher.formatDate(new Date(vessel.ts_pos_utc*1000)):vessel.ts_pos_utc\r\n                    }\t\t\t\r\n\t\t\t\t\t//nsGmx.leafletMap.removeLayer(highlight);\r\n\t\t\t\t\t//highlight.setLatLng([showVessel.ymax, showVessel.xmax]).addTo(nsGmx.leafletMap);\r\n                    aisView.positionMap(showVessel);\r\n                });\r\n\t//if (tracksLayer){\r\n\tlet templ = '<div class=\"button showtrack\" title=\"'+_gtxt('AISSearch2.show_track')+'\">'+\r\n'<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" width=\"20\" height=\"20\"><g class=\"nc-icon-wrapper\" fill=\"#444444\"><path style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" d=\"M4,13V5 c0-2.209,1.791-4,4-4h0c2.209,0,4,1.791,4,4v14c0,2.209,1.791,4,4,4h0c2.209,0,4-1.791,4-4v-8\" stroke-linejoin=\"miter\"/> <circle style=\"stroke:currentColor\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" cx=\"20\" cy=\"4\" r=\"3\" stroke-linejoin=\"miter\"/> <circle style=\"stroke:currentColor\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" cx=\"4\" cy=\"20\" r=\"3\" stroke-linejoin=\"miter\"/></g></svg>'+\t\t\t\t\t\r\n\t\t\t\t\t'</div>',\r\n\t\t\t\t\t\r\n\t\tshowtrack = $(templ)\r\n\t\t\t\t\t.appendTo(menubuttons) \r\n\t\t\t\t\t.on('click', function(){\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (showtrack.attr('title')!=_gtxt('AISSearch2.hide_track')){\r\n\t\t\t\t\t\t\t$('.showtrack').attr('title', _gtxt('AISSearch2.show_track'))\r\n\t\t\t\t\t\t\t.removeClass('active');\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tcommands.showTrack.call(null, [vessel.mmsi])\r\n\t\t\t\t\t\t\tshowtrack.attr('title', _gtxt('AISSearch2.hide_track'))\r\n\t\t\t\t\t\t\t.addClass('ais active');      \r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t$('.showtrack').attr('title',_gtxt('AISSearch2.show_track'))\r\n\t\t\t\t\t\t\t.removeClass('ais active');\r\n\t\t\t\t\t\t\tcommands.showTrack.call(null, [])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!displaingTrack || displaingTrack!=vessel.mmsi){\r\n\t\t\t\t\t\tshowtrack.attr('title', _gtxt('AISSearch2.show_track'))\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tshowtrack.attr('title', _gtxt('AISSearch2.hide_track'))\r\n\t\t\t\t\t\t.addClass('ais active');      \r\n\t\t\t\t\t}\r\n\t//}\r\n\r\n\tlet\taddremoveIcon = function(add){\r\n\t\t\t\t\treturn ( add ? '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><g class=\"nc-icon-wrapper\" fill=\"#444444\" style=\"fill: currentColor;\"><path d=\"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z\"/></g></svg>'\t\t\t\t\t\r\n:'<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"24px\" height=\"24px\" viewBox=\"0 0 24 24\" style=\"enable-background:new 0 0 24 24;fill: currentColor;\" xml:space=\"preserve\"><g><path class=\"st0\" d=\"M4,6H2v14c0,1.1,0.9,2,2,2h14v-2H4V6z M20,2H8C6.9,2,6,2.9,6,4v12c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2V4    C22,2.9,21.1,2,20,2z M19,11h-4v4h-2v-4H9V9h4V5h2v4h4V11z\"/></g><rect x=\"9\" y=\"5\" class=\"st0\" width=\"10\" height=\"4\"/><rect x=\"9\" y=\"11\" class=\"st0\" width=\"10\" height=\"4\"/></g></svg>' )\r\n\t}\r\n    if (myFleetMembersModel && myFleetMembersModel.data && myFleetMembersModel.data.vessels){\r\n                    let addremove = $('<div class=\"button addremove\">' + addremoveIcon(add) + '</div>')\r\n\t\t\t\t\t\t//.css('background-image','url('+modulePath+'svg/'+(add?'add':'rem')+'-my-fleet.svg)')\r\n\t\t\t\t\t\t.attr('title', add?'добавить в мой флот':'удалить из моего флота')\r\n\t\t\t\t\t\t.appendTo(menubuttons)\r\n                    if (myFleetMembersModel.filterUpdating)\r\n                        addremove.addClass('disabled');\r\n                    addremove.on('click', function(){\r\n                        if (addremove.is('.disabled'))\r\n                            return;\r\n                        \r\n                        $('.addremove').addClass('disabled')\r\n\t\t\t\t\t\taddremove.hide()\r\n                        progress.append(gifLoader)\r\n\t\t\t\t\t\t\r\n                        myFleetMembersModel.changeFilter(vessel).then(function(){  \r\n                            add = myFleetMembersModel.findIndex(vessel)<0;\r\n                            var info = $('.icon-ship[vessel=\"' + vessel.mmsi + ' ' + vessel.imo + '\"]');\r\n                            info.css('display', !add?'inline':'none'); \t\r\n\t\t\t\t\t\t\t$('.vessel_prop.vname svg', canvas).css('visibility', add?'hidden':'visible')\r\n                            \r\n                            addremove.attr('title', add?'добавить в мой флот':'удалить из моего флота')\r\n\t\t\t\t\t\t\t.html(addremoveIcon(add))\r\n                            //.css('background-image','url('+modulePath+'svg/'+(add?'add':'rem')+'-my-fleet.svg)')\r\n \r\n                            progress.text('');               \r\n                            $('.addremove').removeClass('disabled').show()\r\n\t\t\t\t\t\t\t\r\n                            if (aisPluginPanel.activeView==myFleetMembersView)\r\n                                myFleetMembersView.show();\r\n                        });\r\n                    }); \r\n    }\r\n\t\t\t\t\r\n    let progress = $('<div class=\"progress\"></div>')\r\n    .appendTo(menubuttons); \r\n\t\r\n\t// TITLEBAR\t\r\n\tcanvas.parent('div').css({'margin':'0', 'overflow':'hidden'})\t\r\n\tlet titlebar = $(dialog).parent().find('.ui-dialog-titlebar').css('padding','0')\r\n\t\t.html('<table class=\"ais_info_dialog_titlebar\">'+\r\n\t\t'<tr><td><div class=\"date\"><span>'+\r\n\t\tHandlebars.compile('{{{ts_pos_utc}}}')(vessel2?vessel2:vessel)\r\n\t\t+'</span></div></td>'+\r\n\t\t'<td><div class=\"choose done\"><span unselectable=\"on\" class=\"chooser\">Общие сведения</span></div></td>'+\r\n\t\t'<td><div class=\"choose\"><span unselectable=\"on\" class=\"chooser\">Параметры движении</span></div></td>'+\r\n\t\t'<td id=\"closebut\"><div class=\"ais_info_dialog_close-button\" title=\"закрыть\"></div></td></tr>'+\r\n\t\t'</table>'),\r\n\t\tonDone = function(e){e.stopPropagation(); $('.choose', titlebar).removeClass('done'); $(e.currentTarget).parent().addClass('done');}\r\n\t\t\r\n\t$('.ais_info_dialog_close-button', titlebar).on('click', ()=>$( dialog ).dialog( \"close\" ))\t\r\n\t$('.chooser', titlebar).eq(0).on('mousedown', (e)=>{onDone(e); $('.vessel_props1', canvas).show(); $('.vessel_props2', canvas).hide()})\r\n\t$('.chooser', titlebar).eq(1).on('mousedown', (e)=>{onDone(e); $('.vessel_props2', canvas).show(); $('.vessel_props1', canvas).hide()})\r\n\t$('.date span', titlebar).on('mousedown', (e)=>{e.stopPropagation();})\r\n\t\r\n\t//$( dialog ).on( \"dialogdragstart\", function( e, ui ) {console.log(e);console.log(ui)} );\r\n\t\t\r\n\treturn dialog\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/infodialog.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/infodialog.css\n// module id = 17\n// module chunks = 0"],"sourceRoot":""}
