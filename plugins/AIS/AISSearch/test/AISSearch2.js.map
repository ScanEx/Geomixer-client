{"version":3,"sources":["webpack:///webpack/bootstrap e88514c5c83dde3e262f","webpack:///./src/entry.js","webpack:///./src/all.css","webpack:///./src/Views/AisView.css","webpack:///./src/locale.js","webpack:///./src/aisPluginPanel.js","webpack:///./src/ViewsFactory.js","webpack:///./src/Views/ScreenSearchView.js","webpack:///./src/Views/BaseView.js","webpack:///./src/Models/ScreenSearchModel.js","webpack:///./src/Views/MyFleetView.js","webpack:///./src/Views/MyFleet.css","webpack:///./src/Controls/GroupList.js","webpack:///./src/Controls/GroupWidget.js","webpack:///./src/Models/MyFleetModel.js","webpack:///./src/Polyfill.js","webpack:///./src/Views/DbSearchView.js","webpack:///./src/Views/DbSearch.css","webpack:///./src/Models/DbSearchModel.js","webpack:///./src/Views/InfoDialogView.js","webpack:///./src/Views/infodialog.js","webpack:///./src/Views/infodialog.css","webpack:///./src/Views/SpecialFloatView.js","webpack:///./src/Views/SpecialFloatView.css","webpack:///./src/Views/BaseFloatView.js","webpack:///./src/Views/VesselInfoScreen.js","webpack:///./src/Views/VesselInfoScreen.css","webpack:///./src/Search/Searcher.js","webpack:///./src/Toolbox.js"],"names":["NOSIDEBAR","PRODUCTION","SIDEBAR2","BETA","require","Handlebars","registerHelper","context","mmsi","imo","JSON","stringify","pluginName","menuId","toolbarIconId","cssTable","modulePath","gmxCore","getModulePath","highlight","L","marker","icon","className","iconAnchor","iconSize","iconUrl","zIndexOffset","AisPluginPanel","ViewsFactory","publicInterface","afterViewer","params","map","options","aisLayerID","screenSearchLayer","searchLayer","aisLastPoint","historyLayer","tracksLayerID","lastPointLayerAlt","tracksLayerAlt","historyLayerAlt","key","toLowerCase","myFleetLayers","split","id","replace","viewFactory","layersByID","nsGmx","gmxMap","setLayerClickHandler","layer","removeEventListener","addEventListener","e","gmx","properties","hasOwnProperty","infoDialogView","show","forLayers","layersId","i","length","aisPluginPanel","lmap","leafletMap","iconOpt_mf","togglable","title","_gtxt","text","icon_mf","control","gmxIcon","on","ev","target","isActive","$","width","css","hide","addControl","sidebar","window","iconSidebarWidget","sidebarControl","sidebarPane","setPane","position","showOnTop","createTab","createTabFunction","active","inactive","hint","_activeTabId","removeClass","_renderTabs","activeTabId","setTimeout","open","location","search","a","substr","x","filter","c","indexOf","y","vessel","setLatLng","addTo","fitBounds","maxZoom","animate","addModule","_translationsHash","addtext","module","exports","_leftMenuBlock","_canvas","_div","_activeView","_views","create","_isReady","_createTabs","tabsTemplate","workCanvas","append","compile","v","frame","tabs","_this","forEach","tab","eq","resize","is","each","addClass","click","_returnInstance","parentWorkCanvas","removeLayer","attr","insertAfter","blockItem","leftPanelItem","blockTitle","panelCanvas","toggleTitle","isCollapsed","leftMenu","createWorkCanvas","gmxControlIconManager","get","_iconClick","path","call","ScreenSearchView","ScreenSearchModel","MyFleetView","MyFleetModel","DbSearchView","DbSearchModel","InfoDialogView","Searcher","Toolbox","_tools","_searcher","_mfm","aisLayerSearcher","toolbox","_ssm","myFleetModel","_dbsm","_dbsv","model","tools","_ssv","_mfv","_idv","aisView","myFleetView","BaseView","apply","arguments","onLegendSwitched","showAlternative","_switchLegendIcon","needAltLegend","bind","gifLoader","Object","defineProperty","rv","getBoundingClientRect","height","find","container","tableTemplate","cleanFilter","filterReady","filterInput","delay","doFilter","setFilter","repaint","filterString","val","clearTimeout","keyup","input","keyCode","needUpdate","isDirty","update","widgets","commonCalendar","getDateInterval","currentTarget","checked","showAllTracks","prototype","_clean","ic","ica","inProgress","state","progress","_firstRowsPos","_firstRowsNum","_firstRowsShift","_setEventHandlers","thisInst","off","parse","xmin","xmax","longitude","ymin","ymax","latitude","ts_pos_utc","ts_pos_org","dt_pos_utc","closest","html","stopPropagation","lastPosition","showPosition","data","vessels","scrollCont","empty","tempFirst","slice","content","msg","mcsTopPctPrev","rowH","mCustomScrollbar","callbacks","onScroll","scroledPx","mcs","top","whileScrolling","startShow","topPct","start","end","scrollInertia","timeout","focus","_calcHeight","template","h","topOffset","view","clean","startScreen","bb","left","restoreDefault","_actualUpdate","_myFleetModel","_aisLayerSearcher","thisInstance","onChanged","load","actualUpdate","Promise","resolve","all","reject","searchScreen","dateInterval","border","group","json","Status","dataSrc","Result","values","d","Date","vessel_name","mf_member","formatDate","Math","floor","getTime","maxid","vessel_type","sog","cog","heading","icon_rot","round","placeVesselTypeIcon","RegExp","then","markMembers","ErrorInfo","some","r","txt","console","log","GroupList","visibility","_displayedOnly","_notDisplayed","_saveLabelSettingsPromise","settings","newGroupNameValid","ngn","isValid","groups","g","createGroup","groupList","appendGroup","error","value","display","markerTemplate","showVesselsOnMap","saveLabelSettings","toString","onRepaintItem","elm","querySelector","innerText","onDeleteGroup","deleteGroup","hideVesselsOnMap","labelSettings","match","labelSettingCtrl","onCheckItem","uncheked","onChangeGroup","changeGroup","catch","err","onExcludeItem","thisView","beforeExcludeMember","dlg","changeMembers","onGroupMenuShow","parseInt","marker_style","label_color","label_shadow","color","onChangeGroupStyle","colors","changeGroupStyle","onSaveGroupStyle","saveGroupStyle","strMmsi","m","GroupWidget","_onRepaintItemHandler","_onCheckItem","_onExcludeItem","_onChangeGroup","_onDeleteGroup","_onGroupMenuShow","_onChangeGroupStyle","_rolledupGroups","_cp1","_cp2","_cp3","_getFiltered","filtered","selectAll","selectOne","j","push","_setCheckBoxes","check","querySelectorAll","_setGroupCommands","preventDefault","classList","cssClass","done","next","ctxMenu","contextMenu","evnt","remove","colorChangeHandler","cs","_groupStyleChanged","style","backgroundColor","c1","cp1","c2","cp2","c3","cp3","Utils","rgb2hex","Controls","createColorPicker","document","relatedTarget","_hideContextMenu","ColorPickerHide","div","offset","clientX","clientY","offsetHeight","innerHeight","bottom","arrow","cl","contains","add","el","_onSaveGroupStyle","_saveStylePromise","groupblock","previousSibling","set","callback","index","parent","Polyfill","emptyGroup","isDefault","updateTemplate","ms","lsc","ls","eg","label_shadow_color","default","lc","mt","_markerTemplate","VesselData","_isDirty","_myFleetLayers","_defaultGroup","_vessels","_mapID","_prepared","_data","_view","_onChangedHandlers","_fireChanged","_loadVoyageInfo","findIndex","_parseVoyageInfo","fields","searchNames","response","_compareGroups","l","lat","lon","vt","gmx_id","sort","member","formatDateTime","gn","String","_queryMapLayers","buildedTree","gmxProperties","MapID","addGroupField","lid","sendCrossDomainJSONRequest","baseUrl","run","TaskID","Completed","ErorInfo","addDefaultGroup","f","fetchMyFleet","rs","rj","nickname","Nickname","count","layers","LayerID","rejectedResponse","specialVesselFilters","args","ai","displayed","drawMyFleetMarker","notDisplayed","myfleet","reduce","p","thisModel","membCounter","vv","splice","name","objects","action","found","temp","form","FormData","fetch","credentials","method","body","highlightMarker","predicate","list","thisArg","undefined","_searchString","_setSearchInputValue","s","searchBut","removeBut","searchInput","_highlight","needLegendSwitch","hasAlternativeLayers","_map","switchLegend","calendar","mapDateInterval","DateInterval","historyInterval","dateBegin","dateEnd","CalendarWidget","dateMin","dateMax","dateFormat","minimized","showSwitcher","td","after","db","getUTCDayBoundary","setDateInterval","reset","suggestions","positions","trg","suggestionsCount","suggestionsFrame","first","current","last","searchDone","_cleanMap","doSearch","actualId","searcher","searchString2","suggestion","cr","outerWidth","keydown","prev","prepareSearchInput","originalEvent","clipboardData","getData","reload","_vi_template","_prepare_history","displayedTrack","checkTrack","modelDate","trackDate","checkAllTracks","dates","setUTCHours","clearMyFleetMarkers","openPos","switchLegendIcons","ind","vi_cont","siblings","infoDialog","source","source_orig","positionMap","allTracksInput","getDates","showTrack","needAll","calendarInterval","interval","positionDate","checkInterval","zoom","getZoom","setView","_round","isNeg","power","pow","_addUnit","u","_toDd","D","lng","dir","deg","toFixed","_formatPosition","cog_sog","heading_rot","rot","x_y","eta","ts_eta","tm_pos_utc","_formatTime","tm_pos_loc","_formatDate","dt_pos_loc","eta_utc","eta_loc","draught","local","setMinutes","getMinutes","getTimezoneOffset","toLocaleTimeString","toLocaleDateString","searchPositionsAgg","parseResponse","obj","dt","t","counter","k","total","ErrorMessage","displayInfoDialog","VesselInfoScreen","infoDialogCascade","allIinfoDialogs","vesselInfoScreen","aisServices","_showPosition","track","_updateView","getmore","dialog","isNew","dialogOffset","closeFunc","event","openVesselInfoScreen","pos","ui","SpecialFloatView","addUnit","formatVessel","ts_pos_loc","isNaN","Translations","getLanguage","toDd","ddToDms","dms","min","sec","commands","canvas","menu","appendTo","photo","underphoto","buttons","dialogW","dialogH","posX","posY","showDialog","vessel2","moreInfo","smallShipIcon","vesselPropTempl","registry_name","swap","mi","resizable","extend","titlebar","scheme","href","serverBase","replaceWith","menubuttons","openpage","showpos","special","showSpecial","addremoveIcon","addremove","filterUpdating","info","eraseMyFleetMarker","redrawMarkers","ex","onDone","_cssClassName","BaseFloatView","innerHTML","createElement","cancelBubble","returnValue","closeCom","zinCom","zoutCom","img1Com","img2Com","twoimgCom","w","rc1","rc2","image1","image2","logos","showTwo","restoreSize","h1","h2","zoomIn","image","wiw","wih","setPlace1","setPlace2","zoomIn2","ceil","allowMove","src","srcElement","st","getComputedStyle","innerWidth","offsetWidth","right","defaultView","getWindowWidth","rc","downloadingImage1","Image","onload","onerror","random","downloadingImage2","timer","disposeTimer","_getMaxZindex","dialogs","z","zMax","Array","from","parseFloat","zIndex","dx","dy","rect","fx","fy","_ais","_galery","_register","_regcap","_leftPanel","_minh","_lloyds","menuAction","preview","showPicture","errmsg","change","submit","$img","jQuery","imgURL","attributes","prop","$svg","removeAttr","parentElement","mia","panel","theme","documentElement","clientWidth","clientHeight","drawGallery","gallery","galcontent","drawAis","ledokol","aiscontent","flag_country","callsign","nav_status","destination","drawRegister","regcontent","drawTable","article","pn","desc","description","pv","drawRMR","version","drawLloyds","regSwitches","item","onFail","wait","ship","registerServerUrl","lloydsServerUrl","rmr","RS","_baseUrl","_aisServices","_serverScript","_aisLastPoint","_screenSearchLayer","_aisLayerID","_historyLayer","getBorder","dFeatures","gmxDrawing","getFeatures","toGeoJSON","latLngBounds","getBounds","sw","getSouthWest","ne","getNorthEast","max","minX","maxX","geo","type","coordinates","center","formatTime","toLocaleString","formatDate2","dd","mm","getDate","getMonth","getFullYear","getHours","getUTCHours","getUTCMinutes","getUTCDate","getUTCMonth","getUTCFullYear","ldd","lm","ly","lh","lmm","protocol","iconAlt","request","WrapStyle","orderdirection","orderby","columns","query","join","toISOString","gmxUtil","sendCrossDomainPostRequest","searchPositions","searchById","aid","isfuzzy","pagesize","searchString","toUpperCase","arr","avessels","queryParams","minx","miny","maxx","maxy","toJSON","_layersByID","_aisLayer","_tracksLayer","_lastPointLayerAlt","_lastPointLayerAltFact","_tracksLayerAlt","_historyLayerAlt","_almmsi","_tlmmsi","_aldt","_tldt","getGmxProperties","_displayedTrack","_displayedVessels","_notDisplayedVessels","_filterFunc","mmsiArr","_setTrackFilter","removeFilter","addLayer","_specialVesselFilters","_setVesselFilter","_gmx","tileAttributeIndexes","_markers","_visibleMarkers","_markerIcon","vtype","group_style","type_color","startsWith","_eraseMyFleetMarker","layerGroup","getLayers","_drawMyFleetMarker","isVisible","di","parsedStyleKeys","label_line","label","text_shadow","group_name","divIcon","_switchLayers","l1","l2","_legendSwitchedHandlers","_legendSwitched","doit","clearLayers","paths","fill","handler"],"mappings":"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","file":"AISSearch2Test.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e88514c5c83dde3e262f","let NOSIDEBAR = false,\r\n    PRODUCTION = false,\r\n    SIDEBAR2 = false,\r\n    BETA = false;\r\nif (has('NOSIDEBAR'))\r\n    NOSIDEBAR = true;\r\nif (has('SIDEBAR2'))\r\n    SIDEBAR2 = true;\r\nif (has('PRODUCTION'))\r\n    PRODUCTION = true;\r\nif (has('BETA'))\r\n    BETA = true;\r\n\r\nrequire(\"./all.css\")\r\nrequire(\"./Views/AisView.css\")\r\nrequire(\"./locale.js\")\r\n\r\nHandlebars.registerHelper('aisinfoid', function (context) {\r\n    return context.mmsi + \" \" + context.imo;\r\n});\r\n\r\nHandlebars.registerHelper('aisjson', function (context) {\r\n    return JSON.stringify(context);\r\n});\r\n\r\nconst pluginName = PRODUCTION ? (BETA ? 'AISPluginBeta' : 'AISPlugin') : 'AISSearch2Test',\r\n    menuId = 'AISSearch',\r\n    toolbarIconId = null, \r\n    cssTable = PRODUCTION ? (BETA ? 'AISPluginBeta' : 'AISPlugin') : 'AISSearch2',\r\n    modulePath = gmxCore.getModulePath(pluginName);\r\n\r\nconst highlight = L.marker([0, 0], {icon:L.icon({\r\n    className:\"ais_highlight-icon\", \r\n    iconAnchor:[12, 12], \r\n    iconSize:[25,25], \r\n    iconUrl:'plugins/ais/aissearch/highlight.png'}), zIndexOffset:1000});\r\n\r\nconst AisPluginPanel = require('./aisPluginPanel.js'),\r\n      ViewsFactory = require('./ViewsFactory');\r\nconst publicInterface = {\r\n    pluginName: pluginName,\r\n    afterViewer: function (params, map) {\r\n        const options = {\r\n            aisLayerID: params.aisLayerID,// || '8EE2C7996800458AAF70BABB43321FA4',\t// searchById\t\t\t\r\n            screenSearchLayer: params.searchLayer,// || '8EE2C7996800458AAF70BABB43321FA4', // screen search\t\t\t\t\r\n            aisLastPoint: params.aisLastPoint || '303F8834DEE2449DAF1DA9CD64B748FE', // db search\r\n            historyLayer: params.historyLayer,\t\r\n            tracksLayerID: params.tracksLayerID || '13E2051DFEE04EEF997DC5733BD69A15',\r\n\r\n            lastPointLayerAlt: params.lastPointLayerAlt,\r\n            tracksLayerAlt: params.tracksLayerAlt,\r\n            historyLayerAlt: params.historyLayerAlt,\r\n            \r\n            modulePath: modulePath,\r\n            highlight: highlight,\r\n            menuId: menuId\r\n        };\r\n        for (var key in params) \r\n            if (key.toLowerCase() == \"myfleet\") {\r\n                options.myFleetLayers = params[key].split(\",\").map(function (id) {\r\n                    return id.replace(/\\s/, \"\");\r\n                });\r\n                break;\r\n            }\r\n        const viewFactory = new ViewsFactory(options);\r\n        const   layersByID = nsGmx.gmxMap.layersByID,\r\n                setLayerClickHandler = function (layer) {\r\n                layer.removeEventListener('click')\r\n                layer.addEventListener('click', function (e) {\r\n                    //console.log(e)\r\n                    if (e.gmx && e.gmx.properties.hasOwnProperty(\"imo\"))\r\n                        viewFactory.infoDialogView.show(e.gmx.properties)\r\n                })\r\n                },\r\n                forLayers = function (layer) {\r\n                    try {\r\n                    if (layer) {\r\n                        //setLocaleDate(layer)\r\n                        setLayerClickHandler(layer)\r\n                    }\r\n                    }\r\n                    catch(e){}\r\n                }\r\n\r\n        for (var key in params) {\r\n            let layersId = params[key].split(\",\").map(function (id) {\r\n                return id.replace(/\\s/, \"\");\r\n            });\r\n            for (var i = 0; i < layersId.length; ++i) {\r\n//console.log(layersId[i])\r\n                forLayers(layersByID[layersId[i]]);\r\n            }\r\n        }\r\n        \r\n        const aisPluginPanel = new AisPluginPanel(viewFactory);\r\n        aisPluginPanel.menuId = menuId;\r\n\r\n        if (NOSIDEBAR) {            \r\n            let lmap = nsGmx.leafletMap,    \r\n                iconOpt_mf = {\r\n                id: menuId, //toolbarIconId,\r\n                className: \"VesselSearchTool\",\r\n                togglable: true,\r\n                title: _gtxt('AISSearch2.caption')\r\n            };\r\n            if (toolbarIconId)\r\n                iconOpt_mf.id = toolbarIconId;\r\n            else\r\n                iconOpt_mf.text = _gtxt('AISSearch2.capShort');            \r\n            let icon_mf = L.control.gmxIcon(iconOpt_mf).on('statechange', function (ev) {\r\n                if (ev.target.options.isActive) {\r\n                    aisPluginPanel.show();\r\n                    $('.ais_view .instruments').width('100%');\r\n                    $('.ais_tab div').css('font-size', '12px');\r\n                }\r\n                else {\r\n                    aisPluginPanel.hide();\r\n                }\r\n            });\r\n            lmap.addControl(icon_mf);\r\n        }\r\n        else {\r\n            let sidebar = SIDEBAR2 ? window.iconSidebarWidget : window.sidebarControl;\r\n            aisPluginPanel.sidebarPane =  sidebar.setPane(\r\n                    menuId, { \r\n                        position: params.showOnTop ? -100 : 0,\r\n                        createTab: window.createTabFunction({\r\n                            icon: menuId,\r\n                            active: \"ais_sidebar-icon-active\",\r\n                            inactive: \"ais_sidebar-icon\",\r\n                            hint: _gtxt('AISSearch2.caption')\r\n                        })\r\n                    }\r\n                )\r\n            sidebar.addEventListener('opened', function (e) {\r\n                if (sidebar._activeTabId==menuId)                \r\n                    aisPluginPanel.show();\r\n            });\r\n            if (params.showOnTop) { // hack\r\n                $('div[data-pane-id]').removeClass('iconSidebarControl-pane-active')\r\n                sidebar._renderTabs({ activeTabId: menuId });\r\n                setTimeout(() => sidebar.open(menuId), 50);\r\n            }\r\n        }\r\n\r\n        if (location.search.search(/x=[^y=]+y=/i) != -1) {\r\n            var a = location.search.toLowerCase().substr(1).split('&'),\r\n                x = a.filter(function (c) { return !c.indexOf(\"x=\") })[0].substr(2),\r\n                y = a.filter(function (c) { return !c.indexOf(\"y=\") })[0].substr(2)\r\n            highlight.vessel = null;\r\n            highlight.setLatLng([y, x]).addTo(nsGmx.leafletMap);    \r\n            nsGmx.leafletMap.fitBounds([\r\n                [y, x],\r\n                [y, x]\r\n            ], {\r\n                    maxZoom: 9,//config.user.searchZoom,\r\n                    animate: false\r\n            }) \r\n        }\r\n    }\r\n};\r\n\r\ngmxCore.addModule(pluginName, publicInterface, {\r\n    css: cssTable + '.css'\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/entry.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/all.css\n// module id = 1\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/AisView.css\n// module id = 3\n// module chunks = 0","\r\n    _translationsHash.addtext('rus', {\r\n        'AISSearch2.title': ' ',\r\n        'AISSearch2.title1': ' ',\r\n        'AISSearch2.title2': '<b>  !</b>',\r\n        'AISSearch2.error': '<b>   !</b>',\r\n        'AISSearch2.iconTitle': '   ',\r\n        'AISSearch2.placeholder_0': '  , ',\r\n        'AISSearch2.placeholder_1': '    / MMSI',\r\n        // 'AISSearch2.placeholder_1': '    / MMSI.   , ,  '\r\n        'AISSearch2.myFleetDialog': ' ',\r\n        'AISSearch2.vesselName': '',\r\n        'AISSearch2.vesselAdd': '',\r\n        'AISSearch2.vesselRemove': '',\r\n        'AISSearch2.vesselExclude': '',\r\n        'AISSearch2.myFleetMembers': '',\r\n        'AISSearch2.myFleetMember': ' ',\r\n        'AISSearch2.info': '',\r\n        'AISSearch2.position': '',\r\n        'AISSearch2.found':': ',\r\n        'AISSearch2.filter':'   mmsi  imo ',\r\n        'AISSearch2.filterName':'  ',\r\n        'AISSearch2.screen':' ',\r\n        'AISSearch2.database':'  ',\r\n        'AISSearch2.capShort': ' ',\r\n        'AISSearch2.caption': '   \" \"',\r\n        'AISSearch2.refresh': '',\r\n        'AISSearch2.refreshing': '',\r\n        'AISSearch2.nomyfleet': '  ',\r\n        'AISSearch2.auth': ' ',\r\n        'AISSearch2.vessel_info':'  ',\r\n        'AISSearch2.vessel_voyage':'  ',\r\n        'AISSearch2.vessel_name': '',\r\n        'AISSearch2.mmsi': 'MMSI',\r\n        'AISSearch2.imo': 'IMO',\r\n        'AISSearch2.flag_country': '',\r\n        'AISSearch2.vessel_type': ' ',\r\n        'AISSearch2.flag': '',\r\n        'AISSearch2.callsign': '',\r\n        'AISSearch2.length': '',\r\n        'AISSearch2.width': '',\r\n        'AISSearch2.draught': '',\r\n        'AISSearch2.destination': '',\r\n        'AISSearch2.eta': '  ',\r\n        'AISSearch2.nav_status': '',\r\n        'AISSearch2.last_sig': ' ',\r\n        'AISSearch2.show_track': '  ',\r\n        'AISSearch2.hide_track': ' ',\r\n\t\t'AISSearch2.source': ' ',\r\n\t\t'AISSearch2.sais': ' AIS',\r\n\t\t'AISSearch2.tais': ' AIS',\r\n\t\t'AISSearch2.lon': '',\r\n\t\t'AISSearch2.lat': '',\r\n\t\t'AISSearch2.historyTab': '',\r\n        'AISSearch2.voyageInfo': ' ',\r\n        'AISSearch2.DbSearchTab':' ',\r\n        'AISSearch2.ScreenSearchTab':'  ',\r\n        'AISSearch2.MyFleetTab':' ',\r\n        'AISSearch2.dailyTrack':'  ',\r\n        'AISSearch2.allDailyTracks':' ',\r\n        'AISSearch2.myFleetOnly':'  ',\r\n        'AISSearch2.show_pos':'   ',\r\n        'AISSearch2.show_info':'  ',\r\n        'AISSearch2.time_switch':'',\r\n        'AISSearch2.time_local':'',\r\n        'AISSearch2.legend_switch':' ',\r\n        'AISSearch2.legend_type':' ',\r\n        'AISSearch2.legend_speed':' ',\r\n        'AISSearch2.calendar_today':'',\r\n        'AISSearh2.searchresults_view':'  <br>   ,<br>IMO  MMSI ',\r\n        'AISSearh2.myfleet_view':'  <br> <br>',\r\n        'AISSearch2.dialog_tab_general':' ',\r\n        'AISSearch2.dialog_tab_params':' ',\r\n        'AISSearch2.close_but':'',\r\n        'AISSearch2.myfleet_add':'   ',\r\n        'AISSearch2.myfleet_remove':'   ',\r\n        'AISSearch2.infoscreen_gen':' ',\r\n        'AISSearch2.infoscreen_reg':'',\r\n        'AISSearch2.infoscreen_gal':'',\r\n        'AISSearch2.last_update':'  ',\r\n        'AISSearch2.reg_general_tab':' ',\r\n        'AISSearch2.reg_build_tab':'  ',\r\n        'AISSearch2.reg_chars_tab':'  ',\r\n        'AISSearch2.reg_devs_tab':'',\r\n        'AISSearch2.rmrs':'',\r\n        'AISSearch2.AddIntoGroup':'  :',\r\n        'AISSearch2.RemoveFromGroup':'  ',        \r\n        'AISSearch2.AllGroup':'',        \r\n        'AISSearch2.NewGroup':' ',        \r\n        'AISSearch2.NewGroupName':'',        \r\n        'AISSearch2.CreateGroup':'',        \r\n        'AISSearch2.DeleteGroup':' ',       \r\n        'AISSearch2.DeleteGroupCommand':' ',      \r\n        'AISSearch2.DisplaySection':'  :',    \r\n        'AISSearch2.DisplayVesselName':' ',    \r\n        'AISSearch2.DisplayGroupName':' ',    \r\n        'AISSearch2.DisplayCog':'',    \r\n        'AISSearch2.DisplaySog':'',   \r\n        'AISSearch2.KnotShort':' ',\r\n        'AISSearch2.thisVesselOnly':'  : ',\r\n        'AISSearch2.allTracks':'  : ',\r\n        'AISSearch2.markerShadow':'  ',\r\n        'AISSearch2.labelColor':'  ',\r\n        'AISSearch2.labelShadow':'  ',\r\n        'AISSearch2.zoomin_com':'',\r\n        'AISSearch2.zoomout_com':'',\r\n        'AISSearch2.image1_com':' 1',\r\n        'AISSearch2.image2_com':' 2',\r\n        'AISSearch2.twoimages_com':' ',\r\n        'AISSearch2.close_com':''\r\n    });\r\n    _translationsHash.addtext('eng', {\r\n        'AISSearch2.title': 'Searching vessels',\r\n        'AISSearch2.title1': 'Vessels found',\r\n        'AISSearch2.title2': '<b>Vessels not found!</b>',\r\n        'AISSearch2.error': '<b>Vessels not found!</b>',\r\n        'AISSearch2.iconTitle': 'Search vessels within the view area',\r\n        'AISSearch2.placeholder_0': 'Search for addresses, coordinates',\r\n        'AISSearch2.placeholder_1': 'Search by vessel name / MMSI',\r\n        // 'AISSearch2.placeholder_1' : 'Search by vessel name / MMSI. Search by addresses, coordinates, cadastre number'\r\n        'AISSearch2.myFleetDialog': 'My fleet',\r\n        'AISSearch2.vesselName': 'name',\r\n        'AISSearch2.vesselAdd': 'add',\r\n        'AISSearch2.vesselRemove': 'remove',\r\n        'AISSearch2.vesselExclude': 'exclude',\r\n        'AISSearch2.myFleetMembers': 'Members',\r\n        'AISSearch2.myFleetMember': 'my fleet',\r\n        'AISSearch2.info': 'info',\r\n        'AISSearch2.position': 'position',\r\n        'AISSearch2.found':'Found ',\r\n        'AISSearch2.filter':'Insert vessel name or mmsi or imo',\r\n        'AISSearch2.filterName':'Insert vessel name',\r\n        'AISSearch2.screen':'On screen',\r\n        'AISSearch2.database':'In database',\r\n        'AISSearch2.capShort': 'Vessel Search',\r\n        'AISSearch2.caption': 'Vessel Search & My Fleet',\r\n        'AISSearch2.refresh': 'refresh',\r\n        'AISSearch2.refreshing': 'refreshing',\r\n        'AISSearch2.nomyfleet': 'Service is unavailable',\r\n        'AISSearch2.auth': 'Authorization required',\r\n        'AISSearch2.vessel_info':'VESSEL INFORMATION',\r\n        'AISSearch2.vessel_voyage':'VOYAGE INFORMATION',\r\n        'AISSearch2.vessel_name': 'Name',\r\n        'AISSearch2.mmsi': 'MMSI',\r\n        'AISSearch2.imo': 'IMO',\r\n        'AISSearch2.flag_country': 'Flag',\r\n        'AISSearch2.vessel_type': 'Vessel type',\r\n        'AISSearch2.flag': 'Flag',\r\n        'AISSearch2.callsign': 'Callsign',\r\n        'AISSearch2.length': 'Length',\r\n        'AISSearch2.width': 'Width',\r\n        'AISSearch2.draught': 'Draught',\r\n        'AISSearch2.destination': 'Destination',\r\n        'AISSearch2.eta': 'ETA',\r\n        'AISSearch2.nav_status': 'Navigation status',\r\n        'AISSearch2.last_sig': 'Last signal',\r\n        'AISSearch2.show_track': 'show track',\r\n        'AISSearch2.hide_track': 'hide track',\r\n\t\t'AISSearch2.source': 'Source',\r\n\t\t'AISSearch2.sais': 'S-AIS',\r\n\t\t'AISSearch2.tais': 'T-AIS',\r\n\t\t'AISSearch2.lon': 'Longitude',\r\n\t\t'AISSearch2.lat': 'Latitude',\r\n\t\t'AISSearch2.historyTab': 'History',\r\n\t\t'AISSearch2.voyageInfo': 'Voyage Info',\r\n        'AISSearch2.DbSearchTab':'DATA BASE',\r\n        'AISSearch2.ScreenSearchTab':'VESSELS ON SCREEN',\r\n        'AISSearch2.MyFleetTab':'MY FLEET',\r\n        'AISSearch2.dailyTrack':'daily track',\r\n        'AISSearch2.allDailyTracks':'all tracks',\r\n        'AISSearch2.myFleetOnly':'my fleet only',\r\n        'AISSearch2.show_pos':'position and history',\r\n        'AISSearch2.show_info':'vessel data',\r\n        'AISSearch2.time_switch':'Time',\r\n        'AISSearch2.time_local':'Local',\r\n        'AISSearch2.legend_switch':'Vessel legend',\r\n        'AISSearch2.legend_type':'Type',\r\n        'AISSearch2.legend_speed':'Speed',\r\n        'AISSearch2.calendar_today':'today',\r\n        'AISSearh2.searchresults_view':'Results View of Vessel Search<br>by Name,IMO or MMSI',\r\n        'AISSearh2.myfleet_view':'List of Special Selected<br>Vessels<br>',       \r\n        'AISSearch2.dialog_tab_general':'General',\r\n        'AISSearch2.dialog_tab_params':'Parameters',\r\n        'AISSearch2.close_but':'close',\r\n        'AISSearch2.myfleet_add':'include in my fleet',\r\n        'AISSearch2.myfleet_remove':'exclude from my fleet' ,\r\n        'AISSearch2.infoscreen_gen':'General',\r\n        'AISSearch2.infoscreen_reg':'Register',\r\n        'AISSearch2.infoscreen_gal':'Gallery',\r\n        'AISSearch2.last_update':'Last update',   \r\n        'AISSearch2.reg_general_tab':'General',\r\n        'AISSearch2.reg_build_tab':'Building',\r\n        'AISSearch2.reg_chars_tab':'Specification',\r\n        'AISSearch2.reg_devs_tab':'Equipment',        \r\n        'AISSearch2.rmrs':'RMRS',\r\n        'AISSearch2.AddIntoGroup':'Add into group',\r\n        'AISSearch2.RemoveFromGroup':'Remove from group',        \r\n        'AISSearch2.AllGroup':'All',        \r\n        'AISSearch2.NewGroup':'New group',        \r\n        'AISSearch2.NewGroupName':'name',        \r\n        'AISSearch2.CreateGroup':'create',        \r\n        'AISSearch2.DeleteGroup':'delete group',       \r\n        'AISSearch2.DeleteGroupCommand':'Delete group',      \r\n        'AISSearch2.DisplaySection':'Display on map:',    \r\n        'AISSearch2.DisplayVesselName':'vessel name',    \r\n        'AISSearch2.DisplayGroupName':'group name',    \r\n        'AISSearch2.DisplayCog':'cog',    \r\n        'AISSearch2.DisplaySog':'sog',   \r\n        'AISSearch2.KnotShort':' kn',\r\n        'AISSearch2.thisVesselOnly':'Only this ship ',\r\n        'AISSearch2.allTracks':'All ships tracks ',\r\n        'AISSearch2.markerShadow':'Marker highlight',\r\n        'AISSearch2.labelColor':'Label color',\r\n        'AISSearch2.labelShadow':'Label highlight',\r\n        'AISSearch2.zoomin_com':'Zoom in',\r\n        'AISSearch2.zoomout_com':'Zoom out',\r\n        'AISSearch2.image1_com':'Image 1',\r\n        'AISSearch2.image2_com':'Image 2',\r\n        'AISSearch2.twoimages_com':'Two images',\r\n        'AISSearch2.close_com':'Close'\r\n    });\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/locale.js","let NOSIDEBAR = false,\r\n    PRODUCTION = false,\r\n    SIDEBAR2 = false;\r\nif (has('NOSIDEBAR'))\r\n    NOSIDEBAR = true;\r\nif (has('SIDEBAR2'))\r\n    SIDEBAR2 = true;\r\nif (has('PRODUCTION'))\r\n    PRODUCTION = true;\r\n\r\n\r\nmodule.exports = function (viewFactory) {\r\n    let _leftMenuBlock,\r\n        _canvas = _div(null),\r\n        _activeView,\r\n        _views = viewFactory.create(),\r\n        _isReady = false,\r\n        _createTabs = function () {\r\n            let tabsTemplate = '<table class=\"ais_tabs\" border=0><tr>' +\r\n\r\n                '</td><td class=\"ais_tab myfleet_tab unselectable\" unselectable=\"on\">' + // ACTIVE\r\n                '<div>{{i \"AISSearch2.MyFleetTab\"}}</div>' +\r\n              \r\n                '<td class=\"ais_tab dbsearch_tab unselectable\" unselectable=\"on\">' +\r\n                '<div>{{i \"AISSearch2.DbSearchTab\"}}</div>' +\r\n                '</td><td class=\"ais_tab scrsearch_tab unselectable\" unselectable=\"on\">' +\r\n                '<div>{{i \"AISSearch2.ScreenSearchTab\"}}</div>' +\r\n              \r\n                '</td></tr></table>'\r\n\r\n            if (NOSIDEBAR)\r\n                $(_leftMenuBlock.workCanvas).append(_canvas);\r\n            else\r\n                $(this.sidebarPane).append(_canvas);\r\n\r\n            $(_canvas).append(Handlebars.compile(tabsTemplate));\r\n            $(_canvas).append(_views.map(v => v.frame));\r\n    \r\n            let tabs = $('.ais_tab', _canvas),\r\n                _this = this;           \r\n            _views.forEach((v,i) =>{\r\n                v.tab = tabs.eq(i);\r\n                v.resize(true);\r\n            }); \r\n            tabs.on('click', function () {\r\n                if (!$(this).is('.active')) {\r\n                    let target = this;\r\n                    tabs.each(function (i, tab) {\r\n                        if (!$(tab).is('.active') && target == tab) {\r\n                            $(tab).addClass('active');\r\n                            _views[i].show();\r\n                            _activeView = _views[i];\r\n                        }\r\n                        else {\r\n                            $(tab).removeClass('active');\r\n                            _views[i].hide();\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            // Show the first tab\r\n            tabs.eq(0).removeClass('active').click();\r\n\r\n            if (NOSIDEBAR) {\r\n                _returnInstance.hide = function () {\r\n                    $(_leftMenuBlock.parentWorkCanvas).hide();\r\n                    nsGmx.leafletMap.removeLayer(highlight);\r\n                }\r\n\r\n                $(_leftMenuBlock.parentWorkCanvas)\r\n                    .attr('class', 'left_aispanel')\r\n                    .insertAfter('.layers-before');\r\n                var blockItem = _leftMenuBlock.leftPanelItem,\r\n                    blockTitle = $('.leftmenu-path', blockItem.panelCanvas);\r\n                var toggleTitle = function () {\r\n                    if (blockItem.isCollapsed())\r\n                        blockTitle.show();\r\n                    else\r\n                        blockTitle.hide();\r\n                }\r\n                $(blockItem).on('changeVisibility', toggleTitle);\r\n                toggleTitle();\r\n            }\r\n\r\n            // All has been done at first time\r\n            _isReady = true;\r\n        },\r\n\r\n    _returnInstance = {\r\n        show: function () {\r\n            let lmap = nsGmx.leafletMap;\r\n            if (NOSIDEBAR && !_leftMenuBlock)\r\n                _leftMenuBlock = new leftMenu();\r\n\r\n            if ((NOSIDEBAR && (!_leftMenuBlock.createWorkCanvas(\"aispanel\",\r\n                function () { lmap.gmxControlIconManager.get(this.menuId)._iconClick() },\r\n                { path: [_gtxt('AISSearch2.caption')] })\r\n            )) || (!_isReady)) // SIDEBAR\r\n            {\r\n                _createTabs.call(this);\r\n            }\r\n            else{\r\n                if (NOSIDEBAR){\r\n                    $(_leftMenuBlock.parentWorkCanvas)\r\n                    .insertAfter('.layers-before');\r\n                }            \r\n                _activeView && _activeView.show();\r\n            }\r\n        }\r\n    };\r\n    return _returnInstance;\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/aisPluginPanel.js","const ScreenSearchView = require('./Views/ScreenSearchView'),\r\n    ScreenSearchModel = require('./Models/ScreenSearchModel'),\r\n    MyFleetView = require('./Views/MyFleetView'),\r\n    MyFleetModel = require('./Models/MyFleetModel'),\r\n    DbSearchView = require('./Views/DbSearchView'),\r\n    DbSearchModel = require('./Models/DbSearchModel'),\r\n    InfoDialogView = require('./Views/InfoDialogView'),\r\n    Searcher = require('./Search/Searcher'),\r\n    Toolbox = require('./Toolbox.js');\r\n\r\nmodule.exports = function (options) {\r\n    const _tools = new Toolbox(options),\r\n        //_layersByID = nsGmx.gmxMap.layersByID,\r\n        _searcher = new Searcher(options),\r\n        _mfm = new MyFleetModel({aisLayerSearcher:_searcher, toolbox:_tools}),\r\n        _ssm = new ScreenSearchModel({ aisLayerSearcher: _searcher, myFleetModel: _mfm }),\r\n        _dbsm = new DbSearchModel(_searcher),\r\n        _dbsv = new DbSearchView({model:_dbsm, highlight:options.highlight, tools:_tools}),\r\n        _ssv = new ScreenSearchView(_ssm, _tools),\r\n        _mfv = new MyFleetView(_mfm, _tools),\r\n        _idv = new InfoDialogView({\r\n            tools:_tools,\r\n            aisLayerSearcher: _searcher, \r\n            modulePath: options.modulePath,\r\n            aisView: _dbsv, \r\n            myFleetView: _mfv,\r\n            menuId: options.menuId\r\n        });\r\n        _ssv.infoDialogView = _idv;\r\n        _mfv.infoDialogView = _idv;\r\n        _dbsv.infoDialogView = _idv;\r\n    return {\r\n        get infoDialogView(){\r\n            return _idv;\r\n        },\r\n        create: function () {\r\n            return [ _mfv, _dbsv, _ssv ];\r\n        }\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/ViewsFactory.js","const BaseView = require('./BaseView.js');\r\nlet _tools;\r\nconst ScreenSearchView = function (model, tools) {\r\n    BaseView.apply(this, arguments);\r\n    _tools = tools;          \r\n    _tools.onLegendSwitched(((showAlternative)=>{\r\n        _switchLegendIcon.call(this, _tools.needAltLegend);\r\n    }).bind(this));\r\n\r\n    this.frame = $(Handlebars.compile('<div class=\"ais_view search_view\">' +\r\n\r\n        '<table border=0 class=\"instruments\">' +\r\n        //'<tr><td colspan=\"2\"><div class=\"filter\"><input type=\"text\" placeholder=\"{{i \"AISSearch2.filter\"}}\"/><i class=\"icon-flclose clicable\"></div></td></tr>'+\r\n        '<tr><td><div class=\"filter\"><input type=\"text\" placeholder=\"{{i \"AISSearch2.filterName\"}}\"/>' +\r\n        '<div><img class=\"search clicable\" src=\"plugins/AIS/AISSearch/svg/search.svg\">' +\r\n        '<img class=\"remove clicable\" src=\"plugins/AIS/AISSearch/svg/remove.svg\">' +\r\n        '</div></div>' +\r\n        '</td></tr>' + \r\n        '<tr><td>' + \r\n        '<span class=\"sync-switch-slider-description\" style=\"padding: 0;line-height:12px\">{{i \"AISSearch2.allTracks\"}}</span>'+ \r\n        '<label class=\"sync-switch switch all_tracks\" style=\"margin-left:5px\"><input type=\"checkbox\">'+\r\n        '<div class=\"sync-switch-slider switch-slider round\"></div></label>' +\r\n        '<div>&nbsp;</div>'+\r\n        '</td></tr>' + \r\n        '</table>' +\r\n\r\n        '<table class=\"results\">'+\r\n        '<tr><td class=\"count\"></td>' +\r\n        '<td><div class=\"refresh clicable\" title=\"{{i \"AISSearch2.refresh\"}}\"><div>' + this.gifLoader + '</div></div></td></tr>' +\r\n        '</table>'+\r\n        // '<table class=\"start_screen\"><tr><td>'+\r\n        // '<img src=\"plugins/AIS/AISSearch/svg/steer-weel.svg\">'+\r\n        // '<div>  <br> </div></td></tr></table>'+\r\n        '<div class=\"ais_vessels\">'+\r\n        '<div class=\"ais_vessel\">' +\r\n        '<table border=0><tr><td><div class=\"position\">NO VESSELS</div><div>mmsi: 0 imo: 0</div></td>' +\r\n        '<td><i class=\"icon-ship\" vessel=\"\" title=\"\"></i></td>' +\r\n        '<td><span class=\"date\"></span></td>'+\r\n        '<td><div class=\"info\" vessel=\"aisjson this\" title=\"i AISSearch2.info\">' +\r\n        '<img src=\"plugins/AIS/AISSearch/svg/info.svg\">' +\r\n        '</div></td></tr></table>' +\r\n        '</div>' +       \r\n        '</div>' +\r\n        \r\n        '</div>'\r\n    )());\r\n    Object.defineProperty(this, \"topOffset\", {\r\n        get: function () {\r\n            let rv = $('.ais_tabs')[0].getBoundingClientRect().height + \r\n            this.frame.find('.instruments')[0].getBoundingClientRect().height + \r\n            this.frame.find('.results')[0].getBoundingClientRect().height;\r\n            return rv;\r\n        }\r\n    });    \r\n    this.container = this.frame.find('.ais_vessels');\r\n    //this.startScreen = this.frame.find('.start_screen');\r\n    this.tableTemplate = '{{#each vessels}}' +\r\n        '<div class=\"ais_vessel\">' +\r\n        '<table border=0><tr><td><div class=\"position\">{{vessel_name}}</div><div>mmsi: {{mmsi}} imo: {{imo}}</div></td>' +       \r\n        '<td><img src=\"{{icon}}\" class=\"rotateimg{{icon_rot}} legend_icon\"><img src=\"{{iconAlt}}\" class=\"rotateimg{{icon_rot}} legend_iconalt\"></td>' +\r\n        \r\n        //'<td><i class=\"icon-ship\" vessel=\"{{aisinfoid this}}\" style=\"{{mf_member}}\" title=\"{{i \"AISSearch2.myFleetMember\"}}\"></i></td>' +\r\n        '<td><span vessel=\"{{aisinfoid this}}\" style=\"{{mf_member}}\" title=\"{{i \"AISSearch2.myFleetMember\"}}\">'+        \r\n        '<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"14px\" height=\"14px\" viewBox=\"0 0 14 14\" xml:space=\"preserve\">' +\r\n        '<g style=\"fill: #48aff1;\">' +\r\n        '<path class=\"st0\" d=\"M13.4,11H0.6c-0.2,0-0.4,0.1-0.5,0.3c-0.1,0.2-0.1,0.4,0,0.6l1.2,1.8C1.4,13.9,1.6,14,1.8,14h9.9   c0.2,0,0.3-0.1,0.4-0.2l1.7-1.8c0.2-0.2,0.2-0.4,0.1-0.7C13.9,11.1,13.7,11,13.4,11z\"/>' +\r\n        '<path class=\"st0\" d=\"M9.3,9.7h2.9c0.2,0,0.4-0.1,0.5-0.3c0.1-0.2,0.1-0.4,0-0.6L9.8,4.5C9.7,4.3,9.4,4.2,9.2,4.3   C8.9,4.4,8.7,4.6,8.7,4.9v4.3C8.7,9.5,9,9.7,9.3,9.7z\"/>' +\r\n        '<path class=\"st0\" d=\"M1.2,9.7H7c0.3,0,0.6-0.3,0.6-0.6V0.6c0-0.3-0.2-0.5-0.4-0.6C6.9-0.1,6.7,0,6.5,0.3L0.7,8.8   C0.6,9,0.5,9.2,0.6,9.4C0.7,9.6,0.9,9.7,1.2,9.7z\"/>' +\r\n        '</g>' +\r\n        '</svg></span></td>'+\r\n        \r\n        '<td><span class=\"date\">{{ts_pos_utc}}</span></td>'+\r\n        '<td><div class=\"info\" vessel=\"{{aisjson this}}\" title=\"{{i \"AISSearch2.info\"}}\">' +\r\n        '<img src=\"plugins/AIS/AISSearch/svg/info.svg\">' +\r\n        '</div></td></tr></table>' +\r\n        '</div>' +\r\n        '{{/each}}' +\r\n        '{{#each msg}}<div class=\"msg\">{{txt}}</div>{{/each}}';\r\n\r\n    let cleanFilter = this.frame.find('.remove'),\r\n        filterReady = this.frame.find('.search'),\r\n        filterInput = this.frame.find('input'),\r\n        delay,\r\n        doFilter = function(){\r\n            this.model.setFilter();             \r\n            this.repaint();\r\n//console.log(\"doFilter\")\r\n        };\r\n        cleanFilter.click(function(e){\r\n            if (this.model.filterString === '')\r\n                return;\r\n            filterInput.val('');\r\n            this.model.filterString = '';  \r\n            clearTimeout(delay)\r\n            doFilter.call(this);\r\n            //nsGmx.leafletMap.removeLayer(highlight);\r\n        }.bind(this))\r\n        filterInput.keyup(function(e){            \r\n            let input = filterInput.val() || \"\";\r\n            input = input.replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n            if (input===\"\"){\r\n                filterReady.show();\r\n                cleanFilter.hide();\r\n            }\r\n            else{\r\n                cleanFilter.show();\r\n                filterReady.hide();\r\n            }\r\n\r\n            if (input==this.model.filterString && e.keyCode!=13)\r\n                return;\r\n            this.model.filterString = input; \r\n            if (e.keyCode==13)\r\n                this.model.filterString += '\\r' ;  \r\n            clearTimeout(delay)\r\n            delay = setTimeout((() => { doFilter.call(this) }).bind(this), 500);\r\n            //nsGmx.leafletMap.removeLayer(highlight);\r\n        }.bind(this))\r\n    \r\n    let needUpdate = function(){\r\n        this.model.isDirty = true;\r\n        if (this.container.is(':visible')) {\r\n \r\n            clearTimeout(delay)\r\n            delay = setTimeout((() => { this.model.update() }).bind(this), 300);  \r\n        }\r\n    };\r\n    nsGmx.leafletMap.on('moveend', needUpdate.bind(this));\r\n    nsGmx.widgets.commonCalendar.getDateInterval().on('change', needUpdate.bind(this));\r\n\r\n    this.frame.find('.instruments .all_tracks  input[type=\"checkbox\"]').click((e=>{\r\n        if (e.currentTarget.checked) {       \r\n            _tools.showAllTracks(true);\r\n        }\r\n        else{            \r\n            _tools.showAllTracks(false);  \r\n        }\r\n    }).bind(this));\r\n};\r\n\r\nScreenSearchView.prototype = Object.create(BaseView.prototype);\r\n\r\nconst _clean = function () {\r\n    this.frame.find('.count').text(_gtxt('AISSearch2.found') + 0); \r\n},\r\n_switchLegendIcon = function(showAlternative){\r\n    let ic = this.frame.find('.legend_icon'),\r\n    ica = this.frame.find('.legend_iconalt');\r\n    if (showAlternative){\r\n        ic.hide(); ica.show();\r\n    }\r\n    else{\r\n        ica.hide(); ic.show();\r\n    }\r\n};\r\n\r\nScreenSearchView.prototype.inProgress = function (state) {\r\n    let progress = this.frame.find('.refresh div');\r\n    if (state)\r\n        progress.show();\r\n    else\r\n        progress.hide();\r\n};\r\n\r\nlet\r\n_firstRowsPos = 0,\r\n_firstRowsNum = 40,\r\n_firstRowsShift = 20,\r\n_setEventHandlers = function(){\r\n    let thisInst = this;\r\n    this.container.find('.info', ).off('click').on('click', function (e) {\r\n        let target = $(this),\r\n            vessel = JSON.parse(target.attr('vessel'))\r\n//console.log(vessel)\r\n        thisInst.infoDialogView && thisInst.infoDialogView.show(vessel, (v) => {\r\n//console.log(v)\r\n            vessel.xmin = vessel.xmax = v.longitude\r\n            vessel.ymin = vessel.ymax = v.latitude\r\n            if (vessel.hasOwnProperty('ts_pos_utc')) {\r\n                 vessel.ts_pos_utc = v.ts_pos_utc;\r\n                 vessel.ts_pos_org = v.ts_pos_org;\r\n                 v.dt_pos_utc && $(this).closest('tr').find('.date').html(v.dt_pos_utc);\r\n            }\r\n            target.attr('vessel', JSON.stringify(vessel))\r\n        });\r\n        e.stopPropagation();\r\n    });\r\n    this.container.find('.ais_vessel').off('click').on('click', function () {\r\n//console.log(JSON.parse($(this).find('.info').attr('vessel')))\r\n        let v = JSON.parse($(this).find('.info').attr('vessel'));                \r\n        v.lastPosition = true;\r\n        thisInst.infoDialogView.showPosition(v);\r\n    }); \r\n//console.log(\"repaint \"+(new Date()-start)+\"ms\" )      \r\n}\r\n\r\nScreenSearchView.prototype.repaint = function () {\r\n//console.log(\"REPAINT\")\r\n    _clean.call(this);\r\n    this.frame.find('.count').text(_gtxt('AISSearch2.found')+this.model.data.vessels.length); \r\n    //BaseView.prototype.repaint.apply(this, arguments);\r\n    ////////////////////////////////////////////////////\r\n    this.container.find('.info').off('click');\r\n    this.container.find('.ais_vessel', ).off('click');   \r\n    let scrollCont = this.container.find('.mCSB_container')\r\n    if (scrollCont[0])\r\n        scrollCont.empty();\r\n    else\r\n        this.container.empty();\r\n    if (!this.model.data)\r\n        return;\r\n\r\n    let thisInst = this,\r\n        tempFirst = this.model.data.vessels.slice(0, _firstRowsNum),\r\n        content = $(Handlebars.compile(this.tableTemplate)({msg:this.model.data.msg, vessels:tempFirst})),\r\n        mcsTopPctPrev = 0,\r\n        rowH;\r\n    _firstRowsPos = _firstRowsNum;\r\n\r\n    if (!scrollCont[0]) {\r\n        this.container.mCustomScrollbar(\"destroy\").append(content).mCustomScrollbar({\r\n            //scrollInertia: 0,//this.model.data.vessels.length > _firstRowsNum ? 0 : 600,\r\n            callbacks:{\r\n                onScroll:function(){                    \r\n                    thisInst.scroledPx = this.mcs.top;\r\n                    //console.log(\"onScroll \" + this.mcs.top + \" \" + thisInst.container.is(':visible'));\r\n                },\r\n                whileScrolling: /*scrollingHandler*/function(){                     \r\n//console.log(\"whileScrolling \" + this.mcs.top + \"px \" + thisInst.container.is(':visible')+\" ss \"+thisInst.startShow)                  \r\n//console.log(\"% \" + this.mcs.topPct + \" pos\" + _firstRowsPos)\r\n                    if (thisInst.startShow && this.mcs.top == 0){\r\n                        return;\r\n                    }\r\n                    else\r\n                    thisInst.startShow = false;\r\n                        \r\n                    if (this.mcs.topPct==100 && mcsTopPctPrev != 100 && thisInst.model.data.vessels.length > _firstRowsPos){\r\n                        let start = _firstRowsPos - _firstRowsNum + _firstRowsShift,\r\n                            end = _firstRowsPos + _firstRowsShift;\r\n                        if (thisInst.model.data.vessels.length-start <= thisInst.container.height()/rowH)\r\n                            start = thisInst.model.data.vessels.length - _firstRowsNum;\r\n///console.log(\">\"+start+\", \"+end)\r\n                        tempFirst = thisInst.model.data.vessels.slice(start, end),\r\n                        _firstRowsPos += _firstRowsShift;                       \r\n                        let scrollCont = thisInst.container.find('.mCSB_container');\r\n                        scrollCont.html(Handlebars.compile(thisInst.tableTemplate)({vessels:tempFirst}));  \r\n//console.log(\"h=\"+rowH) \r\n                        setTimeout(()=>{\r\n                            thisInst.scroledPx = -rowH * _firstRowsShift + thisInst.container.height();\r\n                            thisInst.container.mCustomScrollbar(\"scrollTo\",\r\n                            thisInst.scroledPx, {\r\n                                    scrollInertia: 0,\r\n                                    callbacks: false\r\n                            });\r\n                            _setEventHandlers.call(thisInst);\r\n                        }, 200);\r\n                        _switchLegendIcon.call(thisInst, _tools.needAltLegend);\r\n                    }\r\n                    if (this.mcs.topPct == 0 && mcsTopPctPrev != 0 && _firstRowsPos > _firstRowsNum) {\r\n//console.log(_firstRowsPos)\r\n                        let start = _firstRowsPos - _firstRowsShift - _firstRowsNum,\r\n                            end = _firstRowsPos - _firstRowsShift;\r\n//console.log(\"<\"+start + \", \" + end)\r\n                        tempFirst = thisInst.model.data.vessels.slice(start, end),\r\n                        _firstRowsPos -= _firstRowsShift;                       \r\n                        let scrollCont = thisInst.container.find('.mCSB_container');\r\n                        scrollCont.html(Handlebars.compile(thisInst.tableTemplate)({ vessels: tempFirst })); \r\n//console.log(\"h=\"+rowH)\r\n                        setTimeout(() => {\r\n                            thisInst.scroledPx = rowH * _firstRowsShift;\r\n                            thisInst.container.mCustomScrollbar(\"scrollTo\",\r\n                                thisInst.scroledPx, {\r\n                                    scrollInertia: 0,\r\n                                    callbacks: false\r\n                                }\r\n                            );\r\n                            _setEventHandlers.call(thisInst);\r\n                        }, 200);\r\n                        _switchLegendIcon.call(thisInst, _tools.needAltLegend);\r\n                    }\r\n                    mcsTopPctPrev = this.mcs.topPct;\r\n                }\r\n            }\r\n        });\r\n        scrollCont = this.container.find('.mCSB_container');\r\n        rowH = scrollCont.height()/$('.ais_vessel', scrollCont).length;\r\n    }\r\n    else {\r\n        scrollCont.append(content);\r\n        this.container.mCustomScrollbar(\"scrollTo\", \"top\", {scrollInertia:0, callbacks:false, timeout:200});\r\n    }\r\n    _setEventHandlers.call(this);  \r\n    _switchLegendIcon.call(this, _tools.needAltLegend);\r\n};\r\n\r\nScreenSearchView.prototype.show = function () {\r\n    this.startShow = true;\r\n    BaseView.prototype.show.apply(this, arguments);\r\n    this.frame.find('.filter input').focus();\r\n\r\n    if (this.frame.find('.instruments .all_tracks  input[type=\"checkbox\"]')[0].checked)\r\n        _tools.showAllTracks(true);\r\n\r\n    if (this.scroledPx) {\r\n        this.container.mCustomScrollbar(\"scrollTo\",\r\n            this.scroledPx, { scrollInertia: 0, callbacks: false }\r\n        );\r\n    }  \r\n};\r\n\r\nmodule.exports = ScreenSearchView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/ScreenSearchView.js","let NOSIDEBAR = false,\r\n    PRODUCTION = false,\r\n    SIDEBAR2 = false;\r\nif (has('NOSIDEBAR'))\r\n    NOSIDEBAR = true;\r\nif (has('SIDEBAR2'))\r\n    SIDEBAR2 = true;\r\nif (has('PRODUCTION'))\r\n    PRODUCTION = true;\r\n\r\nlet _calcHeight = function () {  \r\n    if (NOSIDEBAR){\r\n        let template = this.frame.find('.ais_vessel')[0] || this.frame.find('.ais_positions_date')[0],\r\n            h = template.getBoundingClientRect().height;  \r\n        return h * 5;\r\n    }\r\n    else {\r\n        return $('.iconSidebarControl-pane').height() - this.topOffset;\r\n    }\r\n};\r\n\r\nlet _tools;\r\nconst BaseView = function (model, tools) {\r\n    model.view = this;\r\n    this.model = model;\r\n    this.gifLoader = '<img src=\"img/progress.gif\">';\r\n    _tools = tools;\r\n};\r\n\r\nlet _clean = function(){ \r\n    this.container.find('.info').off('click');\r\n    this.container.find('.position', ).off('click');   \r\n    let scrollCont = this.container.find('.mCSB_container')\r\n    if (scrollCont[0])\r\n        scrollCont.empty();\r\n    else\r\n        this.container.empty();\r\n//console.log(\"EMPTY ON BASE.CLEAN\")\r\n};\r\n\r\nBaseView.prototype = function () {\r\n    return {\r\n        get isActive(){\r\n            return this.frame.is(\":visible\");\r\n        },\r\n        resize: function (clean) {\r\n            let h = _calcHeight.call(this);\r\n            if (this.startScreen){\r\n                let bb = $('.iconSidebarControl-pane:visible')[0].getBoundingClientRect();\r\n                this.startScreen.css({ position:\"absolute\", left: bb.left+\"px\", top: (bb.height/2-50)+\"px\", \r\n                width: bb.width+\"px\"});\r\n            }\r\n            this.container.height(h);\r\n\r\n            if (clean){\r\n                this.container.empty()\r\n            }\r\n        },\r\n        repaint: function(){\r\n            _clean.call(this);            \r\n//console.log(this.model.data)\r\n            if (!this.model.data)\r\n                return;\r\n            let scrollCont = this.container.find('.mCSB_container'),\r\n            content = $(Handlebars.compile(this.tableTemplate)(this.model.data));\r\n            if (!scrollCont[0]) {\r\n                this.container.append(content).mCustomScrollbar();\r\n            }\r\n            else {\r\n                $(scrollCont).append(content);\r\n            }\r\n\r\n            var _this = this;\r\n            this.container.find('.info', ).on('click', function (e) {\r\n                let target = $(this),\r\n                    vessel = JSON.parse(target.attr('vessel'))\r\n//console.log(vessel)\r\n                _this.infoDialogView && _this.infoDialogView.show(vessel, (v) => {\r\n//console.log(v)\r\n                    vessel.xmin = vessel.xmax = v.longitude\r\n                    vessel.ymin = vessel.ymax = v.latitude\r\n                    if (vessel.hasOwnProperty('ts_pos_utc')) {\r\n                         vessel.ts_pos_utc = v.ts_pos_utc;\r\n                         vessel.ts_pos_org = v.ts_pos_org;\r\n                         v.dt_pos_utc && $(this).closest('tr').find('.date').html(v.dt_pos_utc);\r\n                    }\r\n                    target.attr('vessel', JSON.stringify(vessel))\r\n                });\r\n                e.stopPropagation();\r\n            });\r\n            this.container.find('.ais_vessel').on('click', function () {\r\n                let v = JSON.parse($(this).find('.info').attr('vessel'));                \r\n                v.lastPosition = true;\r\n                _this.infoDialogView.showPosition(v);\r\n            });      \r\n        },\r\n        show: function () {\r\n            _tools.restoreDefault();\r\n            this.frame.show();\r\n            this.model.update();\r\n        },\r\n        hide: function () {\r\n            this.frame.hide();\r\n        }\r\n    }\r\n}();\r\n\r\nmodule.exports = BaseView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/BaseView.js","let _actualUpdate,\r\n_myFleetModel,\r\n_aisLayerSearcher;\r\n\r\nconst ScreenSearchModel = function ({aisLayerSearcher, myFleetModel}) {\r\n\r\n    let thisInstance = this;\r\n    myFleetModel.onChanged = function(){\r\n        thisInstance.isDirty = true;\r\n        if (thisInstance.view.isActive)\r\n            thisInstance.update();\r\n    };\r\n    _aisLayerSearcher = aisLayerSearcher;\r\n    _myFleetModel = myFleetModel;\r\n    this.filterString = \"\";\r\n    this.isDirty = true;\r\n};\r\n\r\nScreenSearchModel.prototype.load = function (actualUpdate) {\r\n    if (!this.isDirty)\r\n        return Promise.resolve();\r\n\r\n    let thisInst = this;\r\n    return Promise.all([\r\n        new Promise(function (resolve, reject) {\r\n            _aisLayerSearcher.searchScreen({\r\n                dateInterval: nsGmx.widgets.commonCalendar.getDateInterval(),\r\n                border: true,\r\n                group: true\r\n            }, function (json) {\r\n                if (json.Status.toLowerCase() == \"ok\") {\r\n                    thisInst.dataSrc = {\r\n                        vessels: json.Result.values.map(function (v) {\r\n                            let d = new Date(v[12]),//nsGmx.widgets.commonCalendar.getDateInterval().get('dateBegin'),\r\n                            vessel = {\r\n                                vessel_name: v[0], mmsi: v[1], imo: v[2], mf_member: 'visibility:hidden', \r\n                                ts_pos_utc: _aisLayerSearcher.formatDate(d), ts_pos_org: Math.floor(d.getTime()/1000),\r\n                                xmin: v[4], xmax: v[5], ymin: v[6], ymax: v[7], maxid: v[3],\r\n                                vessel_type: v[8], sog: v[9], cog: v[10], heading: v[11]\r\n                            };\r\n                            vessel.icon_rot = Math.round(vessel.cog/15)*15;\r\n                            _aisLayerSearcher.placeVesselTypeIcon(vessel);\r\n                            return vessel;\r\n                        })\r\n                    };\r\n                    if (_actualUpdate == actualUpdate) {\r\n                        //console.log(\"ALL CLEAN\")\r\n                        //console.log(\"1>\"+new Date(thisInst._actualUpdate))\r\n                        //console.log(\"2>\"+new Date(actualUpdate))\r\n                        thisInst.isDirty = false;\r\n                    }\r\n                    resolve();\r\n                }\r\n                else {\r\n                    reject(json);\r\n                }\r\n            });\r\n        })\r\n        , _myFleetModel.load()\r\n    ]);\r\n};\r\nScreenSearchModel.prototype.setFilter = function () {\r\n    this.filterString = this.filterString.replace(/\\r+$/, \"\");\r\n    if (this.dataSrc){\r\n        if (this.filterString != \"\") {\r\n            this.data = {\r\n                vessels: this.dataSrc.vessels.filter(((v)=>{\r\n                    return v.vessel_name.search(new RegExp(\"\\\\b\" + this.filterString, \"ig\")) != -1;\r\n                }).bind(this))\r\n            };\r\n        }\r\n        else {\r\n            this.data = { vessels: this.dataSrc.vessels.map((v)=>v) };\r\n        }\r\n    }\r\n};\r\nScreenSearchModel.prototype.update = function () {\r\n    if (!this.isDirty)\r\n        return;\r\n    _actualUpdate = new Date().getTime();\r\n    let thisInst = this,\r\n        actualUpdate = _actualUpdate;\r\n    this.view.inProgress(true);       \r\n\r\n    this.load(actualUpdate).then(function () {\r\n        if (_actualUpdate == actualUpdate) {\r\n//console.log(thisInst.dataSrc)\r\n            if (thisInst.dataSrc)\r\n                _myFleetModel.markMembers(thisInst.dataSrc.vessels);\r\n            thisInst.setFilter();                 \r\n            thisInst.view.inProgress(false);\r\n            thisInst.view.repaint();\r\n        }\r\n    }, function (json) {\r\n        thisInst.dataSrc = null;\r\n//console.logconsole.log(json)\r\n        if (json.Status.toLowerCase() == \"auth\" ||\r\n            (json.ErrorInfo && json.ErrorInfo.some && json.ErrorInfo.some(function (r) { return r.Status.toLowerCase() == \"auth\" })))\r\n            thisInst.data = { msg: [{ txt: _gtxt(\"AISSearch2.auth\") }], vessels: [] };\r\n        else {\r\n            //thisInst.data = {msg:[{txt:\"!!!\"}], vessels:[]};\r\n            console.log(json);\r\n        }\r\n        thisInst.view.inProgress(false);\r\n        thisInst.view.repaint();\r\n    });\r\n};\r\n\r\nmodule.exports = ScreenSearchModel;\n\n\n// WEBPACK FOOTER //\n// ./src/Models/ScreenSearchModel.js","require(\"./MyFleet.css\")\r\nconst BaseView = require('./BaseView.js');\r\nconst GroupList = require('../Controls/GroupList.js');\r\n\r\nconst _switchLegendIcon = function(showAlternative){\r\n    let ic = this.frame.find('.legend_icon'),\r\n    ica = this.frame.find('.legend_iconalt');\r\n    if (showAlternative){\r\n        ic.hide(); ica.show();\r\n    }\r\n    else{\r\n        ica.hide(); ic.show();\r\n    }\r\n},\r\n_clean = function(){  \r\n    this.frame.find('.ais_vessels input[type=\"checkbox\"]').off('click');    \r\n    this.startScreen.css({ visibility: \"hidden\" });\r\n};\r\n\r\nlet _tools, \r\n_displayedOnly=[], \r\n_notDisplayed=[],\r\n_saveLabelSettingsPromise = Promise.resolve(0);\r\nconst MyFleetView = function (model, tools){\r\n    BaseView.apply(this, arguments);\r\n    _tools = tools; \r\n    _tools.onLegendSwitched(((showAlternative)=>{\r\n        _switchLegendIcon.call(this, _tools.needAltLegend);\r\n    }).bind(this));\r\n\r\n    let settings = []; //DEFAULT SETTINGS\r\n    this.frame = $(Handlebars.compile('<div class=\"ais_view myfleet_view\">' +\r\n    '<table class=\"instruments\">'+\r\n    '<tr><td style=\"vertical-align:top; padding-right:0\">'+\r\n    '<div style=\"width:140px; margin-bottom: 8px;\">{{i \"AISSearch2.DisplaySection\"}}</div>' +\r\n    '<label class=\"sync-switch switch\"><input type=\"checkbox\">'+\r\n    '<div class=\"sync-switch-slider switch-slider round\"></div></label>' +\r\n    '<span class=\"sync-switch-slider-description\">{{i \"AISSearch2.myFleetOnly\"}}</span>'+    \r\n    '</td>' +\r\n    '<td style=\"padding-right:0\">' +\r\n    '<div style=\"width:120px;float:left;\" class=\"setting\"><label><input type=\"checkbox\" id=\"group_name\" ' + (settings.indexOf('group_name')<0?'':'checked') + '>{{i \"AISSearch2.DisplayGroupName\"}}</div>' +\r\n    '<div style=\"width:120px;float:left;\" class=\"setting\"><label><input type=\"checkbox\" id=\"vessel_name\" ' + (settings.indexOf('vessel_name')<0?'':'checked') + '>{{i \"AISSearch2.DisplayVesselName\"}}</label></div>' +\r\n    '<div style=\"width:70px;float:left;\" class=\"setting\"><label><input type=\"checkbox\" id=\"sog\" ' + (settings.indexOf('sog')<0?'':'checked') + '>{{i \"AISSearch2.DisplaySog\"}}</label></div>' +\r\n    '<div style=\"width:45px;float:left;\" class=\"setting\"><label><input type=\"checkbox\" id=\"cog\" ' + (settings.indexOf('cog')<0?'':'checked') + '>{{i \"AISSearch2.DisplayCog\"}}</label></div>' +\r\n    '</td>' +\r\n    '<td><div class=\"refresh\"><div>' + this.gifLoader + '</div></div></td></tr>' +\r\n\r\n    '<tr><td colspan=\"3\" style=\"padding-top:0\">' +\r\n    '<table><tr><td>{{i \"AISSearch2.NewGroup\"}}</td>' +\r\n    '<td><div class=\"newgroupname\"><input type=\"text\" placeholder=\"{{i \"AISSearch2.NewGroupName\"}}\"/></div></td>' +\r\n    '<td><img class=\"create clicable\" title=\"{{i \"AISSearch2.CreateGroup\"}}\" src=\"plugins/AIS/AISSearch/svg/add.svg\"></td>' +\r\n    '</tr></table>' +\r\n    '</td></tr>' +\r\n    '</table>'+ \r\n\r\n    '<div class=\"ais_vessels\">'+\r\n    '<table class=\"results\">'+\r\n    '<td><input type=\"checkbox\" checked></td>' +\r\n    '<td class=\"count\"></td></tr></table>'+\r\n    '<div class=\"ais_vessel\">' +\r\n    '<table border=0><tr>' +\r\n    '<td><input type=\"checkbox\" checked></td>' +\r\n    '<td><div class=\"position\">vessel_name</div><div>mmsi: mmsi imo: imo</div></td>' +\r\n    '<td></td>' +  \r\n    '<td><span class=\"date\">ts_pos_utc</span></td>'+\r\n    //'<td><div class=\"info\" vessel=\"aisjson this\" title=\"i AISSearch2.info\">' +\r\n    //'<img src=\"plugins/AIS/AISSearch/svg/info.svg\"><div></td>' +\r\n    '</tr></table>' +\r\n    '</div>' +      \r\n    '</div>' +\r\n\r\n    '<table class=\"start_screen\"><tr><td>' +\r\n    '<img src=\"plugins/AIS/AISSearch/svg/steer-weel.svg\">' +\r\n    '<div>{{{i \"AISSearh2.myfleet_view\"}}}' +\r\n    '</div></td></tr></table>' +\r\n\r\n    '</div>')());    \r\n\r\n    Object.defineProperty(this, \"topOffset\", {\r\n        get: function () {\r\n            let rv = $('.ais_tabs')[0].getBoundingClientRect().height + \r\n            this.frame.find('.instruments')[0].getBoundingClientRect().height;\r\n            return rv;\r\n        }\r\n    });  \r\n\r\n    this.container = this.frame.find('.ais_vessels');     \r\n    this.startScreen = this.frame.find('.start_screen');\r\n    // DEFAULT SETTINGS\r\n    // this.model.markerTemplate =  '<div><table><tr>' +\r\n    //     '<td style=\"vertical-align:top\">' +\r\n    //     //'<svg width=\"12\" height=\"11\" fill=\"#00f\" style=\"{{marker_style}}\" viewBox=\"0 0 260 245\"><use xlink:href=\"#mf_label_icon\"/></svg>' +\r\n    //     '{{{marker}}}' +\r\n    //     '</td><td>{{{foo}}}</td></tr></table></div>'; \r\n    \r\n    // craete group controller\r\n    let newGroupNameValid = function(ngn){\r\n        let isValid = ngn.search(/\\S/)!=-1;\r\n        this.model.data.groups.forEach(g=>{\r\n            if (isValid)\r\n                isValid = g.title!=ngn;\r\n        });\r\n        return isValid;\r\n    },\r\n    createGroup = function(ngn){\r\n        if (newGroupNameValid.call(this, ngn)){\r\n            this.inProgress(true);\r\n            this.model.createGroup(ngn)\r\n            .then((group)=>{\r\n                this.groupList.appendGroup(group, this.model.data.groups.length-1);\r\n                this.inProgress(false);\r\n            },\r\n            (error)=>{\r\n                this.inProgress(false);\r\n                console.log(error)\r\n            }\r\n            );\r\n        }        \r\n    };\r\n    this.frame.find('.instruments .create').on(\"click\", (e=>{\r\n        let input = this.frame.find('.instruments .newgroupname input'),\r\n        ngn = input.val();\r\n        input.val('');\r\n        createGroup.call(this, ngn);\r\n    }).bind(this))\r\n    this.frame.find('.instruments .newgroupname input').on(\"keyup\", (e=>{\r\n        let ngn = e.target.value;\r\n        if (e.keyCode==13){\r\n            e.target.value = '';\r\n            createGroup.call(this, ngn);\r\n        }\r\n    }).bind(this)); \r\n\r\n    // marker settings\r\n    this.frame.find('.instruments .setting input')\r\n    .on('change', (e=>{\r\n        let display = '';\r\n        this.frame.find('.instruments .setting input').each((i, e)=>{\r\n            if (e.checked)\r\n                display += \"{{{\" + e.id + \"}}}\";\r\n        });\r\n        if (display=='')\r\n            display = '{{{foo}}}';  \r\n        this.model.markerTemplate =  this.model.markerTemplate.replace(/<td>\\{\\{\\{.+\\}\\}\\}<\\/td>/, '<td>' + display + '</td>');\r\n        if (_displayedOnly.length)          \r\n            _tools.showVesselsOnMap(_displayedOnly);\r\n        else\r\n            _tools.showVesselsOnMap(\"all\"); \r\n            \r\n        _saveLabelSettingsPromise = _saveLabelSettingsPromise.then(((c)=>{return this.model.saveLabelSettings(c);}).bind(this));\r\n    }).bind(this));\r\n    \r\n    // visibility controller\r\n    this.frame.find('.instruments .switch input[type=\"checkbox\"]').on(\"click\", \r\n        function(e){\r\n            _displayedOnly.length = 0;\r\n            if (e.currentTarget.checked) {\r\n                _displayedOnly = this.model.vessels.map(v=>v.mmsi.toString());         \r\n                _tools.showVesselsOnMap(_displayedOnly);\r\n            }\r\n            else\r\n                _tools.showVesselsOnMap(\"all\"); \r\n//console.log(\"showVesselsOnMap\");            \r\n        }.bind(this)\r\n    ); \r\n\r\n    // group list\r\n    this.groupList = new GroupList(this.frame);\r\n    this.groupList.onRepaintItem = ((i, elm)=>{\r\n        elm.querySelector('input[type=checkbox]').checked = _notDisplayed.indexOf(elm.querySelector('.mmsi').innerText)<0;\r\n    }).bind(this);\r\n    this.groupList.onDeleteGroup = (group=>{\r\n        this.inProgress(true);\r\n        this.model.deleteGroup(group);\r\n    }).bind(this);\r\n    \r\n    this.tableTemplate = this.groupList.toString();\r\n};\r\n\r\nMyFleetView.prototype = Object.create(BaseView.prototype);\r\n\r\nObject.defineProperty(MyFleetView.prototype, \"notDisplayed\", {\r\n    get() {\r\n        return _notDisplayed;\r\n    }\r\n});\r\n\r\nMyFleetView.prototype.inProgress = function (state) {\r\n    let progress = this.frame.find('.refresh div');\r\n    if (state)\r\n        progress.show();\r\n    else\r\n        progress.hide();\r\n};\r\n\r\nMyFleetView.prototype.repaint = function () {\r\n    _clean.call(this);  \r\n    BaseView.prototype.repaint.apply(this, arguments);\r\n    // MEMBERS ON MAP\r\n    _displayedOnly.length = 0;\r\n    if (!this.model.vessels.length)\r\n        this.frame.find('.instruments .switch input[type=\"checkbox\"]')[0].checked = false;    \r\n    if (this.frame.find('.instruments .switch input[type=\"checkbox\"]')[0].checked) {\r\n        _displayedOnly = this.model.vessels.map(v=>v.mmsi.toString());         \r\n        _tools.showVesselsOnMap(_displayedOnly);\r\n    } \r\n    else         \r\n        _tools.showVesselsOnMap(\"all\");\r\n\r\n    _tools.hideVesselsOnMap(_notDisplayed); \r\n// console.log(\"showVesselsOnMap\");     \r\n// console.log(\"hideVesselsOnMap\");  \r\n    ///////////////// \r\n\r\n    let labelSettings = this.model.markerTemplate.match(/(?!\\{\\{\\{)[^\\{\\}]+(?=\\}\\}\\})/g),\r\n    labelSettingCtrl;\r\n    for (var i in labelSettings){\r\n        labelSettingCtrl = this.frame.find('.instruments .setting input#' + labelSettings[i])[0];\r\n        if (labelSettingCtrl)\r\n            labelSettingCtrl.checked = true;\r\n    }\r\n\r\n    this.groupList.repaint();  \r\n    \r\n    // GROUP LIST EVENTS\r\n    this.groupList.onCheckItem = function(uncheked){\r\n        if (uncheked.length)\r\n            _notDisplayed=uncheked.map(mmsi=>mmsi);\r\n        else\r\n            _notDisplayed.length = 0;\r\n        _tools.hideVesselsOnMap(uncheked);\r\n// console.log(\"hideVesselsOnMap\");\r\n    }\r\n    this.groupList.onChangeGroup = ((mmsi, group)=>{\r\n        let view = this;\r\n        this.inProgress(true);          \r\n        this.model.changeGroup(mmsi, group)\r\n        .then((r)=>{\r\n            view.repaint();\r\n            view.inProgress(false);  \r\n        })\r\n        .catch((err)=>{\r\n            console.log(err)\r\n            view.inProgress(false);   \r\n        });\r\n    }).bind(this);\r\n    this.groupList.onExcludeItem = ((ev, mmsi, i) => {\r\n            ev.stopPropagation();\r\n            let thisView = this;\r\n            let vessel = thisView.model.vessels[i];\r\n            \r\n            thisView.beforeExcludeMember(vessel.mmsi.toString());\r\n\r\n            let dlg = $('.ui-dialog:contains(\"' + vessel.mmsi + '\")');\r\n            if (dlg[0]){ \r\n                dlg.find('.button.addremove').click();\r\n            }\r\n            else{\r\n                thisView.model.changeMembers(vessel).then(function () {\r\n                    thisView.show();\r\n                })\r\n            }        \r\n    }).bind(this);    \r\n    this.groupList.onGroupMenuShow = ((group)=>{\r\n        let i = parseInt(group.replace(/gr/, ''), 10);\r\n        return {\r\n            marker_style:parseInt(this.model.data.groups[i].marker_style.replace(/#/, ''), 16),\r\n            label_color:parseInt(this.model.data.groups[i].label_color.replace(/#/, ''), 16),\r\n            label_shadow:parseInt(this.model.data.groups[i].label_shadow.color.replace(/#/, ''), 16)\r\n        };\r\n    }).bind(this);\r\n    this.groupList.onChangeGroupStyle = ((group, colors)=>{\r\n        let i = parseInt(group.replace(/gr/, ''), 10);\r\n        this.model.changeGroupStyle(i, colors);\r\n    }).bind(this);\r\n    this.groupList.onSaveGroupStyle = this.model.saveGroupStyle;\r\n    _switchLegendIcon.call(this, _tools.needAltLegend);\r\n};\r\n\r\nMyFleetView.prototype.beforeExcludeMember = function (strMmsi) {\r\n    _displayedOnly = _displayedOnly.filter(m => m != strMmsi);\r\n    _notDisplayed = _notDisplayed.filter(m => m != strMmsi);\r\n}\r\n\r\nMyFleetView.prototype.hide = function () {\r\n    BaseView.prototype.hide.apply(this, arguments); \r\n    _tools.showVesselsOnMap(\"all\");\r\n    _tools.hideVesselsOnMap([]);\r\n}\r\n\r\n// MyFleetView.prototype.show = function () {\r\n//     BaseView.prototype.show.apply(this, arguments);  \r\n//     _switchLegendIcon.call(this, _tools.needAltLegend);\r\n// }\r\n\r\nmodule.exports = MyFleetView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/MyFleetView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/MyFleet.css\n// module id = 11\n// module chunks = 0","const GroupWidget = require('./GroupWidget.js');\r\n\r\nlet _onRepaintItemHandler,\r\n_onCheckItem,\r\n_onExcludeItem,\r\n_onChangeGroup,\r\n_onDeleteGroup,\r\n_onGroupMenuShow,\r\n_onChangeGroupStyle,\r\n_rolledupGroups = {},\r\n_cp1, _cp2, _cp3,\r\n_getFiltered = function(){\r\n    let filtered = [];\r\n    let group = this.frame.find('.mf_group'), selectAll, selectOne;\r\n    for (let i = 0; i < group.length; i++){\r\n        selectAll = group.eq(i).find('.results input[type=\"checkbox\"]');\r\n        selectOne = group.eq(i).find('.ais_vessel input[type=\"checkbox\"]');\r\n        selectAll[0].checked = true;\r\n        for (let j = 0; j < selectOne.length; j++)\r\n            if (!selectOne[j].checked) {\r\n                filtered.push(selectOne[j].closest('.ais_vessel').querySelector('.mmsi').innerText);\r\n                selectAll[0].checked = false;\r\n            }\r\n    }\r\n    return filtered;\r\n},\r\n_setCheckBoxes = function(){\r\n    this.frame.find('.ais_vessel').each(_onRepaintItemHandler);            \r\n    this.frame.find('.results input[type=\"checkbox\"]')\r\n    .each((i,e)=>{\r\n        let check = true; \r\n        e.closest('.mf_group').querySelectorAll('input').forEach((e,i)=>check = check && e.checked); \r\n        e.checked = check;\r\n    });\r\n},\r\n_setGroupCommands = function(){\r\n    this.frame.find('.results input[type=\"checkbox\"]').off(\"click\").on(\"click\", ((e)=>{\r\n        let group = $(e.target).closest('.mf_group');\r\n        group.find('.ais_vessel input[type=\"checkbox\"]').each((i, elm)=>{\r\n            elm.checked = e.target.checked;\r\n        }) \r\n        let filtered = _getFiltered.call(this);\r\n        _onCheckItem(filtered);\r\n    }).bind(this)); \r\n           \r\n    this.frame.find('.results').off(\"contextmenu\").on(\"contextmenu\", (e=>{  \r\n        e.preventDefault();\r\n        let values= e.currentTarget.classList.values(), \r\n        cssClass, group;\r\n        while (!cssClass || !cssClass.done){\r\n            cssClass = values.next(); \r\n            group = cssClass.value;\r\n            if (group && group.search(/^gr\\d/)==0)\r\n                break;\r\n        }\r\n\r\n        let ctxMenu = this.contextMenu,//$('.mf_group_menu'),\r\n        evnt = e;\r\n        if (_cp1)\r\n            _cp1.remove();\r\n        if (_cp2)\r\n            _cp2.remove();   \r\n        if (_cp3)\r\n            _cp3.remove();           \r\n        ctxMenu.html('');\r\n        let colorChangeHandler = function(c, cs){\r\n            _groupStyleChanged = true;            \r\n            cs.style.backgroundColor = \"#\" + c;\r\n            let c1 = cp1.style.backgroundColor,\r\n            c2 = cp2.style.backgroundColor,\r\n            c3 = cp3.style.backgroundColor\r\n            _onChangeGroupStyle(group, {\r\n                marker_style: c1.substr(0,3)==\"rgb\" ? nsGmx.Utils.rgb2hex(c1) : c1,\r\n                label_color: c2.substr(0,3)==\"rgb\" ? nsGmx.Utils.rgb2hex(c2) : c2,\r\n                label_shadow: c3.substr(0,3)==\"rgb\" ? nsGmx.Utils.rgb2hex(c3) : c3 \r\n            })\r\n        },\r\n        colors = _onGroupMenuShow(group),\r\n        cp1 = nsGmx.Controls.createColorPicker(colors.marker_style, ()=>{}, ()=>{}, (c1, c2, c3)=>{colorChangeHandler(c2, cp1)}),\r\n        cp2 = nsGmx.Controls.createColorPicker(colors.label_color, ()=>{}, ()=>{}, (c1, c2, c3)=>{colorChangeHandler(c2, cp2)}),\r\n        cp3 = nsGmx.Controls.createColorPicker(colors.label_shadow, ()=>{}, ()=>{}, (c1, c2, c3)=>{colorChangeHandler(c2, cp3)});\r\n        _cp1 = document.querySelector(\"#\"+$(cp1).data('colorpickerId'));\r\n        _cp2 = document.querySelector(\"#\"+$(cp2).data('colorpickerId'));\r\n        _cp3 = document.querySelector(\"#\"+$(cp3).data('colorpickerId'));\r\n        $(_cp1).on('mouseleave', (e)=>{if(!e.relatedTarget || !e.relatedTarget.closest('.mf_group_menu')) _hideContextMenu.call(this, e); $(cp1).ColorPickerHide()});\r\n        $(_cp2).on('mouseleave', (e)=>{if(!e.relatedTarget || !e.relatedTarget.closest('.mf_group_menu')) _hideContextMenu.call(this, e); $(cp2).ColorPickerHide()});\r\n        $(_cp3).on('mouseleave', (e)=>{if(!e.relatedTarget || !e.relatedTarget.closest('.mf_group_menu')) _hideContextMenu.call(this, e); $(cp3).ColorPickerHide()});\r\n        cp1.title = \"\";\r\n        cp2.title = \"\";\r\n        cp3.title = \"\";\r\n        let div = $('<div class=\"command marker_color\"></div>');         \r\n        ctxMenu.append(div.append(cp1).append(\"<span>\"+_gtxt(\"AISSearch2.markerShadow\")+\"</span>\"));\r\n        div = $('<div class=\"command label_color\"></div>');         \r\n        ctxMenu.append(div.append(cp2).append(\"<span>\"+_gtxt('AISSearch2.labelColor')+\"</span>\"));\r\n        div = $('<div class=\"command label_shadow\"></div>');         \r\n        ctxMenu.append(div.append(cp3).append(\"<span>\"+_gtxt('AISSearch2.labelShadow')+\"</span>\"));\r\n        ctxMenu.append('<div class=\"command remove\">' + _gtxt(\"AISSearch2.DeleteGroupCommand\") + '</div>');\r\n        \r\n        $(cp1).on('click', e=>$(_cp1).offset({left:$('.colorpicker:visible').offset().left+20}));       \r\n        $(cp2).on('click', e=>$(_cp2).offset({left:$('.colorpicker:visible').offset().left+20}));       \r\n        $(cp3).on('click', e=>$(_cp3).offset({left:$('.colorpicker:visible').offset().left+20}));\r\n        ctxMenu.find('.command.marker_color').on(\"click\",(e)=>{            \r\n            $(cp1).click();\r\n        })\r\n        ctxMenu.find('.command.label_color').on(\"click\",(e)=>{             \r\n            $(cp2).click();\r\n        })\r\n        ctxMenu.find('.command.label_shadow').on(\"click\",(e)=>{             \r\n            $(cp3).click();\r\n        })\r\n        \r\n        if (e.currentTarget.querySelector(\".delete\")) {\r\n            ctxMenu.find('.command.remove').show().on(\"click\", (e) => {\r\n                _onDeleteGroup(evnt.currentTarget.querySelector('.title').innerText);\r\n                ctxMenu.hide();\r\n            })\r\n        }\r\n        else{\r\n            ctxMenu.find('.command.remove').hide();\r\n        }\r\n        ctxMenu.show();\r\n        ctxMenu[0].style.left = (e.clientX - 10) + \"px\";\r\n        if ((e.clientY - 10 + ctxMenu[0].offsetHeight) < window.innerHeight) {\r\n            ctxMenu[0].style.top = (e.clientY - 10) + \"px\";\r\n            ctxMenu[0].style.bottom = \"\";//\"auto\";\r\n        }\r\n        else {  \r\n            ctxMenu[0].style.bottom = (window.innerHeight - e.clientY - 10) + \"px\";\r\n            ctxMenu[0].style.top = \"\";//\"auto\";\r\n        }\r\n    }).bind(this));\r\n\r\n    this.frame.find('.results .upout').off(\"click\").on(\"click\", (e=>{\r\n        let arrow = e.currentTarget,\r\n            title = arrow.closest('.results').querySelector('.title').innerText,\r\n            cl = arrow.classList,\r\n            vessels = arrow.closest('.mf_group').querySelectorAll('.ais_vessel');\r\n        if (cl.contains('icon-down-open')){\r\n            cl.remove('icon-down-open');\r\n            cl.add('icon-right-open');\r\n            vessels.forEach(v=>v.style.display='none');\r\n            _rolledupGroups[title] = true;\r\n        }\r\n        else{\r\n            cl.add('icon-down-open');\r\n            cl.remove('icon-right-open');\r\n            vessels.forEach(v=>v.style.display='block');\r\n            delete(_rolledupGroups[title]);\r\n        }\r\n//console.log(_rolledupGroups)\r\n    }).bind(this))    \r\n    .each((i,el)=>{\r\n        let title = el.closest('.results').querySelector('.title').innerText;\r\n        if (_rolledupGroups[title]){\r\n            el.classList.remove('icon-right-open');\r\n            el.classList.add('icon-down-open');\r\n            el.click();            \r\n        }\r\n    });\r\n    _rolledupGroups = {};\r\n    this.frame.find('.results .icon-right-open').each((i, el) => {\r\n        _rolledupGroups[el.closest('.results').querySelector('.title').innerText] = true;\r\n    })\r\n\r\n    this.frame.find('.results .delete')\r\n    .off(\"click\").on(\"click\", (e=>{\r\n        _onDeleteGroup(e.currentTarget.closest('.results').querySelector('.title').innerText);\r\n    }).bind(this));\r\n},\r\n_onSaveGroupStyle,\r\n_groupStyleChanged,\r\n_saveStylePromise = Promise.resolve(0),\r\n_hideContextMenu = function (e){\r\n    this.contextMenu.hide();\r\n    //if (e.currentTarget.querySelector('.colorSelector') || e.currentTarget.classList.contains('colorpicker'))\r\n    if (_groupStyleChanged){\r\n        _groupStyleChanged = false;\r\n        _saveStylePromise = _saveStylePromise.then(_onSaveGroupStyle);\r\n    }\r\n};\r\n\r\nconst GroupList = function (frame) {\r\n    this.frame = frame;\r\n       \r\n    // context menu\r\n    this.contextMenu = $('<div class=\"mf_group_menu\"></div>')\r\n    .on('mouseleave', (e=>{\r\n        if(!e.relatedTarget || !e.relatedTarget.closest('.colorpicker')){\r\n            _hideContextMenu.call(this, e);\r\n            $('.colorpicker:visible').hide();\r\n        }\r\n    }).bind(this));\r\n    $('body').append(this.contextMenu); \r\n\r\n    this.repaint = function(){\r\n        _setCheckBoxes.call(this);\r\n        _setGroupCommands.call(this);\r\n\r\n        // exclude memeber control\r\n        this.frame.find('.ais_vessel .exclude').each((i, elm)=>{\r\n            $(elm).on('click', (ev)=>{\r\n                $(elm).off('click');\r\n                _onExcludeItem(ev, elm.closest('.ais_vessel').querySelector('.mmsi').innerText, i);\r\n            })\r\n        });\r\n\r\n        // memeber visibility control\r\n        this.frame.find('.ais_vessel input[type=\"checkbox\"]').each(((i, elm)=>{\r\n            $(elm).off('click').on('click', (e => {\r\n                e.stopPropagation();\r\n                let filtered = _getFiltered.call(this);\r\n                _onCheckItem(filtered);\r\n            }).bind(this));\r\n        }).bind(this));  \r\n        \r\n        // context menu event handler\r\n        this.frame.find('.ais_vessel').off(\"contextmenu\").on(\"contextmenu\", (e=>{\r\n            e.preventDefault();\r\n            let mmsi = e.currentTarget.querySelector('.mmsi'),\r\n            ctxMenu = this.contextMenu,//$('.mf_group_menu'),\r\n            groupblock = e.currentTarget.closest('.mf_group'),\r\n            group = groupblock.querySelector('.results .title').innerText,\r\n            groups = this.frame.find('.results .title'),\r\n            template = '';\r\n            if (groups.length==1)\r\n                return;\r\n\r\n            groups.each((i,g)=>{\r\n                if (i>0 && g.innerText!=group)\r\n                    template += ('<div class=\"command\">' + g.innerText + '</div>');\r\n            });\r\n            if (template!='')\r\n                template = ('<div>' + _gtxt(\"AISSearch2.AddIntoGroup\") + '</div>') + template;\r\n            if (groupblock.previousSibling){\r\n                if (template!='')\r\n                    template += ('<div class=\"command remove\">' + _gtxt(\"AISSearch2.RemoveFromGroup\") + '</div>');\r\n                else\r\n                    template += ('<div class=\"command remove lonely\">' + _gtxt(\"AISSearch2.RemoveFromGroup\") + '</div>');\r\n            }\r\n            ctxMenu.html(template);\r\n            \r\n            ctxMenu.find('.command').on(\"click\",(e)=>{\r\n                if(!e.currentTarget.classList.contains('remove'))\r\n                    _onChangeGroup(mmsi.innerText, e.currentTarget.innerText);\r\n                else\r\n                    _onChangeGroup(mmsi.innerText, null);                \r\n                ctxMenu.hide();\r\n            });\r\n            ctxMenu.show();\r\n            ctxMenu[0].style.left = (e.clientX - 10) + \"px\";\r\n            if ((e.clientY - 10 + ctxMenu[0].offsetHeight) < window.innerHeight) {\r\n                ctxMenu[0].style.top = (e.clientY - 10) + \"px\";\r\n                ctxMenu[0].style.bottom = \"\";//\"auto\";\r\n            }\r\n            else {  \r\n                ctxMenu[0].style.bottom = (window.innerHeight - e.clientY - 10) + \"px\";\r\n                ctxMenu[0].style.top = \"\";//\"auto\";\r\n            }\r\n        }).bind(this));       \r\n    };\r\n\r\n    // events\r\n    Object.defineProperty(this, \"onChangeGroup\", {\r\n        set: function (callback) {\r\n            _onChangeGroup = callback;\r\n        }\r\n    });\r\n    Object.defineProperty(this, \"onDeleteGroup\", {\r\n        set: function (callback) {\r\n            _onDeleteGroup = callback;\r\n        }\r\n    });\r\n    Object.defineProperty(this, \"onRepaintItem\", {\r\n        set: function (callback){\r\n            _onRepaintItemHandler = callback;\r\n        }\r\n    }); \r\n    Object.defineProperty(this, \"onCheckItem\", {\r\n        set: function (callback){\r\n            _onCheckItem = callback;\r\n        }\r\n    }); \r\n    Object.defineProperty(this, \"onExcludeItem\", {\r\n        set: function (callback){\r\n            _onExcludeItem = callback;\r\n        }\r\n    }); \r\n    Object.defineProperty(this, \"onGroupMenuShow\", {\r\n        set: function (callback){\r\n            _onGroupMenuShow = callback;\r\n        }\r\n    }); \r\n    Object.defineProperty(this, \"onChangeGroupStyle\", {\r\n        set: function (callback){\r\n            _onChangeGroupStyle = callback;\r\n        }\r\n    }); \r\n    Object.defineProperty(this, \"onSaveGroupStyle\", {\r\n        set: function (callback){\r\n            _onSaveGroupStyle = callback;\r\n        }\r\n    }); \r\n      \r\n    // template\r\n    this.toString = function () {\r\n        return '{{#each groups}}' + GroupWidget.prototype.toString.call() + '{{/each}}' +\r\n            '{{#each msg}}<div class=\"msg\">{{txt}}</div>{{/each}}';\r\n    } \r\n}\r\n\r\nGroupList.prototype.appendGroup = function(group, index){\r\n    this.frame.find('.mf_group').eq(0).parent().append(Handlebars.compile(GroupWidget.prototype.toString.call().replace(/\\{\\{@index\\}\\}/, index))(group));    \r\n    _setGroupCommands.call(this);\r\n}\r\n\r\nmodule.exports = GroupList;\n\n\n// WEBPACK FOOTER //\n// ./src/Controls/GroupList.js","const GroupWidget = function (title){\r\n    \r\n}\r\n\r\nGroupWidget.prototype.toString = function () {\r\n    return '<div class=\"mf_group\">' +\r\n    '<table class=\"results gr{{@index}}\"><tr>'+\r\n    '<td><input type=\"checkbox\" checked><div class=\"upout clicable ui-helper-noselect icon-down-open\" style=\"float: right;\"></div></td>' +\r\n    '<td><span class=\"title\">{{title}}</span></td>' +\r\n    '<td class=\"count\">{{vessels.length}}</td>' +    \r\n    '<td>' +\r\n    '{{#unless default}}' +\r\n    '<img class=\"delete clicable\" title=\"{{i \"AISSearch2.DeleteGroup\"}}\" src=\"plugins/AIS/AISSearch/svg/delete.svg\">' +\r\n    '</td>' +\r\n    '{{/unless}}' +\r\n    '</tr></table>'+\r\n    '{{#each vessels}}' +\r\n    //'{{#unless foovessel}}' +\r\n    '<div class=\"ais_vessel\">' +\r\n    '<table border=0><tr>' +\r\n    '<td><input type=\"checkbox\" checked></td>' +\r\n    '<td><div class=\"position\">{{vessel_name}}</div><div>mmsi: <span class=\"mmsi\">{{mmsi}}</span> imo: <span class=\"imo\">{{imo}}</span></div></td>' +\r\n    '<td><img src=\"{{icon}}\" class=\"course rotateimg{{icon_rot}} legend_icon\"><img src=\"{{iconAlt}}\" class=\"course rotateimg{{icon_rot}} legend_iconalt\">' +\r\n    '<div class=\"info\" vessel=\"{{aisjson this}}\" title=\"{{i \"AISSearch2.info\"}}\">' +\r\n    '<img src=\"plugins/AIS/AISSearch/svg/info.svg\"></div>' +\r\n    '</td>' +\r\n    '<td>' +\r\n    '<div class=\"ais_info_dialog_close-button exclude\" title=\"{{i \"AISSearch2.vesselExclude\"}}\"></div>' +\r\n    '<span class=\"date\">{{dt_pos_utc}}</span></td>' +\r\n    '</tr></table>' +\r\n    '</div>' +\r\n    //'{{/unless}}' +\r\n    '{{/each}}</div>';\r\n}\r\n\r\nmodule.exports = GroupWidget;\n\n\n// WEBPACK FOOTER //\n// ./src/Controls/GroupWidget.js","const Polyfill = require('../Polyfill');\r\nlet emptyGroup = function(title, isDefault, id, style, updateTemplate){\r\n    let ms = \"#ffff00\",\r\n    lsc = \"#ffff00\",\r\n    ls = {\"color\":\"#ffff00\",\"text_shadow\": \"-1px -1px 0 #ffff00, 0px -1px 0 #ffff00, 1px -1px 0 #ffff00, -1px  0px 0 #ffff00, 1px  0px 0 #ffff00, -1px  1px 0 #ffff00, 0px  1px 0 #ffff00, 1px  1px 0 #ffff00\"},\r\n    eg = {\r\n    title: title,\r\n    vessels: [],\r\n    get marker_style(){return ms}, \r\n    set marker_style(c){ms = c},\r\n    //label_shadow:\"color:black;-webkit-text-stroke:1px yellow;\"\r\n    label_color: \"#000000\",\r\n    get label_shadow_color(){return lsc},\r\n    get label_shadow(){return ls},\r\n    set label_shadow(c){ \r\n        lsc = c;\r\n        ls = {\"color\": c, \"text_shadow\": \"-1px -1px 0 \" + c + \", 0px -1px 0 \" + c + \", 1px -1px 0 \" + c + \", -1px  0px 0 \" + c + \", 1px  0px 0 \" + c + \", -1px  1px 0 \" + c + \", 0px  1px 0 \" + c + \", 1px  1px 0 \" + c + \"\"}\r\n    }\r\n    };\r\n    if (isDefault) eg.default = true;\r\n    if (style)\r\n    {\r\n        style = JSON.parse(style);\r\n        eg.marker_style = style.ms;\r\n        eg.label_color = style.lc;\r\n        eg.label_shadow = style.lsc;\r\n        if (isDefault && style.mt && updateTemplate)\r\n            _markerTemplate = style.mt;\r\n    }\r\n    eg.id = id;\r\n    return eg;\r\n}\r\n\r\nconst VesselData = function () {\r\n    this.groups = []\r\n};\r\n\r\nlet _tools,\r\n_isDirty = true,\r\n_myFleetLayers = [],\r\n_defaultGroup = _gtxt(\"AISSearch2.AllGroup\"),\r\n_vessels = [],\r\n_mapID,\r\n_prepared,\r\n_actualUpdate,\r\n_markerTemplate = '<div><table><tr>' +\r\n'<td style=\"vertical-align:top\">' +\r\n//'<svg width=\"12\" height=\"11\" fill=\"#00f\" style=\"{{marker_style}}\" viewBox=\"0 0 260 245\"><use xlink:href=\"#mf_label_icon\"/></svg>' +\r\n'{{{marker}}}' +\r\n'</td><td>{{{foo}}}</td></tr></table></div>',\r\n_data,\r\n_view,\r\n_aisLayerSearcher,\r\n_onChangedHandlers = [],\r\n_fireChanged = function(){ _onChangedHandlers.forEach(h=>h()); },\r\n_loadVoyageInfo = function (vessels) {   \r\n    return new Promise(function (resolve, reject) {\r\n        if (!vessels.length){\r\n            reject();\r\n            return;\r\n        }\r\n\r\n        let data;\r\n        if (Polyfill.findIndex(vessels, v=>v.mmsi || v.imo)<0){\r\n            data = _parseVoyageInfo({Result:{fields:[], values:[]}}, vessels); \r\n            resolve(data);\r\n        } \r\n        else\r\n            _aisLayerSearcher.searchNames(\r\n                vessels,\r\n                function (response) {\r\n                    if (response.Status && response.Status.toLowerCase() == \"ok\") {\r\n                        data = _parseVoyageInfo(response, vessels);\r\n                        resolve(data);\r\n                    }\r\n                    else {\r\n                        reject(response);\r\n                    }\r\n                });\r\n    });\r\n},\r\n_compareGroups = function(l, r){\r\n    if (l.default)\r\n        return -1;\r\n    if (r.default)\r\n        return 1;        \r\n    if (l.id<r.id)\r\n        return -1;\r\n    if (l.id>r.id)\r\n        return 1;        \r\n    return 0;\r\n},\r\n_parseVoyageInfo = function (response, vessels) {\r\n        let mmsi = response.Result.fields.indexOf(\"mmsi\"),\r\n            vessel_name = response.Result.fields.indexOf(\"vessel_name\"),\r\n            ts_pos_utc = response.Result.fields.indexOf(\"ts_pos_utc\"),\r\n            imo = response.Result.fields.indexOf(\"imo\"),\r\n            lat = response.Result.fields.indexOf(\"longitude\"),\r\n            lon = response.Result.fields.indexOf(\"latitude\"),\r\n            vt = response.Result.fields.indexOf(\"vessel_type\"),\r\n            cog = response.Result.fields.indexOf(\"cog\"),\r\n            sog = response.Result.fields.indexOf(\"sog\"),\r\n            data,\r\n            eg;\r\n        if (_data){ // _data.groups.length>1 || _data.groups[0].vessels_length>0\r\n            data = _data;\r\n            data.groups.forEach(g=>g.vessels.length=0);\r\n        }\r\n        else{\r\n            data = new VesselData();\r\n            vessels.forEach(v=>{\r\n                if (!v.mmsi && !v.imo){\r\n                    if (v.group)\r\n                        eg = emptyGroup(v.group, false, v.gmx_id, v.style, true);\r\n                    else\r\n                        eg = emptyGroup(_defaultGroup, true, v.gmx_id, v.style, true);\r\n                    data.groups.push(eg);\r\n                }\r\n            });\r\n            data.groups.sort(_compareGroups);\r\n//console.log(data);\r\n        }\r\n        response.Result.values.forEach(c => {\r\n            let d = new Date(c[ts_pos_utc] * 1000),\r\n                member = {\r\n                    vessel_name: c[vessel_name], mmsi: c[mmsi], imo: c[imo],\r\n                    ts_pos_utc: _aisLayerSearcher.formatDateTime(d), dt_pos_utc: _aisLayerSearcher.formatDate(d),\r\n                    ts_pos_org: c[ts_pos_utc],\r\n                    xmin: c[lat], xmax: c[lat], ymin: c[lon], ymax: c[lon],\r\n                    vessel_type: c[vt], cog: c[cog], sog: c[sog]\r\n                };\r\n            member.icon_rot = Math.round(member.cog / 15) * 15;\r\n            _aisLayerSearcher.placeVesselTypeIcon(member);\r\n\r\n            let i = Polyfill.findIndex(vessels, function (v) {\r\n                return v.mmsi == member.mmsi;\r\n            }),\r\n                gn = i<0 ? \"\" : (!vessels[i].group ? _defaultGroup : vessels[i].group);\r\n            if (gn != \"\") {\r\n                i = Polyfill.findIndex(data.groups, function (g) {\r\n                    return g.title == gn;\r\n                });\r\n                data.groups[i].vessels.push(member);\r\n            }\r\n        });\r\n\r\n        //thisInst.data.vessels.sort(function (a, b) { return +(a.vessel_name > b.vessel_name) || +(a.vessel_name === b.vessel_name) - 1; })\r\n//console.log(\"PARSE VI \" + data.groups.reduce((p,c)=>p+c.vessels.length, 0))\r\n        return data;\r\n}\r\n\r\nmodule.exports = function ({aisLayerSearcher, toolbox}) {    \r\n    _tools = toolbox;\r\n    _aisLayerSearcher = aisLayerSearcher;\r\n    _mapID = String($(_queryMapLayers.buildedTree).find(\"[MapID]\")[0].gmxProperties.properties.MapID);\r\n    let addGroupField = function(lid, resolve, reject, vessels){\r\nconsole.log(\"add group and style field\");\r\n        sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl + 'VectorLayer/Update.ashx?VectorLayerID=' + lid +\r\n            '&columns=[{\"Name\":\"mmsi\",\"OldName\":\"mmsi\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"mmsi\\\\\"\"},{\"Name\":\"imo\",\"OldName\":\"imo\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"imo\\\\\"\"},{\"Name\":\"gmx_id\",\"OldName\":\"gmx_id\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":true,\"IsIdentity\":true,\"IsComputed\":false,\"expression\":\"\\\\\"gmx_id\\\\\"\"},{\"Name\":\"group\",\"OldName\":\"group\",\"ColumnSimpleType\":\"String\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"group\\\\\"\"},{\"Name\":\"style\",\"ColumnSimpleType\":\"String\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"style\\\\\"\"}]',\r\n            function (response) {\r\n                if (response.Status.toLowerCase() == \"ok\")\r\n                    setTimeout(function run() {\r\n                        sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                            \"AsyncTask.ashx?TaskID=\" + response.Result.TaskID, function (response) {\r\n                                if (response.Status.toLowerCase() == \"ok\")\r\n                                    if (!response.Result.Completed)\r\n                                        setTimeout(run, 1000);\r\n                                    else {\r\n                                        if(response.Result.ErorInfo)\r\n                                            reject(response);\r\n                                        else\r\n                                            resolve(vessels);\r\n                                    }\r\n                                else \r\n                                    reject(response);\r\n                            });\r\n                    }, 1000);\r\n            });\r\n        },  \r\n        addDefaultGroup = function(resolve, reject, vessels){\r\n            sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                'VectorLayer/ModifyVectorObjects.ashx?LayerName=' + _myFleetLayers[0] +\r\n                '&objects=[{\"properties\":{\"group\": null},\"action\":\"insert\"}]',\r\n                function (response) {\r\n                    if (response.Status.toLowerCase() == \"ok\") {                           \r\n                        sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                            'VectorLayer/Search.ashx?layer=' + _myFleetLayers[0] +\r\n                            '&query=\"group\" is null and \"mmsi\" is null and \"imo\" is null',\r\n                            function (response) {                                          \r\n                                if (response.Status.toLowerCase() == \"ok\" && response.Result.values && response.Result.values.length>0) {\r\n                                    let f = response.Result.fields, v = response.Result.values;  \r\n                                    console.log(\"insert def group\");\r\n                                    vessels.push({imo:null, mmsi:null, group:null, gmx_id:v[0][f.indexOf('gmx_id')]});\r\n                                    resolve(vessels);\r\n                                }\r\n                                else\r\n                                    reject(response);\r\n                            })\r\n                    }\r\n                    else\r\n                        reject(response);\r\n                }\r\n            ); \r\n        },\r\n        fetchMyFleet = function (lid) {\r\n            return new Promise(function (resolve, reject) {\r\n                sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl + \"VectorLayer/Search.ashx?layer=\" + lid,\r\n                    function (response) {\r\n                        if (response.Status.toLowerCase() == \"ok\") {\r\n                            let v = response.Result.values,\r\n                                f = response.Result.fields,\r\n                                vessels = [];\r\n                            for (let i = 0; i < v.length; ++i) {\r\n                                vessels.push({})\r\n                                for (let j = 0; j < f.length; ++j){\r\n                                    vessels[i][f[j]] = v[i][j];\r\n                                }\r\n                            }\r\n\r\n                            new Promise((rs, rj)=>{\r\n                                if (f.indexOf('group')<0 || f.indexOf('style')<0)\r\n                                    addGroupField(lid, rs, rj, vessels);\r\n                                else \r\n                                    rs();\r\n                            }).then(()=>{\r\n                                if (Polyfill.findIndex(vessels, v=>!v.imo&&!v.mmsi&&!v.group)<0)\r\n                                    addDefaultGroup(resolve, reject, vessels);\r\n                                else\r\n                                    resolve(vessels);\r\n                            },  r=>reject(r));\r\n                        }\r\n                        else\r\n                            reject(response);\r\n                    });\r\n            })\r\n        };\r\n\r\n    _prepared = new Promise((resolve, reject) => {\r\n        sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n            \"User/GetUserInfo.ashx\",\r\n            function (response) {\r\n                if (response.Status.toLowerCase() == \"ok\" && response.Result)\r\n                    resolve(response);\r\n                if (response.Status.toLowerCase() == \"ok\" && !response.Result)\r\n                    reject({Status:\"auth\"});\r\n                else\r\n                    reject(response);\r\n            });\r\n    })\r\n    .then((response) => {\r\n            let nickname = response.Result.Nickname;\r\n            return new Promise((resolve, reject) => {\r\n                sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                    \"Layer/Search2.ashx?page=0&pageSize=50&orderby=title &query=([Title]='myfleet\" + _mapID + \"' and [OwnerNickname]='\" + nickname + \"')\",\r\n                    function (response) {\r\n                        if (response.Status.toLowerCase() == \"ok\" && response.Result.count > 0)\r\n                            resolve(response);\r\n                        else \r\n                            reject(response); // no my fleet layer\r\n                    });\r\n            });\r\n    })\r\n    .then((response) => {\r\n            let lid = response.Result.layers[0].LayerID;\r\n            _myFleetLayers.push(lid);\r\n            return fetchMyFleet(lid)\r\n        }\r\n        ,(rejectedResponse) => {\r\n            if (rejectedResponse.Status && rejectedResponse.Status.toLowerCase() == \"ok\")\r\n                return Promise.resolve([]); // no mf layer\r\n            else\r\n                return Promise.reject(rejectedResponse); // smth wrong\r\n        }\r\n    )\r\n    .then((vessels=>{\r\n//console.log('INIT REPAINT MAP')\r\n        _vessels = vessels.map(v=>v);\r\n        _tools.specialVesselFilters = {key: \"drawMarker\", value: (args, ai, displayed)=>{          \r\n            let vessel = Polyfill.find(_vessels, v=>{\r\n                return v.mmsi && v.mmsi==args.properties[ai.mmsi];\r\n            })\r\n            if (vessel){\r\n                let group = Polyfill.find(_vessels, v=>(!v.mmsi && !v.imo && v.group==vessel.group));\r\n                if (vessel.group)\r\n                    group = emptyGroup(vessel.group, false, group.gmx_id, group.style);\r\n                else\r\n                    group = emptyGroup(_defaultGroup, true, group.gmx_id, group.style);\r\n                _tools.drawMyFleetMarker(args, _markerTemplate, group, ai, \r\n                    (displayed==\"all\" || displayed.indexOf(vessel.mmsi.toString())>=0) && _view.notDisplayed.indexOf(vessel.mmsi.toString())<0);\r\n            }\r\n        }}\r\n        // _repaintMap(vessels); // only on init\r\n        return Promise.resolve();\r\n    }).bind(this));\r\n\r\n    return {\r\n        get isDirty() { return _isDirty; },\r\n        set isDirty(value) { _isDirty = value; },\r\n        get data() { return _data; },\r\n        set data(value) { _data = value; },\r\n        get view() { return _view; },\r\n        set view(value) { _view = value; },\r\n        get vessels(){\r\n            let myfleet = _data.groups.reduce((p, c) => {\r\n                c.vessels.forEach(v=>{if(v.mmsi)p.push({mmsi:v.mmsi, imo:v.imo})});\r\n                return p;\r\n            }, []);\r\n            return myfleet;\r\n        },\r\n        findIndex: function (vessel) {\r\n            if (_vessels.length == 0)\r\n                return -1;\r\n            return Polyfill.findIndex(_vessels, function (v) {\r\n                return v.mmsi == vessel.mmsi && v.imo == vessel.imo;\r\n            })\r\n        },\r\n        load: function (actualUpdate) {\r\n            var thisInst = this;\r\n            return _prepared.then(()=>{\r\n                if (_myFleetLayers.length == 0 || !thisInst.isDirty)\r\n                    return Promise.resolve();\r\n\r\n                return fetchMyFleet(_myFleetLayers[0]) \r\n                    .then(vessels=>{\r\n                        _vessels = vessels;\r\n                        return _loadVoyageInfo(vessels);\r\n                    })\r\n                    .then(data=>{\r\n                        _data=data;\r\n                        _isDirty = false;\r\n                        return Promise.resolve();\r\n                    })\r\n                    .catch(error=>{\r\n                        _isDirty = false;\r\n                        return Promise.reject(error);\r\n                    });\r\n            });\r\n        },\r\n        update: function () {\r\n            _actualUpdate = new Date().getTime();\r\n            let thisModel = this,\r\n                actualUpdate = _actualUpdate;\r\n            this.view.inProgress(true);\r\n            this.load(actualUpdate).then(\r\n                function () {\r\n                    if (_actualUpdate == actualUpdate) {\r\n                        thisModel.view.inProgress(false);\r\n                        if (_data)\r\n                            thisModel.view.repaint();\r\n                    }\r\n                }, \r\n                function (json) {\r\n                    thisModel.dataSrc = null;\r\n                    if ((json.Status && json.Status.toLowerCase() == \"auth\") ||\r\n                        (json.ErrorInfo && json.ErrorInfo.some && json.ErrorInfo.some(function (r) { return r.Status.toLowerCase() == \"auth\" })))\r\n                        thisModel.data = { msg: [{ txt: _gtxt(\"AISSearch2.auth\") }], groups: [] };\r\n                    else {\r\n                        //thisModel.data = {msg:[{txt:\"!!!\"}], vessels:[]};\r\n                        console.log(json);\r\n                    }\r\n                    thisModel.view.inProgress(false);\r\n                    thisModel.view.repaint();\r\n                });\r\n        },\r\n        get markerTemplate(){\r\n            return _markerTemplate;\r\n        },\r\n        set markerTemplate(v){_markerTemplate = v;},\r\n        markMembers: function (vessels) {\r\n            if (this.data && this.data.groups){\r\n                let membCounter = 0;\r\n                this.data.groups.forEach(function (g) {\r\n                    g.vessels.forEach(function (v) {\r\n                        let i = Polyfill.findIndex(vessels, function (vv) { return v.mmsi == vv.mmsi && v.imo == v.imo });\r\n                        if (i>-1){\r\n                            let member = vessels[i]\r\n                            member.mf_member = \"visibilty:visible\";\r\n                            vessels.splice(i, 1);\r\n                            vessels.splice(membCounter++, 0, member);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        },\r\n        createGroup: function(name){\r\n            if (!_myFleetLayers.length)\r\n                return Promise.reject({Status:\"error\", ErrorInfo:\"no data\"});\r\n\r\n            return new Promise((resolve, reject)=>{\r\n                sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                    'VectorLayer/ModifyVectorObjects.ashx?LayerName=' + _myFleetLayers[0] +\r\n                    '&objects=[{\"properties\":{ \"group\": \"' + name.replace(/\"/g, '\\\\\\\"') + '\"},\"action\":\"insert\"}]',\r\n                    function (response) {\r\n                        if (response.Status.toLowerCase() == \"ok\") {                           \r\n                            sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                                'VectorLayer/Search.ashx?layer=' + _myFleetLayers[0] +\r\n                                '&query=\"group\"=\\'' + name.replace(/'/g, \"''\") + '\\'',\r\n                                function (response) {                                          \r\n                                    if (response.Status.toLowerCase() == \"ok\" && response.Result.values && response.Result.values.length>0) {\r\n                                        let f = response.Result.fields, v = response.Result.values;  \r\n                                        let group = emptyGroup(name, false, v[0][f.indexOf('gmx_id')]);\r\n                                        _data.groups.push(group);\r\n                                        _vessels.push({gmx_id: v[0][f.indexOf('gmx_id')], mmsi:null, imo:null, group:name})\r\n                                        resolve(group);\r\n                                    }\r\n                                    else\r\n                                        reject(response);\r\n                                })\r\n                        }\r\n                        else\r\n                            reject(response);\r\n                    }\r\n                ); \r\n            });\r\n        },\r\n        deleteGroup: function(group){\r\n            let objects = [], thisModel = this, i, j=-1;\r\n            for (i = 0; i < _vessels.length; ++i) {\r\n                if (_vessels[i].group == group) {\r\n                    if (!_vessels[i].mmsi && !_vessels[i].imo) {\r\n                        j = i;\r\n                        objects.push({ id: _vessels[i].gmx_id, action: \"delete\" });\r\n                    }\r\n                    else {\r\n                        _vessels[i].group = null;\r\n                        objects.push({ properties: _vessels[i], id: _vessels[i].gmx_id, action: \"update\" });\r\n                    }\r\n                }\r\n            }\r\n            if (j<0)\r\n                return;\r\n            i = Polyfill.findIndex(_data.groups, g=>g.id==_vessels[j].gmx_id);\r\n// console.log(i+\", \"+j + \" - \"+ _data.groups[i].id +\" \"+_vessels[j].gmx_id);    \r\n            _data.groups.splice(i, 1);\r\n            _data.groups.sort(_compareGroups);\r\n// console.log(_data.groups)\r\n// console.log(_vessels);            \r\n            _vessels.splice(j, 1);\r\n            sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                'VectorLayer/ModifyVectorObjects.ashx?LayerName=' + _myFleetLayers[0] +\r\n                '&objects=' + JSON.stringify(objects),\r\n                function (response) {\r\n                    if (response.Status.toLowerCase() == \"ok\") {\r\n                        thisModel.isDirty = true;\r\n                        thisModel.update();\r\n                    }\r\n                    else\r\n                        console.log(response);\r\n                }\r\n            ); \r\n        },\r\n        set onChanged(callback){ _onChangedHandlers.push(callback) },\r\n        changeMembers: function (vessel) {\r\n            var remove = false;\r\n            for (var i = 0; i < _vessels.length; ++i) {\r\n                if (_vessels[i].imo == vessel.imo && _vessels[i].mmsi == vessel.mmsi) {\r\n                    remove = _vessels[i].gmx_id;\r\n                    _vessels.splice(i, 1);\r\n                    //_tools.eraseMyFleetMarker(vessel.mmsi);\r\n                }\r\n            }\r\n            return new Promise((resolve, reject) => {\r\n                if (!_myFleetLayers.length){\r\n                    sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                        'VectorLayer/CreateVectorLayer.ashx?Title=myfleet' + _mapID + '&geometrytype=point&Columns=' +\r\n                        '[{\"Name\":\"mmsi\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"mmsi\\\\\"\"},{\"Name\":\"imo\",\"ColumnSimpleType\":\"Integer\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"imo\\\\\"\"},{\"Name\":\"group\",\"ColumnSimpleType\":\"String\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"group\\\\\"\"},{\"Name\":\"style\",\"ColumnSimpleType\":\"String\",\"IsPrimary\":false,\"IsIdentity\":false,\"IsComputed\":false,\"expression\":\"\\\\\"style\\\\\"\"}]',\r\n                        function (response) {\r\n                            if (response.Status.toLowerCase() == \"ok\") {\r\n                                _myFleetLayers.push(response.Result.properties.name);\r\n                                addDefaultGroup(resolve, reject, []);\r\n                            }\r\n                            else\r\n                                reject(response); // creation failed\r\n                        }\r\n                    );\r\n                }\r\n                else\r\n                    resolve();\r\n            })\r\n            .then(()=>{\r\n                return new Promise((resolve, reject) => {\r\n                    if (!remove)\r\n                        sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                            'VectorLayer/ModifyVectorObjects.ashx?LayerName=' + _myFleetLayers[0] +\r\n                            '&objects=[{\"properties\":{ \"imo\": ' + vessel.imo + ', \"mmsi\": ' + vessel.mmsi + '},\"action\":\"insert\"}]',\r\n                            function (response) {\r\n                                if (response.Status.toLowerCase() == \"ok\") {\r\n                                    resolve();\r\n                                    _vessels.push({ \"mmsi\": vessel.mmsi, \"imo\": vessel.imo, \"gmx_id\": response.Result[0] });\r\n                                }\r\n                                else\r\n                                    reject(response);\r\n                            })\r\n                    else\r\n                        sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                            'VectorLayer/ModifyVectorObjects.ashx?LayerName=' + _myFleetLayers[0] +\r\n                            '&objects=[{\"id\":' + remove + ',\"action\":\"delete\"}]',\r\n                            function (response) {\r\n                                if (response.Status.toLowerCase() == \"ok\")\r\n                                    resolve();\r\n                                else\r\n                                    reject(response);\r\n                            })\r\n                })\r\n                .then(\r\n                function () {\r\n                    this.isDirty = true;\r\n                    _fireChanged();\r\n                    return Promise.resolve();\r\n                }.bind(this),\r\n                function (response) {\r\n                    console.log(response);\r\n                    this.isDirty = true;\r\n                    return Promise.resolve();\r\n                }.bind(this));\r\n            });\r\n        },\r\n        changeGroup: function(mmsi, group)  {   \r\n            let i=Polyfill.findIndex(_vessels, (v)=>{return v.mmsi==mmsi})\r\n            if (i<0) \r\n                return Promise.reject(mmsi);\r\n            _vessels[i].group = group;\r\n            return new Promise((resolve, reject)=>{\r\n                sendCrossDomainJSONRequest(aisLayerSearcher.baseUrl +\r\n                    'VectorLayer/ModifyVectorObjects.ashx?LayerName=' + _myFleetLayers[0] +\r\n                    '&objects=[' +\r\n                    '{\"properties\":' + JSON.stringify(_vessels[i]) +\r\n                    ',\"id\":' + _vessels[i].gmx_id + ',\"action\":\"update\"}]', (r)=>{\r\n                    if (r.Status && r.Status.toLowerCase()==\"ok\"){\r\n                        let i, j, found = false;\r\n                        for (i=0; i<_data.groups.length; ++i){\r\n                            for (j=0; j<_data.groups[i].vessels.length; ++j){\r\n                                found = _data.groups[i].vessels[j].mmsi==mmsi;\r\n                                if (found) break;\r\n                            }                            \r\n                            if (found) break; \r\n                        } \r\n                        let temp = _data.groups[i].vessels.splice(j, 1)[0];\r\n                        i = !group?0:Polyfill.findIndex(_data.groups, g=>g.title==group)\r\n                        _data.groups[i].vessels.push(temp);\r\n                        resolve(r);\r\n                    }\r\n                    else\r\n                        reject(r);\r\n                });\r\n            });\r\n        },        \r\n        saveLabelSettings: function(count){\r\n            return new Promise((resolve, reject)=>{\r\n                let temp = [], style;\r\n                for (let i=0; i<_data.groups.length; ++i){\r\n                    style = {ms: _data.groups[i].marker_style, lc: _data.groups[i].label_color, lsc: _data.groups[i].label_shadow_color};\r\n                    if(_data.groups[i].default)\r\n                        style.mt = _markerTemplate;\r\n                    temp.push({\r\n                        properties:{style:JSON.stringify(style)}, \r\n                        id:_data.groups[i].id, action:\"update\"\r\n                    });\r\n                    if(_data.groups[i].default)\r\n                        break;\r\n                }\r\n\r\n                let form = new FormData();\r\n                form.set('WrapStyle', 'none');\r\n                form.set('LayerName', _myFleetLayers[0]);\r\n                form.set('objects', JSON.stringify(temp));\r\n                fetch(aisLayerSearcher.baseUrl + 'VectorLayer/ModifyVectorObjects.ashx', {\r\n                credentials: 'include',\r\n                method: \"POST\",\r\n                body: form\r\n                })\r\n                .then((r)=>r.json())\r\n                .then((r)=>{  \r\n                    if (!r.Status || r.Status.toLowerCase() != \"ok\")\r\n                        console.log(r);  \r\n                    resolve(count + 1);\r\n                })\r\n                .catch(err=>{\r\n                    console.log(err);                \r\n                    resolve(count + 1);\r\n                });   \r\n                 \r\n            });\r\n        },        \r\n        saveGroupStyle: function(count){\r\n            return new Promise((resolve, reject)=>{\r\n                let temp = [], style;\r\n                for (let i=0; i<_data.groups.length; ++i){\r\n                    style = {ms: _data.groups[i].marker_style, lc: _data.groups[i].label_color, lsc: _data.groups[i].label_shadow_color};\r\n                    if(_data.groups[i].default)\r\n                        style.mt = _markerTemplate;\r\n                    temp.push({\r\n                        properties:{style:JSON.stringify(style)}, \r\n                        id:_data.groups[i].id, action:\"update\"\r\n                    });\r\n                }\r\n\r\n                let form = new FormData();\r\n                form.set('WrapStyle', 'none');\r\n                form.set('LayerName', _myFleetLayers[0]);\r\n                form.set('objects', JSON.stringify(temp));\r\n                fetch(aisLayerSearcher.baseUrl + 'VectorLayer/ModifyVectorObjects.ashx', {\r\n                credentials: 'include',\r\n                method: \"POST\",\r\n                body: form\r\n                })\r\n                .then((r)=>r.json())\r\n                .then((r)=>{  \r\n                    if (!r.Status || r.Status.toLowerCase() != \"ok\")\r\n                        console.log(r);  \r\n                    resolve(count + 1);\r\n                })\r\n                .catch(err=>{\r\n                    console.log(err);                \r\n                    resolve(count + 1);\r\n                });                \r\n            });    \r\n        },\r\n        changeGroupStyle: function(i, colors){\r\n            _data.groups[i].marker_style = colors.marker_style;\r\n            _data.groups[i].label_color = colors.label_color;\r\n            _data.groups[i].label_shadow = colors.label_shadow;\r\n            _tools.highlightMarker(i, this.data.groups[i]);\r\n            \r\n            let g = _data.groups[i],\r\n            group = Polyfill.find(_vessels, v=>(!v.mmsi && !v.imo && v.gmx_id==g.id)),\r\n            style = {ms: g.marker_style, lc: g.label_color, lsc: g.label_shadow_color};\r\n            if(g.default)\r\n                style.mt = _markerTemplate;\r\n            group.style = JSON.stringify(style);\r\n//console.log(group)\r\n//console.log(this.data.groups[i].marker_style)\r\n        },\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Models/MyFleetModel.js","module.exports = { \r\n\tfind: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn value;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn undefined;\r\n\t},\r\n\tfindIndex: function(a, predicate) {\r\n\t\tvar list = Object(a);\r\n\t\tvar length = list.length >>> 0;\r\n\t\tvar thisArg = arguments[2];\r\n\t\tvar value;\r\n\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t  value = list[i];\r\n\t\t  if (predicate.call(thisArg, value, i, list)) {\r\n\t\t\treturn i;\r\n\t\t  }\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Polyfill.js","require(\"./DbSearch.css\")\r\nconst BaseView = require('./BaseView.js');\r\n\r\nlet _searchString = \"\",\r\n    _setSearchInputValue = function (s) {\r\n        let searchBut = this.frame.find('.filter .search'),\r\n            removeBut = this.frame.find('.filter .remove'),\r\n            _searchString = s;\r\n            \r\n        this.searchInput.val(_searchString);\r\n        if (s != \"\") {\r\n            removeBut.show();\r\n            searchBut.hide();\r\n        }\r\n        else\r\n            removeBut.click();\r\n    },\r\n    _highlight,\r\n    _tools,\r\n    _displayedOnly = [];\r\n\r\nconst DbSearchView = function ({ model, highlight, tools }) {\r\n    BaseView.call(this, model, tools);\r\n    _highlight = highlight;\r\n    _tools = tools;\r\n    let needLegendSwitch = _tools.hasAlternativeLayers,\r\n    needAltLegend = !!needLegendSwitch._map;\r\n    this.frame = $(Handlebars.compile('<div class=\"ais_view search_view\">' +\r\n        '<table border=0 class=\"instruments\">' +\r\n        '<tr><td colspan=\"2\"><div class=\"filter\"><input type=\"text\" placeholder=\"{{i \"AISSearch2.filter\"}}\"/>' +\r\n        '<div><img class=\"search clicable\" src=\"plugins/AIS/AISSearch/svg/search.svg\">' +\r\n        '<img class=\"remove clicable\" src=\"plugins/AIS/AISSearch/svg/remove.svg\">' +\r\n        '</div></div>' +\r\n\r\n        '</td></tr>' +\r\n        '<tr><td class=\"time\" colspan=\"2\"><span class=\"label\">{{i \"AISSearch2.time_switch\"}}:</span>' +\r\n        '<span class=\"utc on unselectable\" unselectable=\"on\">UTC</span><span class=\"local unselectable\" unselectable=\"on\">{{i \"AISSearch2.time_local\"}}</span>'+\r\n        '<span class=\"sync-switch-slider-description\" style=\"padding: 0;margin-left: 10px;line-height:12px\">{{i \"AISSearch2.thisVesselOnly\"}}</span>'+ \r\n        '<label class=\"sync-switch switch only_this\" style=\"margin-left:5px\"><input type=\"checkbox\">'+\r\n        '<div class=\"sync-switch-slider switch-slider round\"></div></label>' +\r\n        '</td></tr>' +\r\n        ( needLegendSwitch ? \r\n            '<tr><td class=\"legend\" colspan=\"2\"><span class=\"label\">{{i \"AISSearch2.legend_switch\"}}:</span>' + \r\n            '<span class=\"type unselectable on\" unselectable=\"on\">{{i \"AISSearch2.legend_type\"}}</span>' +\r\n            '<span class=\"speed unselectable\" unselectable=\"on\">{{i \"AISSearch2.legend_speed\"}}</span></td></tr>'\r\n            : '') +\r\n        '<tr><td><div class=\"calendar\"></div></td>' +\r\n        '<td style=\"padding-left:5px;padding-right:25px;vertical-align:top;\"><div class=\"refresh clicable\" title=\"{{i \"AISSearch2.refresh\"}}\">' +\r\n        '<div class=\"progress\">' + this.gifLoader + '</div>' +\r\n        '<div class=\"reload\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"#2f3c47\" d=\"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z\"/></svg></div>' +\r\n        '</div></td></tr>' +\r\n        '</table>' +\r\n\r\n        '<div class=\"ais_history\">' +\r\n        '<table class=\"ais_positions_date\"><tr><td>NO HISTORY FOUND</td></tr></table>' +\r\n        '</div>' +\r\n        '<table class=\"start_screen\"><tr><td>' +\r\n        '<img src=\"plugins/AIS/AISSearch/svg/steer-weel.svg\">' +\r\n        '<div>{{{i \"AISSearh2.searchresults_view\"}}}' +\r\n        '</div></td></tr></table>' +\r\n\r\n        '<div class=\"suggestions\"><div class=\"suggestion\">SOME VESSEL<br><span>mmsi:0, imo:0</span></div></div>' +\r\n        '</div>'\r\n    )());\r\n    if(needAltLegend){\r\n        _tools.switchLegend(needAltLegend);\r\n        this.frame.find('.legend span').removeClass(\"on\");\r\n        this.frame.find('.legend .speed').addClass('on');\r\n    }\r\n\r\n    Object.defineProperty(this, \"topOffset\", {\r\n        get: function () {\r\n            let rv = $('.ais_tabs')[0].getBoundingClientRect().height + \r\n            this.frame.find('.instruments')[0].getBoundingClientRect().height;\r\n            return rv;\r\n        }\r\n    });  \r\n\r\n    this.container = this.frame.find('.ais_history');\r\n    this.startScreen = this.frame.find('.start_screen');\r\n    this.tableTemplate = '{{#if msg}}<div class=\"message\">{{msg}}</div>{{/if}}' +\r\n\r\n    '<table class=\"ais_positions_date header\"><tr>' +\r\n    '<td></td>' +\r\n    '<td><span class=\"date\"></span></td>' +\r\n    '<td><div class=\"track all\"><input type=\"checkbox\" title=\"{{i \"AISSearch2.allDailyTracks\"}}\"></div></td>' +\r\n    '<td><div class=\"count\">{{total}}</div></td></tr></table>' +\r\n\r\n        '{{#each vessels}}' +\r\n        '<table class=\"ais_positions_date\" border=0><tr>' +\r\n        '<td><div class=\"open_positions ui-helper-noselect icon-right-open\" title=\"{{i \"AISSearch2.voyageInfo\"}}\"></div></td>' +\r\n        '<td><span class=\"date\">{{{ts_pos_utc}}}</span></td>' +\r\n        '<td><div class=\"track\" date=\"{{{ts_pos_utc}}}\"><input type=\"checkbox\" title=\"{{i \"AISSearch2.dailyTrack\"}}\"></div></td>' +\r\n        '<td><div class=\"count\">{{count}}</div></td></tr></table>' +\r\n        '<div id=\"voyage_info{{n}}\"></div>' +\r\n        '{{/each}}';\r\n\r\n    let calendar = this.frame.find('.calendar');\r\n\r\n    // walkaround with focus at first input in ui-dialog\r\n    calendar.append('<span class=\"ui-helper-hidden-accessible\"><input type=\"text\"/></span>')\r\n    let mapDateInterval = nsGmx.widgets.commonCalendar.getDateInterval(),\r\n        dateInterval = new nsGmx.DateInterval();\r\n    dateInterval\r\n        .set('dateBegin', mapDateInterval.get('dateBegin'))\r\n        .set('dateEnd', mapDateInterval.get('dateEnd'))\r\n        .on('change', function (e) {\r\n//console.log(this.model.historyInterval) \r\n//console.log('CHANGE ' + dateInterval.get('dateBegin').toUTCString() + ' ' + dateInterval.get('dateEnd').toUTCString()) \r\n            this.model.historyInterval = { dateBegin: dateInterval.get('dateBegin'), dateEnd: dateInterval.get('dateEnd') };\r\n            this.model.isDirty = true;\r\n            this.show();\r\n        }.bind(this));\r\n\r\n    this.calendar = new nsGmx.CalendarWidget({\r\n        dateInterval: dateInterval,\r\n        name: 'searchInterval',\r\n        container: calendar,\r\n        dateMin: new Date(0, 0, 0),\r\n        dateMax: new Date(3015, 1, 1),\r\n        dateFormat: 'dd.mm.yy',\r\n        minimized: false,\r\n        showSwitcher: false,\r\n        dateBegin: new Date(),\r\n        dateEnd: new Date(2000, 10, 10),\r\n        //buttonImage: 'img/calendar.png'\r\n    })\r\n\r\n    let td = calendar.find('tr:nth-of-type(1) td');\r\n    td.eq(1).after('<td style=\"font-weight:bold\">&nbsp;&nbsp;&ndash;&nbsp;&nbsp;</td>');\r\n    td.eq(td.length - 1).after('<td>&nbsp;&nbsp;<img class=\"default_date\" style=\"cursor:pointer\" title=\"'+_gtxt('AISSearch2.calendar_today')+'\" src=\"plugins/AIS/AISSearch/svg/calendar.svg\"></td>');\r\n\r\n    calendar.find('.default_date').on('click', () => {\r\n        let db = nsGmx.DateInterval.getUTCDayBoundary(new Date());\r\n        this.calendar.getDateInterval().set('dateBegin', db.dateBegin);\r\n        this.calendar.getDateInterval().set('dateEnd', db.dateEnd);\r\n        nsGmx.widgets.commonCalendar.setDateInterval(db.dateBegin, db.dateEnd);\r\n    })\r\n\r\n    //sidebarControl && sidebarControl.on('closing', ()=>calendar.reset())\r\n    this.frame.on('click', ((e) => {\r\n        if (e.target.classList.toString().search(/CalendarWidget/) < 0) {\r\n            this.calendar.reset()\r\n        }\r\n        suggestions.hide();\r\n    }).bind(this));\r\n\r\n    this.frame.find('.time .only_this  input[type=\"checkbox\"]').click((e=>{\r\n        _displayedOnly.length = 0;\r\n        if (e.currentTarget.checked && this.frame.find('.ais_positions_date:not(.header)')[0] ) {\r\n            _displayedOnly.push(this.model.data.vessels[0].positions[0].mmsi.toString());         \r\n            _tools.showVesselsOnMap(_displayedOnly);\r\n        }\r\n        else{            \r\n            _tools.showVesselsOnMap(\"all\");  \r\n        }\r\n    }).bind(this));\r\n\r\n    _tools.onLegendSwitched((()=>{\r\n        let ic = this.frame.find('.legend_icon'),\r\n        ica = this.frame.find('.legend_iconalt');\r\n        if (ic.is(':visible')){\r\n            ic.hide(); ica.show();\r\n        }\r\n        else{\r\n            ica.hide(); ic.show();\r\n        }\r\n    }).bind(this));\r\n    this.frame.find('.legend .type,.speed').click((e => {\r\n        let trg = $(e.currentTarget);\r\n        if (!trg.is('.on')) {\r\n            this.frame.find('.legend span').removeClass(\"on\");\r\n            trg.addClass('on');\r\n            _tools.switchLegend(trg.is('.speed'));\r\n        }\r\n    }).bind(this));\r\n    this.frame.find('.time .utc,.local').click((e => {\r\n        let trg = $(e.currentTarget);\r\n        if (!trg.is('.on')) {\r\n            this.frame.find('.time span').removeClass(\"on\");\r\n            trg.addClass('on')\r\n            if (trg.is('.utc')) {\r\n                this.frame.find('.utc_time').show();\r\n                this.frame.find('.local_time').hide();\r\n                this.frame.find('.utc_date').show();\r\n                this.frame.find('.local_date').hide();\r\n            }\r\n            else {\r\n                this.frame.find('.utc_time').hide();\r\n                this.frame.find('.local_time').show();\r\n                this.frame.find('.utc_date').hide();\r\n                this.frame.find('.local_date').show();\r\n            }\r\n        }\r\n\r\n    }).bind(this));\r\n\r\n    this.frame.find('.refresh .reload').click((e=>{\r\n        if (e.currentTarget.style.display=\"block\"){\r\n            this.model.isDirty = true;\r\n            this.model.update();\r\n        }\r\n    }).bind(this));\r\n\r\n    this.searchInput = this.frame.find('.filter input');\r\n\r\n    let searchBut = this.frame.find('.filter .search'),\r\n        removeBut = this.frame.find('.filter .remove'),\r\n        delay,\r\n        suggestions = this.frame.find('.suggestions'),\r\n        suggestionsCount = 12,\r\n        suggestionsFrame = { first: 0, current: 0, last: suggestionsCount - 1 },\r\n        found = { values: [] },\r\n        searchDone = function () {\r\n            if (found.values.length > 0) {\r\n                _searchString = found.values[suggestionsFrame.current].vessel_name;\r\n                this.searchInput.val(_searchString);\r\n                let v = found.values[suggestionsFrame.current];\r\n                if (!this.vessel || this.vessel.mmsi != v.mmsi || !this.frame.find('.ais_positions_date:not(.header)')[0]) {\r\n                    this.vessel = v;\r\n                    this.show();\r\n                }\r\n            }\r\n            else {\r\n                _clean.call(this);\r\n                _cleanMap.call(this);\r\n            }\r\n        },\r\n        doSearch = function (actualId) {\r\n//console.log(_searchString)\r\n            new Promise(function (resolve, reject) {\r\n                this.model.searcher.searchString2(_searchString, true, function (response) {\r\n                    if (response.Status.toLowerCase() == \"ok\") {\r\n                        found = {\r\n                            values: response.Result.values.map(function (v) {\r\n                                return { vessel_name: v[0], mmsi: v[1], imo: v[2], ts_pos_utc: v[3], ts_pos_org: v[3], vessel_type: v[4] }\r\n                            })\r\n                        };\r\n                        resolve();\r\n                    }\r\n                    else {\r\n                        reject(response);\r\n                    }\r\n                })\r\n            }.bind(this))\r\n                .then(function () { \r\n                    \r\n                    if (actualId!=delay)\r\n                        return;\r\n\r\n                    // SUCCEEDED\r\n                    if (found.values.length == 0) {\r\n                        suggestions.hide();\r\n                        return;\r\n                    }\r\n\r\n//console.log(\"ss: \"+_searchString)\r\n                    if (_searchString==\"\") {\r\n                        suggestions.hide();\r\n                        return;\r\n                    }\r\n\r\n                    let scrollCont = suggestions.find('.mCSB_container'),\r\n                        content = $(Handlebars.compile(\r\n                            '{{#each values}}<div class=\"suggestion\" id=\"{{@index}}\">{{vessel_name}}<br><span>mmsi:{{mmsi}}, imo:{{imo}}</span></div>{{/each}}'\r\n                        )(found));\r\n                    if (!scrollCont[0])\r\n                        suggestions.html(content).mCustomScrollbar();\r\n                    else\r\n                        $(scrollCont).html(content);\r\n\r\n                    let suggestion = suggestions.find('.suggestion');\r\n                    if (!suggestions.is(':visible')) {\r\n                        let cr = this.frame.find('.filter')[0].getBoundingClientRect();\r\n                        suggestions.show();\r\n                        suggestions.offset({ left: cr.left, top: cr.bottom - 3 });\r\n                        suggestions.outerWidth(cr.width)\r\n                    }\r\n\r\n                    suggestions.innerHeight(suggestion[0].getBoundingClientRect().height *\r\n                        (found.values.length > suggestionsCount ? suggestionsCount : found.values.length));\r\n                    suggestionsFrame = { first: 0, current: 0, last: suggestionsCount - 1 };\r\n                    suggestion.eq(suggestionsFrame.current).addClass('selected');\r\n                    suggestion.click(e => {\r\n                        suggestionsFrame.current = e.currentTarget.id;\r\n                        searchDone.call(this);\r\n                    });\r\n                    //console.log(\"doFilter2 \"+_searchString)\r\n                }.bind(this),\r\n                function (response) { // FAILED\r\n                    console.log(response);\r\n                });\r\n        };\r\n    removeBut.click(function (e) {\r\n        this.searchInput.val('');\r\n        this.searchInput.focus();\r\n        clearTimeout(delay)\r\n        removeBut.hide();\r\n        searchBut.show();\r\n        suggestions.hide();\r\n        _clean.call(this);\r\n        _cleanMap.call(this);\r\n        //nsGmx.leafletMap.removeLayer(highlight);\r\n    }.bind(this));\r\n    this.searchInput.keydown(function (e) {\r\n        let suggestion = suggestions.find('.suggestion.selected');\r\n        if (suggestions.is(':visible')) {\r\n            if (e.keyCode == 38) {\r\n                if (suggestionsFrame.current > 0) {\r\n                    suggestionsFrame.current--;\r\n                    suggestion.removeClass('selected').prev().addClass('selected');\r\n                }\r\n            }\r\n            else if (e.keyCode == 40) {\r\n                if (suggestionsFrame.current < found.values.length - 1) {\r\n                    suggestionsFrame.current++;\r\n                    suggestion.removeClass('selected').next().addClass('selected');\r\n                }\r\n            }\r\n            if (suggestionsFrame.last < suggestionsFrame.current) {\r\n                suggestionsFrame.last = suggestionsFrame.current;\r\n                suggestionsFrame.first = suggestionsFrame.last - (suggestionsCount - 1);\r\n            }\r\n            if (suggestionsFrame.first > suggestionsFrame.current) {\r\n                suggestionsFrame.first = suggestionsFrame.current;\r\n                suggestionsFrame.last = suggestionsFrame.first + (suggestionsCount - 1);\r\n            }\r\n            suggestions.mCustomScrollbar(\"scrollTo\", \"#\" + suggestionsFrame.first, { scrollInertia: 0 });\r\n        }\r\n    });\r\n\r\n    let prepareSearchInput = function (temp, keyCode) {\r\n        removeBut.show();\r\n        searchBut.hide();\r\n        if (_searchString == temp && (!keyCode || keyCode != 13))\r\n            return false;\r\n        _searchString = temp;\r\n        clearTimeout(delay);\r\n        if (_searchString == \"\") {\r\n            removeBut.click();\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    this.searchInput.keyup(function (e) {\r\n        let temp = (this.searchInput.val() || \"\")\r\n            .replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n        if (!prepareSearchInput(temp, e.keyCode))\r\n            return;\r\n        if (e.keyCode == 13) {\r\n            suggestions.hide();\r\n            searchDone.call(this);\r\n        }\r\n        else\r\n            delay = setTimeout((() => {\r\n                doSearch.apply(this, [delay])\r\n            }).bind(this), 200);\r\n        //nsGmx.leafletMap.removeLayer(highlight);\r\n    }.bind(this));\r\n    this.searchInput.on(\"paste\", function (e) {\r\n        let temp = ((e.originalEvent || window.clipboardData).clipboardData.getData('text') || \"\")\r\n            .replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n        if (!prepareSearchInput(temp))\r\n            return;\r\n        delay = setTimeout((() => {\r\n            doSearch.apply(this, [delay])\r\n        }).bind(this), 200);\r\n    }.bind(this));\r\n};\r\n\r\nDbSearchView.prototype = Object.create(BaseView.prototype);\r\n\r\nlet _clean = function () {\r\n    this.frame.find('.open_positions').off('click');\r\n    this.frame.find('.ais_positions_date .track input[type=\"checkbox\"]').off('click');\r\n    let scrollCont = this.container.find('.mCSB_container')\r\n    if (scrollCont[0])\r\n        scrollCont.empty();\r\n    else\r\n        this.container.empty();\r\n    //console.log(\"EMPTY ON SELF.CLEAN \"+this)\r\n    this.startScreen.css({ visibility: \"hidden\" });\r\n    nsGmx.leafletMap.removeLayer(_highlight);\r\n},\r\n_cleanMap = function(){  \r\n    if (_displayedOnly.length) \r\n        this.frame.find('.time .only_this  input[type=\"checkbox\"]').click();\r\n};\r\n\r\nDbSearchView.prototype.inProgress = function (state) {\r\n    let progress = this.frame.find('.refresh div.progress'),\r\n    reload = this.frame.find('.refresh div.reload');\r\n    if (state){\r\n        progress.show();\r\n        reload.hide();\r\n    }\r\n    else{\r\n        progress.hide();\r\n        reload.show();\r\n    }\r\n};\r\n\r\nlet _vi_template = '<table class=\"ais_positions\">' +\r\n    '{{#each positions}}' +\r\n    '<tr>' +\r\n    '<td  title=\"{{i \"AISSearch2.info\"}}\"><img class=\"show_info\" id=\"show_info{{@index}}\" src=\"plugins/AIS/AISSearch/svg/info.svg\"></td>' +\r\n    '<td><span class=\"utc_time\">{{tm_pos_utc}}</span><span class=\"local_time\">{{tm_pos_loc}}</span></td>' +\r\n    '<td><span class=\"utc_date\">{{dt_pos_utc}}</span><span class=\"local_date\">{{dt_pos_loc}}</span></td>' +\r\n    '<td><img src=\"{{icon}}\" class=\"legend_icon rotateimg{{icon_rot}}\"><img src=\"{{iconAlt}}\" class=\"legend_iconalt rotateimg{{icon_rot}}\"></td>' +\r\n    '<td><img src=\"{{source}}\"></td>' +\r\n    '<td>{{longitude}}&nbsp;&nbsp;{{latitude}}</td>' +\r\n    '<td><div class=\"show_pos\" id=\"show_pos{{@index}}\" title=\"{{i \"AISSearch2.position\"}}\"><img src=\"plugins/AIS/AISSearch/svg/center.svg\"></div></td>' +\r\n    '</tr>' +\r\n    '<tr><td colspan=\"7\" class=\"more\"><hr><div class=\"vi_more\">' +\r\n\r\n    '<div class=\"c1\">COG | SOG:</div><div class=\"c2\">&nbsp;{{cog}} {{#if cog_sog}}&nbsp;{{/if}} {{sog}}</div>' +\r\n    '<div class=\"c1\">HDG | ROT:</div><div class=\"c2\">&nbsp;{{heading}} {{#if heading_rot}}&nbsp;{{/if}} {{rot}}</div>' +\r\n    '<div class=\"c1\">{{i \"AISSearch2.draught\"}}:</div><div class=\"c2\">&nbsp;{{draught}}</div>' +\r\n    '<div class=\"c1\">{{i \"AISSearch2.destination\"}}:</div><div class=\"c2\">&nbsp;{{destination}}</div>' +\r\n    '<div class=\"c1\">{{i \"AISSearch2.nav_status\"}}:</div><div class=\"c2\">&nbsp;{{nav_status}}</div>' +\r\n    '<div class=\"c1\">ETA:</div><div class=\"c2\">&nbsp;<span class=\"utc_time\">{{eta_utc}}</span><span class=\"local_time\">{{eta_loc}}</span></div>' +\r\n\r\n    '</div></td></tr>' +\r\n    '{{/each}}' +\r\n    '</table>';\r\n\r\nlet _prepare_history = function(){   \r\n//console.log(_tools.displayedTrack)     \r\n    if (this.model.data.vessels.length>0 && _tools.displayedTrack && \r\n        _tools.displayedTrack.mmsi==this.model.data.vessels[0].positions[0].mmsi){\r\n        let checkTrack, modelDate, trackDate, checkAllTracks = this.frame.find('.ais_positions_date.header .track input')[0];\r\n        checkAllTracks.checked = true;          \r\n        this.frame.find('.ais_positions_date:not(.header)').each((i, el) => {\r\n            if (_tools.displayedTrack.dates) {\r\n                modelDate = new Date(this.model.data.vessels[i].positions[0].ts_pos_org * 1000).setUTCHours(0, 0, 0, 0); \r\n                checkTrack = false;\r\n                for (let j = 0; j < _tools.displayedTrack.dates.list.length; ++j) {\r\n                    trackDate = _tools.displayedTrack.dates.list[j];\r\n                    if (modelDate === trackDate.getTime()) {\r\n                        checkTrack = $(el).find('.track:not(.all) input')[0];\r\n                        checkTrack.checked = true;\r\n                        break;\r\n                    }\r\n                }\r\n                if (!checkTrack)\r\n                    checkAllTracks.checked = false; \r\n            }\r\n            else\r\n                $(el).find('.track input:not(.all)')[0].checked = true;\r\n        });\r\n    }\r\n}\r\n\r\nDbSearchView.prototype.repaint = function () {\r\n    _clean.call(this);\r\n    BaseView.prototype.repaint.apply(this, arguments); \r\n\r\n    _prepare_history.call(this);\r\n\r\n//console.log(\"REPAINT\") \r\n    _tools.clearMyFleetMarkers();\r\n    _displayedOnly.length = 0; \r\n    if (this.frame.find('.time .only_this  input[type=\"checkbox\"]')[0].checked) {\r\n        _displayedOnly.push(this.model.data.vessels[0].positions[0].mmsi.toString());         \r\n        _tools.showVesselsOnMap(_displayedOnly);\r\n    }     \r\n    else {  \r\n        _tools.showVesselsOnMap(\"all\"); \r\n    }  \r\n\r\n    let openPos = this.frame.find('.open_positions'),\r\n    switchLegendIcons = (function(){\r\n        let ic = this.frame.find('.legend_icon'),\r\n            ica = this.frame.find('.legend_iconalt');\r\n        if (this.frame.find('.legend .speed').is('.on')) {\r\n            ica.show(); ic.hide();\r\n        }\r\n        else {\r\n            ic.show(); ica.hide();\r\n        }  \r\n    }).bind(this);\r\n    openPos.each((ind, elm) => {\r\n        $(elm).click(((e) => {\r\n            let icon = $(e.target),\r\n                vi_cont = this.frame.find('#voyage_info' + ind);\r\n            if (icon.is('.icon-down-open')) {\r\n                icon.removeClass('icon-down-open').addClass('.icon-right-open');\r\n                vi_cont.find('.ais_positions td[class!=\"more\"]').off('click')\r\n                vi_cont.empty();\r\n            }\r\n            else {\r\n                icon.addClass('icon-down-open').removeClass('.icon-right-open');\r\n                vi_cont.html(Handlebars.compile(_vi_template)(this.model.data.vessels[ind]));\r\n                if (this.frame.find('.time .local').is('.on')) {\r\n                    vi_cont.find('.utc_time').hide();\r\n                    vi_cont.find('.local_time').show();\r\n                    vi_cont.find('.utc_date').hide();\r\n                    vi_cont.find('.local_date').show();\r\n                }\r\n                switchLegendIcons();\r\n                vi_cont.find('.ais_positions td[class!=\"more\"]').click((e) => {\r\n                    let td = $(e.currentTarget);\r\n                    if (td.is('.active')) {\r\n                        td.removeClass('active')\r\n                        td.siblings().removeClass('active')\r\n                        td.parent().next().find('td').removeClass('active')\r\n                    }\r\n                    else {\r\n                        td.addClass('active')\r\n                        td.siblings().addClass('active')\r\n                        td.parent().next().find('td').addClass('active')\r\n                    }\r\n                });\r\n                let infoDialog = this.infoDialogView,\r\n                    vessel = this.vessel;\r\n                vi_cont.find('.ais_positions .show_info').click(((e) => {\r\n                    let i = e.currentTarget.id.replace(/show_info/, \"\"),\r\n                        position = this.model.data.vessels[ind].positions[i];\r\n                    position.vessel_name = vessel.vessel_name;\r\n                    position.imo = vessel.imo;\r\n                    position.latitude = position.ymax;\r\n                    position.longitude = position.xmax;\r\n                    position.source = position.source_orig;\r\n                    //console.log(vessel)\r\n                    //console.log(position)\r\n                    infoDialog.show(position, false);\r\n                    e.stopPropagation();\r\n                }).bind(this));\r\n                vi_cont.find('.ais_positions .show_pos').click(((e) => {\r\n                    //showPosition\r\n                    let i = e.currentTarget.id.replace(/show_pos/, \"\"),\r\n                        vessel = this.model.data.vessels[ind].positions[parseInt(i)];\r\n                    this.positionMap(vessel, this.calendar.getDateInterval());\r\n\r\n                    this.frame.find('.track:not(.all) input')[ind].checked = true; \r\n                    allTracksInput[0].checked = (this.frame.find('.track:not(.all) input:checked').length==this.model.data.vessels.length);  \r\n\r\n                    let dates = getDates.call(this);\r\n                    this.showTrack({mmsi:this.model.data.vessels[0].positions[0].mmsi}, dates);\r\n                    e.stopPropagation();\r\n                }).bind(this));\r\n            }\r\n        }).bind(this));\r\n    });\r\n\r\n    let getDates = function(needAll){\r\n        let dates = [];\r\n        this.frame.find('.ais_positions_date .track:not(.all)').each((i, el)=>{ \r\n            let input = $('input', el)[0];   \r\n            if (needAll)\r\n                input.checked = true;       \r\n            if (input.checked)\r\n                dates.push(\r\n                    new Date(new Date(1000*this.model.data.vessels[i].positions[0].ts_pos_utc).setUTCHours(0,0,0,0))\r\n                );\r\n        })\r\n        return dates;\r\n    },\r\n    allTracksInput = this.frame.find('.ais_positions_date .track.all input[type=\"checkbox\"]');\r\n    allTracksInput.click(((e)=>{\r\n        if (!this.model.data.vessels || !this.model.data.vessels.length)\r\n            return;\r\n        let calendarInterval = this.calendar.getDateInterval(),\r\n        interval = {dateBegin:calendarInterval.get(\"dateBegin\"), dateEnd:calendarInterval.get(\"dateEnd\")};\r\n        nsGmx.widgets.commonCalendar.setDateInterval(interval.dateBegin, interval.dateEnd); \r\n        if (!e.target.checked){        \r\n            this.frame.find('.ais_positions_date .track:not(.all)').each((i, el)=>{ \r\n                $('input', el)[0].checked = false; \r\n            });\r\n            this.showTrack();\r\n        }\r\n        else\r\n            this.showTrack({mmsi:this.model.data.vessels[0].positions[0].mmsi}, getDates.call(this, true));   \r\n\r\n    }).bind(this));\r\n    this.frame.find('.ais_positions_date .track:not(.all) input[type=\"checkbox\"]').click(((e)=>{\r\n        let calendarInterval = this.calendar.getDateInterval(),\r\n        interval = {dateBegin:calendarInterval.get(\"dateBegin\"), dateEnd:calendarInterval.get(\"dateEnd\")};\r\n        nsGmx.widgets.commonCalendar.setDateInterval(interval.dateBegin, interval.dateEnd);\r\n        let dates = getDates.call(this);\r\n        allTracksInput[0].checked = (dates.length==this.model.data.vessels.length);\r\n        this.showTrack({mmsi:this.model.data.vessels[0].positions[0].mmsi}, dates);\r\n    }).bind(this));\r\n\r\n    if (this.model.data.vessels.length == 1)\r\n        openPos.eq(0).click();\r\n\r\n    if (this.vessel.lastPosition){\r\n        this.positionMap(this.vessel, this.calendar.getDateInterval());\r\n        this.vessel.lastPosition = false;\r\n    }    \r\n};\r\n\r\n\r\nObject.defineProperty(DbSearchView.prototype, \"vessel\", {\r\n    get() {\r\n        return this.model.vessel;\r\n    },\r\n    set(v) {\r\n        _setSearchInputValue.call(this, v.vessel_name);\r\n        _searchString = v.vessel_name;\r\n        \r\n        let positionDate = nsGmx.DateInterval.getUTCDayBoundary(new Date(v.ts_pos_org * 1000));\r\n        this.model.vessel = null;\r\n        let checkInterval = this.calendar.getDateInterval();\r\n// console.log(positionDate.dateBegin + '<' + checkInterval.get('dateBegin'))\r\n// console.log(checkInterval.get('dateEnd') + '<' + positionDate.dateEnd)\r\n        if (positionDate.dateBegin < checkInterval.get('dateBegin') || checkInterval.get('dateEnd') < positionDate.dateEnd){\r\n            this.calendar.getDateInterval().set('dateBegin', positionDate.dateBegin);\r\n            this.calendar.getDateInterval().set('dateEnd', positionDate.dateEnd);      \r\n            this.model.historyInterval = { dateBegin: positionDate.dateBegin, dateEnd: positionDate.dateEnd };\r\n        }\r\n        else\r\n            this.model.historyInterval = { dateBegin: checkInterval.get('dateBegin'), dateEnd: checkInterval.get('dateEnd') };\r\n        this.model.vessel = v;\r\n        this.model.isDirty = true;\r\n    }\r\n});\r\n\r\nDbSearchView.prototype.show = function () {\r\n    this.frame.show();\r\n    this.searchInput.focus();\r\n    BaseView.prototype.show.apply(this, arguments); \r\n    if (!this.vessel)\r\n        return;\r\n        \r\n    if (!_tools.displayedTrack)\r\n        this.frame.find('.ais_positions_date .track input[type=\"checkbox\"]').each((i,e)=>{e.checked = false;});\r\n\r\n    if (_displayedOnly.length)        \r\n        _tools.showVesselsOnMap(_displayedOnly); \r\n    else\r\n        _tools.showVesselsOnMap(\"all\");\r\n};\r\n\r\nDbSearchView.prototype.hide = function () { \r\n    BaseView.prototype.hide.apply(this, arguments); \r\n    _tools.showVesselsOnMap(\"all\");\r\n};\r\n\r\nDbSearchView.prototype.showTrack = function (vessel, dates) {\r\n    if (!vessel){\r\n        _tools.showTrack([]);\r\n        return;\r\n    }\r\n    if (!dates && vessel.ts_pos_org)\r\n        dates = [new Date(new Date(vessel.ts_pos_org*1000).setUTCHours(0,0,0,0))];\r\n\r\n    let dlg = $('.ui-dialog:contains(\"' + vessel.mmsi + '\")');\r\n    $('.showtrack').attr('title', _gtxt('AISSearch2.show_track'))\r\n        .removeClass('ais active');\r\n    if (dlg[0]) \r\n        dlg.find('.showtrack').attr('title', _gtxt('AISSearch2.hide_track'))\r\n        .addClass('ais active')\r\n    _tools.showTrack([vessel.mmsi], dates);\r\n};\r\n\r\nDbSearchView.prototype.positionMap = function (vessel, interval) {\r\n//console.log(\"positionMap\")\r\n    if (interval)       \r\n        nsGmx.widgets.commonCalendar.setDateInterval(interval.get(\"dateBegin\"), interval.get(\"dateEnd\"));\r\n        \r\n    let xmin = vessel.xmin ? vessel.xmin : vessel.longitude,\r\n        xmax = vessel.xmax ? vessel.xmax : vessel.longitude,\r\n        ymin = vessel.ymin ? vessel.ymin : vessel.latitude,\r\n        ymax = vessel.ymax ? vessel.ymax : vessel.latitude,\r\n        zoom = nsGmx.leafletMap.getZoom();\r\n\r\n    nsGmx.leafletMap.setView([ymax, xmax<0?(360+xmax):xmax], (zoom < 9 ? 12 : zoom));\r\n    nsGmx.leafletMap.removeLayer(_highlight);\r\n    _highlight.vessel = vessel;\r\n    _highlight.setLatLng([ymax, xmax<0?(360+xmax):xmax]).addTo(nsGmx.leafletMap);\r\n};\r\n\r\nmodule.exports = DbSearchView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/DbSearchView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/DbSearch.css\n// module id = 17\n// module chunks = 0","module.exports = function (aisLayerSearcher) {\r\n    let _actualUpdate,\r\n        _round = function (d, p) {\r\n            let isNeg = d < 0,\r\n                power = Math.pow(10, p)\r\n            return d ? ((isNeg ? -1 : 1) * (Math.round((isNeg ? d = -d : d) * power) / power)) : d\r\n        },\r\n        _addUnit = function (v, u) {\r\n            return v != null && v != \"\" ? v + u : \"\";\r\n        },\r\n        _toDd = function (D, lng) {\r\n            let dir = D < 0 ? lng ? 'W' : 'S' : lng ? 'E' : 'N',\r\n                deg = Math.round((D < 0 ? D = -D : D) * 1000000) / 1000000\r\n            return deg.toFixed(2) + \" \"//\"\"\r\n                + dir\r\n        },\r\n        _formatPosition = function (vessel) {\r\n            vessel.cog_sog = vessel.cog && vessel.sog\r\n            vessel.heading_rot = vessel.heading && vessel.rot\r\n            vessel.x_y = vessel.longitude && vessel.latitude\r\n            let d = new Date(vessel.ts_pos_utc * 1000)\r\n            let eta = new Date(vessel.ts_eta * 1000)\r\n            vessel.tm_pos_utc = _formatTime(d);\r\n            vessel.tm_pos_loc = _formatTime(d, true);\r\n            vessel.dt_pos_utc = _formatDate(d);\r\n            vessel.dt_pos_loc = _formatDate(d, true);\r\n            vessel.eta_utc = aisLayerSearcher.formatDateTime(eta);\r\n            vessel.eta_loc = aisLayerSearcher.formatDateTime(eta, true);\r\n            vessel.icon_rot = Math.round(vessel.cog/15)*15;\r\n            vessel.cog = _addUnit(_round(vessel.cog, 5), \"\");\r\n            vessel.rot = _addUnit(_round(vessel.rot, 5), \"/\");\r\n            vessel.heading = _addUnit(_round(vessel.heading, 5), \"\");\r\n            vessel.draught = _addUnit(_round(vessel.draught, 5), \" \");\r\n            //vessel.length = _addUnit(vessel.length, \" \");\r\n            //vessel.width = _addUnit(vessel.width, \" \");\r\n            //vessel.source = 'plugins/AIS/AISSearch/svg/satellite-ais.svg'//vessel.source=='T-AIS'?_gtxt('AISSearch2.tais'):_gtxt('AISSearch2.sais');\r\n            vessel.source_orig = vessel.source;\r\n            vessel.source = vessel.source=='T-AIS'?'plugins/AIS/AISSearch/svg/waterside-radar.svg':'plugins/AIS/AISSearch/svg/satellite-ais.svg';\r\n\t            \r\n            vessel.xmin = vessel.longitude;\r\n            vessel.xmax = vessel.longitude;           \r\n            vessel.ymin = vessel.latitude;\r\n            vessel.ymax = vessel.latitude; \r\n\r\n            vessel.longitude = _toDd(vessel.longitude, true);\r\n            vessel.latitude = _toDd(vessel.latitude);\r\n            aisLayerSearcher.placeVesselTypeIcon(vessel);\r\n            vessel.sog = _addUnit(_round(vessel.sog, 5), \" \");\r\n\r\n            return vessel;\r\n        },\r\n        _formatTime = function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleTimeString();\r\n        },\r\n        _formatDate = function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleDateString();\r\n        }\r\n    return {\r\n        searcher: aisLayerSearcher,\r\n        filterString: \"\",\r\n        isDirty: false,\r\n        load: function (actualUpdate) {\r\n            if (!this.isDirty)\r\n                return Promise.resolve();\r\n            //return new Promise((resolve)=>setTimeout(resolve, 1000))\r\n            //console.log('LOAD ' + _historyInterval['dateBegin'].toUTCString() + ' ' + _historyInterval['dateEnd'].toUTCString())     \r\n            var _this = this;\r\n            return new Promise((resolve) => {\r\n                aisLayerSearcher.searchPositionsAgg([_this.vessel.mmsi], _this.historyInterval, function (response) {\r\n                    if (parseResponse(response)) {\r\n                        let position, positions = [],\r\n                            fields = response.Result.fields,\r\n                            groups = response.Result.values.reduce((p, c) => {\r\n                                let obj = {}, d;\r\n                                for (var j = 0; j < fields.length; ++j) {\r\n                                    obj[fields[j]] = c[j];\r\n                                    if (fields[j] == 'ts_pos_utc'){\r\n                                        let dt = c[j], t = dt - dt % (24 * 3600);\r\n                                        d = new Date(t * 1000);\r\n                                        obj['ts_pos_org'] = c[j];\r\n                                    }\r\n                                }\r\n                                if (p[d]) {\r\n                                    p[d].positions.push(_formatPosition(obj));\r\n                                    p[d].count = p[d].count + 1;\r\n                                }\r\n                                else\r\n                                    p[d] = { ts_pos_utc: _formatDate(d), positions: [_formatPosition(obj)], count: 1 };\r\n                                return p;\r\n                            }, {});\r\n                        let counter = 0;\r\n                        for (var k in groups) {\r\n                            groups[k][\"n\"] = counter++;\r\n                            positions.push(groups[k]);\r\n                        }\r\n                        resolve({ Status: \"ok\", Result: { values: positions, total: response.Result.values.length } });\r\n                    }\r\n                    else\r\n                        resolve(response)\r\n                })\r\n            })\r\n                .then(function (response) {\r\n                    //console.log(response)       \r\n                    _this.isDirty = false;\r\n                    if (response.Status.toLowerCase() == \"ok\") {\r\n                        _this.data = { vessels: response.Result.values, total: response.Result.total }\r\n                        return Promise.resolve();\r\n                    }\r\n                    else {\r\n                        return Promise.reject(response);\r\n                    }\r\n                });\r\n        },\r\n        update: function () {\r\n            if (!this.vessel || !this.isDirty)\r\n                return;\r\n\r\n            _actualUpdate = new Date().getTime();\r\n            let _this = this,\r\n                actualUpdate = _actualUpdate;\r\n            this.view.inProgress(true);\r\n            //this.filterString&&console.log(this.filterString+\" \"+this.filterString.search(/\\r$/))\r\n            //this.filterString&&console.log(this.filterString.replace(/^\\s+/, \"\").replace(/\\s+\\r*$/, \"\")!=\"\")            \r\n\r\n            this.load(actualUpdate).then(function () {\r\n                //console.log(\"LOADED \"+(new Date().getTime()-_this._actualUpdate)+\"ms\")\r\n                //console.log(\"3>\"+new Date(_this._actualUpdate))\r\n                //console.log(\"4>\"+new Date(actualUpdate))\r\n                if (_actualUpdate == actualUpdate) {\r\n//_this.data.vessels && (_this.data.vessels.length>0) && console.log(_this.data.vessels[0].positions[0])                    \r\n                    _this.view.inProgress(false);\r\n                    _this.view.repaint();\r\n                }\r\n            }, function (json) {\r\n                _this.dataSrc = null;\r\n                console.log(json)\r\n                if (json.Status.toLowerCase() == \"auth\" ||\r\n                    (json.ErrorInfo && json.ErrorInfo.some &&\r\n                        json.ErrorInfo.some(function (r) { return r.Status.toLowerCase() == \"auth\" })) ||\r\n                    (json.ErrorInfo && json.ErrorInfo.ErrorMessage.search(/not access/i) != -1))\r\n                    _this.data = { msg: _gtxt(\"AISSearch2.auth\"), vessels: [] };\r\n                else {\r\n                    //_this.data = {msg:[{txt:\"!!!\"}], vessels:[]};\r\n                    console.log(json);\r\n                }\r\n                _this.view.inProgress(false);\r\n                _this.view.repaint();\r\n            });\r\n        }\r\n    };\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/Models/DbSearchModel.js","const displayInfoDialog = require('./infodialog.js'),\r\n      Polyfill = require('../Polyfill'),\r\n      VesselInfoScreen = require('./VesselInfoScreen');\r\n\r\nlet infoDialogCascade = [],\r\n    allIinfoDialogs = [],\r\n    vesselInfoScreen;\r\n\r\nmodule.exports = function ({\r\n    tools,\r\n    aisLayerSearcher: aisLayerSearcher,\r\n    modulePath: modulePath,\r\n    aisView: aisView, \r\n    myFleetView: myFleetView,\r\n    menuId:menuId }) {\r\n\r\n    vesselInfoScreen  = new VesselInfoScreen({modulePath: modulePath, aisServices: aisLayerSearcher.aisServices});\r\n    const _showPosition = function(vessel, track){ \r\n        window.iconSidebarWidget.open(menuId);\r\n\r\n        aisView.vessel = vessel;\r\n        if (aisView.tab)\r\n        if (aisView.tab.is('.active'))\r\n            aisView.show();\r\n        else\r\n            aisView.tab.click(); \r\n        \r\n        aisView.showTrack(track);\r\n    }, \r\n    _updateView = function (displayed, vessel, getmore){\r\n        if (displayed.vessel.ts_pos_utc!=vessel.ts_pos_utc){\r\n            $(displayed.dialog).dialog(\"close\")\r\n            return true;\r\n        }\r\n        else\r\n            return false;\r\n    };\r\n    return {\r\n        showPosition: function(vessel){  \r\n            _showPosition(vessel, vessel);\r\n            //aisView.showTrack(vessel);\r\n        },\r\n        show: function (vessel, getmore) {\r\n            let ind = Polyfill.findIndex(allIinfoDialogs, function (d) { \r\n                return d.vessel.imo == vessel.imo && d.vessel.mmsi == vessel.mmsi \r\n            }),\r\n            isNew = true,\r\n            dialogOffset;\r\n            if (ind >= 0) {\r\n                isNew = false;\r\n                let displayed = allIinfoDialogs[ind];\r\n                dialogOffset = $(displayed.dialog).parent().offset();\r\n                ind = Polyfill.findIndex(infoDialogCascade, function (d) { return d.id == displayed.dialog.id })\r\n                if(!_updateView(displayed, vessel)){\r\n                    $(displayed.dialog).parent().insertAfter($('.ui-dialog').eq($('.ui-dialog').length - 1));\r\n                    return;\r\n                }\r\n            }\r\n\r\n            let dialog = displayInfoDialog({\r\n                vessel: vessel,\r\n                getmore: getmore,\r\n                displayedTrack: tools.displayedTrack,\r\n                closeFunc: function (event) {\r\n                    let ind = Polyfill.findIndex(infoDialogCascade, function (d) { return d.id == dialog.id });\r\n                    if (ind >= 0)\r\n                        infoDialogCascade.splice(ind, 1);\r\n                    ind = Polyfill.findIndex(allIinfoDialogs, function (d) { return d.dialog.id == dialog.id });\r\n                    if (ind >= 0)\r\n                        allIinfoDialogs.splice(ind, 1);\r\n                },\r\n                aisLayerSearcher: aisLayerSearcher,\r\n                modulePath:modulePath, \r\n                aisView: aisView,\r\n                myFleetView: myFleetView,\r\n                tools: tools\r\n            },\r\n                {\r\n                    openVesselInfoScreen: vesselInfoScreen.open,\r\n                    showTrack: tools.showTrack,\r\n                    showPosition: _showPosition\r\n                })\r\n\r\n            if (!dialogOffset && infoDialogCascade.length > 0) {\r\n                let pos = $(infoDialogCascade[infoDialogCascade.length - 1]).parent().position();\r\n                dialogOffset = {left:pos.left - 10, top:pos.top + 10};\r\n            }\r\n            if (dialogOffset)\r\n                $(dialog).dialog(\"option\", \"position\", [dialogOffset.left, dialogOffset.top]);\r\n            if (ind >= 0)\r\n                infoDialogCascade.splice(ind, 0, dialog);\r\n            else if(isNew)\r\n                infoDialogCascade.push(dialog);\r\n\r\n            allIinfoDialogs.push({ vessel: vessel, dialog: dialog });\r\n            $(dialog).on(\"dialogdragstop\", function (event, ui) {\r\n                var ind = Polyfill.findIndex(infoDialogCascade, function (d) { return d.id == dialog.id });\r\n                if (ind >= 0)\r\n                    infoDialogCascade.splice(ind, 1);\r\n            });\r\n\r\n        }\r\n    };\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/Views/InfoDialogView.js","require(\"./infodialog.css\")\r\nconst SpecialFloatView = require('./SpecialFloatView.js');\r\n\r\nlet addUnit = function (v, u) {\r\n\treturn v != null && v != \"\" ? v + u : \"\";\r\n},\r\n\tformatDate,\r\n\tformatDateTime,\r\n\tround = function (d, p) {\r\n\t\tlet isNeg = d < 0,\r\n\t\t\tpower = Math.pow(10, p)\r\n\t\treturn d ? ((isNeg ? -1 : 1) * (Math.round((isNeg ? d = -d : d) * power) / power)) : d\r\n\t},\r\n\tformatVessel = function (vessel) {\r\n\t\tlet d = new Date(vessel.ts_pos_utc * 1000);\r\n\t\tvessel.ts_pos_org = vessel.ts_pos_utc;\r\n\t\tvessel.dt_pos_utc = formatDate(d);\r\n\t\tvessel.ts_pos_utc = formatDateTime(d);\r\n\t\tvessel.ts_pos_loc = \"<br><span class='local'>\" + formatDateTime(d, true) + \"</span>\";\r\n\t\tvessel.ts_eta = vessel.ts_eta ? formatDateTime(new Date(vessel.ts_eta * 1000)) : \"\";\r\n\t\tvessel.cog = !isNaN(vessel.cog)?addUnit(round(vessel.cog, 5), \"\"):vessel.cog;\r\n\t\tvessel.sog = !isNaN(vessel.sog)?addUnit(round(vessel.sog, 5), nsGmx.Translations.getLanguage()==\"rus\"?\" \":\" kn\"):vessel.sog;\r\n\t\tvessel.rot = !isNaN(vessel.rot)?addUnit(round(vessel.rot, 5), nsGmx.Translations.getLanguage()==\"rus\"?\"/\":\"/min\"):vessel.rot;\r\n\t\tvessel.heading = !isNaN(vessel.heading)?addUnit(round(vessel.heading, 5), \"\"):vessel.heading;\r\n\t\tvessel.draught = !isNaN(vessel.draught)?addUnit(round(vessel.draught, 5), nsGmx.Translations.getLanguage()==\"rus\"?\" \":\" m\"):vessel.draught;\r\n\t\tvessel.length = !isNaN(vessel.length)?addUnit(vessel.length, nsGmx.Translations.getLanguage()==\"rus\"?\" \":\" m\"):vessel.length;\r\n\t\tvessel.width = !isNaN(vessel.width)?addUnit(vessel.width, nsGmx.Translations.getLanguage()==\"rus\"?\" \":\" m\"):vessel.width;\r\n\t\tvessel.source = vessel.source == 'T-AIS' ? _gtxt('AISSearch2.tais') : _gtxt('AISSearch2.sais');\r\n\t\treturn vessel;\r\n\t},\r\n\ttoDd = function (D, lng) {\r\n\t\tlet dir = D < 0 ? lng ? 'W' : 'S' : lng ? 'E' : 'N',\r\n\t\t\tdeg = Math.round((D < 0 ? D = -D : D) * 1000000) / 1000000\r\n\t\treturn deg + \"\" + dir\r\n\t},\r\n\tddToDms = function (D, lng) {\r\n\t\tlet dms = {\r\n\t\t\tdir: D < 0 ? lng ? 'W' : 'S' : lng ? 'E' : 'N',\r\n\t\t\tdeg: 0 | (D < 0 ? D = -D : D),\r\n\t\t\tmin: 0 | D % 1 * 60,\r\n\t\t\tsec: (0 | D * 60 % 1 * 6000) / 100\r\n\t\t};\r\n\t\treturn dms.deg + \"\" + dms.min + \"'\" + dms.sec + \"\\\" \" + dms.dir\r\n\t}\r\n\r\nmodule.exports = function ({ vessel, closeFunc, aisLayerSearcher, getmore,\r\n\tmodulePath,\taisView, displayedTrack,\r\n\tmyFleetView, tools }, commands) {\r\n\r\n\tformatDate = aisLayerSearcher.formatDate;\r\n\tformatDateTime = aisLayerSearcher.formatDateTime;\r\n\r\n\tlet myFleetModel = myFleetView.model,\r\n\t\tadd = myFleetModel && myFleetModel.findIndex(vessel) < 0;\r\n\r\n\tlet canvas = $('<div class=\"ais_myfleet_dialog\"/>'),\r\n\t\tmenu = $('<div class=\"column1 menu\"></div>').appendTo(canvas),\r\n\t\tphoto = $('<div class=\"photo\"><div></div></div>').appendTo(menu),\r\n\t\tunderphoto = $('<div class=\"underphoto\"><div></div></div>').appendTo(menu),\r\n\t\tcontent = $('<div class=\"column2 content\"></div>'),\r\n\t\tbuttons = $('<div class=\"column3 buttons\"></div>'),\r\n\t\tgifLoader = '<img src=\"img/progress.gif\">'\r\n\t//console.log(content);\r\n\r\n\tcanvas.append(content).append(buttons)\r\n\r\n\tlet searchInput = $('.leaflet-ext-search'),\r\n\t\tdialogW = 610, dialogH = 250,\r\n\t\tposX = searchInput.offset().left + searchInput.width() - dialogW,\r\n\t\tposY = searchInput.offset().top + searchInput.height() + 10,\r\n\t\tdialog = showDialog(vessel.vessel_name, canvas[0], { \r\n\t\t\twidth: dialogW, height: dialogH, posX: posX, posY:posY, \r\n\t\t\tcloseFunc: closeFunc \r\n\t\t}),\r\n\t\tvessel2,\r\n\t\tmoreInfo = function (v) {\r\n\t\t\tlet smallShipIcon = '<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"14px\" height=\"14px\" viewBox=\"0 0 14 14\" style=\"margin-left: 10px\" xml:space=\"preserve\">' +\r\n\t\t\t\t'<g style=\"fill: #48aff1;\">' +\r\n\t\t\t\t'<path class=\"st0\" d=\"M13.4,11H0.6c-0.2,0-0.4,0.1-0.5,0.3c-0.1,0.2-0.1,0.4,0,0.6l1.2,1.8C1.4,13.9,1.6,14,1.8,14h9.9   c0.2,0,0.3-0.1,0.4-0.2l1.7-1.8c0.2-0.2,0.2-0.4,0.1-0.7C13.9,11.1,13.7,11,13.4,11z\"/>' +\r\n\t\t\t\t'<path class=\"st0\" d=\"M9.3,9.7h2.9c0.2,0,0.4-0.1,0.5-0.3c0.1-0.2,0.1-0.4,0-0.6L9.8,4.5C9.7,4.3,9.4,4.2,9.2,4.3   C8.9,4.4,8.7,4.6,8.7,4.9v4.3C8.7,9.5,9,9.7,9.3,9.7z\"/>' +\r\n\t\t\t\t'<path class=\"st0\" d=\"M1.2,9.7H7c0.3,0,0.6-0.3,0.6-0.6V0.6c0-0.3-0.2-0.5-0.4-0.6C6.9-0.1,6.7,0,6.5,0.3L0.7,8.8   C0.6,9,0.5,9.2,0.6,9.4C0.7,9.6,0.9,9.7,1.2,9.7z\"/>' +\r\n\t\t\t\t'</g>' +\r\n\t\t\t\t'</svg>',\r\n\t\t\t\tvesselPropTempl = '<div class=\"vessel_prop vname\"><b>{{vessel_name}}</b>' + smallShipIcon + '</div>' +\r\n\t\t\t\t\t'<div class=\"vessel_prop altvname\"><b>' + (vessel2.registry_name && vessel2.registry_name != vessel2.vessel_name ? vessel2.registry_name : '') + '&nbsp;</b></div>'\r\n\r\n\t\t\t$('.content', canvas).append(Handlebars.compile(\r\n\t\t\t\t'<div class=\"vessel_props1\">' + vesselPropTempl +\r\n\t\t\t\t'<table>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.vessel_type\"}}: </div></td><td><div class=\"vessel_prop value\">{{vessel_type}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.flag\"}}: </div></td><td><div class=\"vessel_prop value\">{{flag_country}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">IMO: </div></td><td><div class=\"vessel_prop value\">{{imo}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">MMSI: </div></td><td><div class=\"vessel_prop value mmsi\">{{mmsi}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.callsign\"}}: </div></td><td><div class=\"vessel_prop value mmsi\">{{callsign}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.source\"}}: </div></td><td><div class=\"vessel_prop value\">{{source}}</div></td></tr>' +\r\n\t\t\t\t'</table>' +\r\n\t\t\t\t'</div>'\r\n\t\t\t)(v));\r\n\r\n\t\t\t$('.content', canvas).append(Handlebars.compile(\r\n\t\t\t\t'<div class=\"vessel_props2\">' + vesselPropTempl +\r\n\t\t\t\t'<table>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">COG | SOG: </div></td><td><div class=\"vessel_prop value\">{{cog}}&nbsp;&nbsp;&nbsp;{{sog}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">HDG | ROT: </div></td><td><div class=\"vessel_prop value\">{{heading}}&nbsp;&nbsp;&nbsp;{{rot}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.draught\"}}: </div></td><td><div class=\"vessel_prop value\">{{draught}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.destination\"}}: </div></td><td><div class=\"vessel_prop value\">{{destination}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">{{i \"AISSearch2.nav_status\"}}: </div></td><td><div class=\"vessel_prop value\">{{nav_status}}</div></td></tr>' +\r\n\t\t\t\t'<tr><td><div class=\"vessel_prop\">ETA: </div></td><td><div class=\"vessel_prop value\">{{ts_eta}}</div></td></tr>' +\r\n\r\n\t\t\t\t'</div>'\r\n\t\t\t)(v));\r\n\r\n\t\t\t$(underphoto).append('<table><tr>' +\r\n\t\t\t\t'<td class=\"ais_refresh\"><svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" height=\"16\" width=\"16\"><g class=\"nc-icon-wrapper\" fill=\"#444444\"><polyline data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 15,16 7,16 7,13 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 15,18 17,16 15,14 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" data-stroke=\"none\" fill=\"#444444\" points=\"15,18 17,16 15,14 \" stroke-linejoin=\"miter\" stroke-linecap=\"square\" style=\"stroke: currentColor;fill: currentColor;\"/> <polyline data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 9,8 17,8 17,11 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\"9,6 7,8 9,10 \" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/> <polygon data-color=\"color-2\" data-stroke=\"none\" fill=\"#444444\" points=\"9,6 7,8 9,10 \" stroke-linejoin=\"miter\" stroke-linecap=\"square\" style=\"stroke: currentColor;fill: currentColor;\"/> <rect x=\"2\" y=\"1\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" width=\"20\" height=\"22\" stroke-linejoin=\"miter\" style=\"stroke: currentColor;\"/></g></svg></td>' +\r\n\t\t\t\t'<td><div class=\"vessel_prop coordinates\"><span class=\"small\">' +\r\n\t\t\t\tddToDms(v.latitude, false) + ' ' + ddToDms(v.longitude, true) +\r\n\t\t\t\t'</small></div></td>' +\r\n\t\t\t\t'</tr></table>'\r\n\t\t\t);\r\n\r\n\t\t\tlet swap = \"<span class='small'>\" + toDd(v.latitude, false) + \" \" + toDd(v.longitude, true) + \"</span>\"\r\n\t\t\t$('.ais_refresh', underphoto).click((e) => {\r\n\t\t\t\tlet mi = $('.coordinates', underphoto),\r\n\t\t\t\t\tt = mi.html()\r\n\t\t\t\tmi.html(swap)\r\n\t\t\t\tswap = t\r\n\t\t\t})\r\n\r\n\t\t\t$('.vessel_props1', canvas).hide()\r\n\t\t\t$('.vessel_prop.vname svg', canvas).css('visibility', add ? 'hidden' : 'visible')\r\n\r\n\t\t}\r\n\r\n\t$(dialog).dialog({ resizable: false });\r\n\r\n\tif (!getmore) {\r\n\t\tvessel2 = $.extend({}, vessel);\r\n\t\tmoreInfo(formatVessel(vessel2));\r\n\t}\r\n\telse\r\n\t\taisLayerSearcher.searchNames([{ mmsi: vessel.mmsi, imo: vessel.imo }], function (response) {\r\n\t\t\tif (parseResponse(response)) {\r\n\t\t\t\tvessel2 = {};\r\n\t\t\t\tfor (var i = 0; i < response.Result.fields.length; ++i)\r\n\t\t\t\t\tvessel2[response.Result.fields[i]] = response.Result.values[0][i];\r\n\t\t\t\tmoreInfo(formatVessel(vessel2));\r\n\t\t\t\t$('.date', titlebar).html('<span class=\"utc\">' + vessel2.ts_pos_utc + ' UTC</span>' + vessel2.ts_pos_loc);\r\n\t\t\t\tif (typeof (getmore) == \"function\")\r\n\t\t\t\t\tgetmore(vessel2)\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tconsole.log(response)\r\n\t\t})\r\n\r\n\t// IMAGE\t\r\n\tlet scheme = document.location.href.replace(/^(https?:).+/, \"$1\");\r\n\r\n\t$('<img src=\"' + scheme + window.serverBase.replace(/^https?:/, \"\")+'plugins/ais/getphoto.ashx?mmsi=' + vessel.mmsi + '\">')\r\n\t.load(function(){\t\r\n\t\tif (this) $('div', photo).replaceWith(this);\r\n\t})\r\n\t.error(function(){\t\t\r\n\t\t$('<img src=\"' + scheme + '//photos.marinetraffic.com/ais/showphoto.aspx?size=thumb&mmsi=' + vessel.mmsi + '\">')\r\n\t\t.load(function(){\r\n\t\t\t\tif (this) $('div', photo).replaceWith(this);\r\n\t\t})\r\n\t});\t\r\n\r\n\t// BUTTONS\r\n\tlet menubuttons = $('<div class=\"menubuttons\"></div>').appendTo(buttons)\r\n\r\n\tlet openpage = $('<div class=\"button openpage\" title=\"' + _gtxt('AISSearch2.show_info') + '\">' +\r\n\t\t'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">' +\r\n\t\t'<g class=\"nc-icon-wrapper\" style=\"fill:currentColor\">' +\r\n\t\t'<path d=\"M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 9h2V7h-2v2z\"/>' +\r\n\t\t'</g>' +\r\n\t\t'</svg>'\r\n\t\t+ '</div>')\r\n\t\t.appendTo(menubuttons)\r\n\t\t.on('click', () => commands.openVesselInfoScreen.call(null, vessel, vessel2));\r\n\r\n\tlet showpos = $('<div class=\"button showpos\" title=\"' + _gtxt('AISSearch2.show_pos') + '\">' +\r\n\t\t'<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" width=\"20\" height=\"20\"><g class=\"nc-icon-wrapper\" fill=\"#444444\"><polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 1,7 1,1 7,1 \" stroke-linejoin=\"miter\"/> <polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 17,1 23,1 23,7 \" stroke-linejoin=\"miter\"/> <polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 23,17 23,23 17,23 \" stroke-linejoin=\"miter\"/> <polyline style=\"stroke:currentColor\" data-color=\"color-2\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" points=\" 7,23 1,23 1,17 \" stroke-linejoin=\"miter\"/> <rect style=\"stroke:currentColor\" x=\"8\" y=\"8\" fill=\"none\" stroke=\"#444444\" stroke-width=\"2\" stroke-linecap=\"square\" stroke-miterlimit=\"10\" width=\"8\" height=\"8\" stroke-linejoin=\"miter\"/></g></svg>' +\r\n\t\t'</div>')\r\n\t\t.appendTo(menubuttons)\r\n\t\t.on('click', function () {\r\n\t\t\tif (!vessel.ts_pos_org)\r\n\t\t\t\tvessel.ts_pos_org = vessel.ts_pos_utc;\r\n\t\t\tvessel.lastPosition = true;\r\n\t\t\tcommands.showPosition(vessel);\r\n\t\t\t// if(showtrack.is('.active'))\r\n\t\t\t// \tcommands.showTrack.call(null, [vessel.mmsi])\r\n\t\t});\t\r\n\t\r\n\tif (vessel.mmsi==273316240 && vessel.imo==9152959){\r\n\tlet special = new SpecialFloatView(),\r\n\t\tshowSpecial = $('<div class=\"button showspec\" title=\"' + _gtxt('AISSearch2.show_pos') + '\">' +\r\n\t\t\t'<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"22\" height=\"22\"><title>camera</title><g class=\"nc-icon-wrapper\" fill=\"#384b50\" style=\"fill:currentColor\"><path d=\"M21,4H17L15,1H9L7,4H3A3,3,0,0,0,0,7V19a3,3,0,0,0,3,3H21a3,3,0,0,0,3-3V7A3,3,0,0,0,21,4ZM12,18a5,5,0,1,1,5-5A5,5,0,0,1,12,18Z\"/></g></svg>' +\t\t\t\r\n\t\t\t'</div>')\r\n\t\t\t.appendTo(menubuttons)\r\n\t\t\t.on('click', function () {\r\n\t\t\t\tspecial.show();\r\n\t\t\t});\r\n\t}\r\n\r\n\tlet addremoveIcon = function (add) {\r\n\t\treturn (add ? '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><g class=\"nc-icon-wrapper\" fill=\"#444444\" style=\"fill: currentColor;\"><path d=\"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z\"/></g></svg>'\r\n\t\t\t: '<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"24px\" height=\"24px\" viewBox=\"0 0 24 24\" style=\"enable-background:new 0 0 24 24;fill: currentColor;\" xml:space=\"preserve\"><g><path class=\"st0\" d=\"M4,6H2v14c0,1.1,0.9,2,2,2h14v-2H4V6z M20,2H8C6.9,2,6,2.9,6,4v12c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2V4    C22,2.9,21.1,2,20,2z M19,11h-4v4h-2v-4H9V9h4V5h2v4h4V11z\"/></g><rect x=\"9\" y=\"5\" class=\"st0\" width=\"10\" height=\"4\"/><rect x=\"9\" y=\"11\" class=\"st0\" width=\"10\" height=\"4\"/></g></svg>')\r\n\t}\r\n\t\r\n\tlet addremove = $('<div class=\"button addremove\">' + addremoveIcon(add) + '</div>')\r\n\t\t.attr('title', add ? _gtxt('AISSearch2.myfleet_add') : _gtxt('AISSearch2.myfleet_remove'))\r\n\t\t.appendTo(menubuttons)\r\n\tif (myFleetModel.filterUpdating)\r\n\t\taddremove.addClass('disabled');\r\n\r\n\taddremove.on('click', function () {\r\n\t\tif (addremove.is('.disabled'))\r\n\t\t\treturn;\r\n\r\n\t\t$('.addremove').addClass('disabled')\r\n\t\taddremove.hide()\r\n\t\tprogress.append(gifLoader)\r\n\r\n\t\tmyFleetView.beforeExcludeMember(vessel.mmsi.toString());\r\n\t\tmyFleetModel.changeMembers(vessel).then(function () {\r\n\t\t\tadd = myFleetModel.findIndex(vessel) < 0;\r\n\t\t\tvar info = $('.icon-ship[vessel=\"' + vessel.mmsi + ' ' + vessel.imo + '\"]');\r\n\t\t\tinfo.css('visibility', !add ? 'visible' : 'hidden');\r\n\t\t\t$('.vessel_prop.vname svg', canvas).css('visibility', add ? 'hidden' : 'visible')\r\n\r\n\t\t\taddremove.attr('title', add ? '   ' : '   ')\r\n\t\t\t\t.html(addremoveIcon(add))\r\n\t\t\tprogress.text('');\r\n\t\t\t$('.addremove').removeClass('disabled').show();\r\n\t\t\t\r\n\t\t\ttools.eraseMyFleetMarker(vessel.mmsi);\r\n\t\t\tif (myFleetView.isActive)\r\n\t\t\t\tmyFleetView.show();\r\n\t\t\telse\r\n\t\t\t\ttools.redrawMarkers();\r\n\t\t})\r\n\t\t.catch((ex)=>console.log(ex));\r\n\t});\r\n\t//}\r\n\r\n\tlet progress = $('<div class=\"progress\"></div>')\r\n\t\t.appendTo(menubuttons);\r\n\r\n\t// TITLEBAR\t\r\n\tcanvas.parent('div').css({ 'margin': '0', 'overflow': 'hidden' })\r\n\tlet titlebar = $(dialog).parent().find('.ui-dialog-titlebar').css('padding', '0')\r\n\t\t.html('<table class=\"ais_info_dialog_titlebar\">' +\r\n\t\t'<tr><td><div class=\"date\">' +\r\n\t\t(!getmore ? Handlebars.compile('<span class=\"utc\">{{{ts_pos_utc}}} UTC</span>{{{ts_pos_loc}}}')(vessel2 ? vessel2 : vessel) : '') +\r\n\t\t'</div></td>' +\r\n\t\t\r\n\t\t'<td><div class=\"choose chooser done\"><span unselectable=\"on\">'+_gtxt('AISSearch2.dialog_tab_params')+'</span></div></td>' +\r\n\t\t'<td><div class=\"choose chooser\"><span unselectable=\"on\">'+_gtxt('AISSearch2.dialog_tab_general')+'</span></div></td>' +\r\n\t\t\r\n\t\t'<td id=\"closebut\" title=\"'+_gtxt('AISSearch2.close_but')+'\"><div class=\"ais_info_dialog_close-button\" title=\"'+_gtxt(\"AISSearch2.close_but\")+'\"></div></td></tr>' +\r\n\t\t'</table>'),\r\n\t\tonDone = function (e) { \r\n\t\t\te.stopPropagation(); \r\n\t\t\t$('.choose', titlebar).removeClass('done'); \r\n\t\t\t$(e.currentTarget).addClass('done'); \r\n\t\t};\r\n\r\n\t$('#closebut', titlebar).on('click', (e) => {$(dialog).dialog(\"close\"); })\r\n\t.on('mouseover', (e) => { \r\n\t\t$('.ais_info_dialog_close-button', titlebar).css('background', 'url(\"data:image/svg+xml;charset=utf8,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\'%3E%3Cline x1=\\'0\\' y1=\\'0\\' x2=\\'12\\' y2=\\'12\\' style=\\'stroke:%2348aff1;stroke-width:2px\\'/%3E%3Cline x1=\\'0\\' y1=\\'12\\' x2=\\'12\\' y2=\\'0\\' style=\\'stroke:%2348aff1;stroke-width:2px\\'/%3E%3C/svg%3E\") no-repeat')\r\n\t})\r\n\t.on('mouseout', (e) => { \r\n\t\t$('.ais_info_dialog_close-button', titlebar).attr('style', '')\r\n\t})\r\n\t//url(\"data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3Cline x1='0' y1='0' x2='12' y2='12' style='stroke:%2348aff1;stroke-width:2px'/%3E%3Cline x1='0' y1='12' x2='12' y2='0' style='stroke:%2348aff1;stroke-width:2px'/%3E%3C/svg%3E\") no-repeat\r\n\t$('.chooser', titlebar).eq(1).on('mousedown', (e) => { onDone(e); $('.vessel_props1', canvas).show(); $('.vessel_props2', canvas).hide() })\r\n\t$('.chooser', titlebar).eq(0).on('mousedown', (e) => { onDone(e); $('.vessel_props2', canvas).show(); $('.vessel_props1', canvas).hide() })\r\n\t$('.date span', titlebar).on('mousedown', (e) => { e.stopPropagation(); })\r\n\r\n\t//$( dialog ).on( \"dialogdragstart\", function( e, ui ) {console.log(e);console.log(ui)} );\r\n\r\n\treturn dialog\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Views/infodialog.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/infodialog.css\n// module id = 21\n// module chunks = 0","require(\"./SpecialFloatView.css\")\r\nconst _cssClassName = \"special\";\r\nconst BaseFloatView = require('./BaseFloatView.js');\r\nconst SpecialFloatView = function (){\r\n    BaseFloatView.apply(this, arguments);\r\n    this.frame.innerHTML = '<div class=\"' + _cssClassName + '\"></div><img class=\"img1\"><img class=\"img2\">' +\r\n    '<table class=\"logos\"><tr><td><img src=\"plugins/AIS/AISSearch/png/anchors.png\" style=\"position: unset;\"></td></tr>' +\r\n    '<tr><td><img src=\"plugins/AIS/AISSearch/png/rscc-logo.png\" style=\"position: unset;\"></td></tr></table>';\r\n    this.left = -1000;\r\n\r\n    this.contextMenu = document.createElement(\"div\"); \r\n    this.contextMenu.className = 'mf_group_menu';\r\n    this.contextMenu.innerHTML = '<div class=\"command zoomin\">' + _gtxt('AISSearch2.zoomin_com') + '</div>' +\r\n    '<div class=\"command zoomout\" style=\"display:none\">' + _gtxt('AISSearch2.zoomout_com') + '</div>' + \r\n    '<div class=\"command image1\">' + _gtxt('AISSearch2.image1_com') + '</div>' + \r\n    '<div class=\"command image2\">' + _gtxt('AISSearch2.image2_com') + '</div>' + \r\n    '<div class=\"command twoimages\">' + _gtxt('AISSearch2.twoimages_com') + '</div>' + \r\n    '<div class=\"command close\">' + _gtxt('AISSearch2.close_com') + '</div>';\r\n\r\n    this.contextMenu.addEventListener('mousedown', (e=>{\r\n        if(e.stopPropagation) e.stopPropagation();\r\n        //if(e.preventDefault) e.preventDefault();\r\n        e.cancelBubble=true;\r\n        e.returnValue=false;\r\n    }).bind(this)); \r\n    this.contextMenu.addEventListener('mouseleave', (e=>{\r\n            this.contextMenu.style.display = \"none\";\r\n            this.contextMenu.remove();\r\n    }).bind(this));  \r\n\r\n    let closeCom = this.contextMenu.querySelector('.close'),\r\n    zinCom = this.contextMenu.querySelector('.zoomin'),\r\n    zoutCom = this.contextMenu.querySelector('.zoomout'),\r\n    img1Com = this.contextMenu.querySelector('.image1'),\r\n    img2Com = this.contextMenu.querySelector('.image2'),\r\n    twoimgCom = this.contextMenu.querySelector('.twoimages'),\r\n    l, t , w , h,\r\n    rc1, rc2,\r\n    content = this.frame.querySelector('.'+_cssClassName),    \r\n    image1 = this.frame.querySelector('img.img1'),\r\n    image2 = this.frame.querySelector('img.img2'),\r\n    logos = this.frame.querySelector('.logos'),\r\n    showTwo = false,\r\n    restoreSize = function(){\r\n        let h1 = Math.floor(image1.getBoundingClientRect().height),\r\n        h2 = Math.floor(image2.getBoundingClientRect().height);\r\n        if (h1)        \r\n            content.style.height = h1+\"px\"; \r\n        else if (h2)       \r\n            content.style.height = h2+\"px\";\r\n        showTwo = false;         \r\n    },\r\n    zoomIn = function(image, w, h, wiw, wih){\r\n        let setPlace1 = function(){\r\n            image.style.width = wiw + \"px\";\r\n            image.style.height = \"\";\r\n\r\n            image.style.left = 0;\r\n            image.style.top = Math.round((wih - image.getBoundingClientRect().height)/2) + \"px\";\r\n        },\r\n        setPlace2 = function(){\r\n            image.style.width = \"\";\r\n            image.style.height = wih + \"px\";\r\n \r\n            image.style.left = Math.round((wiw - image.getBoundingClientRect().width)/2) + \"px\"; \r\n            image.style.top = 0; \r\n        };\r\n        if(wiw/wih>1)\r\n            if(parseInt(w)/parseInt(h)>wiw/wih)\r\n                setPlace1();\r\n            else\r\n                setPlace2();\r\n        else\r\n            if(parseInt(w)/parseInt(h)>wiw/wih)\r\n                setPlace1();\r\n            else\r\n                setPlace2();\r\n    },\r\n    zoomIn2 = function(image1, image2, w, h, wiw, wih){\r\n        let setPlace1 = function(){\r\n            image1.style.width = wiw + \"px\";\r\n            image2.style.width = wiw + \"px\";\r\n            image1.style.height = \"\";\r\n            image2.style.height = \"\";\r\n\r\n            image1.style.left = 0;\r\n            image2.style.left = 0;\r\n            image1.style.top = Math.round(wih/2 - image1.getBoundingClientRect().height) + \"px\";           \r\n            image2.style.top = image1.getBoundingClientRect().bottom + \"px\"; \r\n        },\r\n        setPlace2 = function(){\r\n            image1.style.width = \"\";\r\n            image2.style.width = \"\";\r\n            image1.style.height = Math.ceil(wih/2) + \"px\";\r\n            image2.style.height = Math.floor(wih/2) + \"px\";\r\n\r\n            image1.style.top = 0;       \r\n            image2.style.top = image1.getBoundingClientRect().bottom + \"px\"; \r\n            image1.style.left = Math.round((wiw - image1.getBoundingClientRect().width)/2) + \"px\"; \r\n            image2.style.left = image1.style.left;             \r\n        };\r\n        if(wiw/wih>1)\r\n            if(parseInt(w)/parseInt(h)>wiw/wih)\r\n                setPlace1();\r\n            else\r\n                setPlace2();\r\n        else\r\n            if(parseInt(w)/parseInt(h)>wiw/wih)        \r\n                setPlace1();\r\n            else\r\n                setPlace2();\r\n    };\r\n    closeCom.addEventListener(\"click\",(e=>{ \r\n        !this.allowMove && zoutCom.click(); \r\n        this.contextMenu.remove(); \r\n        this.left = -1000;\r\n\r\n        image1.style.display = \"block\";\r\n        image2.style.display = \"none\";\r\n        restoreSize();\r\n\r\n        this.hide(); \r\n        image1.src = \"\";\r\n        image2.src = \"\";\r\n    }).bind(this));\r\n    zinCom.addEventListener(\"click\",(e=>{\r\n        this.contextMenu.remove();\r\n        e.srcElement.style.display = 'none'; \r\n        zoutCom.style.display = 'block';\r\n        img1Com.style.display = 'none';\r\n        img2Com.style.display = 'none';\r\n        twoimgCom.style.display = 'none';\r\n        let st = getComputedStyle(content);\r\n        w = st.width; h = st.height; \r\n        l = this.left; t = this.top;\r\n        this.left = 0; \r\n        this.top = 0;  \r\n\r\n        content.style.width = window.innerWidth + \"px\";   \r\n        content.style.height = window.innerHeight + \"px\"; \r\n\r\n        rc1 = image1.getBoundingClientRect();\r\n        rc2 = image2.getBoundingClientRect();\r\n        let wiw = window.innerWidth, wih = window.innerHeight;\r\n// console.log((parseInt(w)+\"/ \"+parseInt(h)));\r\n// console.log(\"w/h \"+(parseInt(w)/parseInt(h)));\r\n// console.log(\"wiw/wih \"+(wiw/wih));\r\n\r\n        if (rc1.width && rc1.height && !rc2.width && !rc2.height){\r\n            zoomIn(image1, w, h, wiw, wih);\r\n            logos.style.left = image1.style.left;\r\n            logos.style.top = image1.style.top;\r\n        }\r\n        if (rc2.width && rc2.height && !rc1.width && !rc1.height){\r\n            zoomIn(image2, w, h, wiw, wih);\r\n            logos.style.left = image2.style.left;\r\n            logos.style.top = image2.style.top;\r\n        }\r\n        if (rc2.width && rc2.height && rc1.width && rc1.height){\r\n            zoomIn2(image1, image2, w, h, wiw, wih);\r\n            logos.style.left = image1.style.left;\r\n            logos.style.top = image1.style.top;\r\n        }\r\n\r\n        content.classList.add('zoomed_in');  \r\n        image1.classList.add('zoomed_in');   \r\n        image2.classList.add('zoomed_in'); \r\n        logos.classList.add('zoomed_in'); \r\n        this.allowMove = false;\r\n    }).bind(this));\r\n    zoutCom.addEventListener(\"click\",(e=>{\r\n        this.contextMenu.remove();\r\n        e.srcElement.style.display = 'none'; \r\n        zinCom.style.display = 'block';\r\n        img1Com.style.display = 'block';\r\n        img2Com.style.display = 'block';\r\n        twoimgCom.style.display = 'block';\r\n        this.left = l; \r\n        this.top = t;\r\n        content.style.width = w;   \r\n        content.style.height = h; \r\n\r\n        if (rc1.width && rc1.height) {     \r\n            image1.style.left = Math.floor(rc1.left) + \"px\";\r\n            image1.style.top = Math.floor(rc1.top) + \"px\";              \r\n            image1.style.height = Math.floor(rc1.height) + \"px\";\r\n            image1.style.width = Math.floor(rc1.width) + \"px\"; \r\n        }\r\n        if (rc2.width && rc2.height) {     \r\n            image2.style.left = Math.floor(rc2.left) + \"px\";\r\n            image2.style.top = Math.floor(rc2.top) + \"px\";       \r\n            image2.style.height = Math.floor(rc2.height) + \"px\";\r\n            image2.style.width = Math.floor(rc2.width) + \"px\";\r\n        }        \r\n        logos.style.left = 0;\r\n        logos.style.top = 0;\r\n\r\n        content.classList.remove('zoomed_in'); \r\n        image1.classList.remove('zoomed_in');   \r\n        image2.classList.remove('zoomed_in');   \r\n        logos.classList.remove('zoomed_in');  \r\n        this.allowMove = true;  \r\n    }).bind(this));\r\n    img1Com.addEventListener(\"click\",(e=>{\r\n        this.contextMenu.remove();\r\n        restoreSize();\r\n        image1.style.top = 0;\r\n        image1.style.display = \"block\";\r\n        image2.style.display = \"none\";\r\n    }).bind(this));\r\n    img2Com.addEventListener(\"click\",(e=>{\r\n        this.contextMenu.remove();\r\n        restoreSize();\r\n        image2.style.top = 0;\r\n        image2.style.display = \"block\";\r\n        image1.style.display = \"none\";\r\n    }).bind(this));\r\n    twoimgCom.addEventListener(\"click\",(e=>{\r\n        showTwo = true;\r\n\r\n        this.contextMenu.remove();\r\n        image1.style.display = \"block\";\r\n        image2.style.display = \"block\"; \r\n        let h1 = Math.floor(image1.getBoundingClientRect().height),\r\n        h2 = Math.floor(image2.getBoundingClientRect().height);\r\n        image2.style.top = Math.floor(h1)+\"px\";\r\n        if (h1 || h2)\r\n            content.style.height = (h1 + h2) + \"px\"; \r\n    }).bind(this));\r\n    image1.addEventListener(\"click\", (e=>{\r\n        if(!this.allowMove)\r\n            zoutCom.click();\r\n    }).bind(this));\r\n    image2.addEventListener(\"click\", (e=>{\r\n        if(!this.allowMove)\r\n            zoutCom.click();\r\n    }).bind(this));\r\n    content.addEventListener(\"click\", (e=>{\r\n        if(!this.allowMove)\r\n            zoutCom.click();\r\n    }).bind(this));\r\n\r\n    this.frame.addEventListener(\"contextmenu\", (e=>{\r\n        e.preventDefault();\r\n        this.frame.append(this.contextMenu);\r\n        this.contextMenu.style.display = \"block\";\r\n\r\n        if ((e.clientX - 10 + this.contextMenu.offsetWidth) < window.innerWidth) { \r\n            this.contextMenu.style.left = (e.clientX - this.left - 10) + \"px\";\r\n            this.contextMenu.style.right = \"\";\r\n        }\r\n        else{ \r\n            this.contextMenu.style.right = (this.right - e.clientX - 10) + \"px\";\r\n            this.contextMenu.style.left = \"\";\r\n        }\r\n        if ((e.clientY - 10 + this.contextMenu.offsetHeight) < window.innerHeight) {\r\n            this.contextMenu.style.top = (e.clientY - this.top - 10) + \"px\";\r\n            this.contextMenu.style.bottom = \"\";\r\n        }\r\n        else {  \r\n            this.contextMenu.style.bottom = (this.bottom - e.clientY - 10) + \"px\";\r\n            this.contextMenu.style.top = \"\";\r\n        }       \r\n    }).bind(this));\r\n}\r\n\r\nSpecialFloatView.prototype = Object.create(BaseFloatView.prototype);\r\n\r\nSpecialFloatView.prototype.show = function(){     \r\n    BaseFloatView.prototype.show.apply(this, arguments); \r\n    if (this.left>-1000)\r\n        return;\r\n    this.left = document.defaultView.getWindowWidth() - this.width;\r\n    this.top = 0;\r\n\r\n    let content = this.frame.querySelector('.'+_cssClassName),\r\n    image1 = this.frame.querySelector('img.img1'),\r\n    image2 = this.frame.querySelector('img.img2'),\r\n    rc = this.frame.getBoundingClientRect();\r\n\r\n    let downloadingImage1 = new Image();\r\n    downloadingImage1.onload = function(){\r\n        image1.src = this.src; \r\n        image1.style.left = 0; image1.style.top = 0;\r\n        image1.style.width = rc.width + \"px\";\r\n        image1.style.height = getComputedStyle(image1).height;\r\n//console.log(downloadingImage1.width)  \r\n//console.log(this.width)  \r\n//console.log(image1.getBoundingClientRect())  \r\n        if (image1.getBoundingClientRect().height)        \r\n            content.style.height = Math.floor(image1.getBoundingClientRect().height)+\"px\"; \r\n    };\r\n    downloadingImage1.onerror = function (e) {\r\n        image1.src = \"\";\r\n        image1.style.height = \"\";\r\n    };\r\n    downloadingImage1.src = \"//maps.kosmosnimki.ru/plugins/ais/50letpobedy.ashx?n=1&r=\" + Math.random();\r\n\r\n    let downloadingImage2 = new Image();\r\n    downloadingImage2.onload = function () {\r\n        image2.src = this.src;\r\n        image2.style.left = 0; image2.style.top = 0;\r\n        image2.style.width = rc.width + \"px\";\r\n        image2.style.height = getComputedStyle(image2).height;\r\n        image2.style.display = \"none\";\r\n//console.log(image1.getBoundingClientRect())\r\n    };\r\n    downloadingImage2.onerror = function (e) {\r\n        image2.src = \"\";\r\n        image2.style.height = \"\";\r\n    };\r\n    downloadingImage2.src = \"//maps.kosmosnimki.ru/plugins/ais/50letpobedy.ashx?n=2&r=\" + Math.random();\r\n\r\n    // UPDATE \r\n    let timer = setTimeout(function update() {\r\n//console.log(\"TIME \" + timer)\r\n        let downloadingImage1 = new Image();\r\n        downloadingImage1.onload = function () {\r\n            image1.src = downloadingImage1.src;\r\n        };\r\n        // downloadingImage1.onerror = function (e) {\r\n        //     image1.src = \"\";\r\n        //     image1.style.height = \"\";\r\n        // };\r\n        downloadingImage1.src = \"//maps.kosmosnimki.ru/plugins/ais/50letpobedy.ashx?n=1&r=\" + Math.random();\r\n\r\n        let downloadingImage2 = new Image();\r\n        downloadingImage2.onload = function () {\r\n            image2.src = downloadingImage2.src;\r\n        };\r\n        // downloadingImage2.onerror = function (e) {\r\n        //     image2.src = \"\";\r\n        //     image2.style.height = \"\";\r\n        // };\r\n        downloadingImage2.src = \"//maps.kosmosnimki.ru/plugins/ais/50letpobedy.ashx?n=2&r=\" + Math.random();\r\n        if (timer){\r\n            clearTimeout(timer);\r\n            timer = setTimeout(update, 1000 * 60 * 0.25);\r\n        }\r\n    }.bind(this), 1000 * 60 * 5),\r\n    \r\n    closeCom = this.contextMenu.querySelector('.close');\r\n    this.disposeTimer && closeCom.removeEventListener(\"click\", this.disposeTimer);\r\n    this.disposeTimer = function () {\r\n//console.log(\"STOP TIME\")\r\n        clearTimeout(timer);\r\n        timer = false;\r\n    };\r\n    closeCom.addEventListener(\"click\", this.disposeTimer);\r\n}\r\n\r\nmodule.exports = SpecialFloatView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/SpecialFloatView.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/SpecialFloatView.css\n// module id = 23\n// module chunks = 0","let _getMaxZindex = function(){\r\n    let dialogs = document.querySelectorAll('.ui-dialog'),\r\n    z,\r\n    zMax = Array.from(document.querySelectorAll('.ui-front')).reduce((p,c)=>{\r\n        z = parseFloat(getComputedStyle(c).zIndex);\r\n        return isNaN(z) || z<=p ? p : z;\r\n    }, 0);\r\n    zMax = Array.from(document.querySelectorAll('.float_view')).reduce((p,c)=>{\r\n        z = parseFloat(getComputedStyle(c).zIndex);\r\n        return isNaN(z) || z<=p ? p : z;\r\n    }, zMax);\r\n    return zMax;\r\n};\r\nconst BaseFloatView = function (){\r\n    let frame = document.createElement(\"div\"); \r\n    frame.className = \"float_view\";\r\n    frame.style.position = \"absolute\";\r\n    frame.style.display = \"none\";\r\n    let x, y;\r\n    frame.addEventListener('mousedown', e=>{\r\n        if (!this.allowMove)\r\n            return;\r\n            \r\n        x = e.clientX; y = e.clientY;\r\n        frame.style.zIndex = _getMaxZindex();\r\n        document.body.append(frame);\r\n            \r\n        if(e.stopPropagation) e.stopPropagation();\r\n        if(e.preventDefault) e.preventDefault();\r\n        e.cancelBubble=true;\r\n        e.returnValue=false;\r\n    });\r\n    frame.addEventListener('mouseup', e=>{\r\n        x = false; y = false;\r\n    });\r\n    document.body.addEventListener('mousemove', e=>{\r\n        if (!x && !y)\r\n            return;\r\n        let dx = e.clientX - x, dy = e.clientY - y,\r\n        rect = frame.getBoundingClientRect(),\r\n        fx = rect.left, fy = rect.top;\r\n        frame.style.left = fx + dx + \"px\";\r\n        frame.style.top = fy + dy + \"px\";\r\n        x = e.clientX; y = e.clientY;\r\n\r\n        if(e.stopPropagation) e.stopPropagation();\r\n        if(e.preventDefault) e.preventDefault();\r\n        e.cancelBubble=true;\r\n        e.returnValue=false;\r\n    }); \r\n    this.frame = frame;   \r\n    this.allowMove = true;\r\n}\r\n\r\nBaseFloatView.prototype = function () {\r\n    return {\r\n        get left(){ return this.frame.getBoundingClientRect().left; },\r\n        set left(v){ this.frame.style.left = v + \"px\"; },\r\n        get top(){ return this.frame.getBoundingClientRect().top; },\r\n        set top(v){ this.frame.style.top = v + \"px\"; },\r\n        get right(){ return this.frame.getBoundingClientRect().right; },\r\n        get bottom(){ return this.frame.getBoundingClientRect().bottom; },\r\n        get width(){ return this.frame.getBoundingClientRect().width; },\r\n        set width(v){ this.frame.style.width = v + \"px\"; },\r\n        get height(){ return this.frame.getBoundingClientRect().height; },\r\n        set height(v){ this.frame.style.height = v + \"px\"; },\r\n        show: function () {\r\n            this.frame.style.zIndex = _getMaxZindex();\r\n            document.body.append(this.frame);\r\n            this.frame.style.display = \"block\";\r\n        },\r\n        hide: function () {\r\n            this.frame.remove();\r\n        }\r\n    }\r\n}();\r\n\r\nmodule.exports = BaseFloatView;\n\n\n// WEBPACK FOOTER //\n// ./src/Views/BaseFloatView.js","require(\"./VesselInfoScreen.css\")\r\n\r\nmodule.exports = function ({modulePath, aisServices}){\r\n        var _ais,  \r\n        _galery, \r\n        _register, \r\n        _regcap,    \r\n        _leftPanel,  \r\n        _minh,\r\n        _lloyds,\r\n        resize,\r\n        menuAction,       \r\n\t    scheme = document.location.href.replace(/^(https?:).+/, \"$1\"),\r\n        show = function(vessel){\r\n//console.log(vessel) \r\n            $(\"body\").append(''+  \r\n'<table class=\"vessel-info-page overlay\">' +\r\n        '<tr>' +\r\n            '<td>' +\r\n'<table class=\"vessel-info-page container\">' +\r\n    '<tr>' +\r\n        '<td class=\"column1\">' +\r\n                '<table>' +\r\n                    '<tr>' +\r\n                        '<td>' +\r\n                            '<div>' +\r\n                                '<div class=\"title\">' +\r\n                                   '<div class=\"cell\">'+vessel.vessel_name+'<div class=\"timestamp\">'+vessel.ts_pos_utc+'</div></div>  ' +                  \r\n                                '</div>' +\r\n                                '<div class=\"menu\">' +\r\n                                '<div class=\"ais cell menu-item active\"><img src=\"'+modulePath+'svg/info_gen.svg\" class=\"icon\">'+_gtxt(\"AISSearch2.infoscreen_gen\")+'</div>' +\r\n                                '<div class=\"register cell menu-item\"><img src=\"'+modulePath+'svg/info.svg\" class=\"icon\">'+_gtxt(\"AISSearch2.infoscreen_reg\")+'</div>' +\r\n                                '<div class=\"galery cell menu-item\"><img src=\"'+modulePath+'svg/photogallery.svg\" class=\"icon\">'+_gtxt(\"AISSearch2.infoscreen_gal\")+'<div class=\"counter\">0</div></div>' +\r\n                               '</div>' +\r\n                            '</div>  ' +\r\n                        '</td>' +\r\n                    '</tr>' +\r\n                    '<tr>' +\r\n                        '<td class=\"frame\">' +\r\n                                '<div class=\"photo\">' +\r\n                                    '<img src=\"'+modulePath+'svg/no-image.svg\" class=\"no-image\">' +\r\n                                '</div>  ' +  \r\n                        '</td>' +\r\n                    '</tr>' +\r\n                '</table>' +\r\n    '</td>' +\r\n    '<td class=\"column2\">' +\r\n        '<div class=\"close-button-holder\">' +\r\n            '<div class=\"close-button\" title=\"'+_gtxt(\"AISSearch2.close_but\")+'\"></div>' +\r\n        '</div>' +\r\n        '<div class=\"register panel\">' +\r\n            '<div class=\"caption\">' +\r\n                '<span style=\"display: inline-block;height: 100%;vertical-align: middle;width: 40px;\"></span>' +\r\n                '<img src=\"img/progress.gif\" style=\"vertical-align: middle\">' +\r\n            '</div>' +\r\n            '<div class=\"menu\">' +\r\n                '<div>' +\r\n                    '<table>' +\r\n                        '<tr>' +\r\n                            '<td><div class=\"general menu-item active\">'+_gtxt(\"AISSearch2.reg_general_tab\")+'</div></td>' +\r\n                            '<td><div class=\"build menu-item\">'+_gtxt(\"AISSearch2.reg_build_tab\")+'</div></td>' +\r\n                            '<td><div class=\"dimensions menu-item\">'+_gtxt(\"AISSearch2.reg_chars_tab\")+'</div></td>' +\r\n                            '<td><div class=\"gears menu-item\">'+_gtxt(\"AISSearch2.reg_devs_tab\")+'</div></td>' +\r\n                        '</tr>' +\r\n                    '</table>' +\r\n                '</div>' +\r\n            '</div>' +\r\n            '<div class=\"content\">' +\r\n                '<div class=\"placeholder\"></div>' +\r\n            '</div>' +\r\n        '</div>' +\r\n\r\n        '<div class=\"galery panel\">' +   \r\n'<form action=\"' + aisServices + 'Upload.ashx\" class=\"uploadFile\" method=\"post\" enctype=\"multipart/form-data\" target=\"upload_target\" style=\"display:none\" >' +\r\n    '<input name=\"Filedata\" class=\"chooseFile\" type=\"file\">' +    \r\n    '<input name=\"imo\" type=\"hidden\" value=\"'+vessel.imo+'\">' +    \r\n    '<input name=\"mmsi\" type=\"hidden\" value=\"'+vessel.mmsi+'\">' +\r\n          //'<input type=\"submit\" name=\"submitBtn\" value=\"Upload\" />' +\r\n'</form>' + \r\n'<iframe id=\"upload_target\" name=\"upload_target\" src=\"#\" style=\"width:0;height:0;border:0px solid #fff;\"></iframe>' + \r\n            '<div class=\"placeholder\">' +\r\n                '<div class=\"photo\" onclick=\"document.querySelector(\\'.vessel-info-page .chooseFile\\').click();\"'+\r\n                ' style=\"background-image: url('+modulePath+'svg/add-image.svg);background-size: 50px;\"></div>' +                \r\n            '</div>' +\r\n        '</div>' +\r\n\r\n        '<div class=\"ais panel\">' +\r\n            '<div class=\"placeholder\"></div>' +\r\n        '</div>' +\r\n    '</td>' +\r\n    '</tr>' +\r\n'</table>' +\r\n            '</td>' +\r\n        '</tr>' +\r\n    '</table>'           \r\n            );\r\n        window.addEventListener(\"message\", function(e){\r\n            if (e.data.search(/\"uploaded\"\\:/)<0)\r\n                return;\r\n            var data = JSON.parse(e.data);    \r\n            if (data.id && parseInt(data.id)) { //uploaded:\r\n//console.log('UPLOADED '+id)\r\n                var counter = $('.vessel-info-page .menu-item .counter'), \r\n                count = parseInt(counter.text())+1;\r\n                counter.text(count).css('display', 'inline');\r\n                var preview = $(\"<div class='photo preview' id='\"+data.id+\"' style='background-image: url(\"+aisServices+\"getphoto.ashx?id=\"+data.id+\")'/>\");\r\n                $('.vessel-info-page .uploader').replaceWith(preview);\r\n                preview.click(showPicture);\r\n//console.log(preview)\r\n            }\r\n            else {//uploadError:            \r\n                $('.vessel-info-page .uploader').remove();\r\n                console.log(data.errmsg)\r\n            }  \r\n        }, false);\r\n\r\n        $('<img src=\"' + scheme + window.serverBase.replace(/^https?:/, \"\")+'plugins/ais/getphoto.ashx?mmsi=' + vessel.mmsi + '\">')\r\n        .load(function () {\t\r\n            if (this)\r\n                $('.column1 .photo img.no-image').replaceWith(this);\t\r\n        }).error(function(){\t\t\t\r\n            $('<img src=\"' + scheme + '//photos.marinetraffic.com/ais/showphoto.aspx?size=thumb&mmsi=' + vessel.mmsi + '\">').load(function () {\r\n                    if (this)\r\n                        $('.column1 .photo img.no-image').replaceWith(this);\r\n            });\r\n        });\r\n\r\n        $('.vessel-info-page .chooseFile').change(function(){            \r\n            $('<div class=\"photo uploader\" style=\"background-image:url(img/progress.gif);background-size:20px;\"></div>')\r\n            .insertAfter($('.vessel-info-page .galery .placeholder .photo').eq(0));\r\n            $('.vessel-info-page .uploadFile')[0].submit();\r\n        })\r\n        $('.vessel-info-page .close-button').click(function(){\r\n            $('.vessel-info-page.overlay').remove();\r\n        });\r\n/**/\r\n        $('.vessel-info-page .menu img[src$=\".svg\"]').each(function() {\r\n            var $img = jQuery(this);\r\n            var imgURL = $img.attr('src');\r\n            var attributes = $img.prop(\"attributes\");\r\n\r\n            $.get(imgURL, function(data) {\r\n                // Get the SVG tag, ignore the rest\r\n                var $svg = jQuery(data).find('svg');\r\n\r\n                // Remove any invalid XML tags\r\n                $svg = $svg.removeAttr('xmlns:a');\r\n\r\n                // Loop through IMG attributes and apply on SVG\r\n                $.each(attributes, function() {\r\n                    $svg.attr(this.name, this.value);\r\n                });\r\n\r\n                // Replace IMG with SVG\r\n                $img.replaceWith($svg);\r\n            }, 'xml');\r\n        });\r\n\r\n        _ais = document.querySelector('.vessel-info-page .column2 .ais') \r\n        _galery = document.querySelector('.vessel-info-page .column2 .galery')\r\n        _register = document.querySelector('.vessel-info-page .column2 .register .content')\r\n        _regcap = document.querySelector('.vessel-info-page .column2 .register .caption')    \r\n        _leftPanel = document.querySelector('.vessel-info-page .column1 table')      \r\n        _minh = 420\r\n        resize = function(){\r\n            var h = Math.floor(window.innerHeight*0.8);\r\n            if (h>_minh){\r\n                _leftPanel.style.height = _ais.style.height = _galery.style.height = h + \"px\";\r\n                _register.style.height = h - _regcap.offsetHeight + \"px\";\r\n            }\r\n            else{\r\n                _leftPanel.style.height = _ais.style.height = _galery.style.height = _minh + \"px\";\r\n                _register.style.height = _minh - _regcap.offsetHeight + \"px\";\r\n            }      \r\n        }\r\n        menuAction = function(e){\r\n            var target = e.currentTarget, p = target.parentElement, mia;\r\n            while(!(mia = p.querySelectorAll('.menu-item')) || mia.length<2){\r\n                p = p.parentElement;\r\n            }\r\n            for (var j=0; j<mia.length; ++j){\r\n                    //console.log( mia[j])\r\n                mia[j].className = mia[j].className.replace(/ active/, \"\");\r\n                var panel = document.querySelector('.panel.' + mia[j].classList[0]);\r\n                if (panel){\r\n                    if (mia[j]!=target)\r\n                    panel.style.display = \"none\";\r\n                    else{\r\n                    panel.style.display = \"block\";\r\n                    }\r\n                }\r\n            }\r\n            target.className += \" active\"\r\n            resize(); \r\n        }\r\n\r\n        window.addEventListener(\"resize\", resize, false); \r\n    \r\n        var mia = document.querySelectorAll('.column1 .menu-item');\r\n        for (var i=0; i<mia.length; ++i){\r\n            mia[i].addEventListener('click', menuAction)\r\n        }\r\n    \r\n        resize();    \r\n        $(_ais).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        $(_galery).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        $(_register).mCustomScrollbar({theme:\"vessel-info-theme\"});\r\n        document.querySelector('.vessel-info-page .container').style.display = \"table\";  \r\n    },\r\n    showPicture = function(){\r\n//console.log($(this))\r\n            $('.vessel-info-page .picture').remove();\r\n            var div = $('<div class=\"picture\" style=\"display:none;position:absolute;\"></div>')\r\n            .insertAfter('.vessel-info-page.container').click(function(){this.remove()});\r\n            $('<img src=\"'+aisServices+'getphoto.ashx?id='+this.id+'\">').load(function() {\r\n                    if (this){\r\n                        var w = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,\r\n                        h = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\r\n                        div.append(this)\r\n                        .css('display', 'table')\r\n                        .offset({\r\n                            left:(w-this.offsetWidth)/2,\r\n                            top:(h-this.offsetHeight)/2})\r\n//console.log($(this))\r\n//console.log(window.screen.width+\"-\"+$(this)[0].offsetWidth)\r\n//console.log((window.screen.width-$(this)[0].offsetWidth)/2)\r\n                    }\r\n            });\r\n        },\r\n    drawGallery = function(gallery){\r\n        if (gallery.length>0)\r\n            $('.vessel-info-page .menu-item .counter').text(gallery.length).css('display', 'inline');   \r\n        var galcontent = $(\".vessel-info-page .galery .placeholder\")\r\n        for (var i=0; i<gallery.length; ++i)\r\n            galcontent.append(\"<div class='photo preview' id='\"+gallery[i]+\"' style='background-image: url(\"+aisServices+\"getphoto.ashx?id=\"+gallery[i]+\")'/>\" )             \r\n        $('.photo.preview').click(showPicture)\r\n        resize();     \r\n    },\r\n    drawAis = function(ledokol){\r\n    var aiscontent = document.querySelector(\".vessel-info-page .ais .placeholder\")\r\n    aiscontent.innerHTML = \"\" +                \r\n    \"<div class='caption'><div>\"+_gtxt(\"AISSearch2.vessel_info\")+\"</div></div>\" +\r\n    \"<table>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.vessel_name\")+\"</td><td><b>\"+ledokol.vessel_name+(ledokol.registry_name?\" (\"+ledokol.registry_name+\")\":\"\")+\"</b></td></tr>\" +\r\n        \"<tr><td>IMO</td><td>\"+ledokol.imo+\"</td></tr>\" +\r\n        \"<tr><td>MMSI</td><td>\"+ledokol.mmsi+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.vessel_type\")+\"</td><td>\"+ledokol.vessel_type+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.flag\")+\"</td><td>\"+ledokol.flag_country+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.callsign\")+\"</td><td>\"+ledokol.callsign+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.length\")+\"</td><td>\"+ledokol.length+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.width\")+\"</td><td>\"+ledokol.width+\"</td></tr>\" +\r\n    \"</table>\" +\r\n    \"<div class='caption'><div>\"+_gtxt(\"AISSearch2.vessel_voyage\")+\"</div></div>\" +\r\n    \"<table>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.nav_status\")+\"</td><td>\"+ledokol.nav_status+\"</td></tr>\" +\r\n        \"<tr><td>COG</td><td>\"+ledokol.cog+\"</td></tr>\" +\r\n        \"<tr><td>SOG</td><td>\"+ledokol.sog+\"</td></tr>\" +\r\n        \"<tr><td>HDG</td><td>\"+ledokol.heading+\"</td></tr>\" +\r\n        \"<tr><td>ROT</td><td>\"+ledokol.rot+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.draught\")+\"</td><td>\"+ledokol.draught+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.destination\")+\"</td><td>\"+ledokol.destination+\"</td></tr>\" +\r\n        \"<tr><td>\"+_gtxt(\"AISSearch2.eta\")+\"</td><td>\"+ledokol.ts_eta+\"</td></tr>\" +\r\n    \"</table>\";     \r\n        resize();        \r\n    },\r\n    drawRegister = function(ledokol){\r\n        let regcontent = _register.querySelector(\".placeholder\"),\r\n        drawTable = function(groups, article, display){\r\n            let s = \"<div class='panel \"+article+\" article' style='display:\"+display+\"'>\";\r\n            for(let i=0; i<groups.length; ++i){\r\n                if (!groups[i])\r\n                    continue;\r\n                s += \"<div class='group'>\"+groups[i].name+\"</div><table>\"\r\n                for(let j=0; j<groups[i].properties.length; ++j){\r\n                    let pn = groups[i].properties[j].name,\r\n                    desc = nsGmx.Translations.getLanguage()==\"rus\"?groups[i].properties[j].description:null, \r\n                    pv = groups[i].properties[j].value\r\n                    s+= \"<tr><td>\"+pn+\r\n                    (desc ? \"<div class='description'>\" + desc + \"</div>\" : \"\")+ \r\n                    \"</td><td>\"+(pn==\" \"||pn==\" \"?\"<b>\"+pv+\"</b>\":pv)+\"</td></tr>\"\r\n                }\r\n                s += \"<tr><td>&nbsp;</td><td>&nbsp;</td></tr></table>\"\r\n            }\r\n            s += \"</div>\"\r\n            return s;\r\n        }\t\r\n\r\n        _regcap.innerHTML = \"<table class='register-title'>\"+\r\n        \"<tr><td><span class='switch active'>\"+_gtxt(\"AISSearch2.rmrs\")+\"</span> <span class='switch'>Lloyd's register</span></td></tr>\"+\r\n        \"<tr><td><span class='update'></span></td></tr>\"+\r\n        \"</table>\";\r\n\r\n        let drawRMR = function(){\r\n            if (ledokol) {\r\n                regcontent.innerHTML =\r\n                    drawTable([ledokol.data[0], ledokol.data[1], ledokol.data[9]], \"general\", \"block\") +\r\n                    drawTable([ledokol.data[2]], \"build\", \"none\") +\r\n                    drawTable([ledokol.data[3]], \"dimensions\", \"none\") +\r\n                    drawTable([ledokol.data[4], ledokol.data[5], ledokol.data[6], ledokol.data[7], ledokol.data[8]], \"gears\", \"none\");\r\n                _regcap.querySelector('.update').innerText = _gtxt(\"AISSearch2.last_update\") + \" \" + ledokol.version.replace(/ \\S+$/g, '');\r\n            }\r\n            else{\r\n                regcontent.innerHTML = \"\";\r\n                _regcap.querySelector('.update').innerHTML = \"&nbsp;\"; \r\n            }\r\n        },\r\n        drawLloyds = function(){\r\n            regcontent.innerHTML =\r\n                drawTable([_lloyds.data[15], _lloyds.data[14], _lloyds.data[13], _lloyds.data[11], _lloyds.data[0]], \"general\", \"block\") +\r\n                drawTable([_lloyds.data[10], _lloyds.data[12]], \"build\", \"none\") +\r\n                drawTable([_lloyds.data[9], _lloyds.data[8], _lloyds.data[7], _lloyds.data[6]], \"dimensions\", \"none\") +\r\n                drawTable([_lloyds.data[4], _lloyds.data[3], _lloyds.data[2], _lloyds.data[1], _lloyds.data[5]], \"gears\", \"none\");\r\n            _regcap.querySelector('.update').innerText = _gtxt(\"AISSearch2.last_update\") + \" \" + _lloyds.version.replace(/ \\S+$/g, '');   \r\n        },\r\n        regSwitches = _regcap.querySelectorAll(\".switch\");\r\n        regSwitches.forEach((item, i)=>item.addEventListener('click', e => {\r\n            let cl = e.currentTarget.classList;\r\n            if (!cl.contains('active')) {\r\n                _regcap.querySelector(\".switch.active\").classList.remove('active');\r\n                cl.add('active');\r\n                switch (i){\r\n                    case 0:\r\n                        drawRMR();\r\n                        break;\r\n                    case 1:\r\n                        if (_lloyds)\r\n                            drawLloyds();\r\n                        else\r\n                            regcontent.innerHTML = \"\";                        \r\n                        break;\r\n                }           \r\n                resize();   \r\n                mia[0] && mia[0].click();\r\n            }\r\n        }));\r\n        var mia = document.querySelectorAll('.column2 .menu-item');\r\n        for (var i=0; i<mia.length; ++i){\r\n            mia[i].addEventListener('click', menuAction)\r\n        }\r\n        drawRMR();             \r\n        resize(); \r\n        if (!ledokol)        \r\n            regSwitches[1].click();         \r\n    }\r\n\t\r\n\tlet open = function(vessel, vessel2){\r\n                    show(vessel2);\r\n                    var onFail = function(error){\r\n                        if (error!='register_no_data')\r\n                            console.log(error)\r\n                        _regcap.innerHTML = \"\";\r\n                    } \r\n                    new Promise(function(resolve, reject){\r\n                        (function wait(){\r\n                            if(!vessel2)\r\n                                setTimeout(wait, 100);\r\n                        })();\r\n                        resolve(vessel2)\r\n                    })\r\n                    .then(function(ship){\r\n//console.log(ship)\r\n                        drawAis(ship)\r\n                    }, \r\n                    onFail);\r\n                    var registerServerUrl = scheme + \"//kosmosnimki.ru/demo/register/api/v1/\",\r\n                        lloydsServerUrl = scheme + \"//kosmosnimki.ru/demo/lloyds/api/v1/\",\r\n                        rmr;\r\n                    if(vessel.imo && vessel.imo!=0 && vessel.imo!=-1){\r\n                        fetch(registerServerUrl+\"Ship/Search/\"+vessel.imo+(nsGmx.Translations.getLanguage()==\"rus\"?\"/ru\":\"/en\"))\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            if (ship.length>0)\r\n                                return fetch(registerServerUrl+\"Ship/Get/\"+ship[0].RS+(nsGmx.Translations.getLanguage()==\"rus\"?\"/ru\":\"/en\"))\r\n                            else\r\n                                return Promise.resolve({json:()=>null});\r\n                            //else\r\n                            //    return Promise.reject('register_no_data');\r\n                        })\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            //console.log(ship)\r\n                            rmr = ship;\r\n                            if (rmr)\r\n                                drawRegister(rmr);\r\n                            return fetch(lloydsServerUrl+\"Ship/Search/\"+vessel.imo+(nsGmx.Translations.getLanguage()==\"rus\"?\"/ru\":\"/en\"));\r\n                        })                        \r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            if (ship.length>0)\r\n                                return fetch(lloydsServerUrl+\"Ship/Get/\"+ship[0].RS+(nsGmx.Translations.getLanguage()==\"rus\"?\"/ru\":\"/en\"))\r\n                            else\r\n                                return Promise.reject('register_no_data');\r\n                        })\r\n                        .then(function(response){\r\n                            return response.json();\r\n                        })  \r\n                        .then(function(ship) {\r\n                            _lloyds = ship;\r\n                            if (nsGmx.Translations.getLanguage()!=\"rus\"){\r\n                                _lloyds.data[15].name = \"Vessel Data\";\r\n                                _lloyds.data[14].name = \"Type and Status\";\r\n                                _lloyds.data[13].name = \"Companies\";\r\n                                _lloyds.data[12].name = \"Companies\";\r\n                                _lloyds.data[11].name = \"Safety\";\r\n                                _lloyds.data[10].name = \"History\";\r\n                                _lloyds.data[9].name = \"Characteristics\";\r\n                                _lloyds.data[8].name = \"Dimensions\";\r\n                                _lloyds.data[7].name = \"Hull\";\r\n                                _lloyds.data[6].name = \"Capacity\";\r\n                                _lloyds.data[5].name = \"Cargo\";\r\n                                _lloyds.data[4].name = \"Machinery\";\r\n                                _lloyds.data[3].name = \"Fuel\";\r\n                                _lloyds.data[2].name = \"Energy Supply\";\r\n                                _lloyds.data[1].name = \"Propellers and Thrusters\";\r\n                                _lloyds.data[0].name = \"Codes\";\r\n                            }\r\n                            if (!rmr)\r\n                                drawRegister(rmr);\r\n                        })\r\n                        .catch( onFail );\r\n                    }\r\n                    else                    \r\n                        _regcap.innerHTML = \"\";\r\n\r\n                    new Promise(function(resolve, reject){\r\n                        sendCrossDomainJSONRequest(aisServices + \r\n                            \"gallery.ashx?mmsi=\"+vessel.mmsi+\"&imo=\"+vessel.imo, function(response){\r\n                            if (response.Status==\"ok\") \r\n                                resolve(response.Result);\r\n                            else\r\n                                reject(response)\r\n                        });\r\n                    })\r\n                    .then(function(gallery){\r\n                        drawGallery(gallery)\r\n                    }, \r\n                    onFail);\r\n                }\r\n        \r\n    return {\r\n\t\topen:open,\r\n            show: show,\r\n            drawRegister: drawRegister,\r\n            drawAis: drawAis,\r\n            drawGallery:drawGallery\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Views/VesselInfoScreen.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/Views/VesselInfoScreen.css\n// module id = 26\n// module chunks = 0","module.exports = function (options) {\r\n    const _baseUrl = window.serverBase || document.location.href.replace(/^(https?:).+/, \"$1\") + '//maps.kosmosnimki.ru/',\r\n        _aisServices = _baseUrl + \"Plugins/AIS/\",\r\n        _serverScript = _baseUrl + 'VectorLayer/Search.ashx';\r\n    const { aisLastPoint:_aisLastPoint, \r\n        screenSearchLayer:_screenSearchLayer, \r\n        aisLayerID:_aisLayerID, \r\n        historyLayer:_historyLayer \r\n    } = options;\r\n\r\n    return {\r\n        baseUrl: _baseUrl,\r\n        get screenSearchLayer(){return _screenSearchLayer},\r\n        aisServices: _aisServices,\r\n        getBorder: function () {\r\n            var lmap = nsGmx.leafletMap;\r\n            var dFeatures = lmap.gmxDrawing.getFeatures();\r\n            if (dFeatures.length) { return dFeatures[dFeatures.length - 1].toGeoJSON(); }\r\n            var latLngBounds = lmap.getBounds(),\r\n                sw = latLngBounds.getSouthWest(),\r\n                ne = latLngBounds.getNorthEast(),\r\n                min = { x: sw.lng, y: sw.lat },\r\n                max = { x: ne.lng, y: ne.lat },\r\n                minX = min.x,\r\n                maxX = max.x,\r\n                geo = { type: 'Polygon', coordinates: [[[minX, min.y], [minX, max.y], [maxX, max.y], [maxX, min.y], [minX, min.y]]] },\r\n                w = (maxX - minX) / 2;\r\n\r\n            if (w >= 180) {\r\n                geo = { type: 'Polygon', coordinates: [[[-180, min.y], [-180, max.y], [180, max.y], [180, min.y], [-180, min.y]]] };\r\n            }\r\n            else if (maxX > 180 || minX < -180) {\r\n                var center = ((maxX + minX) / 2) % 360;\r\n                if (center > 180) { center -= 360; }\r\n                else if (center < -180) { center += 360; }\r\n                minX = center - w; maxX = center + w;\r\n                if (minX < -180) {\r\n                    geo = {\r\n                        type: 'MultiPolygon', coordinates: [\r\n                            [[[-180, min.y], [-180, max.y], [maxX, max.y], [maxX, min.y], [-180, min.y]]],\r\n                            [[[minX + 360, min.y], [minX + 360, max.y], [180, max.y], [180, min.y], [minX + 360, min.y]]]\r\n                        ]\r\n                    };\r\n                } else if (maxX > 180) {\r\n                    geo = {\r\n                        type: 'MultiPolygon', coordinates: [\r\n                            [[[minX, min.y], [minX, max.y], [180, max.y], [180, min.y], [minX, min.y]]],\r\n                            [[[-180, min.y], [-180, max.y], [maxX - 360, max.y], [maxX - 360, min.y], [-180, min.y]]]\r\n                        ]\r\n                    };\r\n                }\r\n            }\r\n            return geo;\r\n        },\r\n\r\n        formatTime: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleTimeString();\r\n        },\r\n        formatDate: function (d, local) {\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleDateString();\r\n        },\r\n        formatDateTime: function (d, local) {\r\n            if (d.isNaN)\r\n                return \"\";\r\n            var temp = new Date(d)\r\n            if (!local)\r\n                temp.setMinutes(temp.getMinutes() + temp.getTimezoneOffset())\r\n            return temp.toLocaleString().replace(/,/, \"\");\r\n        },\r\n\r\n        formatDate2: function (d, local) {\r\n            var dd, m, y, h, mm;\r\n            if (local) {\r\n                dd = (\"0\" + d.getDate()).slice(-2);\r\n                m = (\"0\" + (d.getMonth() + 1)).slice(-2);\r\n                y = d.getFullYear();\r\n                h = (\"0\" + d.getHours()).slice(-2);\r\n                mm = (\"0\" + d.getMinutes()).slice(-2);\r\n                return dd + \".\" + m + \".\" + y + \" \" + h + \":\" + mm +\r\n                    \" (\" + (\"0\" + d.getUTCHours()).slice(-2) + \":\" + (\"0\" + d.getUTCMinutes()).slice(-2) + \" UTC)\";\r\n            }\r\n            else {\r\n                dd = (\"0\" + d.getUTCDate()).slice(-2);\r\n                m = (\"0\" + (d.getUTCMonth() + 1)).slice(-2);\r\n                y = d.getUTCFullYear();\r\n                h = (\"0\" + d.getUTCHours()).slice(-2);\r\n                mm = (\"0\" + d.getUTCMinutes()).slice(-2);\r\n                var\r\n                    ldd = (\"0\" + d.getDate()).slice(-2),\r\n                    lm = (\"0\" + (d.getMonth() + 1)).slice(-2),\r\n                    ly = d.getFullYear(),\r\n                    lh = (\"0\" + d.getHours()).slice(-2),\r\n                    lmm = (\"0\" + d.getMinutes()).slice(-2),\r\n                    offset = -d.getTimezoneOffset() / 60;\r\n                return dd + \".\" + m + \".\" + y + \" <span class='utc'>\" + h + \":\" + mm + \" UTC</span> (\" + lh + \":\" + lmm + \")\"\r\n                //return dd+\".\"+m+\".\"+y+\" \"+h+\":\"+mm+\" UTC <br>\"+\r\n                //\"<span class='small'>(\"+ldd+\".\"+lm+\".\"+ly+\" \"+lh+\":\"+lmm+\" UTC\"+(offset>0?\"+\":\"\")+offset+\")</span>\";\r\n            }\r\n        },\r\n        placeVesselTypeIcon: function(vessel){\r\n            let protocol = document.location.protocol;            \r\n            // speed icon\r\n            if (vessel.sog >= 8) {\r\n                vessel.iconAlt = protocol + \"//geomixer.scanex.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS\\\\SCF\\\\sog8-L-100-move.svg\";\r\n            }\r\n            else if (4 < vessel.sog && vessel.sog < 8) {\r\n                vessel.iconAlt = protocol + \"//geomixer.scanex.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS\\\\SCF\\\\sog4_8-L-100-move.svg\";\r\n            }\r\n            else if (0 < vessel.sog && vessel.sog <= 4) {\r\n                vessel.iconAlt = protocol + \"//geomixer.scanex.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS\\\\SCF\\\\sog4-L-100-move.svg\";\r\n            }\r\n            else {\r\n                vessel.iconAlt = protocol + \"//geomixer.scanex.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS\\\\SCF\\\\sog-L-100-stand_red.svg\";\r\n            }   \r\n            \r\n            // type icon\r\n            switch (vessel.vessel_type.toLowerCase()) {\r\n                case \"cargo\":\r\n                    vessel.icon = protocol + \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Ccargo-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                case \"tanker\":\r\n                    vessel.icon = protocol + \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Ctanker-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                case \"fishing\":\r\n                    vessel.icon = protocol + \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Cfishing-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                case \"passenger\":\r\n                    vessel.icon = protocol + \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Cpassenger-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;                \r\n                case \"hsc\":\r\n                    vessel.icon = protocol + \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Chighspeed-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                case \"pleasure craft\":\r\n                case \"sailing\":\r\n                    vessel.icon = protocol + \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Cpleasure-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                case \"unknown\": \r\n                case \"reserved\": \r\n                case \"other\":\r\n                    vessel.icon = protocol + \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Cother-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n                default:\r\n                    vessel.icon = protocol + \"//maps.kosmosnimki.ru/GetImage.ashx?usr=haibrahmanov%40scanex.ru&img=AIS%5Cspecialcraft-L-100-\" +\r\n                        (vessel.sog != 0 ? \"move\" : \"stand\") + \".svg\"\r\n                    break;\r\n            }\r\n        },\r\n\r\n        searchPositionsAgg: function (vessels, dateInterval, callback) {\r\n            //console.log(dateInterval);\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _historyLayer, //'8EE2C7996800458AAF70BABB43321FA4',//\r\n                orderdirection: 'desc',\r\n                orderby: 'ts_pos_utc',\r\n                columns:'[{\"Value\":\"mmsi\"},{\"Value\":\"flag_country\"},{\"Value\":\"callsign\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"cog\"},{\"Value\":\"sog\"},{\"Value\":\"draught\"},{\"Value\":\"vessel_type\"},'+\r\n                '{\"Value\":\"destination\"},{\"Value\":\"ts_eta\"},{\"Value\":\"nav_status\"},{\"Value\":\"heading\"},{\"Value\":\"rot\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"},{\"Value\":\"source\"}]',\r\n                \r\n                query: \"([mmsi] IN (\" + vessels.join(',') + \")) and '\" + dateInterval.dateBegin.toISOString() + \"'<=[ts_pos_utc] and [ts_pos_utc]<'\" + dateInterval.dateEnd.toISOString() + \"'\"\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchPositions: function (vessels, dateInterval, callback) {\r\n            //console.log(\"searchById\");\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _historyLayer, //'8EE2C7996800458AAF70BABB43321FA4',//\r\n                //orderdirection: 'desc',\r\n                //orderby: 'ts_pos_utc',\r\n                query: \"([mmsi] IN (\" + vessels.join(',') + \")) and '\" + dateInterval.dateBegin.toISOString() + \"'<=[ts_pos_utc] and [ts_pos_utc]<'\" + dateInterval.dateEnd.toISOString() + \"'\"\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchById: function (aid, callback) {\r\n            //console.log(\"searchById\");\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _aisLayerID, //'8EE2C7996800458AAF70BABB43321FA4'\r\n                columns: '[{\"Value\":\"vessel_name\"},{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"},{\"Value\":\"source\"}]',\r\n                query: \"([id] IN (\" + aid.join(',') + \"))\"\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        \r\n        searchString2: function (query, isfuzzy, callback) {\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _aisLastPoint,\r\n                columns: '[{\"Value\":\"vessel_name\"},{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"vessel_type\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"},{\"Value\":\"source\"}]',\r\n                //orderdirection: 'desc',\r\n                //orderby: 'vessel_name',\r\n                query: query\r\n            };\r\n            if (isfuzzy)\r\n                request.pagesize = 1000;\r\n            L.gmxUtil.sendCrossDomainPostRequest(\"http://maps.kosmosnimki.ru/plugins/ais/searchship.ashx\", request, callback);\r\n        },\r\n        searchString: function (searchString, isfuzzy, callback) {\r\n            //console.log(_aisLastPoint+\", \"+_aisLayerID)\r\n            var query = \"\";\r\n            if (searchString) {\r\n                searchString = searchString.toUpperCase();\r\n                if (searchString.search(/[^\\d, ]/) === -1) {\r\n                    var arr = searchString.replace(/ /g, '').split(/,/);\r\n                    query = \"([mmsi] IN (\" + arr.join(',') + \"))\" +\r\n                        \"OR ([imo] IN (\" + arr.join(',') + \"))\"\r\n                } else {\r\n                    if (isfuzzy)\r\n                        query = '([vessel_name] startswith \\'' + searchString + '\\') OR ([vessel_name] contains \\' ' + searchString + '\\')';\r\n                    else\r\n                        query = '([vessel_name] startswith \\'' + searchString + '\\') OR ([vessel_name] contains \\' ' + searchString + '\\')';\r\n                }\r\n            }\r\n            var request = {\r\n                WrapStyle: 'window',\r\n                layer: _aisLastPoint,\r\n                columns: '[{\"Value\":\"vessel_name\"},{\"Value\":\"mmsi\"},{\"Value\":\"imo\"},{\"Value\":\"ts_pos_utc\"},{\"Value\":\"vessel_type\"},{\"Value\":\"longitude\"},{\"Value\":\"latitude\"},{\"Value\":\"source\"}]',\r\n                //orderdirection: 'desc',\r\n                //orderby: 'vessel_name',\r\n                query: query\r\n            };\r\n            if (isfuzzy)\r\n                request.pagesize = 1000;\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchNames: function (avessels, callback) {\r\n            var a = avessels.reduce((p,c)=>{\r\n                if((c.mmsi && c.mmsi!=\"\") || (c.imo && c.imo!=\"\" && c.imo!=-1)) \r\n                    p.push(c); \r\n                return p;\r\n            },[]),\r\n            request = {\r\n                WrapStyle: 'window',\r\n                layer: _aisLastPoint,\r\n                orderdirection: 'desc',\r\n                orderby: 'ts_pos_utc',\r\n                query: a.map(function (v) { return \"([mmsi]=\" + v.mmsi + (v.imo && v.imo != \"\" ? (\" and [imo]=\" + v.imo) : \"\") + \")\" }).join(\" or \")\r\n            };\r\n            L.gmxUtil.sendCrossDomainPostRequest(_serverScript, request, callback);\r\n        },\r\n        searchScreen: function (options, callback) {\r\n            var lmap = nsGmx.leafletMap;\r\n            var latLngBounds = lmap.getBounds(),\r\n                sw = latLngBounds.getSouthWest(),\r\n                ne = latLngBounds.getNorthEast(),\r\n                min = { x: sw.lng, y: sw.lat },\r\n                max = { x: ne.lng, y: ne.lat };\r\n            let queryParams = { WrapStyle: 'window', minx: min.x, miny: min.y, maxx: max.x, maxy: max.y, layer: _screenSearchLayer },\r\n            //     layerTreeNode = $(_queryMapLayers.buildedTree).find(\"div[LayerID='\"+_screenSearchLayer+\"']\")[0];\r\n            // if (layerTreeNode){   \r\n            //     var gmxProp = layerTreeNode.gmxProperties.content.properties;\r\n            //     if (gmxProp.Temporal) {\r\n            //         queryParams.s = options.dateInterval.get('dateBegin').toJSON(),\r\n            //         queryParams.e = options.dateInterval.get('dateEnd').toJSON();\r\n            //     }\r\n            // }\r\n            dateInterval = nsGmx.widgets.commonCalendar.getDateInterval();\r\n            queryParams.s = options.dateInterval.get('dateBegin').toJSON(),\r\n            queryParams.e = options.dateInterval.get('dateEnd').toJSON();\r\n//console.log(queryParams);\r\n            L.gmxUtil.sendCrossDomainPostRequest(_aisServices + \"SearchScreen.ashx\",\r\n                queryParams,\r\n                callback);\r\n        }\r\n    };\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/Search/Searcher.js","const Polyfill = require('./Polyfill');\r\nmodule.exports = function (options) {\r\n    const _layersByID = nsGmx.gmxMap.layersByID;\r\n      let _aisLayer = _layersByID[options.aisLayerID],\r\n          _tracksLayer = _layersByID[options.tracksLayerID],\r\n          _screenSearchLayer = _layersByID[options.screenSearchLayer],\r\n          _lastPointLayerAlt = _layersByID[options.lastPointLayerAlt],\r\n          _lastPointLayerAltFact = _layersByID[options.lastPointLayerAlt],\r\n          _tracksLayerAlt = _layersByID[options.tracksLayerAlt],\r\n          _historyLayerAlt = _layersByID[options.historyLayerAlt];\r\n\r\n    let   _almmsi, _tlmmsi, _aldt, _tldt;\r\n    try{\r\n          _almmsi = _aisLayer.getGmxProperties().attributes.indexOf(\"mmsi\") + 1, \r\n          _tlmmsi = Polyfill.findIndex(_tracksLayer.getGmxProperties().attributes, function(p){return \"mmsi\"==p.toLowerCase();}) + 1,\r\n          _aldt = _aisLayer.getGmxProperties().attributes.indexOf(\"ts_pos_utc\") + 1, \r\n          _tldt = Polyfill.findIndex(_tracksLayer.getGmxProperties().attributes, function(p){return \"date\"==p.toLowerCase();}) + 1;\r\n// console.log(_almmsi+\" \"+_aldt)\r\n// console.log(_tlmmsi+\" \"+_tldt)\r\n    }\r\n    catch(ex){}\r\n\r\n    let _displayedTrack = {mmsi:null},  \r\n    _displayedVessels = \"all\", \r\n    _notDisplayedVessels = [],\r\n    _filterFunc = function (args) {\r\n        let dates = _displayedTrack.dates ? _displayedTrack.dates.list : null,\r\n        mmsiArr = [];\r\n\r\n        if (_displayedTrack.mmsi && _notDisplayedVessels.indexOf(_displayedTrack.mmsi.toString())<0 &&\r\n            (_displayedVessels==\"all\" || _displayedVessels.indexOf(_displayedTrack.mmsi.toString()) >= 0))\r\n            mmsiArr.push(_displayedTrack.mmsi);\r\n\r\n        let mmsi = args.properties[args.properties.length > 20 ? _almmsi : _tlmmsi].toString(),\r\n            dt = new Date(new Date(args.properties[args.properties.length>20 ? _aldt : _tldt]*1000).setUTCHours(0,0,0,0)),\r\n            i, j;\r\n        for (i = 0; i < mmsiArr.length; i++) {\r\n            if (mmsi == mmsiArr[i]) { \r\n                if (dates)\r\n                    for (j=0; j<dates.length; ++j){\r\n                        if (dates[j].getTime()==dt.getTime()){\r\n                            return true;\r\n                        }\r\n                    }\r\n                else{\r\n                    return true; \r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }, \r\n    _setTrackFilter = function(){\r\n//console.log(_displayedTrack)\r\n        let lmap = nsGmx.leafletMap;\r\n        if (_aisLayer && _aisLayer.removeFilter) {\r\n            _aisLayer.removeFilter();\r\n            if (_displayedTrack && _displayedTrack.mmsi) {\r\n                _aisLayer.setFilter(_filterFunc);\r\n                if (!_aisLayer._map) {\r\n                    lmap.addLayer(_aisLayer);\r\n                }\r\n            }\r\n            else\r\n                lmap.removeLayer(_aisLayer); \r\n        }\r\n        if (_tracksLayer && _tracksLayer.removeFilter) {\r\n            _tracksLayer.removeFilter();\r\n            if (_displayedTrack && _displayedTrack.mmsi) {\r\n                _tracksLayer.setFilter(_filterFunc);\r\n                if (!_tracksLayer._map) {\r\n                    lmap.addLayer(_tracksLayer);\r\n                }\r\n            }\r\n            else \r\n                lmap.removeLayer(_tracksLayer);\r\n        }\r\n    }, \r\n    _specialVesselFilters,\r\n    _setVesselFilter = function(){\r\n        if (_screenSearchLayer) {\r\n            _screenSearchLayer.removeFilter();  \r\n\r\n            if (_displayedVessels!=\"all\" || _notDisplayedVessels.length || _specialVesselFilters) {            \r\n                let ai = _screenSearchLayer._gmx.tileAttributeIndexes, fields = [];\r\n                for (var k in ai)\r\n                    fields[ai[k]] = k;\r\n                _screenSearchLayer.setFilter((args) => {\r\n\r\n                    for(var f in _specialVesselFilters)\r\n                            _specialVesselFilters[f](args, ai, _displayedVessels);\r\n\r\n                    let mmsi = args.properties[ai.mmsi].toString();\r\n                    if ((_displayedVessels==\"all\" || _displayedVessels.indexOf(mmsi) >= 0) && \r\n                        _notDisplayedVessels.indexOf(mmsi) < 0)\r\n                        return true;\r\n                    else\r\n                        return false;\r\n                });\r\n            } \r\n        }\r\n\r\n    },\r\n    _markers,\r\n    _visibleMarkers = [],\r\n    _markerIcon = function(icon, cog, sog, vtype, group_style){        \r\n        let type_color = \"#000\";\r\n        if (icon.startsWith(\"sog\")){\r\n            if(sog>=8){type_color = \"#09ab00\";}\r\n            else if(4<sog && sog<8){type_color = \"#d1a710\";}\r\n            else if(0<sog && sog<=4){type_color = \"#ff0f0f\";}\r\n            else{type_color = \"#ff0f0f\";}                 \r\n        }\r\n        else\r\n        switch(vtype){\r\n            case \"Cargo\": type_color = \"#33a643\"; break;\r\n            case \"Fishing\": type_color = \"#f44336\"; break;\r\n            case \"Tanker\": type_color = \"#246cbd\"; break;\r\n            case \"Passenger\": type_color = \"#c6b01d\"; break;\r\n            case \"HSC\": type_color = \"#ff6f00\"; break;\r\n            case 'Pleasure Craft': \r\n            case 'Sailing': type_color = \"#9c27b0\"; break;\r\n            case 'Dredging':\r\n            case 'Law Enforcement':\r\n            case 'Medical Transport':\r\n            case 'Military':\r\n            case 'Pilot':\r\n            case 'Port Tender':\r\n            case 'SAR':\r\n            case 'Ships Not Party to Armed Conflict':\r\n            case 'Spare':\r\n            case 'Towing':\r\n            case 'Tug':\r\n            case 'Vessel With Anti-Pollution Equipment':\r\n            case 'WIG':\r\n            case 'Diving': type_color = \"#9b4628\"; break;\r\n        }\r\n        if (sog)\r\n        return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"21\" height=\"21\" viewBox=\"0 0 21 21\" style=\"transform:rotate(' + (!cog?0:cog) + 'deg)\"><title>1</title><path style=\"fill:' + type_color + ';\" d=\"M13.8,20.07a1,1,0,0,1-.69-0.28l-1.79-1.72a0.72,0.72,0,0,0-1,0L8.52,19.79a1,1,0,0,1-.69.28,1,1,0,0,1-1-1V8.65c0-1.52,1.55-7.59,4-7.59s4,6.07,4,7.59V19a1,1,0,0,1-1,1h0Z\"/><path style=\"fill:' + group_style + ';\" d=\"M10.82,1.57c1.93,0,3.5,5.57,3.5,7.09V19a0.52,0.52,0,0,1-.51.53,0.49,0.49,0,0,1-.34-0.14l-1.79-1.72a1.22,1.22,0,0,0-1.71,0L8.17,19.42a0.49,0.49,0,0,1-.34.14A0.52,0.52,0,0,1,7.32,19V8.65c0-1.51,1.57-7.09,3.5-7.09h0m0-1c-3,0-4.5,6.72-4.5,8.09V19a1.52,1.52,0,0,0,1.51,1.53,1.49,1.49,0,0,0,1-.42l1.79-1.72a0.22,0.22,0,0,1,.32,0l1.79,1.72a1.49,1.49,0,0,0,1,.42A1.52,1.52,0,0,0,15.32,19V8.65c0-1.37-1.51-8.09-4.5-8.09h0Z\"/><ellipse style=\"fill:#fff;\" cx=\"10.82\" cy=\"10.54\" rx=\"1.31\" ry=\"1.35\"/><path style=\"fill:#fff;\" d=\"M10.73,3.34h0.12a0.35,0.35,0,0,1,.35.35v6.85a0,0,0,0,1,0,0H10.38a0,0,0,0,1,0,0V3.69A0.35,0.35,0,0,1,10.73,3.34Z\"/></svg>';\r\n        else\r\n        return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"21\" height=\"21\" viewBox=\"0 0 21 21\" style=\"transform:rotate(' + (!cog?0:cog) + 'deg)\"><title>1</title><rect style=\"fill:' + type_color + ';stroke:' + group_style + ';stroke-miterlimit:10;\" x=\"5.9\" y=\"5.6\" width=\"9.19\" height=\"9.19\" rx=\"2\" ry=\"2\" transform=\"translate(-4.13 10.41) rotate(-45)\"/><circle style=\"fill:#fff;\" cx=\"10.5\" cy=\"10.19\" r=\"1.5\"/></svg>';\r\n    },\r\n    _eraseMyFleetMarker = function(mmsi){\r\n        if (!_markers)\r\n            _markers = L.layerGroup().addTo(nsGmx.leafletMap);\r\n        else{\r\n            let layers = _markers.getLayers(), layer;\r\n            for (var i in layers)\r\n                if (layers[i].id==mmsi){\r\n                    layer = layers[i];\r\n                    break;\r\n                }\r\n                layer && _markers.removeLayer(layer);\r\n        }\r\n    },\r\n    _drawMyFleetMarker = function(args, markerTemplate, group, ai, isVisible){ \r\n        let data = args.properties;\r\n        let di = nsGmx.widgets.commonCalendar.getDateInterval();\r\n// console.log(data[ai.mmsi]+\" \"+data[ai.vessel_name]+\" \"+data[ai.cog]+\" \"+data[ai.sog]+\" y=\"+data[ai.latitude]+\" x=\"+data[ai.longitude]+\" \"+new Date(data[ai.ts_pos_utc]*1000))\r\n//console.log(markerTemplate)\r\n        let icon = args.parsedStyleKeys.iconUrl.replace(/.+(\\/|%5C)(?=[^\\/]+$)/, '')\r\n//console.log(icon)\r\n\r\n        _eraseMyFleetMarker(data[ai.mmsi]);\r\n\r\n        if (!isVisible)\r\n            return;\r\n\r\n        let label_line = function(label, label_color, label_shadow){\r\n            if (label!=\"\")\r\n            return '<div style=\"height:14px;\">'+\r\n            '<div class=\"label_shadow\" style=\"height:14px;color' + label_shadow.color + \";text-shadow:\" + label_shadow.text_shadow + '\">' + label + '</div>'+\r\n            '<div class=\"label_color\" style=\"position:relative;top:-14px;color:' + label_color + '\">' + label + '</div></div>';\r\n            else\r\n            return \"\";\r\n        }\r\n        if (di.get(\"dateBegin\").getTime()<=data[ai.ts_pos_utc]*1000 && data[ai.ts_pos_utc]*1000<di.get(\"dateEnd\").getTime()){ \r\n            let temp = {};\r\n            temp.group_name = label_line(group.default?\"\":(group.title), group.label_color, group.label_shadow)\r\n            temp.vessel_name = label_line(data[ai.vessel_name], group.label_color, group.label_shadow);    \r\n            temp.sog = label_line(data[ai.sog] + _gtxt(\"AISSearch2.KnotShort\"), group.label_color, group.label_shadow);  \r\n            temp.cog = label_line(isNaN(data[ai.cog])?\"\":data[ai.cog].toFixed(1) + \"&deg;\", group.label_color, group.label_shadow);    \r\n            temp.marker = _markerIcon(icon, data[ai.cog], data[ai.sog], data[ai.vessel_type], group.marker_style);\r\n            let m = L.marker([data[ai.latitude], data[ai.longitude]>0?data[ai.longitude]:360+data[ai.longitude]],\r\n                {\r\n                    id:data[ai.mmsi],\r\n                    icon: L.divIcon({\r\n                        className: 'mf_label gr' + group.id,\r\n                        html: Handlebars.compile(markerTemplate)(temp)\r\n                    }),\r\n                    zIndexOffset:1000\r\n                });\r\n            m.id = data[ai.mmsi];\r\n            _markers.addLayer(m);\r\n        }\r\n\r\n    },\r\n    _switchLayers = function(l1, l2){\r\n        //l1 && console.log(l1.getGmxProperties().name +\" \"+ !!(l1._map))\r\n        if (l2._map)\r\n            return;\r\n        let lmap = nsGmx.leafletMap;\r\n        if (l1 && l2){\r\n            lmap.removeLayer(l1);\r\n            lmap.addLayer(l2);\r\n        }\r\n    },\r\n    _legendSwitchedHandlers = [],\r\n    _legendSwitched = function(showAlternative){\r\n        _legendSwitchedHandlers.forEach(h=>h(showAlternative));\r\n    };\r\n\r\n    return {\r\n        set specialVesselFilters({key, value}) {\r\n            if (!_specialVesselFilters)\r\n                _specialVesselFilters = {};\r\n            _specialVesselFilters[key] = value;\r\n            //_setVesselFilter();\r\n        },\r\n        get displayedTrack(){ return _displayedTrack; },\r\n        set displayedTrack(value){ _displayedTrack = value; },\r\n        get hasAlternativeLayers(){ return _lastPointLayerAlt; },\r\n        get needAltLegend(){ return !!_lastPointLayerAltFact._map; },\r\n        showTrack: function (mmsiArr, dates) {\r\n            _displayedTrack = { mmsi:mmsiArr && mmsiArr.length? mmsiArr[0] : null};\r\n            if (dates)\r\n                _displayedTrack.dates = { mmsi:mmsiArr[0], list:dates };\r\n            if (_aisLayer || _tracksLayer)\r\n                _displayedTrack.mmsi = mmsiArr[0];\r\n            else\r\n                _displayedTrack.mmsi = null;\r\n            _setTrackFilter();\r\n        },\r\n        showAllTracks: function(doit){\r\n            let lmap = nsGmx.leafletMap;\r\n            if (doit){\r\n                if (_aisLayer && _aisLayer.removeFilter){\r\n                    _aisLayer.removeFilter();\r\n                    lmap.addLayer(_aisLayer);\r\n                }                \r\n                if (_tracksLayer && _tracksLayer.removeFilter){\r\n                    _tracksLayer.removeFilter();\r\n                    lmap.addLayer(_tracksLayer);\r\n                }\r\n            }\r\n            else{\r\n                _displayedTrack = null;\r\n                _setTrackFilter();\r\n            }\r\n        },\r\n        hideVesselsOnMap: function (vessels) {\r\n            if (vessels && vessels.length)\r\n                _notDisplayedVessels = vessels.map(v=>v);\r\n            else\r\n                _notDisplayedVessels.length = 0;\r\n//console.log(_notDisplayedVessels);\r\n            _setTrackFilter();\r\n            _setVesselFilter();\r\n        },\r\n        restoreDefault: function(){                   \r\n            nsGmx.leafletMap.addLayer(_screenSearchLayer);\r\n            _lastPointLayerAlt && nsGmx.leafletMap.removeLayer(_lastPointLayerAlt); \r\n            _historyLayerAlt && nsGmx.leafletMap.removeLayer(_historyLayerAlt); \r\n            _tracksLayerAlt && nsGmx.leafletMap.removeLayer(_tracksLayerAlt);\r\n        },\r\n        showVesselsOnMap: function (vessels) {            \r\n            _displayedVessels = vessels!=\"all\" ? vessels.map(v=>v) : \"all\";           \r\n//console.log(_displayedVessels);\r\n            _setTrackFilter();\r\n            _setVesselFilter();\r\n        },\r\n        redrawMarkers: function () {\r\n            _setVesselFilter();\r\n        },\r\n        clearMyFleetMarkers: function(){\r\n//console.log(\"clearMyFleetMarkers\")\r\n            _markers && _markers.clearLayers();\r\n        },\r\n        eraseMyFleetMarker: _eraseMyFleetMarker,\r\n        drawMyFleetMarker: _drawMyFleetMarker,\r\n        highlightMarker: function(i, group){\r\n            $('.mf_label.gr'+group.id+' svg').each((i,e)=>{\r\n                let paths = e.querySelectorAll('path');\r\n                if(paths[1])\r\n                    paths[1].style.fill = group.marker_style;\r\n            })\r\n            $('.mf_label.gr'+group.id+' svg rect').css({\"stroke\":group.marker_style});\r\n\r\n            $('.mf_label.gr'+group.id+' .label_color').css({\"color\":group.label_color});\r\n            $('.mf_label.gr'+group.id+' .label_shadow').css({\"color\":group.label_shadow.color, \"text-shadow\":group.label_shadow.text_shadow});\r\n        },\r\n        switchLegend: function(showAlternative){\r\n            _switchLayers(_screenSearchLayer, _lastPointLayerAlt);\r\n            let temp = _screenSearchLayer;\r\n            _screenSearchLayer = _lastPointLayerAlt;\r\n            _lastPointLayerAlt = temp;\r\n            _switchLayers(_aisLayer, _historyLayerAlt);\r\n            temp = _aisLayer;\r\n            _aisLayer = _historyLayerAlt;\r\n            _historyLayerAlt = temp;\r\n            _switchLayers(_tracksLayer, _tracksLayerAlt);\r\n            temp = _tracksLayer;\r\n            _tracksLayer = _tracksLayerAlt;\r\n            _tracksLayerAlt = temp;\r\n            _setTrackFilter();\r\n            _setVesselFilter();\r\n            _legendSwitched(showAlternative);\r\n        },\r\n        onLegendSwitched: function(handler){    \r\n            _legendSwitchedHandlers.push(handler);\r\n        }\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Toolbox.js"],"sourceRoot":""}